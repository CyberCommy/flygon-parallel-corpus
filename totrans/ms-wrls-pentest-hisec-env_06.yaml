- en: Chapter 6. Vulnerability Assessment
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the previous chapter, we discussed how to access the network and identify
    hosts on the network. In this chapter, we will cover a very important topic, vulnerability
    assessments, which leads us to a question, what is a vulnerability assessment?
  prefs: []
  type: TYPE_NORMAL
- en: 'A **vulnerability assessment**, also known as **vulnerability analysis**, is
    where a security professional discovers, identifies, and classifies potential
    security vulnerabilities (holes) in a computer system, network, or other forms
    of electronic infrastructures. In addition, vulnerability assessments can provide
    an effective countermeasure to evaluate threats. Most security professionals usually
    follow a step-by-step procedure to carry out vulnerability assessments. A common
    vulnerability assessment consists of the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Discovering and classifying computer systems and networks
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Listing the most important services
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Identifying potential security threats to each service
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Planning a strategy to defend against the potential threats
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Finding ways to minimize or reduce risk if an attack should occur
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If a person or an organization should discover any vulnerability, they are held
    responsible for the vulnerability and should report it to the vendor. If a vulnerability
    is detected as a high-level threat without the vendor being notified, it is called
    **zero-day**. A zero-day attack will be common where a vulnerability isn't being
    addressed or patched by the developer. This is widely known where the device or
    software is no longer supported by the vendor.
  prefs: []
  type: TYPE_NORMAL
- en: If the threat is low, the vendor most likely won't provide a fix until the next
    update. It all depends on what the threat is and what it can do. If a vulnerability
    allows remote executables or worse, root or administrator rights without authorization,
    it should be patched immediately, but that's not always the case. It depends on
    how the vendor handles that kind of situation. The organization may not be able
    to afford that.
  prefs: []
  type: TYPE_NORMAL
- en: Vulnerability assessments are performed mostly by white hats or certified ethical
    hackers, but there are times where black hats will use it for the opposite reasons.
    They can conduct vulnerability assessments to further identify what they can get
    their hands on through someone's network. Using these methods to access vulnerabilities,
    security experts can discover weaknesses and provide guidance and countermeasures
    to prevent an attack.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we will be covering the following topics:'
  prefs: []
  type: TYPE_NORMAL
- en: Planning an assessment
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Setting up a vulnerability scanner
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Running a vulnerability scanner
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Generating reports
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Resolving vulnerabilities
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Planning an assessment
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Before we can conduct an assessment, we need to start planning an assessment.
    We start by asking ourselves several questions relating to the assessment. Let's
    begin!
  prefs: []
  type: TYPE_NORMAL
- en: How we will be spending our time and resources?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Answer: If you are to conduct an assessment for an individual or business,
    you need to get an estimated amount of time it will take to successfully run an
    assessment. Knowing what you will be using to conduct the assessment is also good
    to know beforehand.'
  prefs: []
  type: TYPE_NORMAL
- en: Do you have enough support evidence on your discoveries?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Answer: It is good practice to make sure you have enough information to cover
    the discoveries you make during the vulnerability assessment. Knowing what each
    vulnerability is and how it works is essential when you begin writing reports.
    Providing a proof of concept is also good.'
  prefs: []
  type: TYPE_NORMAL
- en: When a vulnerability is detected and identified, what is the best way to address
    the problem?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Answer: This question really depends on the level of the threat. The most common
    things to do are make sure you have the latest updates, upgrade your software,
    turn off any background services that aren''t being used, provide any extra levels
    of security such as complex passwords and two-way authentication. Report the vulnerability
    to the vendor.'
  prefs: []
  type: TYPE_NORMAL
- en: How can we improve detection rate and minimize security threats?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Answer: Commercial hardware firewalls that can utilize IDS and IPS monitoring—proactive
    scanners that will detect threats on the spot. WatchGuard provides excellent security
    modules such as packet filtering, intrusion prevention service, application control,
    web blocker, gateway antivirus, spam blocker, and much more within their hardware
    firewalls and unified threat management systems. Always make sure you update your
    software and hardware to reduce risk.'
  prefs: []
  type: TYPE_NORMAL
- en: To run a successful assessment, it requires an objective and logical planning.
  prefs: []
  type: TYPE_NORMAL
- en: Components of a vulnerability assessment plan
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'We will be discussing several key components to a vulnerability assessment
    plan. The following is an example:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Primary objective:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How is this objective handled?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How will this objective be accessed?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Who is involved in the assessment?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Whose patches are available at the vendor side?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Identifying common vulnerabilities
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Summarize
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '1st objective:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Identifies the issues
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '2nd objective:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Provides a temporary or permanent solution
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '3rd, 4th, and so on:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Depending on the situation, may require additional objectives
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Planning the process of a vulnerability assessment
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In this section, we will be going over an example of how to plan a vulnerability
    assessment:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Objectives:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Are there any open networks available? If so, what are they used for?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Criteria:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: What is the priority of this objective?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Strategy:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If there are unauthorized users on the network, can they provide any damage
    to workstations or servers?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Are they on a separate VLAN or subnet?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Methods:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: What can we do to meet the objective?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Time:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Is there a deadline?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: When can we provide a solution?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Results:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Who will need to know about the results?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How can we prevent future unauthorized user access?
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: This should give you a good idea on planning your own vulnerability assessment.
    Use this as a guide for when you provide service for an individual or business.
    Next, we will be setting up a vulnerability scanner. The vulnerability scanner
    we will be covering is **Nessus**.
  prefs: []
  type: TYPE_NORMAL
- en: Before we start setting up a vulnerability scanner, we want to go over what
    a vulnerability scanner is and why it is extremely important to understand. A
    vulnerability scanner is exactly what it sounds like. It is a program or software
    security related tool that will scan computers, devices, and networks for weaknesses.
    In most cases, it will automatically tell you what low, medium, or high security
    threats are available. From a security professional's point of view, this can
    be extremely helpful to further analyze what could potentially threaten an individual
    or business.
  prefs: []
  type: TYPE_NORMAL
- en: If a black hat hacker were to use this tool, they could quickly gain unauthorized
    access to confidential information or business data by exploiting the given vulnerability.
    Our only way of protecting against a vulnerability scanner on a corporate network
    is to create VLANs that separate each department, enforce strong group policies
    that prevent untrusted executables and installations, limit the use of flash drives,
    and offer any form of protection against running unauthorized programs. Employees
    should only be running programs that help accomplish their work; turning on a
    URL blocker and adding security tools, websites can quickly lock down those users.
  prefs: []
  type: TYPE_NORMAL
- en: It is important to understand what a vulnerability scanner is. This is because
    this tool can be very helpful in determining what could possibly be a backdoor
    to your system or even your entire network if a hardware firewall were to in fact
    have a particular service or port open that shouldn't have been turned on in the
    first place. Default settings in firewalls and routers are great because they
    just work right? Wrong! It is very important that you disable any unused services
    and block all ports that aren't being used such as FTP, RDP, SSH, and Telnet.
  prefs: []
  type: TYPE_NORMAL
- en: We will be using the Nessus vulnerability scanner within Kali Linux. Nessus
    is a proprietary comprehensive vulnerability scanner developed by Tenable Network
    Security. They offer both personal and commercial licensed software. We will be
    using the personal version for demonstrations.
  prefs: []
  type: TYPE_NORMAL
- en: Nessus is one of the world's most popular vulnerability scanners. It is currently
    being used by over 80,000 organizations worldwide. Nessus is designed to automatically
    discover known security vulnerabilities. One of the best things about Nessus is
    that it runs as a client and server. It can be placed on the network, allowing
    scans to be conducted from anywhere. It runs on Microsoft Windows, Mac OS X, Linux,
    FreeBSD, Solaris, and IBM/AIX. The reporting functionality is excellent for penetration
    testers.
  prefs: []
  type: TYPE_NORMAL
- en: 'Nessus will detect the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Vulnerabilities that provide remote access
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Access to sensitive data on a system
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Misconfigured systems (missing security patches, open ports, and so on)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Commonly used passwords, default passwords, and blank passwords
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Denial of service attacks by using mangled packets
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: PCI DSS audits
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Not only will it detect vulnerabilities, it will also provide you with information
    on the vulnerability and how serious the threat is. It will provide links to additional
    information and if there is a security patch available, it will provide links
    to download these security patches to help provide that extra layer of security.
  prefs: []
  type: TYPE_NORMAL
- en: Setting up a vulnerability scanner
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section, we will be focusing on Nessus. We will download and install
    Nessus, register for an activation code, activate Nessus, and then run our first
    scan.
  prefs: []
  type: TYPE_NORMAL
- en: Downloading Nessus
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Kali Linux does not come with Nessus preinstalled, so we will need to download
    and install Nessus before we start scanning for vulnerabilities. Navigate to the
    following website to download the latest version of Nessus:'
  prefs: []
  type: TYPE_NORMAL
- en: '[http://www.tenable.com/products/nessus/select-your-operating-system](http://www.tenable.com/products/nessus/select-your-operating-system)'
  prefs: []
  type: TYPE_NORMAL
- en: 'Select the download according to your operating system:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Downloading Nessus](img/3183OS_06_01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Installing Nessus
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In this demonstration, we will be installing the Nessus vulnerability scanner.
    Perform the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Open a Terminal.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Enter the following command and press *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'The following is the output:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Installing Nessus](img/3183OS_06_02.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Enter the following command and press *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'This command will start the Nessus vulnerability scanner tool:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Installing Nessus](img/3183OS_06_03.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Open a web browser and navigate to `https://127.0.0.1:8834`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: When prompted for the site's security certificate, click on **Proceed anyway**.
    The following screen appears:![Installing Nessus](img/3183OS_06_04.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You will be presented with the welcome screen for Nessus. Click on the **Get
    started** button:![Installing Nessus](img/3183OS_06_05.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Create a login and password and click on **Next**:![Installing Nessus](img/3183OS_06_06.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Next, you will need to obtain an activation code:![Installing Nessus](img/3183OS_06_07.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Open your web browser and navigate to [http://www.tenable.com/products/nessus-home](http://www.tenable.com/products/nessus-home).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You will need to fill in your information on the right-hand side of the web
    page:![Installing Nessus](img/3183OS_06_08.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Go back to the activation code field and paste the code you have received via
    e-mail:![Installing Nessus](img/3183OS_06_09.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: After you have entered your activation code, you should receive a message as
    shown:![Installing Nessus](img/3183OS_06_10.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Nessus will download the plugins. This will take some time so, go do something
    else and come back when you see this:![Installing Nessus](img/3183OS_06_11.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Once the plugins have finished downloading, you should be prompted to enter
    your login and password for Nessus home:![Installing Nessus](img/3183OS_06_12.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: That's it! You have successfully installed and registered the Nessus vulnerability
    scanner.
  prefs: []
  type: TYPE_NORMAL
- en: Running the vulnerability scanner
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Before we can start a scan, we need to create a policy for the scan. Perform
    the following steps to do so:'
  prefs: []
  type: TYPE_NORMAL
- en: Log in with your new username that you created earlier:![Running the vulnerability
    scanner](img/3183OS_06_13.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **Policies** from Nessus and the following screen appears:![Running
    the vulnerability scanner](img/3183OS_06_14.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **+** symbol to add a new policy:![Running the vulnerability scanner](img/3183OS_06_15.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on the **Save** button to save your settings:![Running the vulnerability
    scanner](img/3183OS_06_16.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You should receive a success message.
  prefs: []
  type: TYPE_NORMAL
- en: Click on **Scans**:![Running the vulnerability scanner](img/3183OS_06_17.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Next, click on the **+** symbol:![Running the vulnerability scanner](img/3183OS_06_18.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'The fields will need to be filled in as follows:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Name**: `Internal Scan`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Description**: `Internal Scan`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Targets**: `192.168.1.0/24`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'This is shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Running the vulnerability scanner](img/3183OS_06_19.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Click on the **Launch** button to start the scan.![Running the vulnerability
    scanner](img/3183OS_06_20.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: It should display the **Running** status. This process may take a while as it
    has to scan your entire internal network.
  prefs: []
  type: TYPE_NORMAL
- en: Click on the name **Internal Scan**. It should provide scan results, a bar graph,
    and more, as shown in the following screenshot:![Running the vulnerability scanner](img/3183OS_06_21.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **Vulnerabilities** tab. It should provide a list of vulnerabilities
    listing **HIGH** on top:![Running the vulnerability scanner](img/3183OS_06_22.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on one of the vulnerabilities. It will provide additional information:![Running
    the vulnerability scanner](img/3183OS_06_23.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Scroll down to view a solution. In this case, it would be wise to upgrade to
    the latest version of OpenSSL:![Running the vulnerability scanner](img/3183OS_06_24.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The report provides information on the vulnerability and what it does. It will
    provide a solution with reference links to additional information. For the average
    user, this will provide you all the details on what the source of the problem
    is, what the risks and threats are, and how to resolve the problem.
  prefs: []
  type: TYPE_NORMAL
- en: Generating reports
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Generating reports helps organize your work and gives you one spot to review
    all your outputs and results during your penetration test. Reports are important
    because they provide all the information in one area without having to refer back
    to another document.
  prefs: []
  type: TYPE_NORMAL
- en: Now that we have installed and run a scan, it's time to grab the reports from
    our scan. With your results displayed, click on **Vulnerabilities**:![Generating
    reports](img/3183OS_06_25.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **Export**:![Generating reports](img/3183OS_06_26.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Drag and drop the panels on the left to the right-hand side. Click on **Export**.
    This will download the file format that you have chosen:![Generating reports](img/3183OS_06_27.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Open the file to see whether it is in a viewable and working format, as shown:![Generating
    reports](img/3183OS_06_28.jpg)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Congratulations, you have successfully generated a vulnerability report in Nessus!
  prefs: []
  type: TYPE_NORMAL
- en: Resolving vulnerabilities
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Vulnerabilities in programs are less dangerous than operating system vulnerabilities
    because hackers rarely target them. Even then, some program vulnerabilities can
    pose major threats, for example, a vulnerability in Internet Explorer or Microsoft
    Office. These vulnerabilities are usually resolved through Windows updates as
    soon as a patch is available. Security updates are available from Microsoft Update,
    Windows Update, and Office Update. You can find them easily by doing a keyword
    search for `security update`. For example, if Nessus has detected MS07-036 as
    a vulnerability on your Windows system, you can search for that security bulletin
    number and then proceed by downloading all the applicable updates to patch your
    system. When it comes to program vulnerabilities, you must always check for the
    latest software updates and download them when they are available.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Well, that just about wraps up this chapter! I certainly hope you enjoyed this
    chapter. We discussed how to start planning out an assessment, the key components
    of an assessment, and the step-by-step process of an assessment. We installed
    Nessus, registered it, downloaded plugins, and then ran Nessus. We also created
    a new policy and scan, identified vulnerabilities, read the vulnerability details,
    and followed it with a solution to the vulnerability. Now, we will be moving onward
    to the next chapter where you will be learning client-side attacks!
  prefs: []
  type: TYPE_NORMAL
