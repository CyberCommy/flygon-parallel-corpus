- en: Assessments
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Chapter 1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Scaling, operational cost, and longer release cycle.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Master components run on the master node. These components are responsible for
    the management of the worker nodes. The master components include `kube-apiserver`,
    `etcd`, `kube-scheduler`, `kube-controller-manager`, `cloud-controller-manager`,
    and `dns-server`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Kubernetes Deployments help scale pods up/down based on labels and selectors.
    Deployments encapsulate replica sets and pods. The YAML spec for a Deployment
    consists of number of instances of pods and `template`, which is identical to
    a Pod specification.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: OpenShift, K3S, and Minikube.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Kubernetes environments are highly configurable and are composed of a myriad
    of components. Configurability and complexity with insecure defaults is a big
    cause of concern. Additionally, the compromise of master components in cluster
    is the easiest way to cause a breach.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Chapter 2
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Pod.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Network namespace and IPC namespace.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: A placeholder to hold a network namespace for other containers.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: ClusterIP, NodePort, LoadBalancer, and ExternalName.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Ingress supports layer 7 routing and doesn't require extra load balancers from
    the cloud provider, while LoadBalancer services require one load balancer per
    service.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Chapter 3
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Threat modeling is an iterative process that starts at the design phase.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: End user, internal attacker, and privileged attacker.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Unencrypted data stored in `etcd`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The complexity of the Kubernetes environment increases the difficulty of using
    threat modeling applications in Kubernetes environments.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Kubernetes introduces additional assets and interactions with applications.
    This increases the complexity of applications in Kubernetes, increasing the attack
    surface.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Chapter 4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A `Role` object contains rules consisting of verbs and resources that indicate
    the operational privileges for resources in a namespace.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: A `RoleBinding` object links the `Role` object in a namespace to a group of
    subjects (for example, `User` and `ServiceAccount`). It is used to grant privileges
    defined in the Role objects to the subjects.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`RoleBinding` indicates that the privileges the subjects have are effective
    in the `RoleBinding` object''s namespace. `ClusterRoleBinding` indicates that
    the privileges the subjects have are effective in the entire cluster.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`hostPID`, `hostNetwork`, and `hostIPC`.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Create a network policy for the Pod with an egress rule.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Chapter 5
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Master components, worker components, and Kubernetes objects.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Pod, service/Ingress, `api-server`, nodes, and namespace.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: RBAC and network policy.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Processes in the Pod can access host the PID namespace, viewing all the processes
    running in the worker node.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Chapter 6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Token-based authentication enables static tokens to be used to identify the
    origin of requests in the cluster. Static tokens cannot be updated without restarting
    the API server and so should not be used.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The `NodeRestriction` admission controller ensures that a kubelet can only modify
    the node and Pod objects for the node that it is running on.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Pass `--encryption-provider-config` to the API server to ensure data is encrypted
    at rest in `etcd`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Security vulnerabilities in `dnsmasq`, performance issues in SkyDNS, and a single
    container instead of three for `kube-dns` to provide the same functionality.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'You can use `kube-bench` on an EKS cluster as follows:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**$ git clone :** https://github.com/aquasecurity/kube-bench**â€¨    $ kubectl apply -f job-eks.yaml**'
  prefs: []
  type: TYPE_NORMAL
- en: Chapter 7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Static tokens and basic authentication should not be used in production clusters.
    These modules use static credentials, which require a restart of the API server
    to be updated.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Cluster administrators can use the user impersonation privileges to test the
    permissions granted to a new user. Using `kubectl`, cluster administrators can
    use the `--as --as-group` flags to run requests as a different user.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Node and RBAC are enabled by default in Kubernetes. These should be used. If
    the cluster uses a remote API for authorization, Webhook mode should be used instead.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The `EventRateLimit` admission controller specifies the maximum limit for requests
    that can be serviced by the API server. On the other hand, LimitRanger ensures
    that Kubernetes objects adhere to the resource limits specified by the `LimitRange`
    object.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'The `rego` policy to deny the creation of an Ingress with the `test.example`
    endpoint is as follows:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: Chapter 8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Defines a command to ask Docker Engine to check the health status of the container
    periodically.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The `COPY` instruction can only copy files from build machine to the filesystem
    of the image, while the `ADD` instruction can not only copy files from localhost
    but also retrieve files from remote URLs to the filesystem of the image. Using
    `ADD` may introduce the risk of adding malicious files from the internet to the
    image.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`CAP_NET_BIND_SERVICE`.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: With the `runAsNonRoot` setting set to `true`, kubelet will block the container
    from starting if run as root user.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Create a role with privilege, use the `PodSecurityPolicy` object, and create
    a `rolebinding` object to assign the role to the service account that is used
    by the workload.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Chapter 9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '`Docker history <image name>`.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 7-8.9.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`anchore-cli image add <image name>`.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`anchore-cli image vuln <image name> all`.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`anchore-cli evaluate check <image digets> --tag <image full tag>`.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: It helps identify images with latest publicly known vulnerabilities.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Chapter 10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Resource requests specify what a Kubernetes object is guaranteed to get, whereas
    limits specify the maximum resources a Kubernetes object can use.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'The resource quota that limits memory to 500 mi is as follows:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: LimitRanger is an admission controller that enforces LimitRanges. LimitRange
    defines constraints on a Kubernetes resources. A limit range can be applied to
    a Pod, container, or `persistantvolumeclaim`. Namespace resource quotas are similar
    to `LimitRange`, but are enforced for the entire namespace.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Service account tokens.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Prometheus and Grafana.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Chapter 11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The secret data will be recorded in the Kubernetes audit log.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`--master-zones`.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Sync the updated secret to the Pod's mounted volume.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: System calls and Kubernetes audit events.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '`proc.name`.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Checkpoint a running container, which can be restored later in a sandboxed environment.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Troubleshooting and security investigation.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Chapter 12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Dashboard is used without authentication enabled.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Do not run Dashboard, or enable authentication for Dashboard.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: No. It could be a crypto mining attack, but it could also be caused by some
    other things, such as application errors.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The crypto mining binary uses the HTTP or HTTPS protocol to connect to the mining
    pool server instead of stratum.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Kubernetes cluster provisioning, build, deployment, and runtime.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Chapter 13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Cluster administrators keep track of CVE IDs to ensure that the Kubernetes cluster
    is not vulnerable to a publicly known issue. Security researchers study the references
    section to understand the technical details of the issue to develop mitigations
    for a CVE. Lastly, attackers study the references section to find unpatched variations
    or use similar techniques to discover issues in other parts of the code.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Client-side issues often lead to data exfiltration or code execution on the
    client side. Build machines or machines of cluster administrators often contain
    sensitive data, and an attack on such machines can have a significant economic
    impact on the organization.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: DoS issues on `api-server` can lead to disruption of the availability of the
    entire cluster.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Unauthenticated DoS issues are more severe than authenticated DoS issues. Ideally,
    unauthenticated users should not be able to communicate with `api-server`. If
    an unauthenticated user is able to send requests and cause a DoS issue for `api-server`,
    it is worse than an authenticated user. Authenticated DoS requests are also very
    severe since a misconfiguration in the cluster can allow an unauthenticated user
    to escalate privileges and become an authenticated user.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Security advisories and announcements by Kubernetes are a great way to learn
    about any new publicly known vulnerabilities. These announcements and advisories
    are fairly noisy, and administrators can easily miss an important issue. Running
    `kube-hunter` regularly helps cluster admins identify any publicly known issues
    that administrators might have missed.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
