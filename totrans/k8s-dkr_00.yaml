- en: Preface
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Kubernetes has taken the world by storm, becoming the standard infrastructure
    for DevOps teams to develop, test, and run applications. Most enterprises are
    either running it already, or are planning to run it in the next year. A look
    at job postings on any of the major job sites shows that just about every big-name
    company has Kubernetes positions open. The fast rate of adoption has led to Kubernetes-related
    positions growing by over 2,000% in the last 4 years.
  prefs: []
  type: TYPE_NORMAL
- en: One common problem that companies are struggling to address is the lack of enterprise
    Kubernetes knowledge. Since the technology is relatively new, and even newer for
    production workloads, companies have had issues trying to build teams to run clusters
    reliably. Finding people with basic Kubernetes skills is becoming easier, but
    finding people with knowledge on topics that are required for enterprise clusters
    is still a challenge.
  prefs: []
  type: TYPE_NORMAL
- en: Who this book is for
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We created this book to help DevOps teams to expand their skills beyond the
    basics of Kubernetes. It was created from the years of experience we have working
    with clusters in multiple enterprise environments.
  prefs: []
  type: TYPE_NORMAL
- en: There are many books available that introduce Kubernetes and the basics of installing
    clusters, creating deployments, and using Kubernetes objects. Our plan was to
    create a book that would go beyond a basic cluster, and in order to keep the book
    a reasonable length, we will not re-hash the basics of Kubernetes. You should
    have some experience with Kubernetes before reading this book.
  prefs: []
  type: TYPE_NORMAL
- en: While the primary focus of the book is to extend clusters with enterprise features,
    the first section of the book will provide a refresher of key Docker topics, and
    Kubernetes objects. It is important that you have a solid understanding of Kubernetes
    objects in order to get the most out of the more advanced chapters.
  prefs: []
  type: TYPE_NORMAL
- en: What this book covers
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '[*Chapter 1*](B15514_01_Final_ASB_ePub.xhtml#_idTextAnchor018), *Understanding
    Docker and Containers Essentials,* helps you learn what problems Docker and Kubernetes
    address for developers. You will be introduced to different aspects of Docker
    including the Docker daemon, data, installation, and using the Docker CLI.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 2*](B15514_02_Final_ASB_ePub.xhtml#_idTextAnchor044), *Working with
    Docker Data,* discusses how containers need to store data, with some use cases
    only requiring ephemeral disks, while others require persistent disks. In this
    chapter, you will learn about persistent data and how Docker can be used with
    volumes, bind mounts, and tmpfs to store data.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 3*](B15514_03_Final_ASB_ePub.xhtml#_idTextAnchor062), *Understanding
    Docker Networking,* introduces you to networking in Docker. It will cover creating
    different network types, adding and removing container networks, and exposing
    container services.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 4*](B15514_04_Final_ASB_ePub.xhtml#_idTextAnchor083), *Deploying
    Kubernetes Using KinD,* shows how KinD is a powerful tool that allows you to create
    a Kubernetes cluster ranging from a single node cluster to a full multi-node cluster.
    The chapter goes beyond a basic KinD cluster explaining how to use a load balancer
    running HAproxy to load-balance worker nodes. By the end of this chapter, you
    will understand how KinD works and how to create a custom multi-node cluster,
    which will be used for the exercises in the following chapters.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 5*](B15514_05_Final_ASB_ePub.xhtml#_idTextAnchor150), *Kubernetes
    Bootcamp,* covers most of the objects that a cluster includes, whether you need
    a refresher on Kubernetes, or are if you are newer to the platform. It explains
    the objects with a description of what each object does and its function in a
    cluster. This chapter is meant to be a refresher, or a "pocket guide" to objects
    – it does not contain exhaustive details for each object, as that would require
    a second book.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 6*](B15514_06_Final_ASB_ePub.xhtml#_idTextAnchor174), *Services,
    Load Balancing, and External-DNS,* teaches you how to expose a Kubernetes deployment
    using services. Each service type is explained with examples, and you will learn
    how to expose them using both a Layer-7 and a Layer-4 load balancer. In this chapter,
    you will go beyond the basics of a simple Ingress controller, installing MetalLB,
    to provide Layer-4 access to services. You will also install an incubator project
    called external-dns to provide dynamic name resolution for the services exposed
    by MetalLB.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 7*](B15514_07_Final_ASB_ePub.xhtml#_idTextAnchor203), *Integrating
    Authentication into Your Cluster,* considers the question of how users will access
    your cluster once it is built. In this chapter, we''ll detail how OpenID Connect
    works and why you should use it for accessing your cluster. We''ll also cover
    several anti-patterns that should be avoided and why they should be avoided.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 8*](B15514_08_Final_ASB_ePub.xhtml#_idTextAnchor228), *RBAC Policies
    and Auditing,* demonstrates how, once users have access to a cluster, you need
    to be able to limit their access. Whether you are providing an entire cluster
    to your users or just a namespace, you''ll need to know how Kubernetes authorizes
    access via its **role-based access control** system, or **RBAC**. In this chapter,
    we''ll detail how to design RBAC policies, how to debug them, and different strategies
    for multi-tenancy.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 9*](B15514_09_Final_ASB_ePub.xhtml#_idTextAnchor246), *Securing the
    Kubernetes Dashboard,* looks at the Kubernetes Dashboard, which is often the first
    thing users try to launch once a cluster is up and running. There''s quite a bit
    of mythology around the security (or lack thereof). Your cluster will be made
    of other web applications too, such as network dashboards, logging systems, and
    monitoring dashboards too. This chapter looks at how the dashboard is architected,
    how to properly secure it, and examples of how not to deploy it with details as
    to why.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 10*](B15514_10_Final_ASB_ePub.xhtml#_idTextAnchor260), Creating *Pod
    Security Policies,* deals with the security of the nodes that run your **Pod**
    instances. We will discuss how to securely design your containers so they are
    harder to abuse and how to build policies to constrain your containers from accessing
    resources they don''t need. We''ll also cover the deprecation of the **PodSecurityPolicy**
    API and how to handle it.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 11*](B15514_11_Final_ASB_ePub.xhtml#_idTextAnchor272)*,* *Extending
    Security using Open Policy Agent,* provides you with the guidance you need to
    deploy OpenPolicyAgent and GateKeeper to enable policies that can''t be implemented
    using RBAC or PodSecurityPolicies. We''ll cover how to deploy GateKeeper, how
    to write policies in Rego, and how to test your policies using OPA''s built-in
    testing framework.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 12*](B15514_12_Final_ASB_ePub.xhtml#_idTextAnchor295), *Auditing
    Using Falco and EFK,* discusses how Kubernetes includes event logging for API
    access, but it doesn''t have the ability to log events that may be executed inside
    a Pod. To address this limitation, we will install a project that was donated
    to the CNCF called Falco. You will also learn how to present the data that is
    captured by Falco using FalcoSideKick and the **EFK** stack (**ElasticSearch,
    FluentD, and Kibana**). You will get hands-on experience by looking for events
    in Kibana and creating a custom dashboard that contains important events.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 13*](B15514_13_Final_ASB_ePub.xhtml#_idTextAnchor314), *Backing Up
    Workloads,* teaches you how to create a backup of your cluster workloads for disaster
    recovery, or cluster migrations, using Velero. You will go hands-on and create
    a backup of example workloads and restore the backup to a brand-new cluster to
    simulate a cluster migration.'
  prefs: []
  type: TYPE_NORMAL
- en: '[*Chapter 14*](B15514_14_Final_ASB_ePub.xhtml#_idTextAnchor337), *Provisioning
    a Platform,* has you building a platform for automating a multi-tenant cluster
    with GitLab, Tekton, ArgoCD, and OpenUnison. We''ll explore how to build pipelines
    and how to automate their creation. We''ll explore how the objects that are used
    to drive pipelines are related to each other, how to build relationships between
    systems, and finally, how to create a self-service workflow for automating the
    deployment of pipelines.'
  prefs: []
  type: TYPE_NORMAL
- en: To get the most out of this book
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: You should have a basic understanding of the Linux, basic commands, and tools
    such as Git and a text editor such as vi.
  prefs: []
  type: TYPE_NORMAL
- en: 'The chapters contain both theory and hands-on exercises. We feel that the exercises
    help to reinforce the theory, but they are not required to understand each topic.
    If you want to do the exercises in the book, you will need to meet the requirement
    in the following table:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](image/B15514_Table_01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: All exercises were using Ubuntu, but most of them will work on other Linux installations.
    The Falco chapter has steps that are specific to Ubuntu and the exercise will
    likely fail to deploy correctly on other Linux installations.
  prefs: []
  type: TYPE_NORMAL
- en: '**If you are using the digital version of this book, we advise you to type
    the code yourself or access the code via the GitHub repository (link available
    in the next section). Doing so will help you avoid any potential errors related
    to the copying and pasting of code.**'
  prefs: []
  type: TYPE_NORMAL
- en: Download the example code files
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: You can download the example code files for this book from your account at [www.packt.com](http://www.packt.com).
    If you purchased this book elsewhere, you can visit [www.packtpub.com/support](http://www.packtpub.com/support)
    and register to have the files emailed directly to you.
  prefs: []
  type: TYPE_NORMAL
- en: 'You can download the code files by following these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Log in or register at [www.packt.com](http://www.packt.com).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the **Support** tab.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click on **Code Downloads**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enter the name of the book in the **Search** box and follow the onscreen instructions.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Once the file is downloaded, please make sure that you unzip or extract the
    folder using the latest version of the following:'
  prefs: []
  type: TYPE_NORMAL
- en: WinRAR/7-Zip for Windows
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Zipeg/iZip/UnRarX for Mac
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 7-Zip/PeaZip for Linux
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The code bundle for the book is also hosted on GitHub at [https://github.com/PacktPublishing/Kubernetes-and-Docker-The-Complete-Guide](https://github.com/PacktPublishing/Kubernetes-and-Docker-The-Complete-Guide).
    In case there's an update to the code, it will be updated on the existing GitHub
    repository.
  prefs: []
  type: TYPE_NORMAL
- en: We also have other code bundles from our rich catalog of books and videos available
    at [https://github.com/PacktPublishing/](https://github.com/PacktPublishing/).
    Check them out!
  prefs: []
  type: TYPE_NORMAL
- en: Code in Action
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Code in Action videos for this book can be viewed at [http://bit.ly/2OQfDum](http://bit.ly/2OQfDum).
  prefs: []
  type: TYPE_NORMAL
- en: Download the color images
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'We also provide a PDF file that has color images of the screenshots/diagrams
    used in this book. You can download it here: **https://static.packt-cdn.com/downloads/9781839213403_ColorImages.pdf**.'
  prefs: []
  type: TYPE_NORMAL
- en: Conventions used
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: There are a number of text conventions used throughout this book.
  prefs: []
  type: TYPE_NORMAL
- en: '**Code in text**: Indicates code words in text, database table names, folder
    names, filenames, file extensions, pathnames, dummy URLs, user input, and Twitter
    handles. Here is an example: "The final component to identify is **apiGroups**.
    This is an additional area of inconsistency from the URL model."'
  prefs: []
  type: TYPE_NORMAL
- en: 'A block of code is set as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: 'apiVersion: rbac.authorization.k8s.io/v1'
  prefs: []
  type: TYPE_NORMAL
- en: 'kind: ClusterRole'
  prefs: []
  type: TYPE_NORMAL
- en: 'metadata:'
  prefs: []
  type: TYPE_NORMAL
- en: 'name: cluster-pod-and-pod-logs-reader'
  prefs: []
  type: TYPE_NORMAL
- en: 'rules:'
  prefs: []
  type: TYPE_NORMAL
- en: '- apiGroups: [""]'
  prefs: []
  type: TYPE_NORMAL
- en: 'resources: ["pods", "pods/log"]'
  prefs: []
  type: TYPE_NORMAL
- en: 'verbs: ["get", "list"]'
  prefs: []
  type: TYPE_NORMAL
- en: 'When we wish to draw your attention to a particular part of a code block, the
    relevant lines or items are set in bold:'
  prefs: []
  type: TYPE_NORMAL
- en: '- hostPath:'
  prefs: []
  type: TYPE_NORMAL
- en: 'path: /usr/share/ca-certificates'
  prefs: []
  type: TYPE_NORMAL
- en: 'type: DirectoryOrCreate'
  prefs: []
  type: TYPE_NORMAL
- en: 'name: usr-share-ca-certificates'
  prefs: []
  type: TYPE_NORMAL
- en: '**  - hostPath:**'
  prefs: []
  type: TYPE_NORMAL
- en: '**      path: /var/log/k8s**'
  prefs: []
  type: TYPE_NORMAL
- en: '**      type: DirectoryOrCreate**'
  prefs: []
  type: TYPE_NORMAL
- en: '**    name: var-log-k8s**'
  prefs: []
  type: TYPE_NORMAL
- en: '**  - hostPath:**'
  prefs: []
  type: TYPE_NORMAL
- en: '**      path: /etc/kubernetes/audit**'
  prefs: []
  type: TYPE_NORMAL
- en: '**      type: DirectoryOrCreate**'
  prefs: []
  type: TYPE_NORMAL
- en: '**    name: etc-kubernetes-audit**'
  prefs: []
  type: TYPE_NORMAL
- en: 'Any command-line input or output is written as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: PS C:\Users\mlb> kubectl create ns not-going-to-work namespace/not-going-to-work
    created
  prefs: []
  type: TYPE_NORMAL
- en: '**Bold**: Indicates a new term, an important word, or words that you see onscreen.
    For example, words in menus or dialog boxes appear in the text like this. Here
    is an example: "Hit the **Finish Login** button at the bottom of the screen."'
  prefs: []
  type: TYPE_NORMAL
- en: Tips or important notes
  prefs: []
  type: TYPE_NORMAL
- en: Appear like this.
  prefs: []
  type: TYPE_NORMAL
、