- en: Chapter 6. Designing Reports with Navicat
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A powerful **Report Builder** came with the Windows version of Navicat Version
    10, and exclusively in its Enterprise Edition, when this book was being written.
    With Navicat's Report Builder, you can present data from your MySQL databases
    in various reports, such as invoices, sales figures, order summaries, even forms,
    and mailing labels (also known as mail merge). You can even set a scheduler (see
    [Chapter 3](ch03.html "Chapter 3. Data Management with Navicat"), *Data Management
    with Navicat*) to have the reports automatically delivered at a specific time
    and/or at defined intervals.
  prefs: []
  type: TYPE_NORMAL
- en: As you will see in the next sections, the look and feel of Navicat's **Report
    Designer** resembles the **Report Module** of Microsoft Access in many ways.
  prefs: []
  type: TYPE_NORMAL
- en: To be able to follow the tutorial in this chapter, you need to have imported
    the Sakila example database introduced in [Chapter 3](ch03.html "Chapter 3. Data
    Management with Navicat"), *Data Management with Navicat*.
  prefs: []
  type: TYPE_NORMAL
- en: 'As of Version 10 of Navicat Premium and Navicat for MySQL, a powerful Report
    Builder tool is included in the Enterprise Edition for Windows. This chapter will
    train you to develop skills, such as:'
  prefs: []
  type: TYPE_NORMAL
- en: Preparing a dataset by designing queries for reports in a GUI
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Designing reports using a wizard
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Customizing the report design
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Printing to a paper or file in a variety of formats
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: First contact with the tool(s)
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In order to access Navicat''s **Report Manager**, all you need to do is to
    select the server and the database from the left navigation pane, and then click
    on the big **Report** button from the toolbar of Navicat''s main window. Alternatively,
    you may select **View** | **Report** from the main menu bar. Once in the context
    of **Report** (Manager), you can use the buttons on the secondary toolbar to create,
    edit, or delete reports, or right-click anywhere in the object pane to invoke
    a pop-up menu that will let you perform the same actions, as shown in the following
    screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![First contact with the tool(s)](img/image1.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Now let's go ahead and design a simple report based on the view named **film_list**
    from the **sakila** database.
  prefs: []
  type: TYPE_NORMAL
- en: Create a new report using one of the previously described methods. A new, larger
    **Untitled** window should appear, with its **Design** tab active by default.
    You will also notice that the user interface of this window is probably the most
    complex among all the other tools that Navicat features, as Navicat's Report Designer
    is a full-blown, report-building application as it is.
  prefs: []
  type: TYPE_NORMAL
- en: What we need to do first with a blank report is to select a dataset with which
    we will populate our report. Therefore, we need to switch to the **Data** tab
    of this window to specify the source of the report's data.
  prefs: []
  type: TYPE_NORMAL
- en: Preparing the data with Query Wizard
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The **Data** tab presents us with a blank page when opening it for the first
    time. It is very difficult to figure out what the next step will be from here.
    Refer to the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Preparing the data with Query Wizard](img/image2.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'To specify some data source at this point is a little frustrating, as right-clicking
    on the empty area yields nothing, and there''s no toolbar under the **Data** tab
    either. Rather, you need to go to the **File** menu of the menu bar and select
    **New...**. This will bring up a small, modal dialog box asking you to run **Query
    Wizard** or **Query Designer**, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Preparing the data with Query Wizard](img/image3.jpg)'
  prefs: []
  type: TYPE_IMG
- en: We'll go with **Query Wizard** at this time, so make sure that its icon is highlighted,
    and then click on **OK**. The **Query Wizard** window displays two, scrollable
    listboxes (side by side) that some programmers also call shuttle lists. The list
    box on the left-hand side titled **Available Tables** contains the names of all
    **Tables** and **Views** from our **sakila** database, and the one on the right-hand
    side titled **Selected Tables** indicates the items we have picked from the available
    ones.
  prefs: []
  type: TYPE_NORMAL
- en: You will have to click and select one or more items from the list on the left,
    which will be transferred to the list on the right as soon as you press the **>**
    button.
  prefs: []
  type: TYPE_NORMAL
- en: 'For the sake of our simple tutorial, we only need the **film_list** view. Just
    select it by clicking on its name and move it to the list box titled **Selected
    Tables**, and then click on **Next**. The screenshot of the **Query Wizard** window
    is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Preparing the data with Query Wizard](img/image4.jpg)'
  prefs: []
  type: TYPE_IMG
- en: You can skip the next screen simply by clicking on **Next** again, since we
    want all the fields from the database view we have chosen, and this option is
    already selected in this screen by default.
  prefs: []
  type: TYPE_NORMAL
- en: In the screen displaying if we want to **Add calculated fields to the query**,
    we will skip it again by clicking on **No Calculations** and clicking on **Next**
    one more time.
  prefs: []
  type: TYPE_NORMAL
- en: Now we are presented with the option of **Group rows together based on common
    field values**, which we also want to pass by clicking on **No Grouping** and
    clicking on **Next** once more.
  prefs: []
  type: TYPE_NORMAL
- en: 'As for the **Limit the rows returned** screen, we want no limit here, so leave
    **All rows** selected without changing anything else, and hit **Next** again.
    After clicking on **Next**, the window displayed will look similar to the following
    screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Preparing the data with Query Wizard](img/image5.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Here, we will be asked about the way the rows of the dataset we selected will
    be ordered. The default option is **Natural Order** , which should bring the results
    to the report in the same order as they would appear in the **View** (which would
    most probably sort the items by ID). However, I think it would be a good idea
    to sort them by both category and film title for our report. So select **Set Order**
    and then move **film_list.category** to the list box titled **Selected Fields**,
    and then do the same for the **film_list.title**, and finally click on **Next**
    for the last time.
  prefs: []
  type: TYPE_NORMAL
- en: 'The last step will ask us to give our query a name of our choice, and before
    we finally click on **Finish**, we can indicate our preference of whether to **Return
    to the data workspace**, **Preview the query**, or **Modify the query''s design**.
    Go with the first option, which is the default anyway. So when we''re done, our
    data workspace will now contain the **film_list** view, as shown in the following
    screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Preparing the data with Query Wizard](img/image6.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Now to get an idea of the dataset we just prepared, click on the first tiny
    button on the toolbar of the **film_list** window, which will bring up a pop-up
    window titled **Preview Data – film_list** displaying the film records from the
    query that we just created. You might need to enlarge the window and manually
    adjust the column lengths by hovering the mouse arrow over the column heading
    borders and then clicking-and-dragging the columns to the desired length, as shown
    in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Preparing the data with Query Wizard](img/image7.jpg)'
  prefs: []
  type: TYPE_IMG
- en: When you are done with previewing the query results, just click on **OK** at
    the bottom-right of this window.
  prefs: []
  type: TYPE_NORMAL
- en: The other seven buttons on the toolbar help us open up the **Query Designer**
    window for reports, and this window lets you modify the query by selecting the
    tables and fields, defining the filtering criteria, grouping the fields, and so
    on.
  prefs: []
  type: TYPE_NORMAL
- en: 'Now, you can click on the second button on the toolbar of the **film_list**
    table to invoke the **Query Designer** with its **Tables** tab active, to add
    more tables or views to the query by joining them. Similarly, the third button
    will help you open **Query Designer** with its **Fields** tab active, to modify
    the selected fields, which we specified using the **Query Wizard** in the first
    place, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Preparing the data with Query Wizard](img/image8.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '**Query Designer** has some advanced features, which will only be mentioned
    here briefly, but not be covered in detail.'
  prefs: []
  type: TYPE_NORMAL
- en: The **Calcs** tab, for example, is where you can define some dynamic fields
    with aggregate functions, such as `sum()`, `avg()`, `min()`, `max()`, and `count()`,
    or any SQL expression you can use as a function that MySQL supports.
  prefs: []
  type: TYPE_NORMAL
- en: Another example is the **Search** tab, in which you can define some pre-filtering
    criteria, and which will be added to the SQL query as a `WHERE` condition.
  prefs: []
  type: TYPE_NORMAL
- en: For the sake of this simple report, we will leave the **Query Designer** for
    now, and switch to the **Design** tab of the Report Builder to finally start working
    on our report's layout. When we go back to the **Design** tab, we are reminded
    that the canvas that was divided into three areas, as **Header**, **Detail**,
    and **Footer** (also as indicated in the upper left pane titled **Report Tree)**,
    is still blank. However, on the right-hand side of the window, we now see **film_list**
    under **Data Tree** and **Fields for film_list** below it.
  prefs: []
  type: TYPE_NORMAL
- en: Designing the report
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: While it is possible for us to design our report's layout by clicking-and-dragging
    the fields listed from the right-hand side onto the canvas and aligning them as
    desired, this is how a report is normally designed without wizards. This can get
    quite complex, so I will show you an easier way, which will help finish this report
    in no time.
  prefs: []
  type: TYPE_NORMAL
- en: 'Go to the **File** menu and select **New...**. A new dialog box titled **New
    Items** will pop up and will present us with four buttons as icons labeled **Report
    Wizard**, **Report**, **Label Templates**, and **Cross Tab Wizard** respectively.
    I promised the easier way, so we want the **Report Wizard** for this. It should
    be highlighted by default, but make sure it''s selected. Then click on **OK**,
    as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Designing the report](img/image9.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Now, we should see a modal window titled **Report Wizard** , which is very similar
    to the wizards in other applications, such as Microsoft Access. The usage of this
    wizard is quite intuitive as each step includes understandable explanations and
    user interface elements. On the first screen of **Report Wizard**, you will be
    asked to select the dataset and its fields, which you require to appear on the
    report.
  prefs: []
  type: TYPE_NORMAL
- en: For this report, add **FID**, **title**, **category**, **actors**, **rating**,
    and **price** to the selected fields in this very order, and then click on **Next**.
  prefs: []
  type: TYPE_NORMAL
- en: 'The next screen of **Report Wizard** is where we can specify groups in which
    the selected data might be categorized. Click on **category** from **Available
    Fields** and move it to the **Groups** list box by pressing the corresponding
    down arrow located between the two list boxes. When you do that, you should also
    note that the report layout preview would be updated by reflecting this change,
    as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Designing the report](img/image10.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Click on **Next** to proceed to the screen, where we will pick a **Layout**
    style and choose the (default) page printing **Orientation**. Now because we have
    opted to group the report output according to category, we are presented with
    a total of six **Layout** style options here. In the other case, we would have
    had only two layouts to choose from—**Vertical** (print labels or cards style)
    or plain **Tabular**.
  prefs: []
  type: TYPE_NORMAL
- en: 'The **Layout** style options that we have, in this case, are:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Stepped**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Block**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Outline 1**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Outline 2**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Align Left 1**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Align Left 2**![Designing the report](img/image11.jpg)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: As for the **Orientation** options, they simply consist of **Portrait** and
    **Landscape**, with which you should be exceedingly familiar from the printing
    options in other programs that you use every day.
  prefs: []
  type: TYPE_NORMAL
- en: For our report, I will urge you to choose **Align Left 2** as the **Layout**
    style and the page (printing) **Orientation** option as **Portrait**, which is
    the default. And unless you are eager to later have the hassle of adjusting the
    column widths on the report layout manually, you should leave the option **Adjust
    field widths so all fields fit on page** checked.
  prefs: []
  type: TYPE_NORMAL
- en: 'Click on **Next** when you''re done here. Refer to the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Designing the report](img/image12.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'The **Report Wizard** window will ask you to pick a thematic style from a choice
    list of ready-made report designs or templates, for which you have the following
    options:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Bold**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Casual**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Compact**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Corporate**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Formal**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Soft Gray**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Although, in a left-hand side design preview when each option is clicked, it
    is dynamically updated to give you an idea about what your report will look like.
    It might be a good idea to experiment with this as many times as you can, so that
    you can get familiar with each style reflected on your reports.
  prefs: []
  type: TYPE_NORMAL
- en: My personal favorite here is **Casual**, which you will see in the screenshots
    of the report designs and previews from this point on in the chapter.
  prefs: []
  type: TYPE_NORMAL
- en: When you click on **Next**, you will be thankful that all the necessary information
    to create the report has been provided by now, and you will be presented with
    the choices of previewing your report right away or heading straight to modifying
    the report's design.
  prefs: []
  type: TYPE_NORMAL
- en: First, let's do some final retouches before we preview the report, so check
    the second option before you click on **Finish**.
  prefs: []
  type: TYPE_NORMAL
- en: As we get back to the Report Design, we will happily notice that the canvas
    is no longer blank. Also, **Title**, **Header**, **Detail**, and **Footer** are
    a bit weird, as they are all filled in with the labels and data placeholders that
    we defined in **Report Wizard** earlier, but still appear to be small.
  prefs: []
  type: TYPE_NORMAL
- en: 'In order to make the report look more "human", we can start by changing the
    title to something more natural such as `Sakila Movie List`, and modify the column
    header labels by giving them nicer names. For example, name it `Item #` instead
    of **FID** (which stands for film ID). Refer to the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Designing the report](img/image13.jpg)'
  prefs: []
  type: TYPE_IMG
- en: You will also want to resize column widths to use the space efficiently. For
    example, you will especially notice that the **rating**, **price**, and **category**
    columns are unnecessarily wider than they should be. So, you can move them towards
    the right and reduce their width. Then, increase the width for **actors** and
    **title**. Remember to vertically align the column name and the data field (the
    placeholder for data), which are placed in the header and detail areas respectively.
  prefs: []
  type: TYPE_NORMAL
- en: Also, tweaking the appearance of the **category** field is highly recommended,
    which will substantially affect the look and feel of the report, so as to make
    it appear more pleasing to the eye.
  prefs: []
  type: TYPE_NORMAL
- en: Switching to the Preview tab
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Now, it's about time we switched to the **Preview** tab to see what our report
    and its output looks like.
  prefs: []
  type: TYPE_NORMAL
- en: 'In the report preview, you can experiment with the buttons on the toolbar to
    adjust your viewing settings, such as choosing how to fit the report data to the
    page, printing options, as well as text search on the report''s output. You can
    also navigate between the pages of the report using the tiny, arrow-shaped buttons.
    Refer to the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Switching to the Preview tab](img/image14.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Now is a good time to save the report if you haven''t already done so. Navicat
    has some specificity in saving reports, unlike how it treats other objects, such
    as **Queries**, **Events**, and **Models**. First of all, to save your report
    you need to go to the menu bar and choose **File** | **Save**. When you''re saving
    the report for the first time, you will be prompted with a standard **Save As**
    dialog box. Then, specify a name for the report that will be suffixed with the
    file extension `.rtm` and a location in the filesystem, which suggests that you
    can store your reports anywhere on your drive. However, as soon as you click on
    the **Save** button of the dialog box, Navicat will prompt you with a confirmation
    alert warning you that if you save your report outside Navicat''s default directory
    for reports, your report will not be visible in the **Reports** view within the
    program (in which case you will have to locate the report using an **Open File**
    dialog box every time you need to access it in Navicat). Refer to the following
    screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Switching to the Preview tab](img/image15.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Even if you would like to have the report file in a specific folder in the
    file, it is probably a good idea to save to the default location, which you can
    access in Windows Explorer by going through the following path:'
  prefs: []
  type: TYPE_NORMAL
- en: '`\Users\<user_name>\Documents\Navicat\MySQL\servers\localhost\sakila`'
  prefs: []
  type: TYPE_NORMAL
- en: After you save your report and exit **Report Designer**, you will need to right-click
    on its name in the **Report** view and select **Design Report** from the pop-up
    menu. Double-clicking on a saved report directly brings the report output window,
    (which is very similar to the **Preview** tab of the designer) from which you
    can print the report or just view its contents as it is on the screen.
  prefs: []
  type: TYPE_NORMAL
- en: You can not only print your reports on paper, but also produce output in a variety
    of formats including PDF, Excel, text, and HTML. You can specify this option,
    on the fly, in the **Print** dialog box.
  prefs: []
  type: TYPE_NORMAL
- en: If you are aiming at a text-based output, you may want to tweak some more settings
    by selecting **File** | **Print to File Setup...** and specifying some parameters,
    such as column delimiters and the fields to include in the output.
  prefs: []
  type: TYPE_NORMAL
- en: Navicat's report building and management can do more than what's discussed in
    this chapter and than what is outside the scope of this introductory book. But
    you can explore these features in depth, by experimenting yourself and also by
    referring to Navicat's own manual accessible from its website. There you can also
    find more step-by-step and screen-by-screen tutorials, which could teach you how
    to create more advanced reports, such as invoices, detailed order summaries, sales
    statistics, crosstab reports, mailing labels, and even photo albums.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Building a report in Navicat consists of two major phases—preparing the data
    and designing the report based on that data.
  prefs: []
  type: TYPE_NORMAL
- en: In this chapter, we have seen the report building and management tools of Navicat,
    and the basics of designing reports by following a simple tutorial, which also
    helps in getting acquainted with some of the tools that can be used for more advanced
    purposes.
  prefs: []
  type: TYPE_NORMAL
- en: We have also seen how the reports can be printed on a paper as well as exported
    to a variety of popular file formats.
  prefs: []
  type: TYPE_NORMAL
