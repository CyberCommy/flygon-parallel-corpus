- en: Internet of Things Exploitation
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The term IoT was crafted by Kevin Ashton from the media center at the Massachusetts
    Institute of Technology. It describes a network of physical devices including
    cameras, vehicles, and sensors. The IoT is exponentially adopted and it represents
    undeniable promises and possibilities. This rapid adoption opened the doors for
    new business opportunities, but on the other hand, revealed new threats and weaknesses
    from a security perspective. This chapter will be your savior. Thus, it will take
    you from understanding the IoT ecosystem, to knowing how to defend against the
    real-world IoT attacks. In fact, in this chapter, you will gain the required skills
    to be ready to secure IoT projects, after learning how to exploit IoT environments
    starting from the smallest devices to connected cars. According to the F5 Labs
    report, IoT attacks exploded by 280% in the first half of 2017\. In this chapter,
    we will finalize our journey. It is another milestone. After walking through the
    different techniques of attacking and protecting valuable enterprise assets, it
    is time to continue the learning experience, and discover the skills for pentesting
    IoT projects.
  prefs: []
  type: TYPE_NORMAL
- en: The IoT ecosystem
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'By 2020, there will be more than 50 billion connected devices. This huge number
    of devices will come with a huge number of new threats. As penetration testers,
    we need to be ready to resist this technological apocalypse. The IoT ecosystem
    is based on many factors, which we''ve also shown in the following image:'
  prefs: []
  type: TYPE_NORMAL
- en: Business opportunities
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Public authorities
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Consumers
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Infrastructure
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/00361.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: IoT project architecture
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Like any technical project, a typical IoT project is composed of many components,
    as follows (see the following image):'
  prefs: []
  type: TYPE_NORMAL
- en: '**Remote devices**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Data storage**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**IoT devices**(for example, CCTV cameras, home routers, printers, industrial
    systems, and connected cars)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Gateway**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'This illustration shows a typical architecture of an IoT project:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00362.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: IoT protocols
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In a typical IoT project, a lot of protocols are involved to make sure that
    the requirements are met. They are divided into different layers. The following
    are some well-known IoT protocols:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Wi-Fi**: This is a widely used protocol among IoT developers. It is based
    on IEEE 802.11 standards. It uses 2.4 GHz and 5 GHz as band frequencies, with
    about 50 meters as a range. Usually, it can transfer 150-200 Mbps of data.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Z-Wave**: This is an RF communications technology with a low power capacity.
    It is widely used in sensors and home automation products with a 100 Kbps data
    rate. It can control a maximum of 232 devices, with a range of 30 meters.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Zigbee**: This is like Bluetooth. It is based on the IEEE 802.15.4 protocol,
    and it operates at 2.4 GHz frequency. It is usually used in cases when we don''t
    have large data rates, usually 250 Kbps, with  a range of 100 meters. There are
    many Zigbee profiles, such as Zigbee PRO, and Zigbee Remote Control (RF4CE). The
    latest version is Zigbee 3, which combines all the previous Zigbee standards.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Sigfox**: This is a wide-range technology with 30-50 km in rural environments,
    and 3-10 km in urban environments. It works on a 900 MHz frequency, with a 10-1000
    Kbps data rate. You don''t need a license to use its band, because it operates
    on a free-to-use band (ISM).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Lora**: This is similar to Sigfox. It is designed to work on WAN networks
    (2-5 km in an urban environment, 15 km in a suburban environment), with a 0.3-50
    Kbps data rate.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Near-field communication (NFC)**: This is a two-way interaction technology
    based on the ISO/IEC 18000-3 standard, with a 13.56 MHz frequency, widely used
    in smartphones, especially in contactless payment operations. It operates between
    a range of 4 and 10 cm, with a 100–420 Kbps data rate.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**IPv6 Low-Power Wireless Personal Area Network** (**6LOWPAN**): This is based
    on internet protocol according to RFC 6282\. It is very adaptable, while it can
    use different communications platforms such as Wi-Fi and Ethernet.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The IoT communication stack
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The IoT communication stack is similar to the OSI networking model. It represents
    the needed features and the interactions between the different layers. It is composed
    of the following layers:'
  prefs: []
  type: TYPE_NORMAL
- en: Data layer
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: End-to-end layer
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Network layer
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: ID layer
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Link layer
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Physical layer
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/00363.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: IP Smart Objects protocols suite
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In an analogy with the TCP/IP model, IoT projects has its own suite and representation
    named the *IP Smart Objects protocol suite*:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00364.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Standards organizations
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The IoT shows a promising future. As a result, it needed to be organized and
    standardized by many organizations and alliances. These are some well-known IoT
    standards organizations:'
  prefs: []
  type: TYPE_NORMAL
- en: '**International Electrotechnical Commission (IEC)**:** The **IEC plays a huge
    role as one of the biggest contributors to the IoT standards, especially with
    its IEC 62056 (DLMS/COSEM), which discusses smart meters.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**International Organization for Standardization (ISO)**: The ISO is addresses a
    various range of products, especially the IoT in the supply chain via the ISO/AWI
    18575 standard. ISO is also united with IEC as a joint technical committee.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Institute of Electrical and Electronics Engineers (IEEE)**: The IEEE developed
    the IEEE P2413 standard for the IoT in addition of other standards, such as IEEE
    802.15.4.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Internet Engineering Task Force (IETF)**: IETF has a network-centric vision
    for IoT. This vision is supported by working on the constrained RESTful environments
    and IPv6 protocol.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: IoT attack surfaces
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The previous section was a small overview of the IoT ecosystem. The IoT presents
    an amazing opportunity for businesses to grow, but it comes with a huge number
    of threats. From different perspectives, the IoT faces a lot of challenges, including
    security, integration issues, and interoperability. In the early stages of market
    development, the IoT will likely raise many security alerts and technical threats
    for these surfaces.
  prefs: []
  type: TYPE_NORMAL
- en: Devices and appliances
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Devices are core components in an IoT project. In this subsection, we are going
    to discover the hardware threats, and we will discuss the framework attacks in
    another point. Physical security is playing a huge role in information security.
    Physically unprotected devices are presenting a real threat to your architecture.
    Exposed appliances can be attacked easily. Thus, a black hat hacker could gather
    information about the device online, thanks to the publicly available datasheets
    and required information about the majority of used and well-known devices. A
    website such as [https://wiki.openwrt.org](https://wiki.openwrt.org) helps users
    to know detailed information about a various number of devices, such as routers
    and gateways:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00365.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'This step can be dangerous, because by knowing hardware information, attackers
    can identify (as an entry point) used interfaces, such as **Universal Asynchronous
    Receiver/Transmitter** (**UART**), which grant root access if an attacker successfully
    connects to the device over it by looking for **PINS** (**TX**, **RX**, and **GND**),
    using a multimeter as a continuity mode (no power is needed in this mode):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00366.gif)'
  prefs: []
  type: TYPE_IMG
- en: The previous figure illustrates the pins connected with a USB cable. You need
    to find the baud rate, which is like the bit rate (number of bits per second),
    but it is the signal changes per second. In other words, it is the number of information
    changes as symbols per second. To identify the baud rate of a device, you can
    use a script developed by Craig Heffner from this GitHub link: [https://github.com/devttys0/baudrate/blob/master/baudrate.py](https://github.com/devttys0/baudrate/blob/master/baudrate.py).
    Once you get the suitable baud rate, you can connect to the device.
  prefs: []
  type: TYPE_NORMAL
- en: Firmware
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**Firmware** is a set of software that takes control of the device''s hardware.
    Analyzing the firmware is a critical step for IoT penetration testing. In order
    to achieve that, you can use a lot of tools and utilities. One of them is **binwalk**,
    which is a great tool developed also by Craig Heffner that helps pentesters to
    analyze the firmware of an IoT device. You can simply grab it from this GitHub
    link: [https://github.com/ReFirmLabs/binwalk/blob/master/INSTALL.md](https://github.com/ReFirmLabs/binwalk/blob/master/INSTALL.md).
    Let''s run the following commands:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'Then, install it by using the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '![](img/00367.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'If you are using Kali Linux Distribution, you can use binwalk directly by typing
    `binwalk` in the CLI:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00368.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'For example, if you want to gather information about the Airlink 101 AR430W
    V1 router binary file using binwalk, use the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '![](img/00369.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'To extract files from the binary, add the `-e` option:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00370.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'If you want to extract a specific file type, use the `-D` option:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'After extracting the files from the binaries, you can perform firmware analysis.
    If you want to automate the process, you can use **firmwalker** from [https://github.com/craigz28/firmwalker](https://github.com/craigz28/firmwalker):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00371.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Web interfaces
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Insecure web interfaces present a huge risk for IoT projects. Many devices have
    integrated web servers, and like any other web server-app projects, they are vulnerable
    to web application attacks, and can be exploited. Not only are integrated web
    applications vulnerable, but also the lack of transport encryption is a dangerous
    move; thus, sent messages could be intercepted.
  prefs: []
  type: TYPE_NORMAL
- en: Network services
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Network services are a necessity in any IoT project. As discussed in the previous
    sections, a typical IoT project could use many communication protocols, and these
    communications faces different threats: they are representing high-profile targets
    for attackers. For attackers, mapping the attack surfaces makes the hacking attempts
    more fruitful.'
  prefs: []
  type: TYPE_NORMAL
- en: Cloud interfaces and third-party API
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: IoT projects can use cloud interfaces and third-party APIs. They plays a major
    role in modern organizations and especially in IoT projects, while they ease a
    lot of cloud processes. That is why, as a penetration tester, you should take
    them into consideration. Sensitive data can be transferred via these channels,
    and many APIs are used for authentication and authorization. Thus, you need to
    ensure the security aspects of cloud interfaces and third-party APIs.
  prefs: []
  type: TYPE_NORMAL
- en: Case study – Mirai Botnet
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To have a clearer understanding and conscience about the dangerous impact of
    insecure IoT, let''s dive into one of the catastrophic attacks that hit million
    of devices and users. It is **Mirai Botnet**. Mirai in Japanese means *the future*.
    It used millions of compromised devices to perform distributed **Denial of Service**
    (**DoS**) at about 665 GBs against many businesses and service providers, including
    DNS, Twitter, PayPal, reddit, Brian Krebs website, and many other well-known websites:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00372.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: The OWASP IoT Project
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the first chapter, we saw the **Open Web Application Security Project** (**OWASP**)
    guidelines as one of the well-known web application security standards. They are
    also active, and they worked on a new list that represents the top 10 threats
    that face IoT projects. The 10 threats are mentioned next.
  prefs: []
  type: TYPE_NORMAL
- en: Insecure web interface
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'As discussed before, web interfaces are important in any IoT project. That
    is why insecure web interfaces are listed in the top 10 threats. To ensure that
    your IoT web interfaces are generally secure, use at least a web application vulnerability
    scanner. **Nikto** is one of the most commonly used tools to check web application
    security. If you are using Kali Linux, you are able to use it directly via your
    CLI. It is a built-in tool in Kali Linux:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00373.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'If you want to scan your web application interface using Nikto, type the following
    command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'In the following example, we used the [www.example.com](http://www.example.com)
    website as a demonstration:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00374.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Insufficient authentication/authorization
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Authentication issues present a real security concern for IoT devices. If interfaces
    are not secured with strong passwords, devices can be compromised. As you can
    see, even though the devices and appliances are new, attacking techniques are
    old. It is all about the behavior of the user. In order to avoid this type of
    attack, make sure that all the passwords are strong, and that you change every
    default password. As an example, you can use [https://howsecureismypassword.net/](https://howsecureismypassword.net/) to
    check your password''s strength:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00375.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Insecure network services
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Insecure network services could be exploited to compromise a device using external
    and internal means via the network, usually by identifying open ports using a
    port scanner. In this case, you need to ensure that only required ports are open.
  prefs: []
  type: TYPE_NORMAL
- en: Lack of transport encryption
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Passing data as a plain text represents a huge risk for your IoT project. Encrypting
    data is always the best method to avoid data being intercepted. There are many
    standard encryption techniques and protocols, such as SSL and TLS. You can scan
    your project using a tool named `sslscan`, a built-in tool in Kali Linux:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00376.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'As a demonstration, this is a snippet from the output message of a scan:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00377.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Privacy concerns
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Many privacy issues could be identified as a threat for IoT projects. Being
    able to collect information about the used data, especially sensitive information,
    could be dangerous; also, getting information about the device's functionalities
    is dangerous.
  prefs: []
  type: TYPE_NORMAL
- en: Insecure cloud interface
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Cloud computing plays a major role in modern IoT projects. Ensuring that cloud
    interfaces are secure is a must. As security measures, you need to mitigate abnormal
    behaviors and implement an account lockout mechanism at least.
  prefs: []
  type: TYPE_NORMAL
- en: Insecure mobile interface
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Mobile applications are very important. Insecure mobile interfaces could put
    the IoT project in danger. Unencrypted data can be intercepted by attackers.
  prefs: []
  type: TYPE_NORMAL
- en: Insufficient security configurability
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Many measures need to be taken when it comes to configurations. Separating admin
    panels and interfaces, logging security events, and enabling alerts are wise decisions
    to avoid the insufficient security configurability.
  prefs: []
  type: TYPE_NORMAL
- en: Insecure software/firmware
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the previous sections, we discussed firmware threats because you know that
    it is a software, and every software can be exploited. Firmware analysis using
    static and dynamic analysis is always a great move to harden your firmware.
  prefs: []
  type: TYPE_NORMAL
- en: Poor physical security
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Don't forget physical security. Access to the device could be a threat for your
    project. Exposing devices and misplacing them can be dangerous. If you leave your
    devices exposed to anyone, they can be disassembled or accessed via open interfaces,
    such as USBs.
  prefs: []
  type: TYPE_NORMAL
- en: Hacking connected cars
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'IoT devices and home appliances are not the only victims of attacks. Recently,
    many researches show that connected cars could also be attacked. According to
    the *Vehicle Hacking Vulnerability Survey*, January 2016, 60% of millennials support
    vehicles becoming more connected. Modern connected cars are composed by many following
    units:'
  prefs: []
  type: TYPE_NORMAL
- en: Infotainment (The head unit)—sometimes called **engine control unit** (**ECU**)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Telematics and connectivity forms
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: GPS and navigation systems
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Vehicle-to-vehicle communication systems
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Security and anti-theft systems
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Sensors
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Night vision
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Most connected cars include a controller area network that connects all the
    car''s components (sensors, airbags, and so on) with a central control unit. The
    standard of the controller area networks was accepted and published by ISO since
    1993:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00378.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Threats to connected cars
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Connected cars faces many threats from different attack vectors. Because, they
    are composed by many units; there is a variety of attack categories:'
  prefs: []
  type: TYPE_NORMAL
- en: Firmware attacks
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Operating system attacks
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Remote attacks on the CAN
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Compromised on OBD2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Sniffing
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Malicious downloaded applications
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A Nissan Leaf was hacked via mobile application and a web browser as a security
    research. In February 2016, security researchers showed that Nissan could be accessed
    via the internet using Nissan's phone app.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This chapter was a simple and clear guide to help developers, manufacturers,
    and penetration testers to build and secure IoT projects. We started by discovering
    the IoT ecosystem, and the different components of a typical IoT project. We saw
    the threats faced by an IoT project in addition to the required steps to ensure
    the security of an IoT environment. At this point, you acquired the technical
    skills and the suitable mindset to perform a penetration testing mission efficiently.
    You will now be able to protect modern organization infrastructure from today's
    threats and attacks, and deploy the suitable safeguards against these attacks.
  prefs: []
  type: TYPE_NORMAL
