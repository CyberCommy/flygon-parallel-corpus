- en: Wireless Attacks â€“ Getting Past Aircrack-ng
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this chapter, we will cover the following recipes:'
  prefs: []
  type: TYPE_NORMAL
- en: The good old Aircrack
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Hands on with Gerix
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Dealing with WPAs
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Owning an employee account with Ghost Phisher
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Pixie dust attack
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'As described on their official website:'
  prefs: []
  type: TYPE_NORMAL
- en: '"Aircrack-ng is a complete suite of tools to assess Wi-Fi network security.'
  prefs: []
  type: TYPE_NORMAL
- en: 'It focuses on different areas of Wi-Fi security:'
  prefs: []
  type: TYPE_NORMAL
- en: '*Monitoring: Packet capture and export of data to text files for further processing
    by third party tools*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Attacking: Replay attacks, deauthentication, fake access points and others
    via packet injection*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Testing: Checking Wi-Fi cards and driver capabilities (capture and injection)*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*Cracking: WEP and WPA PSK (WPA 1 and 2)"*'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The good old Aircrack
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Aircrack is a software suite for networks, which consists of a network detector,
    packet sniffer, and WEP/WPA2 cracker. It is open source and is built for 802.11
    wireless LANs (for more information visit [https://en.wikipedia.org/wiki/IEEE_802.11](https://en.wikipedia.org/wiki/IEEE_802.11)).
    It consists of various tools, such as `aircrack-ng`, `airmon-ng`, `airdecap`,
    `aireplay-ng`, `packetforge-ng`, and so on.
  prefs: []
  type: TYPE_NORMAL
- en: In this recipe, we will cover a bit basic of cracking wireless networks with
    Aircrack suite. You will learn to use tools such as `airmon-ng`, `aircrack-ng`,
    `airodump-ng`, and so on to crack the password of wireless networks around us.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We will need to have a Wi-Fi hardware that supports packet injection. Alfa card
    by Alfa Networks, TP-Link TL-WN821N, and EDIMAX EW-7811UTC AC600 are some of the
    cards we can use. In this one, we are using Alfa card.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The following steps demonstrate the Aircrack:'
  prefs: []
  type: TYPE_NORMAL
- en: 'We type the `airmon-ng` command to check whether our card has been detected
    by Kali:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/4ba756bd-221c-4e3e-8d93-90e01b3ca948.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Next, we need to set our adapter to the monitor mode by using the following
    command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'The following screenshot shows the output of the preceding command:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/83c25089-ab96-4ed4-8159-abe046621744.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Now in order to see what routers are running in the neighborhood, we use the
    following command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'The following screenshot shows the output of the preceding command:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/5741911a-9894-42e4-9926-73e2911af7ed.png)'
  prefs: []
  type: TYPE_IMG
- en: Here, we note the `BSSID` of the network we want to crack; in our case, it's
    `B8:C1:A2:07:BC:F1` and the channel number is `9`. We stop the process by pressing
    *Ctrl* + *C* and leave the window open.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Now we capture the packets using `airodump-ng` with the `-w` switch to write
    these packets to a file:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'The following screenshot shows the output of the preceding command:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/728e79cd-1cb3-4407-bfd9-5d5bf20806bc.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Now we need to watch the beacons and data column; these numbers start from
    `0` and increase as the packets are passed between the router and other devices.
    We need at least 20,000 initialization vectors to successfully crack the **Wired
    Equivalent Privacy** (**WEP**) password:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'To speed the process, we open another Terminal window and run `aireplay-ng`
    and perform a fake authentication using this command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'The following screenshot shows an example of the preceding command:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/6d610a66-b5fb-4a61-8029-48b325d8517e.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Now let''s do the ARP packet replay using the following command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'The following screenshot shows an example of the preceding command:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/89ef9aa4-2a73-40af-91da-e77be873bada.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Once we have enough packets, we start `aircrack-ng` and provide the filename
    where we saved the packets:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'The following screenshot shows an example of the preceding command:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/85b13ebc-b4d7-4cf4-b57e-a5c651b51cf3.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Once cracked, we should see the password on screen:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/598ceb35-cdf3-4d03-aa38-8e42eee9f958.png)'
  prefs: []
  type: TYPE_IMG
- en: How it works...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The idea behind this attack is to capture as many packets as possible. Each
    data packet contains an **Initialization Vector** (**IV**), which is 3 bytes in
    size and is associated with it. We simply capture as many IVs and then use Aircrack
    on them to get our password.
  prefs: []
  type: TYPE_NORMAL
- en: Hands on with Gerix
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the previous recipe, you learned how to use the Aircrack suite to crack WEPs.
    In this recipe, we will use a GUI-based tool Gerix, which makes the Aircrack suite
    easy to use and makes our wireless network audit much easier. Gerix is a python-based
    tool built by J4r3tt.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Let''s install Gerix using the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The following steps demonstrate the use of Gerix:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Once it''s downloaded, we go to the directory where it''s downloaded and run
    the following command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'We run the tool using the following command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: 'The preceding commands can be seen in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/1c6a0fb6-59c8-4656-a282-b789919330b3.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Once the window opens, we click on Enable/Disable Monitor Mode in the Configuration
    tab as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/f1b44039-6aa4-4bf2-a217-e3dd6fd261cd.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Then, we click on Rescan networks:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/7c0a111f-ce75-4d7b-a8d8-f0a8d77d9861.png)'
  prefs: []
  type: TYPE_IMG
- en: This will show us the list of access points available and the type of authentication
    they use. We select the one with WPA and then switch to the WPA tab.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Here, we click on General functionalities and then we click on Start Capturing:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/a18f5443-8dde-4d3b-82e1-688640ee2214.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Since the WPA attack requires the handshake to be captured, we need a station
    to be already connected to the access point. So, we click on the Autoload victim
    clients or enter custom victim MAC:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/2daabcbc-3386-4bf9-9dc1-1eee3572e418.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Next, we choose the deauth number. We choose `0` here in order to perform the
    deauthentication attack and click on the Client deauthentication button:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/2f299964-f40e-4055-8547-a1711eb0eeb7.png)'
  prefs: []
  type: TYPE_IMG
- en: 'We should see a window pop up, which performs deauthentication for us:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/849fac2f-5f2b-4b28-b6a2-f108b96a8700.png)'
  prefs: []
  type: TYPE_IMG
- en: And in the airodump window, we should see that the handshake has been captured.
  prefs: []
  type: TYPE_NORMAL
- en: 'Now that we are ready to crack the WPA, we switch to the WEP cracking tab,
    and in the WPA bruteforce cracking, we give a path to our dictionary and click
    on Aircrack-ng - Crack WPA password:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/74011f72-16e9-42f8-b62a-1c04b6c7022f.png)'
  prefs: []
  type: TYPE_IMG
- en: 'We should see the Aircrack window, and it will show us the password when it
    has been cracked:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/aa2ec4c1-8976-4336-b663-f1e11c454d0f.png)'
  prefs: []
  type: TYPE_IMG
- en: Similarly, this tool can be used to crack WEP/WPA2 networks as well.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Dealing with WPAs
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Wifite is a Linux-only tool designed to automate the process of a wireless audit.
    It requires Aircrack suite, Reaver, Pyrit, and so on to be installed for it to
    be able to run properly. It comes preinstalled with Kali. In this recipe, you
    will learn how to use wifite to crack some WPAs.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To learn about Wifite follow the given steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'We can start Wifite by typing the following command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: 'The preceding command shows up a list of all the available networks as shown
    in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/4b271091-8b18-4260-9066-d1af9bced405.png)'
  prefs: []
  type: TYPE_IMG
- en: 'We then press *Ctrl* + *C* to stop; it will then ask you to choose the network
    we would want to try cracking:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/be62ee07-d710-4dcb-9013-26cf74ba9146.png)'
  prefs: []
  type: TYPE_IMG
- en: 'We enter our number and press *Enter*. The tool automatically tries to use
    a different method to crack the network, and in the end, it will show us the password
    if it was successfully cracked:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/df19c17a-2cef-4fcd-8bc7-8a37c900a2a6.png)'
  prefs: []
  type: TYPE_IMG
- en: 'We will see the following password:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/e63e7d14-3448-411e-981c-2b8b1dadc008.png)'
  prefs: []
  type: TYPE_IMG
- en: Owning employee accounts with Ghost Phisher
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Ghost Phisher is a wireless network audit and attack software that creates a
    fake access point of a network, which fools a victim to connect to it. It then
    assigns an IP address to the victim. The tool can be used to perform various attacks,
    such as credentials phish and session hijacking. It can also be used to deliver
    meterpreter payloads to the victims. In this recipe, you will learn how to use
    the tool to perform various phishing attacks or steal cookies, among others.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The use of Ghost Phisher can be seen as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: 'We start it using the `ghost-phisher` command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/5de7687f-5874-4b4e-b824-7421144c0eb5.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Here, we choose our interface and click on Set Monitor:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/a47db3c8-f9ad-48ad-b901-6e9918a30977.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Now we enter the details of the access point we want to create:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/3df8ae0a-f332-473e-a6a1-569c06977b9f.png)'
  prefs: []
  type: TYPE_IMG
- en: Then, we click on Start to create a new wireless network with that name.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Then, we switch to a Fake DNS Server. Here, we need to mention the IP address
    the victim will be directed to whenever he/she opens any web page:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/9e1b828b-1d63-4a65-b2a6-0d4238494a62.png)'
  prefs: []
  type: TYPE_IMG
- en: We then start the DNS server.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Then, we switch to Fake DHCP Server. Here, we need to make sure that when a
    victim tries to connect, he/she gets an IP address assigned to him/her:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/0785fac4-4b9a-47a3-94f5-f08dd1caa02f.png)'
  prefs: []
  type: TYPE_IMG
- en: Once this is done, we click on Start to start the DHCP service.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'If we want to phish someone and capture credentials, we can direct them to
    our phishing page by setting the options in the Fake HTTP Server tab. Here, we
    can upload the HTML page we want to be displayed or provide a URL we would want
    it to clone. We start the server:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/f869dbf3-035d-444d-8f64-73c11381cafa.png)'
  prefs: []
  type: TYPE_IMG
- en: In the next tab, we see Ghost Trap; this feature allows us to perform a Metasploit
    payload attack, which will ask the victim to download our prepared meterpreter
    payload, and as soon as it is executed, we will get a meterpreter connection back.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'In the Session Hijacking tab, we can listen and capture sessions that might
    go through the network. All we need to do here is enter the IP address of the
    gateway or router and click on Start, and it will detect and show any cookies/sessions
    captured:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/bea5d007-f1a0-4e1e-897f-3284c2b71048.png)'
  prefs: []
  type: TYPE_IMG
- en: The credentials we captured in the HTTP server can be seen in the Harvested
    Credentials tab.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Pixie dust attack
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**Wi-Fi Protected Setup** (**WPS**) was introduced in 2006 for home users who
    wanted to connect to their home network without the trouble of remembering complex
    passwords for the Wi-Fi. It used an eight digit pin to authenticate a client to
    the network.'
  prefs: []
  type: TYPE_NORMAL
- en: A pixie dust attack is a way of brute forcing the eight digit pin. This attack
    allowed the recovery of the pin within minutes if the router was vulnerable. On
    the other hand, a simple brute force would have taken hours. In this recipe, you
    will learn how to perform a pixie dust attack.
  prefs: []
  type: TYPE_NORMAL
- en: This list of vulnerable routers on which the attack will work can be found at
    [https://docs.google.com/spreadsheets/d/1tSlbqVQ59kGn8hgmwcPTHUECQ3o9YhXR91A_p7Nnj5Y/edit?pref=2&pli=1#gid=2048815923](https://docs.google.com/spreadsheets/d/1tSlbqVQ59kGn8hgmwcPTHUECQ3o9YhXR91A_p7Nnj5Y/edit?pref=2&pli=1#gid=2048815923).
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We need the network with WPS enabled. Otherwise, it will not work.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To learn about pixie dust follow the given steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'We start our interface in the monitor mode using the following command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: 'Then, we need to find the networks with WPS enabled; we can do that using the
    following command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: 'The following screenshot shows an example of the preceding command:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/004235d3-a7ac-43c5-a134-a8298c963cba.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Now we run `reaver` using the following command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: 'The following screenshot shows an example of the preceding command:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/9ba9b27a-ac24-44aa-a6ee-271da1d02b62.png)'
  prefs: []
  type: TYPE_IMG
- en: Once it's done, we should see the PIN.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: There's more...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Here are some great articles which can be referred to while attacking wireless
    networks:'
  prefs: []
  type: TYPE_NORMAL
- en: '[http://www.hackingtutorials.org/wifi-hacking-tutorials/pixie-dust-attack-wps-in-kali-linux-with-reaver/](http://www.hackingtutorials.org/wifi-hacking-tutorials/pixie-dust-attack-wps-in-kali-linux-with-reaver/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[http://www.kalitutorials.net/2014/04/hack-wpawpa2-wps-reaver-kali-linux.html](http://www.kalitutorials.net/2014/04/hack-wpawpa2-wps-reaver-kali-linux.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
