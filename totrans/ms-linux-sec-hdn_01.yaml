- en: Running Linux in a Virtual Environment
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: So, you may be asking yourself, "*Why do I need to study Linux security? Isn't
    Linux already secure? After all, it's not Windows*." But, the fact is, there are
    many reasons.
  prefs: []
  type: TYPE_NORMAL
- en: 'It''s true that Linux has certain advantages over Windows when it comes to
    security.  These include:'
  prefs: []
  type: TYPE_NORMAL
- en: Unlike Windows, Linux was designed from the ground up as a multiuser operating
    system. So, user security tends to be a bit better on a Linux system.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Linux offers a better separation between administrative users and unprivileged
    users. This makes it a bit harder for intruders, and it also makes it a bit harder
    for a user to accidentally infect a Linux machine with something nasty.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Linux is much more resistant to virus and malware infections than Windows is.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Certain Linux distributions come with built-in mechanisms, such as **SELinux**
    in Red Hat and CentOS and **AppArmor** in Ubuntu, which prevents intruders from
    taking control of a system.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Linux is a free and open source software. This allows anyone who has the skill
    to audit Linux code to hunt for bugs or backdoors.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: But, even with those advantages, Linux is just like everything else that's been
    created by mankind. That is, it isn't perfect.
  prefs: []
  type: TYPE_NORMAL
- en: 'Here are the topics that we''ll cover in this chapter:'
  prefs: []
  type: TYPE_NORMAL
- en: Why every Linux administrator needs to learn about Linux security
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A bit about the threat landscape, with some examples of how attackers have,
    at times, been able to breach Linux systems
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Resources for keeping up with IT security news
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How to set up Ubuntu Server and CentOS virtual machines with VirtualBox, and
    how to install the EPEL repository in the CentOS virtual machine
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How to create virtual machine snapshots
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How to install Cygwin on a Windows host so that Windows users can connect to
    a virtual machine from their Windows hosts
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The threat landscape
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'If you''ve kept up with IT technology news over the past few years, you''ll
    likely have seen at least a few articles about how attackers have compromised
    Linux servers.  For example, while it''s true that Linux isn''t really susceptible
    to virus infections, there have been several cases where attackers have planted
    other types of malware on Linux servers.  These cases have included:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Botnet malware**: It causes a server to join a botnet that is controlled
    by a remote attacker. One of the more famous cases involved joining Linux servers
    to a botnet that launched *denial-of-service* attacks against other networks.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Ransomware**: It is designed to encrypt user data until the server owner
    pays a ransom fee. But, even after paying the fee, there''s no guarantee that
    the data can be recovered.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Cryptocoin mining software**: It causes the CPUs of the server on which it''s
    planted to work extra hard and consume more energy. Cryptocoins that get mined
    go to the accounts of the attackers who planted the software.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: And, of course, there have been plenty of breaches that don't involve malware,
    such as where attackers have found a way to steal user credentials, credit card
    data, or other sensitive information.
  prefs: []
  type: TYPE_NORMAL
- en: Some security breaches come about because of plain carelessness. Here's an example
    of where a careless Adobe administrator placed the company's private security
    key on a public security blog: [https://www.theinquirer.net/inquirer/news/3018010/adobe-stupidly-posts-private-pgp-key-on-its-security-blog](https://www.theinquirer.net/inquirer/news/3018010/adobe-stupidly-posts-private-pgp-key-on-its-security-blog).
  prefs: []
  type: TYPE_NORMAL
- en: So, how does this happen?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Regardless of whether you're running Linux, Windows, or whatever else, the reasons
    for security breaches are usually the same. They could be security bugs in the
    operating system, or security bugs in an application that's running on that operating
    system.  Often, a bug-related security breach could have been prevented had the
    administrators applied security updates in a timely manner.
  prefs: []
  type: TYPE_NORMAL
- en: Another big issue is poorly-configured servers. A standard, out-of-the-box configuration
    of a Linux server is actually quite insecure and can cause a whole ton of problems.
    One cause of poorly-configured servers is simply the lack of properly-trained
    personnel to securely administer Linux servers. (Of course, that's great news
    for the readers of this book, because, trust me, there's no lack of well-paying,
    IT security jobs.)
  prefs: []
  type: TYPE_NORMAL
- en: As we journey through this book, we'll see how to do business the right way,
    to make our servers as secure as possible.
  prefs: []
  type: TYPE_NORMAL
- en: Keeping up with security news
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: If you're in the IT business, even if you're not a security administrator, you
    want to keep up with the latest security news.  In the age of the internet, that's
    easy to do.
  prefs: []
  type: TYPE_NORMAL
- en: First, there are quite a few websites that specialize in network security news.
    Examples include *Packet Storm Security* and *The Hacker News*. Regular tech news
    sites and Linux news websites, such as *The INQUIRER*, *The Register*, *ZDNet*,
    and *LXer* also carry reports about network security breaches.  And, if you'd
    rather watch videos than read, you'll find plenty of good YouTube channels, such
    as *BeginLinux Guru*.
  prefs: []
  type: TYPE_NORMAL
- en: Finally, regardless of which Linux distribution you're using, be sure to keep
    up with the news and current documentation for your Linux distribution. Distribution maintainers
    should have a way of letting you know if a security problem crops up in their
    products.
  prefs: []
  type: TYPE_NORMAL
- en: 'Links to security news sites are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Packet Storm Security: [https://packetstormsecurity.com/](https://packetstormsecurity.com/)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The Hacker News:   [http://thehackernews.com/](http://thehackernews.com/)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Links to general tech news sites are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: The INQUIRER: [https://www.theinquirer.net/](https://www.theinquirer.net/)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The Register: [http://www.theregister.co.uk/](http://www.theregister.co.uk/)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: ZDNet: [http://www.zdnet.com/](http://www.zdnet.com/)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'You can check out some general Linux learning resources as well. Linux News
    Site:'
  prefs: []
  type: TYPE_NORMAL
- en: LXer: [http://lxer.com/](http://lxer.com/)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '*BeginLinux Guru* on YouTube:  [https://www.youtube.com/channel/UC88eard_2sz89an6unmlbeA](https://www.youtube.com/channel/UC88eard_2sz89an6unmlbeA)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: (Full disclosure:  I am the *BeginLinux Guru*.)
  prefs: []
  type: TYPE_NORMAL
- en: One thing to always remember as you go through this book is that the only operating
    system you'll ever see that's totally, 100% secure will be installed on a computer
    that never gets turned on.
  prefs: []
  type: TYPE_NORMAL
- en: Introduction to VirtualBox and Cygwin
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Whenever I write or teach, I try very hard not to provide students with a cure
    for insomnia. Throughout this book, you'll see a bit of theory whenever it's necessary,
    but I mainly like to provide good, practical information. There will also be plenty
    of step-by-step hands-on labs.
  prefs: []
  type: TYPE_NORMAL
- en: The best way to do the labs is to use Linux virtual machines. Most of what we'll
    do can apply to any Linux distribution, but we will also do some things that are
    specific to either Red Hat Enterprise Linux or Ubuntu Linux. (Red Hat Enterprise
    Linux is the most popular for enterprise use, while Ubuntu is most popular for
    cloud deployments.)
  prefs: []
  type: TYPE_NORMAL
- en: Red Hat is a billion-dollar company, so there's no doubt about where they stand
    in the Linux market. But, since Ubuntu Server is free-of-charge, we can't judge
    its popularity strictly on the basis of its parent company's worth.  The reality
    is that Ubuntu Server is the most widely-used Linux distribution for deploying
    cloud-based applications.
  prefs: []
  type: TYPE_NORMAL
- en: See here for details: [http://www.zdnet.com/article/ubuntu-linux-continues-to-dominate-openstack-and-other-clouds/](http://www.zdnet.com/article/ubuntu-linux-continues-to-dominate-openstack-and-other-clouds/).
  prefs: []
  type: TYPE_NORMAL
- en: Since Red Hat is a fee-based product, we'll substitute CentOS 7, which is built
    from Red Hat source code and is free-of-charge. There are several different virtualization
    platforms that you can use, but my own preferred choice is VirtualBox.
  prefs: []
  type: TYPE_NORMAL
- en: VirtualBox is available for Windows, Linux, and Mac hosts, and is free of charge
    for all of them. It has features that you have to pay for on other platforms,
    such as the ability to create snapshots of virtual machines.
  prefs: []
  type: TYPE_NORMAL
- en: Some of the labs that we'll be doing will require you to simulate creating a
    connection from your host machine to a remote Linux server. If your host machine
    is either a Linux or a Mac machine, you'll just be able to open the Terminal and
    use the built-in Secure Shell tools.  If your host machine is running Windows,
    you'll need to install some sort of Bash shell, which we'll do by installing Cygwin.
  prefs: []
  type: TYPE_NORMAL
- en: Installing a virtual machine in VirtualBox
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'For those of you who''ve never used VirtualBox, here''s a quick how-to to get
    you going:'
  prefs: []
  type: TYPE_NORMAL
- en: Download and install VirtualBox and the VirtualBox Extension Pack. You can get
    them from: [https://www.virtualbox.org/](https://www.virtualbox.org/).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Download the installation `.iso` files for Ubuntu Server and CentOS 7\. You
    can get them from: [https://www.ubuntu.com/](https://www.ubuntu.com/) and [https://www.centos.org/](https://www.centos.org/).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Start VirtualBox and click the New icon at the top of the screen. Fill out
    the information where requested. Increase the virtual drive size to 20 GB, but
    leave everything else as the default settings:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/5323d37a-850e-494b-8b2b-e34cf13972af.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Start the new virtual machine. Click on the folder icon at the bottom-left
    corner of the dialog box and navigate to the directory where you stored the `.iso`
    files that you downloaded.  Choose either the Ubuntu `.iso` file or the CentOS
    `.iso` file as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/dab65846-598e-4b54-89c9-af8ffc106097.png)'
  prefs: []
  type: TYPE_IMG
- en: Click the Start button on the dialog box to start installing the operating system.
    Note that, for Ubuntu Server, you won't be installing a desktop interface.  For
    the CentOS virtual machine, choose either the KDE desktop or the Gnome desktop,
    as you desire. (We'll go through at least one exercise that will require a desktop
    interface for the CentOS machine.)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Repeat the procedure for the other Linux distribution.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Update the Ubuntu virtual machine by entering:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Hold off on updating the CentOS virtual machine because we'll do that in the
    next exercise.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: When installing Ubuntu, you'll be asked to create a normal user account and
    password for yourself. It won't ask you to create a root user password, but will
    instead automatically add you to the sudo group so that you'll have admin privileges.
  prefs: []
  type: TYPE_NORMAL
- en: When you get to the user account creation screen of the CentOS installer, be
    sure to check the Make this user administrator box for your own user account,
    since it isn't checked by default. It will offer you the chance to create a password
    for the root user, but that's entirely optional—in fact, I never do.
  prefs: []
  type: TYPE_NORMAL
- en: 'The user account creation screen of CentOS installer is shown as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/97ee3e45-b6b1-4165-bcf2-5e1e02cd6f1c.png)'
  prefs: []
  type: TYPE_IMG
- en: The EPEL repository on the CentOS virtual machine
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'While the Ubuntu package repositories have pretty much everything that you
    need for this course, the CentOS package repositories are—shall we say—lacking.
    To have the packages that you''ll need for the CentOS hands-on labs, you''ll need
    to install the **EPEL** (**Extra Packages for Enterprise Linux**) repository.
    (The EPEL project is run by the Fedora team.) When you install third-party repositories
    on Red Hat and CentOS systems, you''ll also need to install a `priorities` package,
    and edit the `.repo` files to set the proper priorities for each repository. This
    will prevent packages from the third-party repository from overwriting official
    Red Hat and CentOS packages if they just happen to have the same name. The following
    steps will help you install the required packages and edit `.repo` file:'
  prefs: []
  type: TYPE_NORMAL
- en: 'The two packages that you''ll need to install EPEL are in the normal CentOS
    repositories. Run the command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'When the installation completes, navigate to the `/etc/yum.repos.d` directory,
    and open the `CentOS-Base.repo` file in your favorite text editor. After the last
    line of the `base`, `updates`, and `extras` sections, add the line, `priority=1`.
    After the last line of the `centosplus` section, add the line, `priority=2`. Save
    the file and close the editor.  Each of the sections that you''ve edited should
    look something like this (except with the appropriate name and priority number):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: Open the `epel.repo` file for editing. After the last line of the `epel` section,
    add the line, `priority=10`. After the last line of each remaining section, add
    the line, `priority=11`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Update the system and then create a list of the installed and available packages
    by running:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: Configuring a network for VirtualBox virtual machines
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Some of our training scenarios will require you to simulate creating a connection
    to a remote server. You would do this by using your host machine to connect to
    a virtual machine. When you first create a virtual machine on VirtualBox, the
    networking is set to NAT mode. In order to connect to the virtual machine from
    the host, you''ll need to set the virtual machine''s network adapter to Bridged
    Adapter mode. Here''s how you can do this:'
  prefs: []
  type: TYPE_NORMAL
- en: Shut down any virtual machines that you've already created.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: On the VirtualBox manager screen, open the Settings dialog for a virtual machine.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Click the Network menu item, and change the Attached to setting from NAT to
    Bridged Adapter:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/1922abb1-ca77-4d89-83b4-a878720d7533.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Expand the Advanced item, and change the Promiscuous Mode setting to Allow
    All:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/140d886d-3721-41ae-b61e-d8c2ea6cb77e.png)'
  prefs: []
  type: TYPE_IMG
- en: Restart the virtual machine and set it to use a static IP address.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If you assign static IP addresses from the high end of your subnet range, it
    will be easier to prevent conflicts with low-number IP addresses that get handed
    out from your internet gateway.
  prefs: []
  type: TYPE_NORMAL
- en: Creating a virtual machine snapshot with VirtualBox
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: One of the beautiful things about working with virtual machines is that you
    can create a snapshot and roll back to it if you mess something up. With VirtualBox,
    that's easy to do.
  prefs: []
  type: TYPE_NORMAL
- en: 'At the top, right-hand corner of the VirtualBox manager screen, click the Snapshots
    button:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/09d49f2f-e616-4403-9da7-d9e7c8c949c4.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Just left of mid-screen, you''ll see a camera icon. Click on that to bring
    up the snapshot dialog box. Either fill in the desired Snapshot Name, or accept
    the default name. Optionally, you can create a description:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/6ec078e5-0ff4-4751-94d4-77b555203215.png)'
  prefs: []
  type: TYPE_IMG
- en: 'After you''ve made changes to the virtual machine, you can roll back to the
    snapshot by shutting down the virtual machine, then right-clicking on the snapshot
    name, and selecting the proper menu item:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/b5852d38-9e29-4f31-adf7-2a9fa2e8e1d2.png)'
  prefs: []
  type: TYPE_IMG
- en: Using Cygwin to connect to your virtual machines
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: If your host machine is either a Linux or Mac machine, you'll simply open the
    host's Terminal and use the tools that are already there to connect to the virtual
    machine. But, if you're running a Windows machine, you'll want to install some
    sort of Bash shell and use its networking tools. Windows 10 Pro now comes with
    a Bash shell that's been provided by the Ubuntu folk and you can use that if you
    desire. But, if you don't have Windows 10 Pro, or if you prefer to use something
    else, you might consider Cygwin.
  prefs: []
  type: TYPE_NORMAL
- en: Cygwin, a project of the Red Hat company, is a free open source Bash shell that's
    built for Windows. It's free-of-charge, and easy to install.
  prefs: []
  type: TYPE_NORMAL
- en: Installing Cygwin on your Windows host
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Here''s a quick how-to to get you going with Cygwin:'
  prefs: []
  type: TYPE_NORMAL
- en: In your host machine's browser, download the appropriate `setup*.exe` file for
    your version of Windows from: [http://www.cygwin.com/](http://www.cygwin.com/).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Double-click on the setup icon to begin the installation. For the most part,
    just accept the defaults until you get to the package selection screen. (The one
    exception will be the screen where you select a download mirror.)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'At the top of the package selection screen, select Category from the View menu:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/a7955ecd-56fb-4cc9-b120-4f1f57754662.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Expand the Net category:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/aa78f65c-4fcf-41bc-9753-2bdf7e80d2e4.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Scroll down until you see the openssh package. Under the New column, click
    on Skip. (This causes a version number to appear in place of the Skip.):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/d2faa751-5cf6-427f-b7d1-581c69445eca.png)'
  prefs: []
  type: TYPE_IMG
- en: 'After you have selected the proper package, your screen should look like this:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/0cc4c271-38a6-41a2-8ecb-663d8c60157a.png)'
  prefs: []
  type: TYPE_IMG
- en: In the bottom right-hand corner, click Next. If a Resolving Dependencies screen
    pops up, click Next on it as well.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Keep the setup file that you downloaded, because you'll use it later to either
    install more software packages, or to update Cygwin. (When you open Cygwin, any
    updated packages will show up on the Pending view on View menu.)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Once you open Cygwin from the Windows Start menu, you can resize it as you
    desire, and use either the *Ctrl* + *+* or *Ctrl* + *-* key combinations to resize
    the font:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/d6812407-13b9-4495-bcf2-03d46fec1930.png)'
  prefs: []
  type: TYPE_IMG
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: So, we've made a good start to our journey into Linux security and hardening.
    In this chapter, we looked at why it's just as important to know about securing
    and hardening Linux systems as it is to know how to secure and harden Windows
    systems. We provided a few examples of how a poorly-configured Linux system can
    be compromised, and we mentioned that learning about Linux security could be good
    for your career. After that, we looked at how to set up a virtualized lab environment
    using VirtualBox and Cygwin.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we'll look at locking down user accounts, and ensuring
    that the wrong people never get administrative privileges. I'll see you there.
  prefs: []
  type: TYPE_NORMAL
