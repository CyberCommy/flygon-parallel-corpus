- en: Building a Lab
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Learning the art of exploitation and penetration tests in the field of cybersecurity
    is exciting and fascinating for both students and professionals. The idea of hacking
    is quite cool, but when learning about cybersecurity, such as penetration testing,
    an institution, such as a technical college or university, usually sets up a physical
    lab environment to conduct training. Learning ethical hacking and penetration
    testing should only be taught using systems designed and built for such training;
    in other words, penetration testing should definitely not be taught using systems
    available on the internet or those that do not provide consent for such testing.
  prefs: []
  type: TYPE_NORMAL
- en: To get started with penetration testing, you should set up a lab. Having your
    own lab will eliminate certain constraints, such as physically being within the
    training institution to access their lab. Also, the lab's availability and portability
    will be unrestricted.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we will cover the following topics:'
  prefs: []
  type: TYPE_NORMAL
- en: Requirements for building a penetration testing lab
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: An introduction in virtualization
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Setting up vulnerable systems
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Let's dive in!
  prefs: []
  type: TYPE_NORMAL
- en: Technical requirements
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: One of the most important considerations in building anything is the cost required
    to complete it. However, in the world of IT, there are many legitimate ways of
    building a penetration testing lab without having to spend any money. We're not
    talking about pirating here, because that would be illegal, however, there are
    many freeware applications available that operate at an enterprise standard. We
    will be using various applications to assemble our very own portable penetration
    testing lab.
  prefs: []
  type: TYPE_NORMAL
- en: 'To get started, there are some items you need to download from the internet
    to make all this happen:'
  prefs: []
  type: TYPE_NORMAL
- en: Hypervisor
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Vulnerable system(s)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Penetration testing distribution
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Hypervisor
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Some of us in the field of IT love working with servers, either Windows or Linux.
    Servers are awesome to work with just as everything else in IT. One of the most
    important technologies today is virtualization. Virtualization allow you to install
    almost any type of **operating system** (**OS**) on any type of hardware. What
    does this mean? Some OS, such as Android, Windows Server, Linux Server, and macOS,
    require specialized hardware, such as a specific type of processor, and if a system
    does not have the required hardware resources, the OS will not be installed. Virtualization
    comes in to save the day by using a virtual machine manager known as a **hypervisor**.
  prefs: []
  type: TYPE_NORMAL
- en: A hypervisor creates and emulates a virtual environment to fit the need for
    an OS. The hypervisor allows the administrator, such as yourself, to configure
    the number of cores and threads for the processor, the amount of RAM and hard
    disk drive allocation, and **input/output** (**I/O**) such as USB controllers
    and serial controllers. Therefore, during the installation process, the guest
    OS thinks it's being installed on physical hardware but it's actually being installed
    in a virtual environment. These are called virtual machines.
  prefs: []
  type: TYPE_NORMAL
- en: The host OS is the OS currently on your laptop or desktop computer, and the
    guest OS is the OS within a virtual machine or within a hypervisor.
  prefs: []
  type: TYPE_NORMAL
- en: There are two types of hypervisors. Let's discuss each in the upcoming sections.
  prefs: []
  type: TYPE_NORMAL
- en: Type 1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The Type 1 hypervisor is known as the bare-metal hypervisor. This type of hypervisor
    is installed directly onto the hardware and becomes the host OS:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/e70d0e08-f857-4119-8433-12b540467fc5.png)'
  prefs: []
  type: TYPE_IMG
- en: Type 2
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The Type 2 hypervisor is installed on top of a host OS. This type of hypervisor
    uses resources such as CPU, RAM, and storage, which are provided by the host OS:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/896a001f-f95b-416d-a5dc-a6d6531a724c.png)'
  prefs: []
  type: TYPE_IMG
- en: We are going to use a Type 2 hypervisor to set up our penetration testing lab.
    A benefit of using virtual machines for technical training is that if anything
    happens within a guest OS, it does not affect the host OS.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following are Type 2 hypervisors:'
  prefs: []
  type: TYPE_NORMAL
- en: Oracle VM VirtualBox (free)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: VMware Workstation Player (free and commercial)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: VMware Workstation Pro (commercial)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Microsoft Virtual PC (free)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Vulnerable systems
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: One of the most important components in building a penetration lab is its vulnerable
    system(s). We can't go around attempting to practice on systems for which we do
    not have prior consent as that would be illegal and intrusive.
  prefs: []
  type: TYPE_NORMAL
- en: Popular vulnerable machines used for penetration testing training and practice
    are known as Metasploitable 2 and Metasploitable 3\. These were created by the
    development team at Rapid 7 ([www.rapid7.com](http://www.rapid7.com)) for students
    and professionals to develop their skills in penetration testing using Rapid 7's
    own exploitation development framework, Metasploit ([www.rapid7.com/products/metasploit](http://www.rapid7.com/products/metasploit)).
  prefs: []
  type: TYPE_NORMAL
- en: Other sources of vulnerable systems for practicing and adding to a lab include
    VulnHub ([www.vulnhub.com](http://www.vulnhub.com)) and Pentesterlab ([www.pentesterlab.com](http://www.pentesterlab.com)).
  prefs: []
  type: TYPE_NORMAL
- en: Setting up the lab
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section, we are going to assemble all the pieces to have our fully operational
    penetration testing lab.
  prefs: []
  type: TYPE_NORMAL
- en: Step 1 – installing the hypervisor
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: First, download Oracle VM VirtualBox from its official website: [www.virtualbox.org](http://www.virtualbox.org).
  prefs: []
  type: TYPE_NORMAL
- en: 'Once you''ve downloaded Oracle VM VirtualBox, complete the installation process
    and leave all the options as default. Once the installation is successful, you
    will be presented with the following window:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/eb1b2e87-e151-4770-bfcc-9a153deea759.png)'
  prefs: []
  type: TYPE_IMG
- en: Another very popular hypervisor is VMware Workstation. However, this product
    is commercial (paid) unlike Oracle VM VirtualBox (free).
  prefs: []
  type: TYPE_NORMAL
- en: Step 2 – obtaining vulnerable systems
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: As mentioned, there are many available vulnerable systems that can be found
    on the internet. We are going to deploy *Metasploitable* and *OWASP Broken Web
    Applications Project *– both of these are virtual machines designed to give students
    and professionals a real-world, hands-on experience.
  prefs: []
  type: TYPE_NORMAL
- en: Metasploitable 2 is currently available at its official repository at [https://information.rapid7.com/download-metasploitable-2017.html](https://information.rapid7.com/download-metasploitable-2017.html),
    and alternatively at [https://sourceforge.net/projects/metasploitable/](https://sourceforge.net/projects/metasploitable/).
  prefs: []
  type: TYPE_NORMAL
- en: The OWASP Broken Web Applications Project can be found at [https://sourceforge.net/projects/owaspbwa/files/](https://sourceforge.net/projects/owaspbwa/files/).
    Ensure you have downloaded the `.ova` file as it will make the setup process seamless.
  prefs: []
  type: TYPE_NORMAL
- en: Step 3 – setting up Metasploitable
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Starting with Metasploitable 2, go to the folder that has the file, `metasploitable-linux-2.0.0.zip`.
    Ensure the contents of the compressed folder are extracted. These files make up
    a virtual hard disk that can later be added on to a hypervisor:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/8b35d837-9fc6-4c3b-bfe8-3ea497f4b370.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Open VirtualBox, click on New. The wizard opens on guided mode, however, we
    are going to use expert mode:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/576c619c-1ae0-4d21-adaf-20902836060b.png)'
  prefs: []
  type: TYPE_IMG
- en: For the Hard disk option, we are going to use the Metasploitable 2 virtual hard
    disk; these are the extracted files from the previous step. Select the Use an
    existing virtual hard disk file option and click on the folder icon
  prefs: []
  type: TYPE_NORMAL
- en: 'Click Add to attach the virtual hard disk. Once it''s in the window, click
    Choose to select it:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/6f14d7e2-db5d-46f8-a86a-7d72712f10dc.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Clicking Choose carries you back to the main window—we can see that the file
    has been attached:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/a5831fe5-a31b-4caa-bdea-7a6dfe55c7fd.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Click on Create to complete the process:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/906697f3-a614-4f69-85e6-8f9452c5f563.png)'
  prefs: []
  type: TYPE_IMG
- en: Let's configure the network adapter on this newly created virtual machine. Select
    the virtual machine and click on Settings.
  prefs: []
  type: TYPE_NORMAL
- en: 'Next, select the Network category, apply the following configurations, and
    click OK once completed:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/02ff8f76-573e-48f5-ae5e-56961f740732.png)'
  prefs: []
  type: TYPE_IMG
- en: The **Host-only Adapter** settings will allow communications on a private virtual
    network between the virtual machine and the host OS. It is not recommended to
    connect vulnerable systems to the internet.
  prefs: []
  type: TYPE_NORMAL
- en: '**Bridge mode** will allow the virtual machine to connect directly onto your
    physical, or real, network.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Now, it''s time to set up virtual networking using VirtualBox. To configure
    a virtual adapter on your host system, ensure VirtualBox is open—at the top, click
    on Tools | Create:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/5b7c3a41-4f40-46fb-b535-c35975828765.png)'
  prefs: []
  type: TYPE_IMG
- en: 'If an adapter already exists, select it and click on Properties. We are going
    to use the `10.10.10.0/24` network in our virtual lab network. This IP scheme
    would provide a usable range from `10.10.10.1` to `10.10.10.254`, however, these
    IP addresses will be distributed by the DHCP server that is built into VirtualBox:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/12b7bea2-93a1-46a7-8ba3-52d71b434c0e.png)'
  prefs: []
  type: TYPE_IMG
- en: Once you've made these configurations, click on Apply.
  prefs: []
  type: TYPE_NORMAL
- en: 'Now it''s time to power on *Metasploitable*. The username is `msfadmin` and
    the password is `msfadmin`:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/f99a5991-3d64-48f2-9f28-97d41ea8ae59.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Once you''re logged in, use the `ifconfig` command to check for the IP address
    of the **virtual machine** (**VM**):'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/7aeff7fa-a177-4cd0-bb89-bb55dc73e08f.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Step 4 – setting up the OWASP broken web applications project
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Open VirtualBox and click on Import:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/d170de4f-cd4d-4c72-9b27-2637fbd8a157.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The Import Virtual Appliance window will open—click the folder icon on the
    right. Select the `OWASP_Broken_Web_Apps_VM_1.2.ova` file:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/0633d9a3-6eec-4b15-b3ff-4e5636c5c55b.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The appliance configurations should now be populated in the window, so click
    on Import:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/d739ad5d-7a1c-42bc-8e69-ffaaf7e651da.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Once imported, it''s time to start the new virtual machine and obtain its IP
    address. The username is `root` and the password is `owaspbwa`:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/86e7db50-1f97-4e29-b90e-a87ff8671baf.png)'
  prefs: []
  type: TYPE_IMG
- en: The resources of the OWASP Broken Web Applications Project, which is a VM has
    access via a web interface.
  prefs: []
  type: TYPE_NORMAL
- en: 'Now we have a couple of vulnerable systems in our virtualized penetration testing
    lab, and it''s available at our convenience. Please remember: additional vulnerable
    systems can be added to your lab at a later time to further your practice and
    build your skills.'
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we covered the requirements for assembling a virtualized lab
    to practice penetration testing, the reason for choosing each component, and finally
    put the pieces together during the assembly phase. I hope this chapter has been
    informative and you are able to add a lot more virtual machines to increase the
    size of your lab while becoming better at penetration testing. Now, you are able
    to build your very own lab at home.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will look at how to select various options for a Kali
    device and hardware.
  prefs: []
  type: TYPE_NORMAL
