- en: Reconnaissance and Profiling the Web Server
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 侦察和分析Web服务器
- en: Over the years, malicious attackers have found various ways to penetrate a system.
    They gather information about the target, identify vulnerabilities, and then unleash
    an attack. Once inside the target, they try to hide their tracks and remain hidden.
    The attacker may not necessarily follow the same sequence as we do, but as a penetration
    tester, following the approach suggested here will help you conduct the assessment
    in a structured way; also, the data collected at each stage will aid in preparing
    a report that is of value to your client. An attacker's aim is ultimately to own
    your system; so, they might not follow any sequential methodology to do this.
    As a penetration tester, your aim is to identify as many bugs as you can; therefore,
    following a logical methodology is really useful. Moreover, you need to be creative
    and think outside the box.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 多年来，恶意攻击者找到了各种渗透系统的方法。他们收集有关目标的信息，识别漏洞，然后发动攻击。一旦进入目标，他们试图隐藏自己的踪迹并保持隐藏。攻击者可能不一定按照我们的顺序进行，但作为渗透测试人员，遵循这里建议的方法将帮助您以结构化的方式进行评估；此外，每个阶段收集的数据将有助于准备一份对客户有价值的报告。攻击者的目标最终是拥有您的系统；因此，他们可能不遵循任何顺序的方法来实现这一目标。作为渗透测试人员，您的目标是尽可能多地识别漏洞；因此，遵循一个逻辑的方法非常有用。此外，您需要有创造力并且要有开阔的思维。
- en: 'The following are the different stages of a penetration test:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是渗透测试的不同阶段：
- en: '**Reconnaissance**: This involves investigating publicly available information
    and getting to know the target''s underlying technologies and relationships between
    components'
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**侦察**：这涉及调查公开可用的信息，了解目标的基础技术和组件之间的关系'
- en: '**Scanning**: This involves finding possible openings or vulnerabilities in
    the target through manual testing or automated scanning'
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**扫描**：这涉及通过手动测试或自动扫描找到目标中可能的漏洞或弱点'
- en: '**Exploitation**: This involves exploiting vulnerabilities, compromising the
    target, and gaining access'
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**利用**：这涉及利用漏洞，入侵目标并获取访问权限'
- en: '**Maintaining access (post-exploitation)**: Setting up the means to escalate
    privileges on the exploited assets or access in alternative ways; installing backdoors,
    exploiting local vulnerabilities, creating users, and other methods'
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**维持访问（后期利用）**：建立升级特权的手段或以其他方式访问被利用的资产；安装后门、利用本地漏洞、创建用户和其他方法'
- en: '**Covering tracks**: This involves removing evidence of the attack; usually,
    professional penetration testing doesn''t involve this last stage, as being able
    to rebuild the path followed by the tester gives valuable information to defensive
    teams and helps build up the security level of the targets'
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**销毁痕迹**：这涉及删除攻击的证据；通常，专业的渗透测试不涉及这个最后阶段，因为能够重建测试人员所遵循的路径为防御团队提供了有价值的信息，并有助于提高目标的安全水平'
- en: Reconnaissance and scanning are the initial stages of a penetration test. The
    success of the penetration test depends greatly on the quality of the information
    gathered during these phases. In this chapter, you will work as a penetration
    tester and extract information using both passive and active reconnaissance techniques.
    You will then probe the target using the different tools provided with Kali Linux
    to extract further information and to find some vulnerabilities using automated
    tools.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 侦察和扫描是渗透测试的初始阶段。渗透测试的成功在很大程度上取决于在这些阶段收集到的信息的质量。在本章中，您将作为渗透测试人员，并使用被动和主动侦察技术提取信息。然后，您将使用Kali
    Linux提供的不同工具对目标进行探测，以进一步提取信息并使用自动化工具找到一些漏洞。
- en: Reconnaissance
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 侦察
- en: '**Reconnaissance** is a term used by defense forces, and it means obtaining
    information about the enemy in a way that does not alert them. The same concept
    is applied by attackers and penetration testers to obtain information related
    to the target. Information gathering is the main goal of reconnaissance. Any information
    gathered at this initial stage is considered important. The attacker working with
    malicious content builds on the information learned during the reconnaissance
    stage and gradually moves ahead with the exploitation. A small bit of information
    that appears innocuous may help you in highlighting a severe flaw in the later
    stages of the test. A valuable skill for a penetration tester is to be able to
    chain together vulnerabilities that may be low risk by themselves, but that represent
    a high impact if assembled.'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: '**侦察**是国防部队使用的一个术语，它意味着以不引起敌人警觉的方式获取有关敌人的信息。攻击者和渗透测试人员也采用相同的概念来获取与目标相关的信息。信息收集是侦察的主要目标。在这个初始阶段收集到的任何信息都被认为是重要的。攻击者在恶意内容的基础上构建侦察阶段中学到的信息，并逐渐进行利用。一个看似无害的小信息可能会帮助你在测试的后期阶段突出显示一个严重的缺陷。渗透测试人员的一个有价值的技能是能够将可能是低风险的漏洞链接在一起，但如果组合起来则具有高影响力。'
- en: 'The aim of reconnaissance in a penetration test includes the following tasks:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 侦察测试的目标包括以下任务：
- en: Identifying the IP address, domains, subdomains, and related information using
    Whois records, search engines, and DNS servers.
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Whois记录、搜索引擎和DNS服务器识别IP地址、域名、子域名和相关信息。
- en: Accumulating information about the target website from publicly available resources
    such as Google, Bing, Yahoo!, and Shodan. Internet Archive ([https://archive.org/](https://archive.org/)),
    a website that acts as a digital archive for all of the web pages on the internet,
    can reveal some very useful information in the reconnaissance phase. The website
    has been archiving cached pages since 1996\. If the target website was created
    recently, however, it will take some time for Internet Archive to cache it.
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从Google、Bing、Yahoo!和Shodan等公开可用资源中积累有关目标网站的信息。互联网档案馆（[https://archive.org/](https://archive.org/)）是一个作为互联网上所有网页的数字档案的网站，在侦察阶段可以揭示一些非常有用的信息。该网站自1996年以来一直在存档缓存页面。然而，如果目标网站是最近创建的，互联网档案馆将需要一些时间来缓存它。
- en: Identifying people related to the target with the help of social networking
    sites, such as LinkedIn, Facebook, Flick, Instagram, or Twitter, as well as tools
    such as Maltego.
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过社交网络网站（如LinkedIn、Facebook、Flick、Instagram或Twitter）以及Maltego等工具来确定与目标相关的人员。
- en: Determining the physical location of the target using a Geo IP database, satellite
    images from Google Maps, and Bing Maps.
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 使用Geo IP数据库、Google Maps和Bing Maps的卫星图像来确定目标的物理位置。
- en: Manually browsing the web application and creating site maps to understand the
    flow of the application and spidering using tools such as Burp Suite, HTTP Track,
    and ZAP Proxy.
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通过手动浏览Web应用程序并创建站点地图来了解应用程序的流程，并使用Burp Suite、HTTP Track和ZAP Proxy等工具进行爬虫。
- en: In web application penetration testing, reconnaissance may not be so extensive.
    For example, in a gray box approach, most of the information that can be gathered
    at this stage is provided by the client; also, the scope may be strictly limited
    to the target application running in a testing environment. For the sake of completeness,
    in this book we will take a generalist approach.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 在Web应用程序渗透测试中，侦察可能不会那么广泛。例如，在灰盒方法中，大部分在此阶段可以收集到的信息由客户提供；此外，范围可能严格限制在测试环境中运行的目标应用程序上。为了完整起见，在本书中，我们将采取一种通用的方法。
- en: Passive reconnaissance versus active reconnaissance
  id: totrans-18
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 被动侦察与主动侦察
- en: Reconnaissance in the real sense should always be *passive*. This means that
    reconnaissance should never interact directly with the target, and that it should
    gather all of the information from third-party sources. In practical implementation,
    however, while doing a reconnaissance of a web application, you will often interact
    with the target to obtain the most recent changes. Passive reconnaissance depends
    on cached information, and it may not include the recent changes made on the target.
    Although you can learn a lot using the publicly available information related
    to the target, interacting with the website in a way that does not alert the firewalls
    and intrusion prevention devices should always be included in the scope of this
    stage.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 真正意义上的侦察应始终是被动的。这意味着侦察不应直接与目标交互，并且应从第三方来源收集所有信息。然而，在实际实施中，在对Web应用程序进行侦察时，您通常会与目标交互以获取最新的更改。被动侦察依赖于缓存的信息，可能不包括目标上进行的最新更改。尽管您可以使用与目标相关的公开可用信息学到很多东西，但在此阶段的范围内应始终包括以不警报防火墙和入侵防御设备的方式与网站进行交互。
- en: Some penetration testers believe that passive reconnaissance should include
    browsing the target URL and navigating through the publicly available content;
    however, others would contend that it should not involve any network packets targeted
    to the actual website.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 一些渗透测试人员认为被动侦察应包括浏览目标URL并浏览公开可用内容；然而，其他人可能会认为它不应涉及任何针对实际网站的网络数据包。
- en: Information gathering
  id: totrans-21
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 信息收集
- en: As stated earlier, the main goal of reconnaissance is to gather information
    while avoiding detection and alerts on intrusion-detection mechanisms. Passive
    reconnaissance is used to extract information related to the target from publicly
    available resources. In a web application penetration test, to begin you will
    be given a URL. You will then scope the entire website and try to connect the
    different pieces. Passive reconnaissance is also known as **Open Source Intelligence**
    (**OSINT**) gathering.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 如前所述，侦察的主要目标是收集信息，同时避免被入侵检测机制检测和警报。被动侦察用于从公开可用资源中提取与目标相关的信息。在Web应用程序渗透测试中，您将首先获得一个URL。然后，您将确定整个网站的范围并尝试连接不同的部分。被动侦察也被称为开源情报（OSINT）收集。
- en: In a black box penetration test, where you have no previous information about
    the target and have to approach it like an uninformed attacker, reconnaissance
    plays a major role. The URL of a website is the only thing you have, to expand
    your knowledge about the target.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 在黑盒渗透测试中，您对目标没有任何先前的信息，并且必须像一个不知情的攻击者一样接近它，侦察起着重要的作用。网站的URL是您唯一拥有的东西，用于扩展您对目标的了解。
- en: Domain registration details
  id: totrans-24
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 域名注册详细信息
- en: Every time you register a domain, you have to provide details about your company
    or business, such as the name, phone number, mailing address, and specific email
    addresses for technical and billing purposes. The domain registrar will also store
    the IP address of your authoritative DNS servers.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 每次注册域名时，您都必须提供有关您的公司或业务的详细信息，例如名称、电话号码、邮寄地址以及用于技术和计费目的的特定电子邮件地址。域名注册商还将存储您的权威DNS服务器的IP地址。
- en: An attacker who retrieves this information can use it with malicious intent.
    Contact names and numbers provided during registration can be used for social
    engineering attacks such as duping users via telephone. Mailing addresses can
    help the attacker perform wardriving and find unsecured wireless access points.
    The New York Times was attacked in 2013 when its DNS records were altered by a
    malicious attacker conducting a phishing attack against the domain reseller for
    the registrar that managed the domain. Altering DNS records has a serious effect
    on the functioning of a website as an attacker can use it to redirect web traffic
    to a different server, and rectified changes can take up to 72 hours to reach
    all of the public DNS servers spread across the globe.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 检索这些信息的攻击者可以将其用于恶意目的。在注册过程中提供的联系人姓名和电话号码可以用于社会工程攻击，例如通过电话欺骗用户。邮寄地址可以帮助攻击者进行wardriving并找到未加密的无线接入点。纽约时报在2013年遭到攻击，当时其DNS记录被恶意攻击者更改，该攻击者对管理该域名的注册商的域名转售商进行了网络钓鱼攻击。更改DNS记录对网站的功能有严重影响，因为攻击者可以使用它将Web流量重定向到不同的服务器，而修复的更改可能需要长达72小时才能到达全球范围内的所有公共DNS服务器。
- en: Whois – extracting domain information
  id: totrans-27
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Whois - 提取域名信息
- en: '**Whois records** are used to retrieve the registration details provided by
    the domain owner to the domain registrar. It is a protocol that is used to extract
    information about the domain and the associated contact information. You can view
    the name, address, phone number, and email address of the person/entity who registered
    the domain. Whois servers are operated by **Regional Internet Registrars** (**RIR**),
    and they can be queried directly over port `43`. In the early days of the internet,
    there was only one Whois server, but the number of existing Whois servers has
    increased with the expansion of the internet. If the information for the requested
    domain is not present on the queried server, the request is then forwarded to
    the Whois server of the domain registrar and the results are returned to the end
    client. A Whois tool is built into Kali Linux, and it can be run from Terminal.
    The information retrieved by the tool is only as accurate as the information updated
    by the domain owner, and it can be misleading at times if the updated details
    on the registrar website are incorrect. Also, domain owners can block sensitive
    information related to your domain by subscribing to additional services provided
    by the domain registrar, after which the registrar would display their details
    instead of the contact details of your domain.'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: '**Whois记录**用于检索域所有者向域名注册商提供的注册详细信息。它是一种用于提取有关域和相关联系信息的协议。您可以查看注册域名的人/实体的姓名、地址、电话号码和电子邮件地址。Whois服务器由**区域互联网注册机构**（**RIR**）运营，并且可以直接通过端口`43`进行查询。在互联网的早期，只有一个Whois服务器，但随着互联网的扩展，现有的Whois服务器数量也增加了。如果查询的服务器上没有请求域的信息，则将请求转发到域名注册商的Whois服务器，并将结果返回给最终客户端。Kali
    Linux内置了一个Whois工具，可以从终端运行。工具检索到的信息只有域所有者更新的信息准确，如果注册商网站上的更新详细信息不正确，有时可能会误导。此外，域所有者可以通过订阅域名注册商提供的附加服务来阻止与您的域名相关的敏感信息，此后注册商将显示他们的详细信息而不是您的域名的联系方式。'
- en: 'The `whois` command followed by the target domain name should display some
    valuable information. The output will contain the registrar name and the Whois
    server that returned the information. It will also display when the domain was
    registered and the expiration date, as shown in the following screenshot:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 使用`whois`命令后跟目标域名应该显示一些有价值的信息。输出将包含注册商名称和返回信息的Whois服务器。它还将显示域名注册日期和到期日期，如下图所示：
- en: '![](img/00035.jpeg)'
  id: totrans-30
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00035.jpeg)'
- en: 'If the domain administrator fails to renew the domain before the expiration
    date, the domain registrar releases the domain, which can then be bought by anyone.
    The output also points out the DNS server for the domain, which can further be
    queried to find additional hosts in the domain:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 如果域名管理员在到期日期之前未续订域名，域名注册商将释放该域名，然后任何人都可以购买。输出还指出了域名的DNS服务器，可以进一步查询以找到域中的其他主机：
- en: '![](img/00036.jpeg)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00036.jpeg)'
- en: Identifying related hosts using DNS
  id: totrans-33
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用DNS识别相关主机
- en: Once you have the name of the authoritative DNS server, you can use it to identify
    additional hosts in the domain. A DNS zone may not necessarily only contain entries
    for web servers. On the internet, every technology that requires hostnames to
    identify services uses DNS. The mail server and FTP server use DNS to resolve
    hosts to IP addresses. By querying the DNS server, you can identify additional
    hosts in the target organization; it will also help you in identifying additional
    applications accessible from the internet. The records of `citrix.target-domain.com`
    or `webmail.target-domain.com` can lead you to the additional applications accessible
    from the internet.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 一旦您获得了权威DNS服务器的名称，您可以使用它来识别域中的其他主机。DNS区域可能不仅包含用于Web服务器的条目。在互联网上，每个需要主机名来标识服务的技术都使用DNS。邮件服务器和FTP服务器使用DNS来将主机解析为IP地址。通过查询DNS服务器，您可以识别目标组织中的其他主机；它还将帮助您识别从互联网访问的其他应用程序。`citrix.target-domain.com`或`webmail.target-domain.com`的记录可以引导您访问从互联网访问的其他应用程序。
- en: Zone transfer using dig
  id: totrans-35
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用dig进行区域传输
- en: DNS servers usually implement replication (that is, for primary and secondary
    servers) to improve availability. In order to synchronize the host resolution
    database from primary to secondary, an operation called **zone transfer** takes
    place. The secondary server requests the zone (portion of the domain for which
    that server is responsible) data from the primary, and this responds with a copy
    of the database, containing the IP address-hostname pairs that it can resolve.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: DNS服务器通常实现复制（即主服务器和辅助服务器）以提高可用性。为了将主机解析数据库从主服务器同步到辅助服务器，会进行一种称为**区域传输**的操作。辅助服务器从主服务器请求区域（该服务器负责的域的部分）数据，主服务器会响应并返回一个包含其可以解析的IP地址-主机名对的数据库副本。
- en: A misconfiguration in DNS servers allows for anyone to ask for a zone transfer
    and obtain the full list of resolved hosts of these servers. Using the **Domain
    Internet Groper** (**dig**) command-line tool in Linux, you can try to execute
    a zone transfer to identify additional hosts in the domain. Zone transfers are
    done over TCP port `53` and not UDP port `53`, which is the standard DNS port.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: DNS服务器的配置错误允许任何人请求区域传输并获取这些服务器的已解析主机的完整列表。在Linux中使用**域名互联网探测器**（**dig**）命令行工具，您可以尝试执行区域传输以识别域中的其他主机。区域传输是通过TCP端口`53`而不是标准的DNS端口UDP端口`53`进行的。
- en: The `dig` command-line tool is mainly used for querying DNS servers for hostnames.
    A simple command such as `dig google.com` reveals the IP address of the domain
    and the name of the DNS server that hosts the DNS zone for it (also known as the
    name server). There are many types of DNS records, such as **Mail Exchanger**
    (**MX**), SRV records, and PTR records. The `dig google.com mx` command displays
    information for the MX record.
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: '`dig`命令行工具主要用于查询DNS服务器的主机名。一个简单的命令，如`dig google.com`，会显示该域的IP地址和托管DNS区域的DNS服务器的名称（也称为名称服务器）。有许多类型的DNS记录，如**邮件交换器**（**MX**）、SRV记录和PTR记录。`dig
    google.com mx`命令显示MX记录的信息。'
- en: In addition to the usual DNS tasks, the `dig` command can also be used to perform
    a DNS zone transfer.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 除了常规的DNS任务外，`dig`命令还可以用于执行DNS区域传输。
- en: 'Let''s request a zone transfer to `zonetransfer.me`, a vulnerable domain made
    for educational purposes by Robin Wood (DigiNinja). The request is made using
    the `dig` command, for the AXFR (zone transfer) register of the `zonetransfer.me` domain to
    the `nsztm1.digi.ninja` server:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们向`zonetransfer.me`发出一个区域传输请求，这是由Robin Wood（DigiNinja）为教育目的而创建的一个易受攻击的域。请求使用`dig`命令，将`zonetransfer.me`域的AXFR（区域传输）记录发送到`nsztm1.digi.ninja`服务器：
- en: '[PRE0]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'As shown in the following screenshot, if zone transfer is enabled, the `dig`
    tool dumps all of the entries in the zone at Terminal:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 如下屏幕截图所示，如果启用了区域传输，`dig`工具会在终端中转储区域中的所有条目：
- en: '![](img/00037.jpeg)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00037.jpeg)'
- en: Shell commands, such as `grep` or `cut`, are very useful for processing the
    output of command-line tools. In the preceding example, `cut` is used with a `|` (pipe)
    character to show only the first three elements that are separated by a `-d "
    "` (space) character from each line of the `dig` command's results. In this screenshot,
    the columns are separated by tab characters and information shown in the last
    column is separated by spaces.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: Shell命令，如`grep`或`cut`，非常适用于处理命令行工具的输出。在上面的示例中，`cut`与`|`（管道）字符一起使用，只显示`dig`命令结果中每行的由`-d
    " "`（空格）字符分隔的前三个元素。在此屏幕截图中，列由制表符分隔，最后一列中的信息由空格分隔。
- en: You will often find that even though the primary DNS server blocks the zone
    transfer, a secondary server for that domain might allow it. The `dig google.com
    NS +noall +answer` command will display all of the name servers for that domain.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 通常情况下，即使主DNS服务器阻止区域传输，该域的辅助服务器可能允许它。`dig google.com NS +noall +answer`命令将显示该域的所有名称服务器。
- en: 'The attempt to perform a zone transfer from the DNS server of `facebook.com`
    failed, as the company have correctly locked down their DNS servers:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 尝试从`facebook.com`的DNS服务器执行区域传输失败，因为该公司正确地锁定了他们的DNS服务器：
- en: '![](img/00038.jpeg)'
  id: totrans-47
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00038.jpeg)'
- en: Performing a DNS lookup to search for an IP address is passive reconnaissance.
    However, the moment you do a zone transfer using a tool such as `dig` or `nslookup`,
    it turns into active reconnaissance.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 进行DNS查找以搜索IP地址是被动侦察。然而，一旦使用`dig`或`nslookup`等工具进行区域传输，它就变成了主动侦察。
- en: DNS enumeration
  id: totrans-49
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: DNS枚举
- en: Finding a misconfigured server that allows anonymous zone transfers is very
    uncommon on real penetration testing projects. There are other techniques that
    can be used to discover hostnames or subdomains related to a domain, and Kali
    Linux includes a couple of useful tools to do just that.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 在真实的渗透测试项目中，很少会发现允许匿名区域传输的配置错误的服务器。还有其他技术可以用来发现与域名相关的主机名或子域名，Kali Linux包含了一些有用的工具来完成这个任务。
- en: DNSEnum
  id: totrans-51
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: DNSEnum
- en: '**DNSEnum** is a command-line tool that automatically identifies basic DNS
    records such as MX, mail exchange servers, NS, domain name servers, or A—the address
    record for a domain. It also attempts zone transfers on all identified servers,
    and it has the ability to attempt reverse resolution (that is, getting the hostname
    given an IP address) and brute forcing (querying for the existence of hostnames
    in order to get their IP address) of subdomains and hostnames. Here is an example
    of a query to `zonetransfer.me`:'
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: '**DNSEnum**是一个命令行工具，可以自动识别基本的DNS记录，如MX记录、邮件交换服务器、NS记录、域名服务器或A记录（域的地址记录）。它还尝试在所有识别的服务器上进行区域传输，并具有尝试反向解析（即根据IP地址获取主机名）和暴力破解（查询子域和主机名的存在以获取其IP地址）的能力。以下是对`zonetransfer.me`的查询示例：'
- en: '![](img/00039.jpeg)'
  id: totrans-53
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00039.jpeg)'
- en: 'The zone transfer results are as follows:'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 区域传输的结果如下：
- en: '![](img/00040.jpeg)'
  id: totrans-55
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00040.jpeg)'
- en: Fierce
  id: totrans-56
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Fierce
- en: 'Fierce is presented by `mschwager`, in *Fierce: A DNS reconnaissance tool for
    locating non-contiguous IP space* ([https://github.com/mschwager/fierce](https://github.com/mschwager/fierce)),
    GitHub © 2018, as follows:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 'Fierce由`mschwager`提供，详见*Fierce: A DNS reconnaissance tool for locating non-contiguous
    IP space* ([https://github.com/mschwager/fierce](https://github.com/mschwager/fierce)),
    GitHub © 2018，如下所示：'
- en: Fierce is a semi-lightweight scanner that helps locate non-contiguous IP space
    and hostnames against specified domains.
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: Fierce是一个半轻量级的扫描器，用于定位非连续的IP空间和指定域的主机名。
- en: 'Fierce uses zone transfer, dictionary attacks, and reverse resolution to gather
    hostnames and subdomains along with the IP addresses of a domain, and it has the
    option to search for related names (for example, `domain company.com`, `corpcompany.com`,
    or `webcompany.com`). In the following example, we will use search to identify
    hostnames of `google.com`:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: Fierce使用区域传输、字典攻击和反向解析来收集主机名和子域名以及域的IP地址，并且它可以搜索相关名称（例如`domain company.com`、`corpcompany.com`或`webcompany.com`）。在下面的示例中，我们将使用搜索来识别`google.com`的主机名：
- en: '![](img/00041.jpeg)'
  id: totrans-60
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00041.jpeg)'
- en: DNSRecon
  id: totrans-61
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: DNSRecon
- en: '**DNSRecon** is another useful tool included in Kali Linux. It lets you gather
    DNS information through a number of techniques including zone transfer, dictionary
    requests, and Google search. In the following screenshot, we will do an enumeration
    by zone transfer (`-a`), reverse analysis of the IP address space obtained by
    Whois (`-w`), and Google search (`-g`) over `zonetransfer.me`:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: '**DNSRecon**是Kali Linux中的另一个有用工具。它可以通过区域传输、字典请求和Google搜索等多种技术来收集DNS信息。在下面的屏幕截图中，我们将通过区域传输（`-a`）、通过Whois获取的IP地址空间的反向分析（`-w`）和Google搜索（`-g`）对`zonetransfer.me`进行枚举：'
- en: '![](img/00042.jpeg)'
  id: totrans-63
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00042.jpeg)'
- en: Brute force DNS records using Nmap
  id: totrans-64
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Nmap对DNS记录进行暴力破解
- en: '**Nmap** comes with a script to query the DNS server for additional hosts using
    a brute forcing technique. It makes use of the `vhosts-defaults.lst` and `vhosts-full.lst` dictionary
    files, which contain a large list of common hostnames that have been collected
    over the years by the Nmap development team. The files can be located at `/usr/share/nmap/nselib/data/`.
    Nmap sends a query to the DNS server for each entry in that file to check whether
    there are any A records available for that hostname in the DNS zone.'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: '**Nmap**附带了一个脚本，使用暴力破解技术查询DNS服务器以获取其他主机。它使用了`vhosts-defaults.lst`和`vhosts-full.lst`字典文件，这些文件包含了多年来由Nmap开发团队收集的常见主机名的大量列表。这些文件可以在`/usr/share/nmap/nselib/data/`目录下找到。Nmap向DNS服务器发送查询，检查该文件中的每个条目是否有可用于该主机名的A记录。'
- en: 'As shown in the following screenshot, the brute force script returned a positive
    result. It identified a few hosts in the DNS zone by querying for their A records:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 如下所示的屏幕截图显示，暴力破解脚本返回了一个积极的结果。它通过查询A记录来识别DNS区域中的一些主机：
- en: '![](img/00043.jpeg)'
  id: totrans-67
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00043.jpeg)'
- en: Using search engines and public sites to gather information
  id: totrans-68
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用搜索引擎和公共网站收集信息
- en: Modern search engines are a valuable resource for public information gathering
    and passive reconnaissance. Generalist engines such as Google, Bing, and DuckDuckGo
    allow us to use advanced search filters to look for information in a particular
    domain, certain file types, content in URLs, and specific text patterns. There
    are also specialized search engines, such as Shodan, that let you search for hostnames,
    open ports, server location, and specific response headers in a multitude of services.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 现代搜索引擎是公共信息收集和被动侦察的宝贵资源。像Google、Bing和DuckDuckGo这样的综合搜索引擎允许我们使用高级搜索过滤器来查找特定域中的信息、特定文件类型、URL中的内容和特定文本模式。还有一些专门的搜索引擎，比如Shodan，可以让您在多种服务中搜索主机名、开放端口、服务器位置和特定的响应头。
- en: Google dorks
  id: totrans-70
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Google dorks
- en: 'The **Google dorks** technique, also known as *Google hacking*, started as
    an abuse of Google''s advanced search options, and it was later extended to other
    search engines that also included similar options. It searches for specific strings
    and parameters to get valuable information from an organization or target. Here
    are some examples that can be useful for a penetration tester:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: '**Google dorks**技术，也称为*Google hacking*，起初是滥用Google的高级搜索选项，后来扩展到其他也包含类似选项的搜索引擎。它搜索特定的字符串和参数，以从组织或目标中获取有价值的信息。以下是一些对渗透测试人员有用的示例：'
- en: 'PDF documents in a specific site or domain can be searched for, like this:'
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可以搜索特定站点或域中的PDF文档，如下所示：
- en: '[PRE1]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'References to email addresses of a specific domain, excluding the domain''s
    site can be searched for:'
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可以搜索特定域的电子邮件地址引用，但排除该域的网站：
- en: '[PRE2]'
  id: totrans-75
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'Administrative sites with the word `admin` in the title or the URL in `example.com` can
    be searched for:'
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可以搜索标题或URL中包含`example.com`的管理站点：
- en: '[PRE3]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'You can also look for a specific error message indicating a possible SQL injection
    vulnerability:'
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 您还可以搜索特定的错误消息，指示可能存在SQL注入漏洞：
- en: '[PRE4]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'There are thousands of possible useful search combinations in Google and other
    search engines. Offensive Security, the creators of Kali Linux, also maintain
    a public database for search strings that may yield useful results for a penetration
    tester, which is available at: [https://www.exploit-db.com/google-hacking-database/](https://www.exploit-db.com/google-hacking-database/).'
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: Google和其他搜索引擎中有成千上万种可能的有用搜索组合。Kali Linux的创建者Offensive Security还维护了一个公共数据库，其中包含可能为渗透测试人员提供有用结果的搜索字符串，该数据库位于：[https://www.exploit-db.com/google-hacking-database/](https://www.exploit-db.com/google-hacking-database/)。
- en: Shodan
  id: totrans-81
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Shodan
- en: '**Shodan** ([https://shodan.io](https://shodan.io)) is a different kind of
    search engine; it helps you to look for devices connected to the internet instead
    of content in web pages. Like Google, it has operators and a specific syntax to
    execute advanced and specific searches. This screenshot shows a search for all
    hostnames related to `google.com`:'
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: '**Shodan**（[https://shodan.io](https://shodan.io)）是一种不同类型的搜索引擎；它帮助您查找连接到互联网的设备，而不是网页中的内容。与Google一样，它具有运算符和特定的语法来执行高级和特定的搜索。这个屏幕截图显示了搜索与`google.com`相关的所有主机名：'
- en: '![](img/00044.jpeg)'
  id: totrans-83
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00044.jpeg)'
- en: A hostname search example using Shodan
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Shodan进行主机名搜索的示例
- en: 'To take advantage of Shodan''s advanced search features, one needs to first
    create an account. Free accounts yield a limited number of results, and some options
    are restricted though still very useful. Shodan can be used to find the following:'
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
  zh: 要利用Shodan的高级搜索功能，首先需要创建一个帐户。免费帐户只能获得有限数量的结果，而且某些选项受限，但仍然非常有用。Shodan可以用来查找以下内容：
- en: 'Servers exposed to the internet belonging to some domain can be found like
    this:'
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可以通过以下方式找到属于某个域的互联网上公开的服务器：
- en: '[PRE5]'
  id: totrans-87
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'Specific types of devices, such as CCTV cameras or **Industrial Control Systems**
    (**ICS**), can be found by specifying the `Server` parameter:'
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可以通过指定`Server`参数来找到特定类型的设备，例如CCTV摄像头或工业控制系统（ICS）：
- en: '[PRE6]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Specific open ports or services can be found, for example, web servers using
    common ports:'
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可以找到特定开放端口或服务，例如使用常见端口的Web服务器：
- en: '[PRE7]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Hosts in a specific network range can be found like this:'
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 可以通过以下方式找到特定网络范围内的主机：
- en: '[PRE8]'
  id: totrans-93
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'A useful reference on Shodan search options and operators can be found at:
    [https://pen-testing.sans.org/blog/2015/12/08/effective-shodan-searches](https://pen-testing.sans.org/blog/2015/12/08/effective-shodan-searches).'
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
- en: theHarvester
  id: totrans-95
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**theHarvester** is a command-line tool included in Kali Linux that acts as
    a wrapper for a variety of search engines and is used to find email accounts,
    subdomain names, virtual hosts, open ports / banners, and employee names related
    to a domain from different public sources (such as search engines and PGP key
    servers). In recent versions, the authors added the capability of doing DNS brute
    force, reverse IP resolution, and **Top-Level Domain** (**TLD**) expansion.'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
- en: 'In the following example, `theharvester` is used to gather information about
    `zonetransfer.me`:'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00045.jpeg)'
  id: totrans-98
  prefs: []
  type: TYPE_IMG
- en: Maltego
  id: totrans-99
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**Maltego** is proprietary software widely used for OSINT. Kali Linux includes
    the Community Edition of Maltego, which can be used for free with some limitations
    after completing the online registration. Maltego performs *transforms* over pieces
    of data (for example, email addresses, and domain names) to obtain more information,
    and it displays all of the results as a graph showing relationships among different
    objects. A **transform** is a search of public information about a particular
    object, for example, searches for IP addresses related to a domain name or social
    media accounts related to an email address or person''s name. The following screenshot
    shows the main interface of Maltego:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00046.jpeg)'
  id: totrans-101
  prefs: []
  type: TYPE_IMG
- en: Maltego interface
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
- en: Recon-ng – a framework for information gathering
  id: totrans-103
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: OSINT collection is a time-consuming, manual process. Information related to
    the target organization may be spread across several public resources, and accumulating
    and extracting the information that is relevant to the target is a difficult and
    time-consuming task. IT budgets of most organizations do not permit spending much
    time on such activities.
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
- en: '**Recon-ng** is the tool that penetration testers always needed. It''s an information-gathering
    tool on steroids. Recon-ng is a very interactive tool, similar to the Metasploit
    framework. This framework uses many different sources to gather data, for example,
    on Google, Twitter, and Shodan. Some modules require an API key before querying
    the website. The key can be generated by completing the registration on the search
    engine''s website. A few of these modules use paid API keys.'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
- en: To start Recon-ng in Kali Linux, navigate to the Applications menu and click
    on the Information Gathering submenu, or just run the `recon-ng` command in Terminal.
    You will see Recon-ng listed on the pane in the right-hand side. Similar to Metasploit,
    when the framework is up and running, you can type in `show modules` to check
    out the different modules that come along with it. Some modules are passive, while
    others actively probe the target to extract the needed information.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
- en: 'Although Recon-ng has a few exploitation modules, the main task of the tool
    is to assist in reconnaissance activity, and there are a large number of modules
    within it to do this:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00047.jpeg)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
- en: Recon-ng can query multiple search engines, some of them queried via web requests;
    that is, the tool replicates the request made when a regular user enters text
    in the search box and clicks on the Search button. Another option is to use the
    engine's API. This often has better results than with automated tools. When using
    an API, the search engine may require an API key to identify who is sending those
    requests and apply a quota. The tool works faster than a human, and by assigning
    an API the usage can be tracked and can prevent someone from abusing the service.
    So, make sure that you don't overwhelm the search engine, or your query may be
    rejected.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
- en: All major search engines have an option for a registered user to hold an API
    key. For example, you can generate an API key for Bing at [https://azure.microsoft.com/en-us/try/cognitive-services/?api=bing-web-search-api.](https://datamarket.azure.com/dataset/bing/search)
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 所有主要搜索引擎都有一个注册用户持有API密钥的选项。例如，您可以在[https://azure.microsoft.com/en-us/try/cognitive-services/?api=bing-web-search-api.](https://datamarket.azure.com/dataset/bing/search)上为Bing生成API密钥。
- en: 'This free subscription provides you with 5,000 queries a month. Once the key
    is generated, it needs to be added to the keys table in the Recon-ng tool using
    the following command:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 此免费订阅每月提供5000个查询。生成密钥后，需要使用以下命令将其添加到Recon-ng工具的密钥表中：
- en: '[PRE9]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'To display all the API keys that you have stored in Recon-ng, enter the following
    command:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 要显示在Recon-ng中存储的所有API密钥，请输入以下命令：
- en: '[PRE10]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Domain enumeration using Recon-ng
  id: totrans-115
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Recon-ng进行域枚举
- en: Gathering information about the subdomains of the target website will help you
    identify different content and features of the website. Each product or service
    provided by the target organization may have a subdomain dedicated to it. This
    aids in organizing diverse content in a coherent manner. By identifying different
    subdomains, you can create a site map and a flowchart interconnecting the various
    pieces and understand the flow of the website better.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 收集有关目标网站的子域的信息将帮助您识别网站的不同内容和功能。目标组织提供的每个产品或服务可能都有一个专用的子域。这有助于以一致的方式组织各种内容。通过识别不同的子域，您可以创建一个站点地图和流程图，将各个部分相互连接起来，更好地了解网站的流程。
- en: Sub-level and top-level domain enumeration
  id: totrans-117
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 子级和顶级域名枚举
- en: 'Using the Bing Web hostname enumerator module, we will try to find additional
    subdomains on the [https://www.facebook.com/](https://www.facebook.com/) website:'
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 使用Bing Web主机名枚举模块，我们将尝试在[https://www.facebook.com/](https://www.facebook.com/)网站上找到其他子域：
- en: First you need to load the module using the `load recon/domains-hosts/bing_domain_web`
    command. Next, enter the `show info` command that will display the information
    describing the module.
  id: totrans-119
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 首先需要使用`load recon/domains-hosts/bing_domain_web`命令加载模块。接下来，输入`show info`命令，显示描述该模块的信息。
- en: 'The next step is to set the target domain in the `SOURCE` option. We will set
    it to `facebook.com`, as shown in the screenshot:'
  id: totrans-120
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 下一步是在`SOURCE`选项中设置目标域。我们将其设置为`facebook.com`，如截图所示：
- en: '![](img/00048.jpeg)'
  id: totrans-121
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00048.jpeg)'
- en: 'When you are ready, use the `run` command to kick-off the module. The tool
    first queries a few domains, then it uses the (`-`) directive to remove already
    queried domains. Then it searches for additional domains once again. The biggest
    advantage here is speed. In addition to speed, the output is also stored in a
    database in plaintext. This can be used as an input to other tools such as Nmap,
    Metasploit, and Nessus. The output is shown in the following screenshot:'
  id: totrans-122
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: 准备好后，使用`run`命令启动模块。该工具首先查询几个域，然后使用（-）指令删除已查询的域。然后再次搜索其他域。这里的最大优势是速度。除了速度外，输出还以明文形式存储在数据库中。这可以用作其他工具（如Nmap、Metasploit和Nessus）的输入。输出如下截图所示：
- en: '![](img/00049.jpeg)'
  id: totrans-123
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00049.jpeg)'
- en: The DNS public suffix brute force module can be used to identify **Top-level
    Domains** (**TLDs**) and **Second-level Domains** (**SLDs**). Many product-based
    and service-based businesses have separate websites for each geographical region;
    you can use this brute force module to identify them. It uses the wordlist file
    from `/usr/share/recon-ng/data/suffixes.txt` to enumerate additional domains.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: DNS公共后缀暴力破解模块可用于识别顶级域名（TLD）和二级域名（SLD）。许多基于产品和服务的企业为每个地理区域都有单独的网站；您可以使用此暴力破解模块来识别它们。它使用来自`/usr/share/recon-ng/data/suffixes.txt`的字典文件来枚举附加域名。
- en: Reporting modules
  id: totrans-125
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 报告模块
- en: Each reconnaissance module that you run will store the output in separate tables.
    You can export these tables in several formats, such as CSV, HTML, and XML files.
    To view the different tables that the Recon-ng tool uses, you need to enter `show`
    and press *Tab* twice to list the available options for the autocomplete feature.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
  zh: 您运行的每个侦察模块都会将输出存储在单独的表中。您可以将这些表导出为多种格式，例如CSV、HTML和XML文件。要查看Recon-ng工具使用的不同表格，需要输入`show`并按两次*Tab*键列出自动完成功能的可用选项。
- en: 'To export a table into a CSV file, load the CSV reporting module by entering
    `use reporting/csv`. (The `load` command can be used instead of `use` with no
    effect.) After loading the module, set the filename and the table to be exported
    and enter `run`:'
  id: totrans-127
  prefs: []
  type: TYPE_NORMAL
  zh: 要将表导出为CSV文件，请通过输入`use reporting/csv`命令加载CSV报告模块。（`load`命令可以替代`use`命令，效果相同。）加载模块后，设置要导出的文件名和表，并输入`run`：
- en: '![](img/00050.jpeg)'
  id: totrans-128
  prefs: []
  type: TYPE_IMG
  zh: '![](img/00050.jpeg)'
- en: 'Here are some additional reconnaissance modules in Recon-ng that can be of
    great help to a penetration tester:'
  id: totrans-129
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是Recon-ng中的一些其他侦察模块，对渗透测试人员非常有帮助：
- en: '**Netcraft hostname enumerator**: Recon-ng will harvest the Netcraft website
    and accumulate all of the hosts related to the target and store them in the hosts
    table.'
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Netcraft主机名枚举器：Recon-ng将收集Netcraft网站并累积与目标相关的所有主机，并将它们存储在主机表中。
- en: '**SSL SAN lookup**: Many SSL-enabled websites have a single certificate that
    works across multiple domains using the **Subject Alternative Names** (**SAN**)
    feature. This module uses the [http://ssltools.com/](http://ssltools.com/) website
    to retrieve the domains listed in the SAN attribute of the certificate.'
  id: totrans-131
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: SSL SAN查找：许多启用SSL的网站使用**Subject Alternative Names**（SAN）功能在多个域上使用单个证书。该模块使用[http://ssltools.com/](http://ssltools.com/)网站来检索证书的SAN属性中列出的域。
- en: '**LinkedIn authenticated contact enumerator**: This will retrieve the contacts
    from a LinkedIn profile and store them in the contacts table.'
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: LinkedIn身份验证联系人枚举器：将从LinkedIn个人资料中检索联系人并将其存储在联系人表中。
- en: '**IPInfoDB GeoIP**: This will display the geolocation of a host using the IPInfoDB
    database (requires an API).'
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: IPInfoDB GeoIP：使用IPInfoDB数据库显示主机的地理位置（需要API）。
- en: '**Yahoo! hostname enumerator**: This uses the Yahoo! search engine to locate
    hosts in the domains. Having modules for multiple search engines at your disposal
    can help you locate hosts and subdomains that may have not been indexed by other
    search engines.'
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Yahoo!主机名枚举器**：这使用Yahoo!搜索引擎来定位域中的主机。拥有多个搜索引擎的模块可以帮助您定位其他搜索引擎未索引的主机和子域。'
- en: '**Geocoder and reverse geocoder**: These modules obtain the address using the
    coordinates provided using the Google Map API, and they also retrieve the coordinates
    if an address is given. The information then gets stored in the locations table.'
  id: totrans-135
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**地理编码器和反向地理编码器**：这些模块使用提供的坐标使用Google Map API获取地址，并且如果提供了地址，则还会检索坐标。然后将信息存储在位置表中。'
- en: '**Pushpin modules**: Using the Recon-ng pushpin modules, you can pull data
    from popular social-networking websites, correlate it with geolocation coordinates,
    and create maps. Two widely used modules are as follows:'
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**推销模块**：使用Recon-ng推销模块，您可以从流行的社交网络网站中提取数据，将其与地理位置坐标相关联，并创建地图。两个广泛使用的模块如下：'
- en: '**Twitter geolocation search**: This searches Twitter for media (images and
    tweets) uploaded from a specific radius of the given coordinates'
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Twitter地理位置搜索**：这在Twitter上搜索从给定坐标的特定半径内上传的媒体（图片和推文）'
- en: '**Flickr geolocation search**: This tries to locate photos uploaded from the
    area around the given coordinates'
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**Flickr地理位置搜索**：这试图找到从给定坐标附近上传的照片'
- en: These pushpin modules can be used to map people to physical locations and to
    determine who was at the given coordinates at a specific time. The information
    accumulated and converted to a HTML file can be mapped to a satellite image at
    the exact coordinates. Using Recon-ng, you can create a huge database of hosts,
    IP addresses, physical locations, and people, all just using publicly available
    resources.
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
  zh: 这些推销模块可用于将人员映射到物理位置，并确定在特定时间给定坐标处的人员。通过Recon-ng，您可以仅使用公开可用的资源创建一个庞大的主机、IP地址、物理位置和人员数据库。
- en: Reconnaissance should always be done with the goal of extracting information
    from various public resources and to identify sensitive data that can be used
    by an attacker to target the organization directly or indirectly.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: '侦察应始终以从各种公共资源中提取信息并识别攻击者可以直接或间接利用的敏感数据为目标进行。 '
- en: Scanning – probing the target
  id: totrans-141
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 扫描-探测目标
- en: The penetration test needs to be conducted in a limited timeframe, and the reconnaissance
    phase is the one that gets the least amount of time. In a real-world penetration
    test, you share the information gathered during the reconnaissance phase with
    the client and try to reach a consensus on the targets that should be included
    in the scanning phase.
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 渗透测试需要在有限的时间内进行，侦察阶段是最少时间的阶段。在真实的渗透测试中，您将在侦察阶段收集的信息与客户共享，并尝试就应包含在扫描阶段中的目标达成共识。
- en: At this stage, the client may also provide you with additional targets and domains
    that were not identified during the reconnaissance phase, but they will be included
    in the actual testing and exploitation phase. This is done to gain maximum benefit
    from the test by including the methods of both black hat and white hat hackers,
    where you start the test as would a malicious attacker, and as you move forward,
    additional information is provided, which yields an exact view of the target.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个阶段，客户还可以向您提供在侦察阶段未识别的其他目标和域，但它们将包含在实际的测试和利用阶段中。这样做是为了通过包括黑帽和白帽黑客的方法来获得测试的最大效益，您将测试开始时像恶意攻击者一样进行测试，并随着测试的进行，提供额外的信息，从而得到目标的准确视图。
- en: Once the target server hosting the website is determined, the next step involves
    gathering additional information such as the operating system and the services
    available on that specific server. Besides hosting a website, some organizations
    also enable FTP service, and other ports may also be opened according to their
    needs. As the first step, you need to identify the additional ports open on the
    web server besides port `80` and port `443`.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 确定托管网站的目标服务器后，下一步是收集其他信息，如操作系统和该特定服务器上可用的服务。除了托管网站外，一些组织还启用FTP服务，并根据需要打开其他端口。作为第一步，您需要确定除端口`80`和端口`443`之外的Web服务器上打开的其他端口。
- en: 'The scanning phase consists of the following stages:'
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
  zh: 扫描阶段包括以下几个阶段：
- en: Port scanning
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 端口扫描
- en: Operating system fingerprinting
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 操作系统指纹识别
- en: Web server version identification
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Web服务器版本识别
- en: Underlying infrastructure analysis
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基础设施分析
- en: Application identification
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用程序识别
- en: Port scanning using Nmap
  id: totrans-151
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 使用Nmap进行端口扫描
- en: '**Network mapper**, popularly known as Nmap, is the most widely known port
    scanner. It finds TCP and UDP open ports with a great success, and it is an important
    piece of software in the penetration tester''s toolkit. Kali Linux comes with
    Nmap preinstalled. Nmap is regularly updated, and it is maintained by an active
    group of developers contributing to this open source tool.'
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
  zh: '**网络映射器**，通常称为Nmap，是最广为人知的端口扫描器。它以极高的成功率找到TCP和UDP开放端口，并且是渗透测试人员工具包中的重要组成部分。Kali
    Linux预装了Nmap。Nmap定期更新，并由一群积极贡献于这个开源工具的开发人员维护。'
- en: By default, Nmap does not send probes to all ports. Nmap checks only the top
    1,000 frequently used ports that are specified in the `nmap-services` file. Each
    port entry has a corresponding number indicating the likeliness of that port being
    open. This increases the speed of the scan drastically, as the less important
    ports are omitted from the scan. Depending on the response by the target, Nmap
    determines if the port is open, closed, or filtered.
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，Nmap不会向所有端口发送探测。 Nmap仅检查在`nmap-services`文件中指定的前1000个常用端口。每个端口条目都有一个相应的数字，表示该端口开放的可能性。这大大提高了扫描的速度，因为扫描中省略了不太重要的端口。根据目标的响应，Nmap确定端口是开放的、关闭的还是被过滤的。
- en: Different options for port scan
  id: totrans-154
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 端口扫描的不同选项
- en: The straightforward way of running an Nmap port scan is called the **TCP connect
    scan**. This option is used to scan for open TCP ports, and it is invoked using
    the `-sT` option. The connect scan performs a full three-way TCP handshake (SYN-SYN
    / ACK-ACK). It provides a more accurate state of the port, but it is more likely
    to be logged at the target machine and slower than the alternative SYN scan. A
    SYN scan, using the `-sS` option, does not complete the handshake with the target,
    and it is therefore not logged on that target machine. However, the packets generated
    by the SYN scan can alert firewalls and IPS devices, and they are sometimes blocked
    by default by such appliances.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
- en: Nmap, when invoked with the `-F` flag, will scan for the top 100 ports instead
    of the top 1,000 ports. Additionally, it also provides you with the option to
    customize your scan with the `--top-ports [N]` flag to scan for `N` most popular
    ports from the `nmap-services` file. Many organizations might have applications
    that will be listening on a port that is not part of the `nmap-services` file.
    For such instances, you can use the `-p` flag to define a port, port list, or
    a port range for Nmap to scan.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
- en: There are 65535 TCP and UDP ports and applications that could use any of the
    ports. If you want, you can test all of the ports using the `-p 1-65535` or `-p-`
    option.
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot shows the output of the preceding commands:'
  id: totrans-158
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00051.jpeg)'
  id: totrans-159
  prefs: []
  type: TYPE_IMG
- en: 'In a penetration test, it is very important that you save the results and keep
    the logs from all of the tools you run. You should save notes and records to organize
    the project better and save the logs as a preventive measure in case something
    goes wrong with the targets. You can then go back to your logs and retrieve information
    that may be crucial to reestablishing the service or identifying the source of
    the failure. Nmap has various `-o` options to save its results to different file
    formats: `-oX` for the XML format, `-oN` for the Nmap output format, `-oG` for
    greppable text, and `-oA` for all.'
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
- en: Evading firewalls and IPS using Nmap
  id: totrans-161
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In addition to the different scans for TCP, Nmap also provides various options
    that help in circumventing firewalls when scanning for targets from outside the
    organization''s network. The following are the descriptions of these options:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
- en: '**ACK scan**: This option is used to circumvent the rules on some routers that
    only allow SYN packets from the internal network, thus blocking the default connect
    scan. These routers will only allow internal clients to make connections through
    the router and will block all packets originating from the external network with
    a SYN bit set. When the ACK scan option is invoked with the `-sA` flag, Nmap generates
    the packet with only the ACK bit set fooling the router into believing that the
    packet was a response to a connection made by an internal client and allows the
    packet to go through it. The ACK scan option cannot reliably tell whether a port
    at the end system is open or closed, as different systems respond to an unsolicited
    ACK in different ways. However, it can be used to identify online systems behind
    the router.'
  id: totrans-163
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Hardcoded source port in firewall rules**: Many firewall administrators configure
    firewalls with rules that allow incoming traffic from the external network, which
    originate from a specific source port such as `53`, `25`, and `80`. By default,
    Nmap randomly selects a source port, but it can be configured to use a specific
    source port in order to circumvent this rule using the `--source-port` option.'
  id: totrans-164
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Custom packet size**: Nmap and other port scanners send packets in a specific
    size, and firewalls now have rules defined to drop such packets. In order to circumvent
    this detection, Nmap can be configured to send packets with a different size using
    the `--data-length` option.'
  id: totrans-165
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Custom MTU**: Nmap can also be configured to send packets with smaller MTU.
    The scan will be done with a `--mtu` option along with a value of the MTU. This
    can be used to circumvent some older firewalls and intrusion-detection devices.
    New firewalls reassemble the traffic before sending it across to the target machine,
    so it is difficult to evade them. The MTU needs to be a multiple of 8\. The default
    MTU for Ethernet LAN is 1,500 bytes.'
  id: totrans-166
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Fragmented packets**: A common yet effective way of bypassing IDS and IPS
    systems is to fragment the packets so that when analyzed by those defensive mechanisms,
    they don''t match malicious patterns. Nmap has the ability to do this using the
    `-f` option when performing a full TCP scan (`-sT`).'
  id: totrans-167
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**MAC address spoofing**: If there are rules configured in the target environment
    only to allow network packets from certain MAC addresses, you can configure Nmap
    to set a specific MAC address to conduct the port scan. The port scanning packets
    can also be configured with a specific MAC address with the `--spoof-mac` option.'
  id: totrans-168
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Identifying the operating system
  id: totrans-169
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'After identifying the open ports on the web server, you need to determine the
    underlying operating system. Nmap provides several options to do so. The OS scan
    is performed using the `-O` option; you can add `-v` for a verbose output to find
    out the underlying tests done to determine the operating system:'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00052.jpeg)'
  id: totrans-171
  prefs: []
  type: TYPE_IMG
- en: A skilled hacker does not rely on the results of a single tool. Therefore, Kali
    Linux comes with several fingerprinting tools; in addition to running your version
    scan with Nmap, you can get a second opinion using a tool such as Amap.
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
- en: Profiling the server
  id: totrans-173
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Once the underlying operating system and open ports have been determined, you
    need to identify the exact applications running on the open ports. When scanning
    web servers, you need to analyze the flavor and version of web service that is
    running on top of the operating system. Web servers basically process the HTTP
    requests from the application and distribute them to the web; Apache, IIS, and
    nginx are the most widely used web servers. Along with the version, you need to
    identify any additional software, features, and configurations enabled on the
    web server before moving ahead with the exploitation phase.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
- en: Web application development relies heavily on frameworks such as PHP and .NET,
    and each web application will require a different technique depending on the framework
    used to design it.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
- en: In addition to version scanning of the web server, you also need to identify
    the additional components supporting the web application, such as the database
    application, encryption algorithms, and load balancers.
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
- en: Multiple websites are commonly deployed on the same physical server. You need
    to attack only the website that is within the scope of the penetration testing
    project, and a proper understanding of the virtual host is required to do this.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
- en: Identifying virtual hosts
  id: totrans-178
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The websites of many organizations are hosted by service providers using shared
    resources. The sharing of IP addresses is one of the most useful and cost-effective
    techniques used by them. You will often see a number of domain names returned
    when you do a reverse DNS query for a specific IP address. These websites use
    name-based virtual hosting, and they are uniquely identified and differentiated
    from other websites hosted on the same IP address by the host header value.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
- en: This works similar to a multiplexing system. When the server receives the request,
    it identifies and routes the request to the specific host by consulting the `Host`
    field in the request header. This was discussed in [Chapter 1](part0021.html#K0RQ0-d48f8b63a8cc440fbc92835fec01cc38),
    *Introduction to Penetration Testing and Web Applications*.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
- en: When interacting and crafting an attack for a website, it is important to identify
    the type of hosting. If the IP address is hosting multiple websites, then you
    have to include the correct host header value in your attacks or you won't get
    the desired results. This could also affect the other websites hosted on that
    IP address. Directly attacking with the IP address may have undesirable results,
    and may hit out-of-scope elements. This may even have legal implications if such
    elements are not owned by the client organization.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
- en: Locating virtual hosts using search engines
  id: totrans-182
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: You can determine whether multiple websites are hosted on an IP address by analyzing
    the DNS records. If multiple names point to the same IP address, then the host
    header value is used to uniquely identify the website. DNS tools such as `dig`
    and `nslookup` can be used to identify domains returning similar IP addresses.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
- en: 'You can use the [http://ipneighbour.com/](http://ipneighbour.com/) website to
    identify whether other websites are hosted on a given web server. The following
    example shows several websites related to Wikipedia hosted on the same IP address:'
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00053.jpeg)'
  id: totrans-185
  prefs: []
  type: TYPE_IMG
- en: Identifying load balancers
  id: totrans-186
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: High-demand websites and applications use some form of load balancing to distribute
    load across servers and to maintain high availability. The interactive nature
    of websites makes it critical for end users to access the same server for the
    entire duration of the session for the best user experience. For example, on an
    e-commerce website, once a user adds items to the cart, it is expected that the
    user will connect to the same server again at the checkout page to complete the
    transaction. With the introduction of an intermediary, such as a load balancer,
    it becomes very important that the subsequent requests from the user are sent
    to the same server by the load balancer.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
- en: There are several techniques that can be used to load balance user connections
    between servers. DNS is the easiest to configure, but it is unreliable and does
    not provides a true load balancing experience. Hardware load balancers are the
    ones used today to route traffic to websites maintaining load across multiple
    web servers.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
- en: During a penetration test, it is necessary to identify the load balancing technique
    used in order to get a holistic view of the network infrastructure. Once identified,
    you now have to test each server behind the load balancer for vulnerabilities.
    Collaborating with the client team is also required, as different vendors of hardware
    load balancers use different techniques to maintain session affinity.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
- en: Cookie-based load balancer
  id: totrans-190
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A popular method used by hardware load balancers is to insert a cookie in the
    browser of the end client that ties the user to a particular server. This cookie
    is set regardless of the IP address, as many users will be behind a proxy or a
    NAT configuration, and most of them will be using the same source IP address.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
- en: Each load balancer will have its own cookie format and names. This information
    can be used to determine if a load balancer is being used and who its provider
    is. The cookie set by the load balancer can also reveal sensitive information
    related to the target that may be of use to the penetration tester.
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
- en: 'Burp Proxy can be configured to intercept the connection, and you can look
    out for the cookie by analyzing the header. As shown in the following screenshot,
    the target is using an F5 load balancer. The long numerical value is actually
    the encoded value containing the pool name, web server IP address, and the port.
    So, here the load balancer cookie reveals critical server details that it should
    not be doing. The load balancer can be configured to set a customized cookie that
    does not reveal such details:'
  id: totrans-193
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00054.jpeg)'
  id: totrans-194
  prefs: []
  type: TYPE_IMG
- en: 'The default cookie for the F5 load balancer has the following format:'
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  id: totrans-196
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: Other ways of identifying load balancers
  id: totrans-197
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'A few other ways to identify a device such as a load balancer are listed here:'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
- en: '**Analyzing SSL differences between servers**: There can be minor changes in
    the SSL configuration across different web servers. The timestamp on the certificate
    issued to the web servers in the pool may vary. The difference in the SSL configuration
    can be used to determine whether multiple servers are configured behind a load
    balancer.'
  id: totrans-199
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Redirecting to a different URL**: Another method of load balancing requests
    across servers is by redirecting the client to a different URL to distribute load.
    A user may browse to a website, `www.example.com`, but gets redirected to `www2.example.com`
    instead. A request from another user gets redirected to `www1.example.com`, and
    a web page from a different server is then delivered. This is one of the easiest
    ways to identify a load balancer, but it is not often implemented as it has management
    overhead and security implications.'
  id: totrans-200
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**DNS records for load balancers**: Host records in the DNS zone can be used
    to conclude if the device is a load balancer.'
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Load balancer detector**: This is a tool included in Kali Linux. It determines
    whether a website is using a load balancer. The command to execute the tool from
    the shell is `lbd <website name>`. The tool comes with a disclaimer that it''s
    a proof of a concept tool and prone to false positives.'
  id: totrans-202
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Web Application Firewall (WAF)**: In addition to a load balancer, the application
    might also use a WAF to thwart attacks. The WAFW00F web application firewall detection
    tool in Kali Linux is able to detect whether any WAF device exists in the path.
    The tool can be accessed by navigating to Information Gathering | IDS/IPS Identification.'
  id: totrans-203
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Application version fingerprinting
  id: totrans-204
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Services running on well-known ports such as port `25` and port `80` can be
    identified easily, as they are used by widely known applications such as the mail
    server and the web server. The **Internet Assigned Numbers Authority** (**IANA**)
    is responsible for maintaining the official assignments of port numbers, and the
    mapping can be identified from the port mapping file in every operating system.
    However, many organizations run applications on ports that are more suitable to
    their infrastructure. You will often see an intranet website running on port `8080`
    instead of port `80`, or port `8443` instead of port `443`.
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
- en: The port mapping file is only a placeholder, and applications can run on any
    open port, as designed by the developer, defying the mapping set by IANA. This
    is exactly why you need to do a version scan to determine whether the web server
    is indeed running on port `80` and further analyze the version of that service.
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
- en: The Nmap version scan
  id: totrans-207
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Nmap has couple of options that can be used to perform version scanning; the
    version scan can be combined along with the operating system scan, or it could
    be run separately. Nmap probes the target by sending a wide range of packets,
    and then it analyzes the response to determine the exact service and its version.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
- en: To start only the version scans, use the `-sV` option. The operating system
    scan and the version scan can be combined together using the `-A` (aggressive)
    option, which also includes route tracing and execution of some scripts. If no
    ports are defined along with the scanning options, Nmap will first perform a port
    scan on the target using the default list of the top 1,000 ports and identify
    the open ports from them.
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
- en: Next, it will send a probe to the open port and analyze the response to determine
    the application running on that specific port. The response received is matched
    against a huge database of signatures found in the `nmap-service-probes` file.
    It's similar to how an IPS signature works, where the network packet is matched
    against a database containing the signatures of the malicious packets. The version
    scanning option is only as good as the quality of signatures in that file.
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot shows the output of the preceding commands:'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00055.jpeg)'
  id: totrans-212
  prefs: []
  type: TYPE_IMG
- en: You can report incorrect results and new signatures for unknown ports to the
    Nmap project. This helps to improve the quality of the signatures in the future
    releases.
  id: totrans-213
  prefs: []
  type: TYPE_NORMAL
- en: The Amap version scan
  id: totrans-214
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Kali Linux also comes with a tool called Amap, which was created by the **The
    Hacker's Choice** (**THC**) group and works like Nmap. It probes the open ports
    by sending a number of packets, and then it analyzes the response to determine
    the service listening on that port.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
- en: The probe to be sent to the target port is defined in a file called `appdefs.trig`,
    and the response that is received is analyzed against the signatures in the `appdefs.resp`
    file.
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
- en: During a penetration test, it is important to probe the port using multiple
    tools to rule out any false positives or negatives. Relying on the signatures
    of one tool could prove to be fatal during a test, as your future exploits would
    depend on the service and its version identified during this phase.
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
- en: 'You can invoke Amap using the `-bqv` option, which will only report the open
    ports and print the response received in ASCII and some detailed information related
    to it:'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00056.jpeg)'
  id: totrans-219
  prefs: []
  type: TYPE_IMG
- en: Fingerprinting the web application framework
  id: totrans-220
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Having the knowledge about the framework used to develop a website gives you
    an advantage in identifying the vulnerabilities that may exist in the unpatched
    versions.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
- en: For example, if the website is developed on a WordPress platform, traces of
    it can be found in the web pages of that website. Most of the web application
    frameworks have markers that can be used by an attacker to determine the framework
    used.
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
- en: There are several places that can reveal details about the framework.
  id: totrans-223
  prefs: []
  type: TYPE_NORMAL
- en: The HTTP header
  id: totrans-224
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Along with defining the operating parameters of an HTTP transaction, the header
    may also include additional information that can be of use to an attacker.
  id: totrans-225
  prefs: []
  type: TYPE_NORMAL
- en: 'In the following example, using the development tools in Firefox (*F12* key),
    you can determine from the `Server` field that the Apache web server is being
    used. Also, using `X-AspNet-Version` you can tell that ASP.NET version 2 is the
    development framework. This approach may not always work, as the header field
    can be disabled by proper configuration at the server end:'
  id: totrans-226
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00057.jpeg)'
  id: totrans-227
  prefs: []
  type: TYPE_IMG
- en: Application frameworks also create new cookie values that can throw some light
    on the underlying framework used, so keep an eye on the cookies too.
  id: totrans-228
  prefs: []
  type: TYPE_NORMAL
- en: Comments in the HTML page source code can also indicate the framework used to
    develop the web application. Information in the page source can also help you
    identify additional web technologies used.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
- en: The WhatWeb scanner
  id: totrans-230
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The WhatWeb tool is used to identify different web technologies used by the
    website. It is included in Kali Linux, and it can be accessed by going to Applications
    | 03 - Web Application Analysis | Web Vulnerability scanners. It identifies the
    different content management systems, statistic/analytics packages, and JavaScript
    libraries used to design the web application. The tool claims to have over 900
    plugins. It can be run at different aggression levels that balance speed and reliability.
    The tool may get enough information on a single web page to identify the website,
    or it may recursively query the website to identify the technologies used.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
- en: 'In the next example, we will use the tool against the OWASP BWA virtual machine
    with the `-v` verbose option enabled. This prints out some useful information
    related to the technologies identified:'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00058.jpeg)'
  id: totrans-233
  prefs: []
  type: TYPE_IMG
- en: Scanning web servers for vulnerabilities and misconfigurations
  id: totrans-234
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: So far, we have dealt with the infrastructure part of the target. We now need
    to analyze the underlying software and try to understand the different technologies
    working beneath the hood. Web applications designed using the default configurations
    are vulnerable to attack, as they provide several openings for a malicious attacker
    to exploit the application.
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
- en: Kali Linux provides several tools to analyze the web application for configuration
    issues. The scanning tools identify vulnerabilities by navigating through the
    entire website and seek out interesting files, folders, and configuration settings.
    Server-side scripting languages, such as PHP and CGI, which have not been implemented
    correctly and found to be running on older versions can be exploited using automated
    tools.
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
- en: Identifying HTTP methods using Nmap
  id: totrans-237
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: One of the first direct requests to a web server during a web penetration test
    should be to identify what methods are supported by the web server. You can use
    Netcat to open a connection to the web server and query the web server with the
    `OPTIONS` method. You can also use Nmap to determine the supported methods.
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
- en: 'In the ever-increasing repository of Nmap scripts, you can find a script named
    `http-methods.nse`. When you run the script using the `--script` option along
    with the target, it will list the allowed HTTP methods on the target, and it will
    also point out the dangerous methods. In the following screenshot, you can see
    this in action where it detects several enabled methods and also points out `TRACE`
    as a risky method:'
  id: totrans-239
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00059.jpeg)'
  id: totrans-240
  prefs: []
  type: TYPE_IMG
- en: Testing web servers using auxiliary modules in Metasploit
  id: totrans-241
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The following modules are useful for a penetration tester testing a web server
    for vulnerabilities:'
  id: totrans-242
  prefs: []
  type: TYPE_NORMAL
- en: '`dir_listing`: This module will connect to the target web server and determine
    whether directory browsing is enabled on it.'
  id: totrans-243
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`dir_scanner`: Using this module, you can scan the target for any interesting
    web directories. You can provide the module with a custom created dictionary or
    use the default one.'
  id: totrans-244
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`enum_wayback`: This is an interesting module that queries the Internet Archive
    website and looks out for web pages in the target domain. Old web pages that might
    have been unlinked may still be accessible and can be found using the Internet
    Archive website. You can also identify the changes that the website has undergone
    throughout the years.'
  id: totrans-245
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`files_dir`: This module can be used to scan the server for data leakage vulnerabilities
    by locating backups of configuration files and source code files.'
  id: totrans-246
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`http_login`: If the web page has a login page that works over HTTP, you can
    try to brute force it using the Metasploit dictionary.'
  id: totrans-247
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`robots_txt`: Robot files can contain some unexplored URLs, and you can query
    them using this module to find the URLs that are not indexed by a search engine.'
  id: totrans-248
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`webdav_scanner`: This module can be used to find out if WebDAV is enabled
    on the server, which basically turns the web server into a file server.'
  id: totrans-249
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Identifying HTTPS configuration and issues
  id: totrans-250
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Any website or web application that manages any kind of sensitive or personally
    identifiable information (names, phone numbers, addresses, health; credit; or
    tax records, credit card and bank account information, and so on) needs to implement
    a mechanism to protect the information on its way from client to server and vice
    versa.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
- en: HTTP was born as a cleartext protocol. As such, it doesn't include mechanisms
    to protect the information exchanged by the client and server from being viewed
    and/or modified by a third party that manages to intercept it. As a workaround
    to this problem, an encrypted communication channel is created between the client
    and server, and HTTP packets are sent through it. HTTPS is the implementation
    of the HTTP protocol over a secure communication channel. It was originally implemented
    over **Secure Sockets Layer** (**SSL**). SSL was deprecated in 2014 and replaced
    by **Transport Layer Security** (**TLS**), although there are still many sites
    that support SSLv3, be it for misconfiguration or for backwards compatibility.
  id: totrans-252
  prefs: []
  type: TYPE_NORMAL
- en: Supporting older encryption algorithms has a major drawback. Most older cipher
    suites are found to be easily breakable by cryptanalysts, within a reasonable
    amount of time using the computing power that is available today.
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
- en: A dedicated attacker can rent cheap computing power from a cloud service provider
    and use it to break older ciphers and gain access to the cleartext information.
    Thus, using older ciphers provides a false sense of security and should be disabled.
    The client and the server should only be allowed to negotiate a cipher that is
    considered secure and is very difficult to break in practice.
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
- en: Kali Linux includes a number of tools that allow penetration testers to identify
    such misconfigurations in SSL/TLS implementation. In this section, we will review
    the most popular ones.
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
- en: OpenSSL client
  id: totrans-256
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Included in almost every GNU/Linux distribution, **OpenSSL** is the basic SSL/TLS
    client and includes the functionality that will help you perform some basic test
    over an HTTPS server.
  id: totrans-257
  prefs: []
  type: TYPE_NORMAL
- en: 'A basic test would be to do a connection with the server. In this example,
    we will connect to a test server on port `443` (the default HTTPS port):'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  id: totrans-259
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'You can see extensive information about the connection parameters and certificates
    exchanges in the result shown in the following screenshot. Something worth your
    attention is that the connection used SSLv3, which is a security issue in itself,
    as SSL is deprecated and has known vulnerabilities that could result in the full
    decryption of the information, such as **Padding Oracle On Downgraded Legacy Encryption**
    (**POODLE**), which we will discuss in later chapters:'
  id: totrans-260
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00060.jpeg)'
  id: totrans-261
  prefs: []
  type: TYPE_IMG
- en: 'You will often see cipher suites written as ECDHE-RSA-RC4-MD5\. The format
    is broken down into the following parts:'
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
- en: '**ECDHE**: This is a key exchange algorithm'
  id: totrans-263
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**RSA**: This is an authentication algorithm'
  id: totrans-264
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**RC4**: This is an encryption algorithm'
  id: totrans-265
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**MD5**: This is a hashing algorithm'
  id: totrans-266
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'A comprehensive list of SSL and TLS cipher suites can be found at: [https://www.openssl.org/docs/apps/ciphers.html](https://www.openssl.org/docs/apps/ciphers.html).'
  id: totrans-267
  prefs: []
  type: TYPE_NORMAL
- en: 'Some other options that you can use with OpenSSL to test your targets better, are
    as follows:'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
- en: '**Disabling or using specific protocols**: Using the `-no_ssl3`, `-no_tls1`,
    `-no_tls1_1`, and `-no_tls1_2` options, you can disable the use of the corresponding
    protocols and test which ones your target accepts'
  id: totrans-269
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Testing one specific protocol**: The `-tls1`, `-tls1_1`, and `-tls1_2` options
    test only the specified protocol'
  id: totrans-270
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Nowadays, accepting SSL and TLS 1.0 is not considered secure. TLS 1.1 can be
    acceptable in certain applications, but TLS 1.2 is the recommended option.
  id: totrans-271
  prefs: []
  type: TYPE_NORMAL
- en: Scanning TLS/SSL configuration with SSLScan
  id: totrans-272
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**SSLScan** is a command-line tool that performs a wide variety of tests over
    the specified target and returns a comprehensive list of the protocols and ciphers
    accepted by an SSL/TLS server along with some other information useful in a security
    test:'
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  id: totrans-274
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: '![](img/00061.jpeg)'
  id: totrans-275
  prefs: []
  type: TYPE_IMG
- en: You can use SSLScan's color code to obtain a quick reference about the severity,
    in terms of security, of the displayed results. Red (allowing SSLv3 and using
    DES and RC4 ciphers) indicates an insecure configuration, while green or white
    is a recommended one.
  id: totrans-276
  prefs: []
  type: TYPE_NORMAL
- en: The output of the command can be exported in an XML document using the `--xml=<filename>`
    option.
  id: totrans-277
  prefs: []
  type: TYPE_NORMAL
- en: Scanning TLS/SSL configuration with SSLyze
  id: totrans-278
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**SSLyze** is a Python tool that can analyze the SSL/TLS configuration of a
    server by connecting to it similarly to SSLScan. It has the ability to scan multiple
    hosts at a time, and it can also test performance and use the client certificate
    for mutual authentication. The following command runs a regular HTTPS scan (this
    includes SSL version 2, SSL version 3, and TLS 1.0, TLS 1.1, and TLS 1.2 checks,
    basic information about the certificate, and tests for compression, renegotiation,
    and Heartbleed) over your testing machine:'
  id: totrans-279
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  id: totrans-280
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'You can see the results in the following screenshot:'
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00062.jpeg)'
  id: totrans-282
  prefs: []
  type: TYPE_IMG
- en: Testing TLS/SSL configuration using Nmap
  id: totrans-283
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Nmap includes a script known as `ssl-enum-ciphers`, which can identify the
    cipher suites supported by the server, and it also rates them based on cryptographic
    strength. It makes multiple connections using SSLv3, TLS 1.1, and TLS 1.2\. The
    script will also highlight if it identifies that the SSL implementation is vulnerable
    to any previously released vulnerabilities, such as CRIME and POODLE:'
  id: totrans-284
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00063.jpeg)'
  id: totrans-285
  prefs: []
  type: TYPE_IMG
- en: Spidering web applications
  id: totrans-286
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: When testing a large real-world application, you need a more exhaustive approach.
    As a first step, you need to identify the size of the application, as there are
    several decisions that depend on it. The number of resources that you require,
    the estimation of effort, and the cost of the assessment depends on the size of
    the application.
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
- en: A web application consists of multiple web pages linked to one another. Before
    starting the assessment of an application, you need to map it out to identify
    its size. You can manually walk through the application, clicking on each link
    and viewing the contents as a normal user would do. When manually spidering the
    application, your goal should be to identify as many web pages as possible—from
    the perspective of both the authenticated and unauthenticated user.
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
- en: Manually spidering the application is both time consuming and prone to omissions.
    Kali Linux has numerous tools that can be used to automate this task. The Burp
    Spider tool in Burp Suite is well-known for spidering web applications. It automates
    the tedious task of cataloging the various web pages in the application. It works
    by requesting a web page, parsing it for links, and then sending requests to these
    new links until all of the web pages are mapped. In this way, the entire application
    can be mapped without any web pages being ignored.
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
- en: 'CAUTION:'
  id: totrans-290
  prefs: []
  type: TYPE_NORMAL
- en: As spidering is an automated process, one needs to be aware of the process and
    the workings of the application in order to avoid the spider having to perform
    sensitive requests, such as password resets, form submissions, and information
    deletion.
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
- en: Burp Spider
  id: totrans-292
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Burp Spider maps the applications using both passive and active methods.
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
- en: When you start Burp Proxy, it runs by default in the passive spidering mode.
    In this mode, when the browser is configured to use Burp Proxy, it updates the
    site map with all of the contents requested through the proxy without sending
    any further requests. Passive spidering is considered safe, as you have direct
    control over what is crawled. This becomes important in critical applications
    that include administrative functionality, which you don't want to trigger.
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
- en: For effective mapping, the passive spidering mode should be used along with
    the active mode. Initially, allow Burp Spider to map the application passively
    as you surf through it, and when you find a web page of interest that needs further
    mapping, you can trigger the active spidering mode. In the active mode, Burp Spider
    will recursively request web pages until it maps all of the URLs.
  id: totrans-295
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot shows the output of passive spidering, as one clicks
    on the various links in the application. Make sure that you have Burp set as the
    proxy in the web browser and that interception is turned off before passively
    mapping the application:'
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00064.jpeg)'
  id: totrans-297
  prefs: []
  type: TYPE_IMG
- en: 'When you want to spider a web page actively, right-click on the link in the
    Site map section and click on Spider this branch. As soon as you do this, the
    active spider mode kicks in. In the Spider section, you will see that requests
    have been made, and the Site map section will be populated with the new items,
    as shown in the following screenshot:'
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00065.jpeg)'
  id: totrans-299
  prefs: []
  type: TYPE_IMG
- en: 'When the active spider is running, it will display the number of requests made
    and a few other details. In the Spider Scope section, you can create rules using
    a regular expression string to define the targets:'
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00066.jpeg)'
  id: totrans-301
  prefs: []
  type: TYPE_IMG
- en: Application login
  id: totrans-302
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'An application may require authentication before it allows you to view contents.
    Burp Spider can be configured to authenticate to the application using reconfigured
    credentials when spidering it. In the Options tab in the Spider section, you can
    define the credentials or select the Prompt for guidance option. When you select
    the Prompt for guidance option, it will display a prompt where you can enter the
    username and password if the spider encounters a login page, as shown here:'
  id: totrans-303
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00067.jpeg)'
  id: totrans-304
  prefs: []
  type: TYPE_IMG
- en: Directory brute forcing
  id: totrans-305
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Also known as *forced browse*, **directory brute forcing** is the process of
    requesting files and server directories to which there are no direct links in
    the application or the server's pages. This is usually done by getting the directory
    and filenames from a common names list. Kali Linux includes some tools to accomplish
    this task. We will explore two of them here.
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
- en: DIRB
  id: totrans-307
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**DIRB** can recursively scan directories and look for files with different
    extensions in a web server. It can automatically detect the *Not Found* code when
    it''s not the standard 404\. It can then export the results to a text file, use
    session cookies in case the server requires having a valid session, and conduct
    basic HTTP authentication and upstream proxy among other features. The following
    screenshot shows a basic DIRB use, using the default dictionary and saving the
    output to a text file:'
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00068.jpeg)'
  id: totrans-309
  prefs: []
  type: TYPE_IMG
- en: ZAP's forced browse
  id: totrans-310
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'DirBuster was a directory brute forcer maintained by OWASP that is now integrated
    into OWASP ZAP as the forced browse functionality. To use it, you start OWASP-ZAP
    (in Kali''s menu, go to 03 - Web Application Analysis | owasp-zap) and configure
    the browser to use it as proxy; the same way Burp does passive spidering, ZAP
    registers all of the URLs you browse and the resources they request from the server.
    Consequently, you browse to your target and the detected files and directories
    get recorded in ZAP. Next, right-click on the directory on which you want to do
    the forced browse and go to Attack | Forced Browse site / Forced Browse directory
    / Forced Browse directory (and children). The choice between site, directory,
    or directory and children depends on what you want to scan—site indicates scanning
    from the root directory of the server, directory means only the selected directory,
    and directory and children is the selected directory recursively:'
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00069.jpeg)'
  id: totrans-312
  prefs: []
  type: TYPE_IMG
- en: 'After this, select the names list file (dictionary) and click on the Start
    button. Existing directories and files will possibly show in the same tab:'
  id: totrans-313
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00070.jpeg)'
  id: totrans-314
  prefs: []
  type: TYPE_IMG
- en: Summary
  id: totrans-315
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'With this, we come to the end of the chapter. We worked through the reconnaissance
    phase and finished by scanning the web server. In the following diagram, you can
    view the tasks involved in the reconnaissance phase of a penetration test and
    some useful tools in Kali Linux that can be used for each task:'
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/00071.jpeg)'
  id: totrans-317
  prefs: []
  type: TYPE_IMG
- en: Reconnaissance is the first stage of a penetration test. When testing a target
    that is accessible from the internet, search engines and social networking websites
    can reveal useful information. Search engines store a wealth of information that
    is helpful when performing a black box penetration. We used these free resources
    to identify information that a malicious user might use against the target. Kali
    Linux has several tools that help you achieve your objectives, and we used a few
    of them in this chapter.
  id: totrans-318
  prefs: []
  type: TYPE_NORMAL
- en: Finally, we moved on to the scanning phase, which required the hacker to interact
    actively with the web application in order to identify vulnerabilities and misconfigurations.
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will look at server-side and client-side vulnerabilities
    that affect web applications.
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
