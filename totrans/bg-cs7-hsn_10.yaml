- en: C# with LINQ and Custom Data Types
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we will talk about using LINQ with custom types.
  prefs: []
  type: TYPE_NORMAL
- en: Adding a Show People button to the HTML
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Bring up a project. Go to `Default.aspx`, and below the line that begins with
    `with <form id=...`, put in a button. To do this, go to the Toolbox, grab a `Button`
    control, and drag it in there. Change the text on the button to say Show People:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Setting up a database
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We will have a database, we will query it, and we will show people who have,
    for example, a certain letter in their names, make a certain amount of money,
    and sort it in a certain way.
  prefs: []
  type: TYPE_NORMAL
- en: 'To accomplish this, go to the Design view, and double-click on the Show People
    button. This takes us into `Default.aspx.cs`. Delete the `Page_Load` block. The
    relevant portion of the starting code for this project should look like *Figure
    10.5.1*:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/2d58bd36-b314-4537-8214-4ccc5824453c.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 10.5.1: The starting code section for this project'
  prefs: []
  type: TYPE_NORMAL
- en: 'In the next stage, first go to the top of the file, and enter the following
    after `using System`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'Next, we''ll make a class. We''ll call it `Person`. So, above the line beginning
    with `public partial class...`, insert the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: Making a custom type using LINQ
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Now, between the set of curly braces below the preceding line, you will declare
    two auto properties, as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'Then, to make a constructor, enter the following below these lines:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'Next, you will set the values of the properties inside the constructor. So,
    enter the following between a set of curly braces below these lines:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: This is our simple custom type, `Person`, with two automatic properties in a
    parameterized constructor.
  prefs: []
  type: TYPE_NORMAL
- en: Setting up an array of people
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In the next stage, you''ll make an array of people; enter the following between
    a set of curly braces below the line beginning with `protected void Button1_Click....`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: Querying the array
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Now, to query this, enter the following below this line:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'As you type, notice that `IEnumerable` doesn''t show up, so you''ve got to
    go to the top of the file again and enter the following after `using System.Linq`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: Now let's make use of this down below; so, underneath the line beginning with
    `Person[] people...`, enter the line `IEnumerable<Person>...` stated earlier.
  prefs: []
  type: TYPE_NORMAL
- en: Here, `Person` is a type of object that can be enumerated from the list of people.
    `peopleWithN` indicates that we'll be searching for people who have an `n` letter
    in their name. In fact, the code searches for people whose name ends with `n`.
    (Note that `per` stands for each person inside the list.) Further, we sort by
    salaries in descending order.
  prefs: []
  type: TYPE_NORMAL
- en: Because people sometimes type information inconsistently, you first have to
    convert everything to the equivalent case, but this is something for you to figure
    out on your own.
  prefs: []
  type: TYPE_NORMAL
- en: Remember, in this line we have `people`, which is the name of some kind of object,
    and `Where`, an extension method, followed by a Lambda. Next, we use `OrderByDescending`,
    which you can select that from the list of methods, to order values, such as a
    person's salary, in descending order.
  prefs: []
  type: TYPE_NORMAL
- en: 'So, the purpose of this line is to choose each person whose name ends with
    `n`, and then order the results by salary. This yields an `IEnumerable` object,
    and now you can step through it, of course, and say the following in the next
    line:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: 'Now, to print it all, enter the following between a set of curly braces below
    this line:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: Here, we put the `Name` variable first, and the `Salary` variable formatted
    as Currency.
  prefs: []
  type: TYPE_NORMAL
- en: Running the program
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'This is the heart of our program. Crank it up in your browser. Click on the
    Show People button, and the results are displayed, as shown in *Figure 10.5.2*:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/a9234352-3698-4fc1-90db-62a81ef03f17.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Figure 10.5.2: The results of running the program'
  prefs: []
  type: TYPE_NORMAL
- en: So, Joan makes $87,656.00 and John makes $76,877.00\. They were selected because
    both of them have names ending in a lowercase **n**, as you can see, and then
    it's sorted by salary in descending order. So, it's working as expected. As you
    can see, you can also define custom types, such as the one within curly braces
    below `public class Person`, using LINQ. It is very powerful and works well.
  prefs: []
  type: TYPE_NORMAL
- en: Chapter review
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'For review, the complete version of the `Default.aspx.cs` file for this chapter,
    including comments, is shown in the following code block:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we talked about using LINQ with custom types. You set up a
    database, made a custom type using LINQ, set up an array of people, and queried
    the array.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, you will learn how to write queries using query syntax.
  prefs: []
  type: TYPE_NORMAL
