- en: Footprinting and Information Gathering
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we will discuss the information gathering phase of penetration
    testing. We will describe the definition and purpose of information gathering.
    We will also describe several tools in Kali Linux that can be used for information
    gathering. After reading this chapter, we hope that the reader will have a better
    understanding of the information gathering phase and will be able to do information
    gathering during penetration testing.
  prefs: []
  type: TYPE_NORMAL
- en: Information gathering is the second phase in our penetration testing process
    (Kali Linux testing process) as explained in the Kali Linux testing methodology
    section in [Chapter 3](4e2983d0-0bc4-4d57-a0a2-760ebaef8f57.xhtml), *Penetration
    Testing Methodology*. In this phase, we try to collect as much information as
    we can about the target, for example, information about the **Domain Name System**
    (**DNS**) hostnames, IP addresses, technologies and configuration used, username's
    organization, documents, application code, password reset information, contact
    information, and so on. During information gathering, every piece of information
    gathered is considered important.
  prefs: []
  type: TYPE_NORMAL
- en: 'Information gathering can be categorized in two ways based on the method used:
    active information gathering and passive information gathering. In the active
    information gathering method, we collect information by introducing network traffic
    to the target network, while in the passive information gathering method, we gather
    information about a target network by utilizing a third party''s services, such
    as the Google search engine. We will cover this later on.'
  prefs: []
  type: TYPE_NORMAL
- en: Remember that neither method is better in comparison to the other; each has
    its own advantage. In passive scanning, you gather less information, but your
    action will be stealthy, while in active scanning, you get more information, but
    some devices may catch your action. During a penetration testing project, this
    phase may be done several times for the completeness of information collected.
    You may also discuss with your pen-testing customer which method they want.
  prefs: []
  type: TYPE_NORMAL
- en: For this chapter, we will utilize the passive and active methods of information
    gathering to get a better picture of the target.
  prefs: []
  type: TYPE_NORMAL
- en: 'We will be discussing the following topics in this chapter:'
  prefs: []
  type: TYPE_NORMAL
- en: Public websites that can be used to collect information about the target domain
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Domain registration information
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: DNS analysis
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Route information
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Search engine utilization
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Open Source Intelligence
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: One of the key terms often associated with information gathering is **Open Source
    Intelligence** (**OSINT**). Military and intelligence organizations divide their
    intelligence sources into a variety of types. True espionage, involving interaction
    between spies, is often referred to as **Human Intelligence** (**HUMINT**). The
    capturing of radio signals with the intent of cracking the encryption is called
    **Signals Intelligence** (**SIGINT**). While the penetration tester is not likely
    to interface with either of these, the information gathering stage is OSINT. OSINT
    is information derived from sources that have no security controls preventing
    their disclosure. They are often public records or information that target organizations
    share as part of their daily operations.
  prefs: []
  type: TYPE_NORMAL
- en: For this information to be of use to the penetration tester, they need specific
    knowledge and tools to find this information. The information gathering stage
    relies heavily on this information. In addition, simply showing an organization
    what OSINT they are leaking may give them an idea of areas in which to increase
    security. As we will see in this chapter, there is a great deal of information
    that is visible to those who know where to look.
  prefs: []
  type: TYPE_NORMAL
- en: Using public resources
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: On the internet, there are several public resources that can be used to collect
    information regarding a target domain. The benefit of using these resources is
    that your network traffic is not sent to the target domain directly, so your activities
    are not recorded in the target domain log files.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following are the resources that can be used:'
  prefs: []
  type: TYPE_NORMAL
- en: '| No. | Resource URL | Description |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | [http://www.archive.org](http://www.archive.org) | This contains an archive
    of websites. |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | [http://www.domaintools.com/](http://www.domaintools.com/) | This contains
    domain name intelligence. |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | [http://www.alexa.com/](http://www.alexa.com/) | This contains the database
    of information about websites. |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | [http://serversniff.net/](http://serversniff.net/) | This is the free
    **Swiss Army Knife** for networking, server checks, and routing. |'
  prefs: []
  type: TYPE_TB
- en: '| 5 | [http://centralops.net/](http://centralops.net/) | This contains free
    online network utilities such as domain, email, browser, ping, traceroute, and
    Whois. |'
  prefs: []
  type: TYPE_TB
- en: '| 6 | [http://www.robtex.com](http://www.robtex.com) | This allows you to search
    for domain and network information. |'
  prefs: []
  type: TYPE_TB
- en: '| 7 | [http://www.pipl.com/](http://www.pipl.com/) | This allows you to search
    for people on the internet by their first and last names, city, state, and country.
    |'
  prefs: []
  type: TYPE_TB
- en: '| 8 | [http://wink.com/](http://wink.com/) | This is a free search engine that
    allows you to find people by their name, phone number, email, website, photo,
    and so on. |'
  prefs: []
  type: TYPE_TB
- en: '| 9 | [http://www.isearch.com/](http://www.isearch.com/) | This is a free search
    engine that allows you to find people by their name, phone number, and email address.
    |'
  prefs: []
  type: TYPE_TB
- en: '| 10 | [http://www.tineye.com](http://www.tineye.com) | TinEye is a reverse
    image search engine. We can use TinEye to find out where the image came from,
    how it is being used, whether modified versions of the image exist, or to find
    higher resolution versions. |'
  prefs: []
  type: TYPE_TB
- en: '| 11 | [http://www.sec.gov/edgar.shtml](http://www.sec.gov/edgar.shtml) | This
    can be used to search for information regarding public listed companies in the
    Securities and Exchange Commission. |'
  prefs: []
  type: TYPE_TB
- en: Due to the ease of use—you only need an internet connection and a web browser—we
    suggest that you utilize these public resources first before using the tools provided
    with Kali Linux.
  prefs: []
  type: TYPE_NORMAL
- en: To protect a domain from being abused, we have changed the domain name that
    we used in our examples. We are going to use several domain names, such as `example.com`
    from IANA and the free hacking testing site [https://www.hackthissite.org/](https://www.hackthissite.org/)
    as well, for illustrative purposes.
  prefs: []
  type: TYPE_NORMAL
- en: Querying the domain registration information
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: After you know the target domain name, the first thing you would want to do
    is query the `Whois` database about that domain to look for the domain registration
    information. The `Whois` database will provide information about the DNS server
    and the contact information of a domain.
  prefs: []
  type: TYPE_NORMAL
- en: '`Whois` is a protocol for searching internet registrations, databases for registered
    domain names, IPs, and autonomous systems. This protocol is specified in RFC 3912
    ([https://www.ietf.org/rfc/rfc3912.txt](https://www.ietf.org/rfc/rfc3912.txt)).'
  prefs: []
  type: TYPE_NORMAL
- en: 'By default, Kali Linux already comes with a `whois` client. To find out the
    `Whois` information for a domain, just type the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'The following is the result of the `Whois` information:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: From the preceding `Whois` result, we can get the information of the DNS server
    and the contact person of a domain. This information will be useful in the later
    stages of penetration testing.
  prefs: []
  type: TYPE_NORMAL
- en: 'Besides using the command-line `Whois` client, the `Whois` information can
    also be collected via the following websites, which provide the `whois` client:'
  prefs: []
  type: TYPE_NORMAL
- en: '[www.whois.net](http://www.whois.net)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[www.internic.net/whois.html](http://www.internic.net/whois.html)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'You can also go to the top-level domain registrar for the corresponding domain:'
  prefs: []
  type: TYPE_NORMAL
- en: '**America**: [www.arin.net/whois/](http://www.arin.net/whois/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Europe**: [www.db.ripe.net/whois](http://www.db.ripe.net/whois)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Asia-Pacific**: [www.apnic.net/apnic-info/whois_search2](http://www.apnic.net/apnic-info/whois_search2)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Beware: to use the top-level domain registrar `whois`, the domain needs to
    be registered through their own system. For example, if you use `ARIN WHOIS`,
    it only searches in the `ARIN WHOIS` database and will not search in the `RIPE`
    and `APNIC Whois` databases.'
  prefs: []
  type: TYPE_NORMAL
- en: After getting information from the `Whois` database, next we want to gather
    information about the DNS entries of the target domain.
  prefs: []
  type: TYPE_NORMAL
- en: Analyzing the DNS records
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The goal of using the tools in the DNS records category is to collect information
    about the DNS servers and the corresponding records of a target domain.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following are several common DNS record types:'
  prefs: []
  type: TYPE_NORMAL
- en: '| No. | Record type | Description |'
  prefs: []
  type: TYPE_TB
- en: '| 1 | SOA | This is the start of authority record. |'
  prefs: []
  type: TYPE_TB
- en: '| 2 | NS | This is the name server record. |'
  prefs: []
  type: TYPE_TB
- en: '| 3 | A | This is the IPv4 address record. |'
  prefs: []
  type: TYPE_TB
- en: '| 4 | MX | This is the mail exchange record. |'
  prefs: []
  type: TYPE_TB
- en: '| 5 | PTR | This is the pointer record. |'
  prefs: []
  type: TYPE_TB
- en: '| 6 | AAAA | This is the IPv6 address record. |'
  prefs: []
  type: TYPE_TB
- en: '| 7 | CNAME | This is the abbreviation for canonical name. It is used as an
    alias name for another canonical domain name. |'
  prefs: []
  type: TYPE_TB
- en: For example, in a penetration test engagement, the customer may ask you to find
    out all of the hosts and IP addresses available for their domain. The only information
    you have is the organization's domain name. We will look at several common tools
    that can help you if you encounter this situation.
  prefs: []
  type: TYPE_NORMAL
- en: Host
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'After we get the DNS server information, the next step is to find out the IP
    address of a hostname. To help us out on this matter, we can use the following
    host command-line tool to look up the IP address of a host from a DNS server:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'By default, the `host` command will look for the `A`, `AAAA`, and `MX` records
    of a domain. To query for any records, just give the `-a` option to the command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: The `host` command looks for these records by querying the DNS servers listed
    in the `/etc/resolv.conf` file of your Kali Linux system. If you want to use other
    DNS servers, just provide the DNS server address as the last command-line option.
  prefs: []
  type: TYPE_NORMAL
- en: If you provide the domain name as the command-line option in `host`, the method
    is called forward lookup, but if you give an IP address as the command-line option
    to the `host` command, the method is called reverse lookup.
  prefs: []
  type: TYPE_NORMAL
- en: 'Try to do a reverse lookup of the following IP address:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: What information can you get from this command?
  prefs: []
  type: TYPE_NORMAL
- en: The `host` tool can also be used to do a DNS zone transfer. With this mechanism,
    we can collect information about the available hostnames in a domain.
  prefs: []
  type: TYPE_NORMAL
- en: A DNS zone transfer is a mechanism used to replicate a DNS database from a master
    DNS server to another DNS server, usually called a slave DNS server. Without this
    mechanism, the administrators have to update each DNS server separately. The DNS
    zone transfer query must be issued to an authoritative DNS server of a domain.
  prefs: []
  type: TYPE_NORMAL
- en: Due to the nature of information that can be gathered by a DNS zone transfer,
    nowadays, it is very rare to find a DNS server that allows zone transfer to an
    arbitrary zone transfer request.
  prefs: []
  type: TYPE_NORMAL
- en: If you find a DNS server that allows zone transfer without limiting who is able
    to do it, this means that the DNS server has been configured incorrectly.
  prefs: []
  type: TYPE_NORMAL
- en: dig
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Besides the `host` command, you can also use the `dig` command to do DNS interrogation.
    The advantages of `dig` compared to `host` are its flexibility and clarity of
    output. With `dig`, you can ask the system to process a list of lookup requests
    from a file.
  prefs: []
  type: TYPE_NORMAL
- en: Let's use `dig` to interrogate the [http://hackthissite.org](http://hackthissite.org)
    domain.
  prefs: []
  type: TYPE_NORMAL
- en: 'Without providing any options besides the domain name, the `dig` command will
    only return the A record of a domain. To request any other DNS record type, we
    can provide the type option in the command line:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: From the result, we can see that the `dig` output now returns the DNS records
    of `A`.
  prefs: []
  type: TYPE_NORMAL
- en: DMitry
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**Deepmagic Information Gathering Tool** (**DMitry**) is an all-in-one information
    gathering tool. It can be used to gather the following information:'
  prefs: []
  type: TYPE_NORMAL
- en: The `Whois` record of a host by using the IP address or domain name
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Host information from [https://www.netcraft.com/](https://www.netcraft.com/)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Subdomains in the target domain
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The email address of the target domain
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Open, filtered, or closed port lists on the target machine by performing a port
    scan
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Even though this information can be obtained using several Kali Linux tools,
    it is very handy to gather all of the information using a single tool and to save
    the report to one file.
  prefs: []
  type: TYPE_NORMAL
- en: We think this tool is more suitable to be categorized under DNS analysis instead
    of the *Route analysis* section because the capabilities are more about DNS analysis
    rather than routing analysis.
  prefs: []
  type: TYPE_NORMAL
- en: 'To access `DMitry` from the Kali Linux menu, navigate to Applications | Information
    Gathering | dmitry, or you can use the console and type the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 'As an example, let''s do the following to a target host:'
  prefs: []
  type: TYPE_NORMAL
- en: Perform a `Whois` lookup
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Get information from [https://www.netcraft.com/](https://www.netcraft.com/)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Search for all the possible subdomains
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Search for all the possible email addresses
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The command for performing the mentioned actions is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'The following is the abridged result of the preceding command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: 'We can also use `dmitry` to perform a simple port scan by providing the following
    command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: 'The result of the preceding command is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: From the preceding command, we find that the target host is using a device to
    do packet filtering. It only allows incoming connections to port `22` for SSH
    and port `80`, which is commonly used for a web server. What is of interest is
    that the type of SSH installation is indicated, allowing for further research
    on possible vulnerabilities to the OpenSSH installation.
  prefs: []
  type: TYPE_NORMAL
- en: Maltego
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Maltego is an open source intelligence and forensics application. It allows
    you to mine and gather information and represent the information in a meaningful
    way. The phrase open source in Maltego means that it gathers information from
    open source resources. After gathering the information, Maltego allows you to
    identify the key relationship between the information gathered.
  prefs: []
  type: TYPE_NORMAL
- en: Maltego is a tool that can graphically display the links between data, so it
    will make it easier to see the common aspects between pieces of information.
  prefs: []
  type: TYPE_NORMAL
- en: 'Maltego allows you to enumerate the following internet infrastructure information:'
  prefs: []
  type: TYPE_NORMAL
- en: Domain names
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: DNS names
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`Whois` information'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Network blocks
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: IP addresses
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'It can also be used to gather the following information about people:'
  prefs: []
  type: TYPE_NORMAL
- en: Companies and organizations related to the person
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Email addresses related to the person
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Websites related to the person
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Social networks related to the person
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Phone numbers related to the person
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Social media information
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Kali Linux, by default, comes with Maltego 3.6.1 Kali Linux edition. The following
    are the limitations of the community version:'
  prefs: []
  type: TYPE_NORMAL
- en: Not for commercial use
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A maximum of 12 results per transform
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: You need to register yourself on our website to use the client
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: API keys expire every couple of days
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Runs on a (slower) server that is shared with all community users
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Communication between client and server is not encrypted
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Not updated until the next major version
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: No end user support
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: No updates of transforms on the server side
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: There are more than 70 transforms available in Maltego. The word transform refers
    to the information gathering phase of Maltego. One transform means that Maltego
    will only do one phase of information gathering.
  prefs: []
  type: TYPE_NORMAL
- en: 'To access Maltego from the Kali Linux menu, navigate to Application | Information
    Gathering | Maltego. There is also a start icon on the desktop, or you can use
    the console and type the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: You will see the Maltego welcome screen. After several seconds, you will see
    the following Maltego start up wizard that will help you set up the Maltego client
    for the first time.
  prefs: []
  type: TYPE_NORMAL
- en: Click on Next to continue to the next window and enter your login details. (Click
    on register here to create an account if you do not have login details.)
  prefs: []
  type: TYPE_NORMAL
- en: Once logged in, enter your personal details (name and email address).
  prefs: []
  type: TYPE_NORMAL
- en: 'You will then need to select the transform seeds, as shown in the following
    screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/642e2c0d-2fc1-42fc-b4bf-71e357116b1b.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The Maltego client will connect to the Maltego servers in order to get the
    transforms. If Maltego has been initialized successfully, you will see the following
    screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/31aeda01-9710-4c5f-abe6-55c2afef7f9d.png)'
  prefs: []
  type: TYPE_IMG
- en: This means that your Maltego client initialization has been done successfully.
    Now you can use the Maltego client.
  prefs: []
  type: TYPE_NORMAL
- en: 'Before we use the Maltego client, let''s first look at the Maltego interface:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/517bb8de-040d-48d1-9b73-92217ad169a7.png)'
  prefs: []
  type: TYPE_IMG
- en: Maltego Interface
  prefs: []
  type: TYPE_NORMAL
- en: 'On the top-left side of the preceding screenshot, you will see the Palette
    window. In the **Palette** window, you can choose the entity type for which you
    want to gather the information. Maltego divides the entities into six groups,
    as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Devices** such as phone or camera'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Infrastructure** such as AS, DNS name, domain, IPv4 address, MX record, NS
    record, netblock, URL, and website'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Locations** on earth'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Penetration testing**'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Personal such as alias, document, email address, image, person, phone number,
    and phrase
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Social network such as Facebook object, Twitter entity, Facebook affiliation,
    and Twitter affiliation
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'In the top-middle of the preceding screenshot, you will see the different views:'
  prefs: []
  type: TYPE_NORMAL
- en: Main View
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Bubble View
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Entity List
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Views are used to extract information that is not obvious from large graphs—where
    the analyst cannot see clear relationships via the manual inspection of data.
    Main View is where you work most of the time. In Bubble View, the nodes are displayed
    as bubbles, while in the Entity List tab, the nodes are simply listed in text
    format.
  prefs: []
  type: TYPE_NORMAL
- en: 'Next to the views, you will see different layout algorithms. Maltego supports
    the following four layout algorithms:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Block layout: This is the default layout and is used during mining.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Hierarchical layout: The hierarchical layout works with a root and subsequent
    branches for hosts. This provides a branch structure to allow for visualization
    of parent/child relationships.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Centrality layout: The centrality layout takes the most central node and then
    graphically represents the incoming links around the nodes. This is useful when
    examining several nodes that are all linked to one central node.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Organic layout: The organic layout displays the nodes in such a way that the
    distance is minimized, giving the viewer a better overall picture of the nodes
    and their relationships.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: After a brief description of the Maltego client user interface, it's time for
    action.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s suppose you want to gather information about a domain. We will use the
    `example.com` domain for this example. We will explore how to do this in the following
    sections:'
  prefs: []
  type: TYPE_NORMAL
- en: Create a new graph (*Ctrl* + *T*) and go to the Palette tab.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select Infrastructure, and click on Domain.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Drag it to the main window. If successful, you will see a domain called `paterva.com`
    in the main window.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Double-click on the name and change it to your target domain, such as `example.com`,
    as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/45ba5d80-b8ff-4307-9b8d-816d9677a82f.png)'
  prefs: []
  type: TYPE_IMG
- en: Maltego Kali Linux
  prefs: []
  type: TYPE_NORMAL
- en: 'If you right-click on the `domain` name, you will see all of the transforms
    that can be done to the domain name:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: DNS from domain
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Domain owner's details
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Email addresses from domain
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Files and documents from domain
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Other transforms, such as To Person, To Phone numbers, and To Website
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: All transforms
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Let''s choose DomainToDNSNameSchema from the domain transforms (Run Transform
    | Other Transforms | DomainToDNSNameSchema). The following screenshot shows the
    result:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/ce5adbf3-ab12-4aca-953a-4ef0b0c2f481.png)'
  prefs: []
  type: TYPE_IMG
- en: Maltego Kali Linux
  prefs: []
  type: TYPE_NORMAL
- en: After the DNS from Domain transform, we got information on the website address
    ([www.example.com](http://www.example.com)) related to the `example.com` domain.
  prefs: []
  type: TYPE_NORMAL
- en: You can run other transforms to the target domain.
  prefs: []
  type: TYPE_NORMAL
- en: 'If you want to change the domain, you need to save the current graph first.
    To save the graph, follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Click on the Maltego icon, and then select Save.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The graph will be saved in the Maltego graph file format (`.mtgx`). To change
    the domain, just double-click on the existing domain and change the domain name.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Next, we will describe several tools that can be used for getting routing information.
  prefs: []
  type: TYPE_NORMAL
- en: Getting network routing information
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Network routing information is useful for penetration testers in a number of
    ways. First, they can identify different devices between the penetration tester's
    machine and the target. The penetration tester can also glean information about
    how the network operates and how traffic is routed between the target and the
    tester's machine. Finally, the penetration tester would also be able to determine
    whether there was an intermediate barrier such as a firewall or proxy server between
    the tester and the target.
  prefs: []
  type: TYPE_NORMAL
- en: Kali Linux has a number of tools that provide network routing information.
  prefs: []
  type: TYPE_NORMAL
- en: tcptraceroute
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A supplement to the `traceroute` command found in Linux distributions is the
    `tcptraceroute` tool. The normal `traceroute` command sends either a UDP or ICMP
    echo request packet to the target house with a **Time to Live** (**TTL**) set
    to one. This TTL is increased by one for each host it reaches until the packet
    reaches the target host. The major difference between `traceroute` and the `tcptraceroute`
    tool is that the `tcptraceroute` tool uses a TCP SYN packet to the target host.
  prefs: []
  type: TYPE_NORMAL
- en: The main advantage with using `tcptraceroute` is when you have the possibility
    of encountering a firewall between the testing machine and the target. Firewalls
    are often configured to filter out ICMP and UDP traffic associated with the `traceroute`
    command. As a result, the `traceroute` information will not be useful to you.
    Using `tcptraceroute` gives the ability to use the TCP connection on a specific
    port, which the firewall will allow you to pass through, thereby allowing you
    to enumerate the network routing path through the firewall.
  prefs: []
  type: TYPE_NORMAL
- en: 'The `tcptraceroute` command makes use of the TCP three-way handshake to determine
    whether the patch through the firewall is allowed. If the port is open, you will
    receive a SYN/ACK packet. If the port is closed, you will receive an RST packet.
    To start `tcptraceroute`, type the following into the command line:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: This command will show the different functions related to the command.
  prefs: []
  type: TYPE_NORMAL
- en: 'The simplest usage is running the command against a domain. For this demonstration,
    we will run the `traceroute` command to trace the network route to the domain
    the `example.com`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: 'The redacted output for `traceroute` is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: As you can see, there are several steps that are indicated and others that appear
    as `***`. If we look at the output, by hop 15, we see that there is no information
    available. This is indicative of a filtering device between the tester machine
    and the host, `example.com` domain.
  prefs: []
  type: TYPE_NORMAL
- en: 'To counter this filtering, we will try to determine the route using the `tcptraceroute`
    command. As we know that `example.com` has a web server, we will set the command
    to try the TCP port `80`, which is the HTTP port. Here is the command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: 'The output is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: As we can see from the `tcptraceroute` output, the request has reached our target
    system and has given us the hops that the request took to get to the target.
  prefs: []
  type: TYPE_NORMAL
- en: tctrace
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Another tool that makes the same use of the TCP handshake is `tctrace`. Much
    like `tcptraceroute`, `tctrace` sends a SYN packet to a specific host and if the
    reply is a SYN/ACK, the port is open. An RST packet indicates a closed port.
  prefs: []
  type: TYPE_NORMAL
- en: 'To start `tctrace`, enter the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: '`-i <device>` is the network interface on the target and `-d <target host>`
    is the target.'
  prefs: []
  type: TYPE_NORMAL
- en: 'For this example, we are going to run `tctrace` against the `www.example.com`
    domain:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: 'The following output is obtained:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: Utilizing the search engine
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Aside from routing and domain information, Kali Linux has other tools that can
    provide a great deal of OSINT to penetration testers. These tools act as search
    engines and have the ability to cull a variety of resources, such as Google or
    social networking sites, for email addresses, documents, and domain information.
    One of the advantages of using these tools is that they do not directly search
    websites, but rather use other search engines to provide OSINT. This limits the
    penetration tester's fingerprints on a target system.
  prefs: []
  type: TYPE_NORMAL
- en: Some of these tools are built into Kali Linux and others have to be installed.
    The following sections present a good subset of the tools that will aid you in
    the vast majority of information collection.
  prefs: []
  type: TYPE_NORMAL
- en: SimplyEmail
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '`SimplyEmail` not only takes email addresses and other information, but also
    scrubs domains for documents such as text, Word, or Excel spreadsheets. In addition,
    there are a wide range of different website and search engines that can be used.
    These include Reddit, Pastebin, and CanaryBin. One of the best features is that
    the tool creates a report in HTML, which comes in handy when you are preparing
    your report.'
  prefs: []
  type: TYPE_NORMAL
- en: '`theharvester` is also a handy tool to aggregate email addresses and other
    information that a target may leak.'
  prefs: []
  type: TYPE_NORMAL
- en: '`SimplyEmail` is a Python script that has a number of modules. Installing it
    is fairly easy.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Use the following steps to install `SimplyEmail`:'
  prefs: []
  type: TYPE_NORMAL
- en: Navigate to the GitHub site at [https://github.com/killswitch-GUI/SimplyEmail](https://github.com/killswitch-GUI/SimplyEmail)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Enter the following code:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE20]'
  prefs: []
  type: TYPE_PRE
- en: Once the startup script has completed, you can execute the scripts.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'The help menu can be accessed by typing this:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE21]'
  prefs: []
  type: TYPE_PRE
- en: 'Email enumeration is an important phase of so many operations that a pen tester
    or Red Teamer goes through. There are tons of applications that do email enumeration,
    but I wanted a simple yet effective way to get what `Recon-Ng` provide and `theharvester`
    (you may want to run `-h`):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE22]'
  prefs: []
  type: TYPE_PRE
- en: 'To start a search, type in the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE23]'
  prefs: []
  type: TYPE_PRE
- en: 'The script then runs. Beware that if there is no information, there will be
    errors in the return. This does not mean you have made an error, but rather that
    there are no results for the search. While the tool runs, you will see the following
    output on your screen:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE24]'
  prefs: []
  type: TYPE_PRE
- en: 'After the searches have been conducted, you will receive a request to verify
    email addresses. This verification process can take some time, but in a targeted
    attack where you want to socially engineer or phish specific individuals, it may
    be prudent. A simple `Y/N` will suffice:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE25]'
  prefs: []
  type: TYPE_PRE
- en: 'After the verification question, the final question is the report generation
    phase:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE26]'
  prefs: []
  type: TYPE_PRE
- en: The report output is an HTML file with the types of searches that have been
    conducted and the data that has been found. If you are good at HTML, you can even
    brand this report with your own logo and include it in the final pen test report.
  prefs: []
  type: TYPE_NORMAL
- en: Google Hacking Database (GHDB)
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The **Google Hacking Database** (**GHDB**) can be found at [https://www.exploit-db.com/google-hacking-database/](https://www.exploit-db.com/google-hacking-database/)
    and allows users to use customized advanced queries that may reveal unusual information,
    which would otherwise not be displayed in a typical results listing on [https://www.google.com/](https://www.google.com/).
  prefs: []
  type: TYPE_NORMAL
- en: The GHDB was originally developed by Johnny Long, creator of Hackers for Charity,
    but is now maintained and hosted by Offensive Security, the makers of Kali Linux.
    The GHDB uses Googledorks which are Google operators used in search strings such
    as inurl, filetype, allintext, site, cache, and also operators such as `+`, `-`,
    `*`, and so on. When used correctly, Googledorks can sometimes reveals interesting
    and even sensitive information such as error messages, vulnerable servers and
    websites, sensitive files, and login pages. Of course, most of this information
    is not readily available via ordinary Google searches, which leads to the use
    of Google as an information gathering and hacking database tool.
  prefs: []
  type: TYPE_NORMAL
- en: The GHDB is simple enough to use. It allows the user to choose from various
    categories than typing in phrases and Googledorks. Lower down on the page, it
    lists many of the categories with search queries, as well as links to the queries
    leading to a Google search, thus making it very easy even for beginners to use.
  prefs: []
  type: TYPE_NORMAL
- en: 'As an example, I''ve chosen Vulnerable Servers from the category list, simply
    entered `apache` in the search field, and clicked on SEARCH:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/c4e66c07-1aeb-4e99-9d59-ea6465e16acc.png)'
  prefs: []
  type: TYPE_IMG
- en: The results listed can be either clicked on or copied and pasted into Google
    to try and gather more information.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot shows the results of the search in Google. Note that
    there are 16,600 results, but not all results will yield interesting information
    about vulnerable servers:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/cb74ec04-4ed9-4b2f-9ee1-3792b95cfb32.png)'
  prefs: []
  type: TYPE_IMG
- en: For ethical and legal purposes, you should only use the GHDB for information
    gathering purposes as it pertains to the laws of your state and country.
  prefs: []
  type: TYPE_NORMAL
- en: Metagoofil
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '`Metagoogil` is a tool that utilizes the Google search engine to get metadata
    from the documents available in the target domain. Currently, it supports the
    following document types:'
  prefs: []
  type: TYPE_NORMAL
- en: Word documents (`.docx`, `.doc`)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Spreadsheet documents (`.xlsx`, `.xls`, `.ods`)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Presentation files (`.pptx`, `.ppt`, `.odp`)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: PDF files (`.pdf`)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`Metagoogil` works by performing the following actions:'
  prefs: []
  type: TYPE_NORMAL
- en: Searching for all of the preceding file types in the target domain using the
    Google search engine
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Downloading all of the documents found and saving them to the local disk
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Extracting the metadata from the downloaded documents
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Saving the result in an HTML file
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The metadata that can be found includes the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Usernames
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Software versions
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Server or machine names
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'This information can be used later on to help in the penetration testing phase.
    `Metagoogil` is not part of the standard Kali Linux v 2.0 distribution. To install,
    all you need to do is use the `apt-get` command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE27]'
  prefs: []
  type: TYPE_PRE
- en: 'After the installer package has finished, you can access Metagoofil from the
    command line:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE28]'
  prefs: []
  type: TYPE_PRE
- en: 'This will display simple usage instructions and an example on your screen.
    As an example of `Metagoogil` usage, we will collect all the DOC and PDF documents
    (`-t`, `.doc`, `.pdf`) from a target domain (`-d hackthissite.org`) and save them
    to a directory named `test` (`-o test`). We limit the search for each file type
    to `20` files (`-l 20`) and only download five files (`-n 5`). The report generated
    will be saved to `test.html` (`-f test.html`). We give the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE29]'
  prefs: []
  type: TYPE_PRE
- en: 'The redacted result of this command is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE30]'
  prefs: []
  type: TYPE_PRE
- en: You can see from the preceding result that we get a lot of information from
    the documents we have collected, such as the usernames and path information. We
    can use the obtained usernames to look for patterns in the usernames and for launching
    a brute-force password attack on them. But, be aware that doing a brute-force
    password attack on an account may have the risk of locking the user accounts.
    The path information can be used to guess the operating system that is used by
    the target. We got all of this information without going to the domain website
    ourselves.
  prefs: []
  type: TYPE_NORMAL
- en: '`Metagoogil` is also able to generate information in a report format. The following
    screenshot shows the generated report in HTML:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/d6ba3ddb-573f-4910-a52e-0ca9fb78f5f2.png)'
  prefs: []
  type: TYPE_IMG
- en: In the report generated, we get information about usernames, software version,
    email address, and server information from the target domain.
  prefs: []
  type: TYPE_NORMAL
- en: Automated footprinting and information gathering tools
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section, we look at fully automated tools, two in particular, consisting
    of several features able to accomplish the tasks covered in many of the individual
    tools mentioned earlier. These tools are freely available for use via [https://github.com/](https://github.com/)
    and work in Kali Linux 2018.2 (and possibly earlier versions).
  prefs: []
  type: TYPE_NORMAL
- en: Devploit
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Devploit 3.6 is listed as an information gathering tool, developed by Joker25000,
    and is available at [https://github.com/joker25000/Devploit](https://github.com/joker25000/Devploit).
  prefs: []
  type: TYPE_NORMAL
- en: To use Devsploit, we first clone it onto our Kali Linux machine and then run
    the tools of choice when presented with the options. Cloning only has to be done
    once; every time you use Devploit thereafter, you simply browse to the Devploit
    directory.
  prefs: []
  type: TYPE_NORMAL
- en: Open a new Terminal and change to the directory of your choice using the `cd`
    command. (You can also use the `ls` command to list the content of the directory
    and ensure you are in the correct directory.)
  prefs: []
  type: TYPE_NORMAL
- en: 'Use the `git clone` command to clone Devploit onto your machine by typing the
    following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE31]'
  prefs: []
  type: TYPE_PRE
- en: '![](img/25c29e7e-23a2-4edd-ac16-f897d63547d8.png)'
  prefs: []
  type: TYPE_IMG
- en: If copying the URL from the GitHub webpage, be sure to include `.git` at the
    end of the URL in the Terminal.
  prefs: []
  type: TYPE_NORMAL
- en: 'Press *Enter* to clone Devploit onto Kali:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/e499109c-30cf-4628-99bd-03fbcd7f72c7.png)'
  prefs: []
  type: TYPE_IMG
- en: In the Terminal, change to the Devploit directory on your desktop by typing
    `cd` Devploit and then use the `ls` command to view the directory contents. You
    should see the `Devploit.py` and `README.me` files among others.
  prefs: []
  type: TYPE_NORMAL
- en: Give the file executable permissions to install by typing `chmod +x install`,
    and then start Devploit by typing `./install`.
  prefs: []
  type: TYPE_NORMAL
- en: Be sure that you are running the preceding commands from within the Devploit
    directory.
  prefs: []
  type: TYPE_NORMAL
- en: 'Once Devploit has been installed, open a new Terminal and type Devploit, as
    shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/6751cf62-d306-44ce-886f-638acfc65a39.png)'
  prefs: []
  type: TYPE_IMG
- en: 'There are 19 options available for automated information gathering with Devploit:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/bd850307-d386-4c05-9fc1-7361871ea44b.png)'
  prefs: []
  type: TYPE_IMG
- en: 'To perform a DNS lookup, enter `1` and then enter the name of the domain, such
    as [www.google.com](http://www.google.com):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/f645bd5a-304f-4221-9c12-0dc1c91b19e0.png)'
  prefs: []
  type: TYPE_IMG
- en: 'To find out basic geographic information about a domain or IP, choose option
    3 and press enter, followed by the IP or domain name:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/e3e2c463-a3bf-4e65-bdd7-1cecac3d96ef.png)'
  prefs: []
  type: TYPE_IMG
- en: Be sure to familiarize yourself with the options available.
  prefs: []
  type: TYPE_NORMAL
- en: Red Hawk v2
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Red Hawk version 2 is another in-depth, all-in-one information gathering suite
    for reconnaissance and data collection.
  prefs: []
  type: TYPE_NORMAL
- en: 'In a new terminal, change to the desktop (or directory of your choice) and
    clone Red Hawk v2 by entering [https://github.com/th3justhacker/RED_HAWK](https://github.com/th3justhacker/RED_HAWK):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/1a976351-a069-4e1f-9ea1-be961eb87ed5.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Once all objects have been successfully unpacked, change directories into the
    `RED_HAWK` directory by typing `cd RED_HAWK`. Use the `ls` command to verify that
    `rhawk.php` exists:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/5139a1d7-e73a-4b0f-8ae0-9fe9484f7c3d.png)'
  prefs: []
  type: TYPE_IMG
- en: 'To start Red Hawk, type `php rhawk.php` and press *Enter*. If successful, the
    following screen should be displayed:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/562012a5-2487-4834-93c9-6618d3284471.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Enter your website and choose either HTTP or HTTPS. Then, choose from the options
    available. For example, type one for a Whois lookup:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/5d45f3a3-6f26-47bc-af7f-436016d40082.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'The Whois lookup information for `https://www.google.com/` is displayed as
    follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/8d50f844-dbf3-427d-a5d4-199de8835987.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'The results of option `[3] Grab Banners` for [https://www.google.com/](https://www.google.com/) are
    as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/f692c408-722d-40b0-bc2f-819f075fafd9.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'An MX lookup (option `13`) for [Google.com](https://www.google.com/?gws_rd=ssl)
    gives the following output:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/16ebd101-7031-4f1c-bd97-a62eae854687.jpg)'
  prefs: []
  type: TYPE_IMG
- en: There are several options available to the user including option `[A]`, which
    scans for everything.
  prefs: []
  type: TYPE_NORMAL
- en: Using Shodan to find internet connected devices
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The Shodan search engine, found at [shodan.io](http://shodan.io), isn't your
    average search engine. Shodan, through the use of basic as well as specific query
    strings, can return searches with vulnerable systems connected to the internet.
  prefs: []
  type: TYPE_NORMAL
- en: The website was developed by John Matherly, has been available for just under
    a decade and has now become an invaluable tool for fingerprinting over the internet.
    Considering that we live in the age of the **Internet of Things** (**IoT**), more
    and more devices are now accessible via the internet, however many of them are
    not as locked down as they should be, sometimes making them vulnerable to not
    only hackers, but any curious minds.
  prefs: []
  type: TYPE_NORMAL
- en: Shodan scans for common ports and performs banner grabbing as part of its footprinting
    process, then  displays devices accessible over the web, including routers and
    network devices, webcams and surveillance devices, traffic cams, servers and SCADA
    systems, and many more interesting devices.
  prefs: []
  type: TYPE_NORMAL
- en: In the list of results, clicking on individual results often returns a list
    of open ports and services on the device, and also allows for report generation.
  prefs: []
  type: TYPE_NORMAL
- en: For privacy and legal purposes, I've opted to not use screenshots of Shodan
    results.
  prefs: []
  type: TYPE_NORMAL
- en: 'To use Shodan, first visit the website at [www.shodan.io](https://www.shodan.io/):'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/eaf16620-8c32-4e2d-b20a-55412c3a2ef7.png)'
  prefs: []
  type: TYPE_IMG
- en: You'll notice that you can use the service for free, but you will be limited
    to viewing one page of returned results if you do not sign up. Signing up is free
    and allows you to view the first two pages of returned findings/results displayed
    by the search engine. There is also a paid subscription that you can subscribe
    to, in order to access all results.
  prefs: []
  type: TYPE_NORMAL
- en: Search queries in Shodan
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The following are the search queries in Shodan:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Keywords** such as webcams, CCTV, Cisco, Fortinet, traffic signal, refrigerator,
    and others can be specified in the search field'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Port numbers** can also be specified according to services, such as `3389`
    (remote desktop).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**OS versions:** Operating systems and versions can also be specified along
    with country codes'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Country names** can also be specified along with keywords and port numbers'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Phrases **and combined keywords can also be used, including popular search
    phrases such as default passwords, failed login, and others.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In the top menu of the Shodan website, there is an Explore option. This option
    displays links for various categories and popular searches. Industrial Control
    Systems and Databases are among the Featured Categories, and entries for Top Voted
    searches include webcam, Cams, Netcam, and default password.
  prefs: []
  type: TYPE_NORMAL
- en: 'Clicking on the Webcams category or even entering server: SQ-WEBCAM in the
    Search field yields several results for webcams in different countries. The common
    search query WebcanXPm, for example, also yields results of cameras accessible
    via the internet, many of which allow the remote user to pan, tilt, and zoom.'
  prefs: []
  type: TYPE_NORMAL
- en: Due to legal restrictions, please ensure that you do not access restricted devices
    and use Shodan in accordance with the laws of your state or country.
  prefs: []
  type: TYPE_NORMAL
- en: Starting off with target discovery
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'After we have gathered information about our target network from third-party
    sources, such as search engines, the next step is to discover our target machines.
    The purpose of this process is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: To find out which machine in the target network is available. If the target
    machine is not available, we won't continue the penetration-testing process on
    that machine and will move to the next machine.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: To find the underlying operating system used by the target machine.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Collecting the previously mentioned information will help us during the vulnerabilities-mapping
    process.
  prefs: []
  type: TYPE_NORMAL
- en: We can utilize the tools provided in Kali Linux for the target-discovery process.
    Some of these tools are available in the Information Gathering menu. Others will
    have to be utilized from the command line. For each of these, the commands are
    provided.
  prefs: []
  type: TYPE_NORMAL
- en: In this chapter, we will only describe a few important tools in each category.
    The tools are selected based on their functionality, popularity, and tool-development
    activity.
  prefs: []
  type: TYPE_NORMAL
- en: For the purposes of this chapter, an installation of Metasploitable 2 was utilized
    as a target system. Each of these commands can be tried with that operating system.
  prefs: []
  type: TYPE_NORMAL
- en: Blue-Thunder-IP-Locator
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Open a new Terminal and change to the directory of your choice. For this example,
    I've used the desktop.
  prefs: []
  type: TYPE_NORMAL
- en: 'Clone the Blue-Thunder-IP-Locator from GitHub by typing `git clone https://github.com/th3sha10wbr04rs/Blue-Thunder-IP-Locator-.git`:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/a8ba6279-0a72-4cbb-81c5-d0802ac45c3b.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Once successfully cloned, change directories to the Blue-Thunder-IP-Locator
    directory.
  prefs: []
  type: TYPE_NORMAL
- en: As specified on the GitHub page, [https://github.com/th3sha10wbr04rs/Blue-Thunder-IP-Locator-](https://github.com/th3sha10wbr04rs/Blue-Thunder-IP-Locator-),
    install and update `perl libs` by entering the following: `apt-get install liblocal-lib-perl`.
  prefs: []
  type: TYPE_NORMAL
- en: 'If you encounter an error when running the preceding command, enter the `Dpkg
    –-configure –a` command and then try the previous command again:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/c9b8eea5-1028-4afe-b632-3e1295e965fe.jpg)'
  prefs: []
  type: TYPE_IMG
- en: You may be prompted with various options throughout the process. Press `Y` (Yes)
    when prompted.
  prefs: []
  type: TYPE_NORMAL
- en: Next, type `apt-get install libjson-perl` followed by `apt-get upgrade libjson-perl`.
  prefs: []
  type: TYPE_NORMAL
- en: 'We will also need to ensure that Blue-Thunder has appropriate executable permissions
    by typing `chmod +x blue_thunder.pl`:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/0e81df44-e501-4c0d-b4a7-c9eab987dab7.png)'
  prefs: []
  type: TYPE_IMG
- en: Blue-Thunder-IP-Locator requires certain Perl dependencies from Mechanize to
    able to run. The `Ruby-mechanize` library in particular is required for automating
    interaction with websites.
  prefs: []
  type: TYPE_NORMAL
- en: It’s suggested to run the commands listed next before running Blur-Thunder.
    (Be sure to navigate back to the root directory.)
  prefs: []
  type: TYPE_NORMAL
- en: 'Type `apt-get install libhttp-daemon-ssl perl`:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/877e4cfb-357e-4e21-91a4-1a0438fb5033.jpg)'
  prefs: []
  type: TYPE_IMG
- en: With the preceding command, it's OK if the `libhttp-daemon-ssl` package cannot
    be located. Continue with the next command.
  prefs: []
  type: TYPE_NORMAL
- en: 'Type  `Apt-cache search WWW::Mechanize`:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/d0aeb1da-b4b0-470c-bad9-57ef78471508.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Lastly, run the following command, `apt-get install libwww-mechanize-perl`:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/c234fdfd-b24f-40e5-8fd7-7d1df0ee53b7.png)'
  prefs: []
  type: TYPE_IMG
- en: Now that all dependencies have been installed and/or updated, we can run Blue-Thunder-IP-Locator.
  prefs: []
  type: TYPE_NORMAL
- en: 'In a Terminal, navigate to the Blue-Thunder-IP-Locator directory, enter the `perl
    blue_thunder.pl` command, and press *Enter*:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/61444cb2-747e-43d9-a6e6-f231908913f6.png)'
  prefs: []
  type: TYPE_IMG
- en: To find in-depth geolocation information, type `perl iplocation.pl` followed
    by the name of the host, IP, or domain (in the Blue-Thunder-IP-Locator directory).
  prefs: []
  type: TYPE_NORMAL
- en: 'For example, to find geolocation information about [Google.com](https://www.google.com/?gws_rd=ssl),
    type `perl blue-thunder.pl www.google.com`:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/ed53e167-098a-44d2-b345-8994ecc19165.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Note that the output includes information on the target `ISP`, `Country`, `Latitude`,
    `Longitude`, and more, as seen in the previous screenshot. `Latitude` and `Longitude`
    coordinates can also be plugged into Google Maps for directions and location specifics.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'This chapter introduced you to the information gathering phase. It is usually
    the first phase that is done during the penetration testing process. In this phase,
    you collect as much information as you can about the target organization. After
    getting to know the target organization, it will be easier when we want to attack
    the target. The great Chinese strategist Sun Tzu stated very succinctly the overall
    intent of OSINT and information gathering:'
  prefs: []
  type: TYPE_NORMAL
- en: '"Know yourself, know your enemy, and you shall win a hundred battles without
    loss."'
  prefs: []
  type: TYPE_NORMAL
- en: This saying can't be more true than in penetration testing.
  prefs: []
  type: TYPE_NORMAL
- en: We described several tools included in Kali Linux that can be used for information
    gathering. We started by listing several public websites that can be used to gather
    information about the target organization. Next, we described how to use tools
    to collect domain registration information. Then, we described tools that can
    be used to get DNS information. Later on, we explored tools for collecting routing
    information. In the final part of the chapter, we described automated tools, including
    the impressive search engine for hackers, Shodan.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will discuss how to discover a target via scanning,
    as well as how to evade detection.
  prefs: []
  type: TYPE_NORMAL
- en: Questions
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Lets try to answer some questions now:'
  prefs: []
  type: TYPE_NORMAL
- en: What does the abbreviation OSINT stand for?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: What tools can be used to query domain registration information?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: What does the A record represent?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: What tool utilizes the Google search engine to gather metadata for documents
    in the target domain?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: What are two automated information gathering tools?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: What tool can be used to find information about devices across the internet?
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Further reading
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'You can also find more information on the topics discussed at the following
    reference links:'
  prefs: []
  type: TYPE_NORMAL
- en: OSINT resources: [http://osintframework.com/](http://osintframework.com/)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Maltego user guides and documentation: [https://www.paterva.com/web7/docs.php](https://www.paterva.com/web7/docs.php)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Google Cheat Sheet: [http://www.googleguide.com/print/adv_op_ref.pdf](http://www.googleguide.com/print/adv_op_ref.pdf)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Shodan for penetration testers: [https://www.defcon.org/images/defcon-18/dc-18-presentations/Schearer/DEFCON-18-Schearer-SHODAN.pdf](https://www.defcon.org/images/defcon-18/dc-18-presentations/Schearer/DEFCON-18-Schearer-SHODAN.pdf)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
