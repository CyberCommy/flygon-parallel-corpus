- en: Understanding Network Scanning Tools
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this chapter, we will cover the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Introducing Nessus and Nmap
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Installing and activating Nessus
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Downloading and installing Nmap
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Updating Nessus
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Updating Nmap
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Removing Nessus
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Removing Nmap
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Introducing Nessus and Nmap
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section, we will learn about the various features available in Nmap
    and Nessus. This helps the user to fully understand the tools and their capabilities
    before using them.
  prefs: []
  type: TYPE_NORMAL
- en: Useful features of Nessus
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The default screen on the Nessus web interface, Scans, is shown in the following
    screenshot; this is where you can see all the scans that you have scheduled/performed.
    In the top right, you can toggle between the Scans and Settings pages. Next, we
    will look into the scans interface:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/f8272db5-ae83-4598-91c9-30df3268a510.png)'
  prefs: []
  type: TYPE_IMG
- en: The left pane of the Nessus default screen displays multiple tabs classified
    into folders and resources. The folders are basically different views of scans
    present on the server. For example, selecting the Trash shows the scans that have
    been deleted by the user. You can further clear the trash by selecting the Clear
    trash option at the top right of the `Trash` folder.
  prefs: []
  type: TYPE_NORMAL
- en: 'Resources are one of the most important options, on the basis of which Nessus
    runs its scans. There are three options visible in the resources pane:'
  prefs: []
  type: TYPE_NORMAL
- en: Policies
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Plugin Rules
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Scanners
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Policies
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In order to perform a Nessus scan, you will have to create a policy. A policy
    is a collection of various configurations, methods, and types of scans being performed.
    Multiple scans can use one policy, but only one policy applies per scan. A user
    can import a previously created policy, which is stored in the `.nessus` format,
    or click Create a new policy. Once a user chooses to create a policy, they are
    presented with various policy templates present in Nessus, based on the test cases
    to be performed on the hosts. The following are the lists of various policy templates
    provided by Nessus:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/24352d93-0f0c-49e4-bf73-1f3ea47fed73.png)'
  prefs: []
  type: TYPE_IMG
- en: These templates consist of a range of configurations required to perform scans
    ranging from generic to attack specific. Out of the 21 displayed in the screenshot,
    we will look into a few templates to understand the composition and working of
    a policy.
  prefs: []
  type: TYPE_NORMAL
- en: We will look at the contents of a policy template in [Chapter 4](b002e523-36b9-4c82-9caf-3b0d983abe45.xhtml),
    *Vulnerability Scanning.*
  prefs: []
  type: TYPE_NORMAL
- en: Plugin Rules
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The plugin rules allow the user to hide or change the risk rating provided by
    Nessus; this will allow the analyst performing a scan on large numbers of hosts
    to configure plugins to lower risk ratings for which they have applied workarounds.
    This will reduce a lot of manual efforts.
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/f618edb0-a18f-44ee-9d35-f2392398c999.png)'
  prefs: []
  type: TYPE_IMG
- en: Customized Reports
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'This option allows the user to customize or personalize the report for a specific
    organization or client by uploading and adding a logo to the report:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/3df48a33-ed84-4699-808f-373e945763b4.png)'
  prefs: []
  type: TYPE_IMG
- en: Scanners
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The scanners tab displays the number of scanners available for scan and their
    details. Adding a scanner is not an option in Nessus Home and Professional versions,
    but can be added in Nessus Security Center:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/acc6c49f-44ed-4be3-854f-69fcc9502735.png)'
  prefs: []
  type: TYPE_IMG
- en: Click on the Settings to display the settings menu. Next, we will discuss the
    details of various options available in the settings menu.
  prefs: []
  type: TYPE_NORMAL
- en: 'In the preceding section, the overview tab provides a tool overview such as
    license information, plugin information, and so on; we will have a look at the
    use of the Software Update tab in the *Updating Nessus* recipe:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Master Password**: Nessus provides an option to encrypt all the scan policies
    and credentials used in the policies using a master password as an extra layer
    of protection at the file level. You can find this as part of the **Settings **menu
    in the web console:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/4bcd009a-5c54-41bd-a42a-773bf09e0fe7.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Proxy Server**: A proxy server is required to connect multiple networks by
    forwarding requests and responses without any changes. You can add a proxy server
    in Nessus, if you require one in your network, in order for the Nessus to reach
    the hosts to be scanned. You can find the Proxy Server option as a part of the
    Settings menu, as shown here:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/7fd8f443-67e6-43f7-9125-2b5b6f097e56.png)'
  prefs: []
  type: TYPE_IMG
- en: '**SMTP Server**: A **Simple Mail Transfer Protocol **(**SMTP**) server is required
    to send emails. Nessus provides the option for an email notification once the
    scans are complete. You can configure an SMTP server so that Nessus will be able
    to use this mail server to send notification emails. The SMTP configuration option
    can be found as a part of the settings menu, shown as follows:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/3bb1e194-0f4c-4bcd-aef6-989424055a0e.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Custom CA**: Nessus, by default, uses a certificate signed while its installation
    for web based access in order for the browser to trust the certificate and negate
    all the certificate errors. Nessus provides an option to save a custom CA. The Custom
    CA option can be found as part of the Settings menu, shown as follows:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/309b9c16-11d6-4783-8147-ca4398f5071e.png)'
  prefs: []
  type: TYPE_IMG
- en: '**Password Management**: Default and weak passwords are one of the most commonly
    found vulnerabilities in a system, so in order to secure the Nessus console from
    unauthorized access, we need to configure strong passwords. For an admin to ensure
    strong password usage, Nessus provides a password management option with which
    an admin can configure parameters such as password complexity, session timeout,
    maximum login attempts, and minimum password length. These can be used to secure
    the Nessus console from password and session-related attacks. Password management
    options can be found in the Settings menu, shown as follows:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/acfbfe36-cab4-455a-9d3a-d7bc109ae10c.png)'
  prefs: []
  type: TYPE_IMG
- en: Various features of Nmap
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'There are various phases involved in performing a network scan using Nmap.
    These steps can be defined by various options provided by the Nmap utility. A
    user can pick any of these options, as per their requirements, to obtain specific
    network scan results. The following are the options provided by the Nmap utility:'
  prefs: []
  type: TYPE_NORMAL
- en: Host discovery
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Scan techniques
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Port specification and scan order
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Service or version detection
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Script scan
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: OS detection
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Timing and performance
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Evasion and spoofing
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Output
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Target specification
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Host discovery
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A network comprises many hosts based on the subnet provided. For example, a
    subnet with a mask value of 27 will have 32 hosts, whereas a subnet with a mask
    value of 24 will have 256 hosts. A full port scan on 256 hosts, without knowing
    which of those hosts are live, could take a lifetime. In order to reduce the traffic
    generated and processed by Nmap we can filter the network hosts based on live
    and non-live hosts. This will allow Nmap to reduce unwanted analysis and obtain
    results quicker.
  prefs: []
  type: TYPE_NORMAL
- en: Scan techniques
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Nmap provides various scan technique options based on the type of packets to
    be generated, depending on its varied nature and the protection mechanisms used
    in the network. These techniques construct the packet with different header values
    to obtain ACK or RST packets, based on which the nature of the port is decided
    and displayed. As mentioned earlier, some of these scan types are used to evade
    detection and ensure the anonymity of the user within the network.
  prefs: []
  type: TYPE_NORMAL
- en: Port specification and scan order
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: By default, if the range of ports to be scanned is not stipulated, Nmap scans
    the top 1,000 most commonly used ports, that is, ports that are found open most
    often across networks. These scan options allow the user to specify which ports
    are to be scanned and the order in which they are to be scanned.
  prefs: []
  type: TYPE_NORMAL
- en: Service or version detection
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Nmap has a database of about 2,200 well-known services. Once the ports are detected
    to be open, these options can be used to identify the exact type and version of
    the service running. Nmap does this by querying these ports with specific requests
    and analyzes the responses received.
  prefs: []
  type: TYPE_NORMAL
- en: Script scan
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Nmap has a script engine, a particularly powerful feature of the program, which
    allows the user to either write or use the already available scripts to perform
    specific tasks on the open ports by passing arguments to these scripts.
  prefs: []
  type: TYPE_NORMAL
- en: OS detection
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Nmap's OS detection option helps the user to identify the operating system used
    by the remote host. This will help the user to further create target-specific
    actions and troubleshoot future compatibility issues. Nmap identifies the operating
    system using the TCP/UDP stack fingerprinting mechanism.
  prefs: []
  type: TYPE_NORMAL
- en: Timing and performance
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Nmap provides multiple options with which a user can define multiple scan parameters
    pertaining to time, such as rate, timeout, and parallelism. This will allow the
    user to configure the scan to obtain results faster, thus increasing the performance
    of the scan when scanning multiple hosts and networks.
  prefs: []
  type: TYPE_NORMAL
- en: Evasion and spoofing
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: There are many network security solutions today, such as firewalls and IDS/IPS,
    which can block the network traffic generated by Nmap. Nmap provides options such
    as fragmentation, decoy scans, spoofing, and proxy to evade these network security
    solutions and successfully complete the scans and obtain results.
  prefs: []
  type: TYPE_NORMAL
- en: Output
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Nmap not only is a powerful scanning tool, but also has a powerful reporting
    mechanism. It provides comprehensive reports in multiple formats that display
    output in XML and text formats.
  prefs: []
  type: TYPE_NORMAL
- en: Target specification
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Nmap provides multiple target specification options with which a user can mention
    subnets, individual IPs, IP ranges, and IP lists to be scanned. This will allow
    the user to scan specific hosts identified from the host discovery.
  prefs: []
  type: TYPE_NORMAL
- en: 'A sample complete syntax of Nmap is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: As per the user requirements, once the required options and arguments are provided,
    the user can perform the scan and obtain the output. We will look at recipes on
    how to perform network scans using Nmap in the next chapter.
  prefs: []
  type: TYPE_NORMAL
- en: As a part of this chapter, we will be covering recipes on how to choose the
    correct software version for both Nmap and Nessus, along with their installation
    and removal. These recipes are to help a new audience understand the requirements,
    as well as how they change from platform to platform.
  prefs: []
  type: TYPE_NORMAL
- en: Installing and activating Nessus
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Nessus is a vulnerability scanner developed by Tenable Network Security. It
    scans hosts and subnets for network-level and service-level vulnerabilities. Nessus
    is available free of charge with restricted features for non-business users. It
    consists of two main components: NessusD (Nessus Daemon), and a client application
    that can be hosted on the same machine. Nessus Daemon is responsible for performing
    the scan and delivering the result to the client application, providing these
    results in various formats. Tenable also develops incremental updates and detection
    mechanisms, called plugins, which can be downloaded and updated regularly. It
    also provides additional probing functionality of known vulnerabilities; for example,
    if an FTP port is found to be open, Nessus will automatically try to log in using
    the `anonymous` user. Nessus has both a command line and web interface, but we
    will be mostly looking into the GUI-based web interface, due to its ease of use.'
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The requirements for Nessus vary for the different components present in it,
    as well as the type of license available and its usage.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following table depicts the Nessus hardware requirements:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Scenario** | **Minimum recommended hardware** |'
  prefs: []
  type: TYPE_TB
- en: '| Nessus scanning up to 50,000 hosts | **CPU**: 4 x 2 GHz cores**Memory**:
    4 GB RAM (8 GB RAM recommended)**Disk space**: 30 GB |'
  prefs: []
  type: TYPE_TB
- en: '| Nessus scanning more than 50,000 hosts | **CPU**: 8 x 2 GHz cores**Memory**:
    8 GB RAM (16 GB RAM recommended)**Disk space**: 30 GB (additional space may be
    needed for reporting) |'
  prefs: []
  type: TYPE_TB
- en: '| Nessus Manager with up to 10,000 agents | **CPU**: 4 x 2 GHz cores**Memory**:
    16 GB RAM**Disk space**: 30 GB (additional space may be needed for reporting)
    |'
  prefs: []
  type: TYPE_TB
- en: '| Nessus Manager with up to 20,000 agents | **CPU**: 8 x 2 GHz cores**Memory**:
    64 GB RAM**Disk space**: 30 GB (additional space may be needed for reporting)
    |'
  prefs: []
  type: TYPE_TB
- en: 'Nessus Agents: This is designed to consume less memory, as the process is low
    priority and yields to the CPU whenever asked. Nessus Agents can be installed
    on a virtual machine that meets the requirements specified in the following table:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '| **Hardware** | **                           Minimum requirement** |'
  prefs: []
  type: TYPE_TB
- en: '| Processor | 1 dual-core CPU |'
  prefs: []
  type: TYPE_TB
- en: '| Processor speed | < 1 GHz |'
  prefs: []
  type: TYPE_TB
- en: '| RAM | < 1 GB |'
  prefs: []
  type: TYPE_TB
- en: '| Disk space | < 1 GB |'
  prefs: []
  type: TYPE_TB
- en: '| Disk speed | 15-50 IOPS |'
  prefs: []
  type: TYPE_TB
- en: 'Virtual machines: Nessus Agents supports the following versions of macOS, Linux,
    and Windows operating systems:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '| **Operating system** | **Supported versions (Nessus Agents)** |'
  prefs: []
  type: TYPE_TB
- en: '| Linux | Debian 7, 8, and 9 - i386Debian 7, 8, and 9 - AMD64Red Hat ES 6/CentOS
    6/Oracle Linux 6 (including Unbreakable Enterprise Kernel) - i386Red Hat ES 6/CentOS
    6/Oracle Linux 6 (including Unbreakable Enterprise Kernel) - x86_64Red Hat ES
    7/CentOS 7/Oracle Linux 7 - x86_64Fedora 24 and 25 - x86_64Ubuntu 12.04, 12.10,
    13.04, 13.10, 14.04, and 16.04 - i386Ubuntu 12.04, 12.10, 13.04, 13.10, 14.04,
    and 16.04 - AMD64 |'
  prefs: []
  type: TYPE_TB
- en: '| Windows | Windows 7, 8, and 10 - i386Windows Server 2008, Server 2008 R2,
    Server 2012, Server 2012 R2, Server 2016, 7, 8, and 10 - x86-64 |'
  prefs: []
  type: TYPE_TB
- en: '| macOS X | macOS X 10.8 - 10.13 |'
  prefs: []
  type: TYPE_TB
- en: 'Nessus Manager supports the following versions of macOS, Linux, and Windows
    operating systems:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Operating System** | **Supported Versions (Nessus Manager)** |'
  prefs: []
  type: TYPE_TB
- en: '| Linux | Debian 7, 8, and 9/Kali Linux 1, 2017.1, and Rolling - i386Debian
    7, 8, and 9/Kali Linux 1, 2017.1, and Rolling - AMD64Red Hat ES 6/CentOS 6/Oracle
    Linux 6 (including Unbreakable Enterprise Kernel) - i386Red Hat ES 6/CentOS 6/Oracle
    Linux 6 (including Unbreakable Enterprise Kernel) - x86_64Red Hat ES 7/CentOS
    7/Oracle Linux 7 (including Unbreakable Enterprise Kernel) - x86_64FreeBSD 10
    and 11 - AMD64Fedora 24 and 25 - x86_64SUSE 11 and 12 Enterprise - i586SUSE 11
    and 12 Enterprise - x86_64Ubuntu 12.04, 12.10, 13.04, 13.10, 14.04, and 16.04
    - i386Ubuntu 12.04, 12.10, 13.04, 13.10, 14.04, and 16.04 - AMD64 |'
  prefs: []
  type: TYPE_TB
- en: '| Windows | Windows 7, 8, and 10 - i386Windows Server 2008, Server 2008 R2,
    Server 2012, Server 2012 R2, Server 2016, 7, 8, and 10 - x86-64 |'
  prefs: []
  type: TYPE_TB
- en: '| macOS X | macOS X 10.8 - 10.13 |'
  prefs: []
  type: TYPE_TB
- en: 'Browsers: Nessus supports the following browsers:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Google Chrome (50 and above)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Apple Safari (10 and above)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Mozilla Firefox (50 and above)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Internet Explorer (11 and above)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'PDF reports: The Nessus `.pdf` report generation feature requires the latest
    version of Oracle Java or OpenJDK. Install Oracle Java or OpenJDK prior to installing
    Nessus.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How to do it …
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Perform the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Download the applicable Nessus installation file from [https://www.tenable.com/downloads/nessus](https://www.tenable.com/downloads/nessus),
    making sure to choose the correct file for the operating system in use.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: For a 64-bit Windows operating system, download Nessus-7.1.3-x64.msi.
  prefs: []
  type: TYPE_NORMAL
- en: 'Register and obtain an activation code from [https://www.tenable.com/downloads/nessus](https://www.tenable.com/downloads/nessus).
    A sample email with the Nessus activation code is shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/f5ea04ae-e34a-4398-a6c0-d9b46822de1c.png)'
  prefs: []
  type: TYPE_IMG
- en: Install the downloaded `.msi` file by following the instructions.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Nessus requires you to create an admin user during the installation process,
    as follows:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/57db9c2b-81fb-4625-aab0-bb183367738c.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Insert the activation code received in the email from Tenable, as shown here:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/e69ded4d-b1a0-4e6a-8c31-a9d4ddd002ca.png)'
  prefs: []
  type: TYPE_IMG
- en: Ensure that the system is connected to the internet so that Nessus can auto-download
    plugins from its server.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works…
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Once the user downloads and installs the executable file on the Windows operating
    system, the Nessus software can be accessed on a web interface on localhost at
    port `8834`. In order for the installation to be completed, Nessus requires an
    activation code which can be obtained by registering on the Tenable website and
    providing some of your details. Once the key is obtained over email, you need
    to enter the activation code based on the usage and click Continue to be able
    to finish the installation by downloading plugins. Whenever a new vulnerability
    is identified, Tenable creates programs and scripts to identify these vulnerabilities.
    These scripts and programs are called plugins, written in **Nessus Attack Scripting
    Language** (**NASL**). These plugins are to be updated regularly to ensure that
    the Nessus scan has not left out any recently uncovered vulnerability. A typical
    plugin consists of vulnerability related information, such as a description, impact,
    remediation, and also some vulnerability metrics, such as CVSS and CVE.
  prefs: []
  type: TYPE_NORMAL
- en: 'With a machine connected to the internet, if you are using the Nessus browser
    interface for installation, the download of the plugins is an automatic process.
    You should see a plugin download screen once you have registered a license with
    Nessus. If installing Nessus offline, you will have to manually download the plugins
    from the custom-generated link once you have registered the license with Nessus.
    Download the plugins and extract the ZIP or TAR folder into the following directories,
    based on the operating system you are using:'
  prefs: []
  type: TYPE_NORMAL
- en: 'In Linux, install to the following directory:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'In FreeBSD, install to the following directory:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'In macOS X, install to the following directory:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: In Windows, install to the following directory: `C:\Program Files\Tenable\Nessus`
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Once you extract the package, you can use the following commands to install
    these plugins based on the operating system in use:'
  prefs: []
  type: TYPE_NORMAL
- en: 'In Linux, use the following command:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'In FreeBSD, use the following command:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'In macOS X, use the following command:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 'In Windows, use the following command: `C:\Program Files\Tenable\Nessus>nessuscli.exe
    update <tar.gz filename>`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: There's more…
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'If you have any issues in connecting to the internet, you can choose to activate
    offline, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/96109434-7b4c-4c92-90dd-961851ca8e77.png)'
  prefs: []
  type: TYPE_IMG
- en: 'In order for the Nessus to be activated offline, a challenge code is displayed
    on your local browser where the Nessus instance is running, or can be displayed
    manually by using the following commands:'
  prefs: []
  type: TYPE_NORMAL
- en: 'On Linux, use the following command:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'On FreeBSD, use the following command:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: 'On macOS X, use the following command:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: 'On Windows, use the following command:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: The preceding commands are configured to the default installation directory.
    Change the directory to the location where Nessus is installed on your machine.
  prefs: []
  type: TYPE_NORMAL
- en: 'You can copy this challenge code onto a machine where the internet is available,
    and generate a license using the offline module on the Nessus website at [https://plugins.nessus.org/v2/offline.php](https://plugins.nessus.org/v2/offline.php),
    and generate a license string. This license string can be used on the machine,
    in either the browser or offline mode, using the following commands:'
  prefs: []
  type: TYPE_NORMAL
- en: 'On Linux, use the following command:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: 'On FreeBSD, use the following command:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: 'On macOS X, use the following command:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: 'On Windows, use the following command:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: Downloading and installing Nmap
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Nmap is a free and open source network scanning and audit tool available at
    [https://Nmap.org/](https://nmap.org/). This tool is one of the most important
    components of a network-level security audit, as it allows the user to monitor
    or observe the network-level posture of a host by providing data about open ports
    and services running on these ports. The Nmap tool also allows interaction with
    these services and the running of various scripts using Nmap Script Engine (NSE). The
    following command is the syntax to perform TCP syn full port scanning on the host `127.0.0.1`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: We will be looking into recipes for the usage of the Nmap tool in further chapters.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Nmap is available in various versions and formats based on the architecture
    and operating system supported by the user machine. Nmap also has a GUI version,
    called Zenmap, which provides better visibility of the options to select the commands
    to run. It is also available as a default tool as a part of operating systems
    used for exploitation and hacking techniques, such as Kali Linux. A user can choose
    the type or the version of Nmap based on their machine's configuration; for example,
    I am using a Windows 7 64-bit operating system, so I will choose the latest stable
    version of the executable that supports the 64-bit Windows 7 operating system.
    If you are using a 64-bit Linux or Unix distribution, there are rpm binary packages
    available for download at [https://Nmap.org/](https://nmap.org/).
  prefs: []
  type: TYPE_NORMAL
- en: How to do it…
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Perform the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Download the applicable Nmap version from [http://www.Nmap.org/download.html](http://www.nmap.org/download.html).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Right click on the downloaded file and select Run as administrator. This is
    required to ensure that the tool has all the privileges to be installed properly
    on your machine.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'After this, you will be shown an open source license agreement. Read the agreement
    and click on I agree, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/9d2aed0f-1d94-4634-855b-c2f7eb69cecc.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Choose various components to be installed as a part of the Nmap package. These
    utilities provide more functionality, such as packet generation and comparison.
    If you feel no need for these extra utilities, you can uncheck the feature, as
    in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/afefabee-2e22-401e-a0c7-a4fe4229ab79.png)'
  prefs: []
  type: TYPE_IMG
- en: Select the location at which you want to install the tool. The tool suggests
    the `C:\Program Files (x86)\Nmap\` path by default. Click Next.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The installation requires Npcap, the packet sniffing library of Windows for
    Nmap. Follow the instructions to install the Npcap to continue the installation
    of the Nmap and wait for the installation to finish.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: How it works…
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Once the installation is finished, open Command Prompt and type `Nmap`. If
    the Nmap tool is correctly installed, it should load the usage instructions of
    Nmap, shown as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/ec9b1227-1a5d-4d44-90c1-4ede64fcf1c9.png)'
  prefs: []
  type: TYPE_IMG
- en: There's more…
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Installing Nmap on a Linux distribution is a different process. Most of the
    Linux-based operating systems have a single-step installation, using the package
    management utilities such as `yum` and `apt`.
  prefs: []
  type: TYPE_NORMAL
- en: 'Ensure that the machine is connected to the internet and execute the following
    commands:'
  prefs: []
  type: TYPE_NORMAL
- en: 'On CentOS, use the following command:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: 'On Debian or Ubuntu, use the following command:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: Updating Nessus
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Nessus can be updated either manually, or by scheduling automatic updates. The
    software update option can be found as a part of the Settings menu. This can be
    used to schedule daily, weekly, or monthly updates for Nessus software or even
    just the plugins. By default, Nessus uses its cloud server to download and install
    the updates, but you can also configure a custom server to download these updates.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: You can update Nessus while connected to the internet or offline. If you want
    a hassle-free update or a quick one, you can ensure that the system is connected
    to the internet.
  prefs: []
  type: TYPE_NORMAL
- en: However, in order to update Nessus offline, you will have to download the update
    package from the Nessus website.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it…
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Navigate to Settings, then Software Update from the home page:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/149f6e69-6911-4c85-b752-12c4211dd091.png)'
  prefs: []
  type: TYPE_IMG
- en: Choose the update frequency: Daily,Weekly, or Monthly.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Provide the server details if you have any internal or external servers from
    which you want Nessus to fetch updates.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Save the settings and they will be automatically applied.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'In order to manually install the update, navigate to Settings, then Software
    Update, then Manual Software Update, as follows:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/3f50f265-2586-4e22-ad60-a00bbb57a6c2.png)'
  prefs: []
  type: TYPE_IMG
- en: Select Update all components or Update plugins to instantly trigger an update.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If the machine is not connected to the internet, you can download the update
    package from the Tenable website and update it by selecting the option **Upload
    your own plugin archive**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: There's more…
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Nessus has an evaluation license with a restriction on the number of IP addresses
    that you can scan, and a full license, bought for a certain length of time and
    without any restrictions on the number of IP addresses one can scan. A fully licensed
    version of Nessus is available at approximately $2,500 per scanner on the Nessus
    website:'
  prefs: []
  type: TYPE_NORMAL
- en: Select the Edit option next to the Activation Code.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the box displayed, select the type of Nessus in use.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In the **Activation Code** box, type your new activation code.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select **Activate**.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Once done, Nessus downloads the plugins required and installs them automatically.
  prefs: []
  type: TYPE_NORMAL
- en: Updating Nmap
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The most straightforward way to update Nmap is to download the latest available
    version of the software and manually install the package.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Download the latest stable version from [https://Nmap.org/download.html/](https://nmap.org/download.html),
    making sure to choose the right version for the current operating system in use.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it…
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Perform the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Right-click on the downloaded file and select Run as administrator. This is
    required to ensure that the tool has all the privileges to be installed properly
    on your machine.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'After this, you will be shown an open source license agreement. Read the agreement
    and click on I agree, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/99a6d7ff-3d3e-4cee-bb9a-535e7f3babbb.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Choose which of the various components will be installed as a part of the Nmap
    package. These utilities provide additional functionality, such as packet generation
    and comparison. If you feel no need for these extra utilities, you can uncheck
    the features, as in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/b3cf1df8-f754-4862-a1b0-9e214ae56efe.png)'
  prefs: []
  type: TYPE_IMG
- en: Select the location where you want to install the tool. `C:\Program Files (x86)\Nmap\` is
    the default path suggested by the tool. Then click Next.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The installation requires Npcap. This is the packet sniffing library of Windows
    for Nmap. Follow the instructions to install the Npcap and to continue the installation
    of the Nmap; wait for the installation to finish.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Removing Nessus
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Removing the Nessus software is similar to removing Nmap. Once done, the port
    on which the service was running will be free and you will no longer be able to
    access the web interface.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The steps to remove Nessus vary from platform to platform. Before uninstalling
    Nessus, you may wish to back up all your policies and scan data by exporting them
    in the required format; for example, NessusDB.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it…
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Follow these steps to uninstall Nessus on Windows:'
  prefs: []
  type: TYPE_NORMAL
- en: Navigate to the **Control Panel** on a Windows machine
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select **Uninstall or change a program**
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Locate and select the Nessus package in the list of software installed
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click **Uninstall**
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: This will uninstall the Nessus software and its data from any Windows machine.
  prefs: []
  type: TYPE_NORMAL
- en: There's more…
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Uninstalling Nessus on Linux is done as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: 'In order to determine the package name of Nessus, which is to be uninstalled,
    use the following commands for the different platforms:'
  prefs: []
  type: TYPE_NORMAL
- en: 'In Open Red Hat, CentOS, Oracle Linux, Fedora, SUSE, or FreeBSD, use the following
    command:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: 'In OpenDebian/Kali and Ubuntu, use the following command:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: 'In OpenFreeBSD, use the following command:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE20]'
  prefs: []
  type: TYPE_PRE
- en: 'Use the package info obtained from the preceding commands as the input to the
    following package removal commands for the respective platforms:'
  prefs: []
  type: TYPE_NORMAL
- en: 'In Open Red Hat, CentOS, Oracle Linux, Fedora, or SUSE, this looks as follows:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE21]'
  prefs: []
  type: TYPE_PRE
- en: 'In Open Debian/Kali and Ubuntu, this looks as follows:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE22]'
  prefs: []
  type: TYPE_PRE
- en: 'In Open FreeBSD, this looks as follows:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE23]'
  prefs: []
  type: TYPE_PRE
- en: 'Remove the Nessus directory to delete any other files present using the commands
    mentioned here:'
  prefs: []
  type: TYPE_NORMAL
- en: 'In Open Linux, use the following command:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE24]'
  prefs: []
  type: TYPE_PRE
- en: 'In Open FreeBSD, use the following command:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE25]'
  prefs: []
  type: TYPE_PRE
- en: If you face any issues during the removal of Nessus, stop the Nessus daemon
    and try removing the files again.
  prefs: []
  type: TYPE_NORMAL
- en: 'Perform the following steps to uninstall Nessus on macOS:'
  prefs: []
  type: TYPE_NORMAL
- en: Navigate to **System Preferences** and select **Nessus**
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the **lock** option
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Enter the username and password
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select the **Stop Nessus** button
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Remove the following Nessus directories, subdirectories, or files:'
  prefs: []
  type: TYPE_NORMAL
- en: '`/Library/Nessus`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/Library/LaunchDaemons/com.tenablesecurity.nessusd.plist`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/Library/PreferencePanes/Nessus Preferences.prefPane`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/Applications/Nessus`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Removal of these files will ensure that the software is completely uninstalled
    from the machine.
  prefs: []
  type: TYPE_NORMAL
- en: Removing Nmap
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The uninstallation process of Nmap is pretty straightforward on both Windows
    and Linux. This will remove all the dependencies and libraries that have been
    installed by Nmap.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it…
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Follow these steps to uninstall Nmap on Windows:'
  prefs: []
  type: TYPE_NORMAL
- en: Navigate to the **Control Panel** of the Windows machine
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Select **Uninstall or change a program**
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Locate and select the Nmap package in the list of software installed
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click **Uninstall**
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: This will uninstall the Nmap software and its data from any Windows machine.
  prefs: []
  type: TYPE_NORMAL
- en: There's more…
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In Linux-based distributions, you can simply delete all the folders pertaining
    to Nmap to uninstall Nmap from your machine. If you have installed Nmap from a
    downloaded source, there will exist an uninstallation script in the same folder
    that will uninstall Nmap from your machine. Furthermore, if it was installed in
    the default location, it can be removed using the following commands:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE26]'
  prefs: []
  type: TYPE_PRE
