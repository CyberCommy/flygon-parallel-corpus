- en: Information Gathering
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the last chapter, we discussed the scoping and planning of a vulnerability
    management program. This chapter is about learning various tools and techniques
    for gathering information about the target system. We will learn to apply various
    techniques and use multiple tools to effectively gather as much information as
    possible about the targets in scope. The information gathered from this stage
    would be used as input to the next stage.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we will cover the following topics:'
  prefs: []
  type: TYPE_NORMAL
- en: Defining information gathering
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Passive information gathering
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Active information gathering
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: What is information gathering?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Information gathering is the first step toward the actual assessment. Before
    targets are scanned using vulnerability scanners, testers should know more details
    about the assets in the scope of the testing. This will help the testing team
    to prioritize assets for scanning.
  prefs: []
  type: TYPE_NORMAL
- en: Importance of information gathering
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '"Give me six hours to chop down a tree and I will spend the first four sharpening
    the axe."'
  prefs: []
  type: TYPE_NORMAL
- en: This is a very old and famous quote by Abraham Lincoln. The same applies to
    the amount of time spent in gathering as much information as possible prior to
    performing any security assessment. Unless, and until, you know your target inside
    and out, you will never succeed in performing its security assessment. It's crucial
    to have a 360-degree view of the target and gather all possible information about
    it through all available sources.
  prefs: []
  type: TYPE_NORMAL
- en: 'Once you are confident that you have gathered enough information, then you
    can very effectively plan the actual assessment. Information gathering can be
    of two types, as discussed in the following sections: passive information gathering
    and active information gathering.'
  prefs: []
  type: TYPE_NORMAL
- en: Passive information gathering
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Passive information gathering is a technique where no direct contact with the
    target is made for gathering the information. All the information is obtained
    through an intermediate source which may be publicly available. The internet has
    many useful resources that can help us with passive information gathering. Some
    such techniques are discussed next.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following diagram describes how passive information gathering works:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/4989e0fd-2dde-459f-92b6-d46ccbf856e1.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Here is how it works:'
  prefs: []
  type: TYPE_NORMAL
- en: The client system first sends a request to an intermediate system
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The intermediate system probes the target system
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The target system sends the result back to the intermediate system
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The intermediate system forwards it back to the client
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: So, there's no direct contact between the client and the target system. Hence,
    the client is partially anonymous to the target system.
  prefs: []
  type: TYPE_NORMAL
- en: Reverse IP lookup
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Reverse IP lookup is a technique that is used to probe any given IP address
    for all the domains it hosts. So all you need to do is feed the target IP address
    and then you'll be returned to all the domains hosted on that IP address. One
    such tool for reverse IP lookup is available online at [http://www.yougetsignal.com/tools/web-sites-on-web-server/](http://www.yougetsignal.com/tools/web-sites-on-web-server/).
  prefs: []
  type: TYPE_NORMAL
- en: Reverse IP lookup works only on Internet-facing websites and isn't applicable
    for sites hosted on intranet.
  prefs: []
  type: TYPE_NORMAL
- en: Site report
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Once you have the target domain, you can get a lot of useful information about
    the domain, such as its registrar, name-server, DNS admin, the technology used,
    and so on. Netcraft, available at [http://toolbar.netcraft.com/site_report](http://toolbar.netcraft.com/site_report),
    is a very handy tool to fingerprint domain information online:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/33cf052d-e084-498f-8141-10d27c8f8589.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Site archive and way-back
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'It''s very common indeed for any given site to undergo changes at regular intervals.
    Normally, when a site is updated, there''s no way for the end users to see its
    previous version. However, the site [https://archive.org/](https://archive.org/)
    takes you to the past version of a given site. This may reveal some information
    that you were looking for but that wasn''t present in the latest version of the
    site:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/23682cd4-0ad3-49ab-80b9-7ed1aeba195a.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Site metadata
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Getting access to metadata of the target site can provide a lot of useful information.
    The site [http://desenmascara.me](http://desenmascara.me) provides metadata for
    any given target site. The metadata typically includes domain information, header
    flags, and so on, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/1b35359a-f937-4292-b20d-bf8d75b951a7.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Looking for vulnerable systems using Shodan
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Shodan is a search engine that can provide very interesting results from a vulnerability
    exploitation perspective. Shodan can be effectively used for finding weaknesses
    in all internet connected devices, such as webcams, IP devices, routers, smart
    devices, industrial control systems, and so on. Shodan can be accessed at [https://www.shodan.io/.](https://www.shodan.io/)
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot shows the home screen of Shodan. You would need to
    create an account and log in in order to fire search queries:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/d6d70e60-14b0-40db-8133-8ada5c5024e3.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'As shown in the following screenshot, Shodan provides an out-of-the-box Explore option
    that provides search results belonging to the most popular search queries:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/4369fc82-cba1-4f71-b4d6-ac6f80a68ca5.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'The following screenshot shows the search results for online webcams. The search
    results can further be classified based on their geographical location:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/a231e2d6-d514-48cd-81de-2af9a374736f.png)'
  prefs: []
  type: TYPE_IMG
- en: Advanced information gathering using Maltego
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Maltego is an extremely powerful, capable, and specialized information gathering
    tool. By default, it is part of Kali Linux. Maltego has numerous sources through
    which it can gather information for any given target. From a Maltego perspective,
    a target could be a name, email address, domain, phone number, and so on.
  prefs: []
  type: TYPE_NORMAL
- en: You need to register a free account in order to access Maltego.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot shows the Maltego home screen:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/2acb4c8c-b18d-4479-8fc9-4f427bc4a8eb.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The following screenshot shows a sample search result for domain [https://www.paterva.com](https://www.paterva.com).
    A search query is known as a **transform** in Maltego. Once a transform is complete,
    it presents a graph of information obtained. All the nodes of the graph can be
    further transformed as required:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/7e709cbe-a4c3-4d39-8b5e-741cbfd658f8.png)'
  prefs: []
  type: TYPE_IMG
- en: theHarvester
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Having email addresses belonging to the target system/organization can prove
    to be useful during further phases of penetration testing. theHarvester helps
    us gather various email addresses belonging to our target system/organization.
    It uses various online sources for gathering this information. The following screenshot
    shows various parameters of theHarvester:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/bc6e9e9b-1c3b-4560-8228-34d0ee8f27e3.png)'
  prefs: []
  type: TYPE_IMG
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: The preceding syntax would execute `theharvester` on the domain [demo.testfire.net](http://demo.testfire.net) and
    look for up to 20 email IDs using Google as the search engine and then store the
    output in the `output.html` file.
  prefs: []
  type: TYPE_NORMAL
- en: Active information gathering
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Unlike passive information gathering, which involves an intermediate system
    for gathering information, active information gathering involves a direct connection
    with the target. The client probes for information directly with the target with
    no intermediate system in between. While this technique may reveal much more information
    than passive information gathering, there''s always a chance of security alarms
    going off on the target system. Since there''s a direct connection with the target
    system, all the information requests would be logged and can later be traced back
    to the source. The following diagram depicts active information gathering where
    the client is directly probing the target system:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/542f5afd-3091-4df4-81fe-38c4d29a2c08.png)'
  prefs: []
  type: TYPE_IMG
- en: Active information gathering with SPARTA
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'SPARTA is an excellent active information gathering tool. It is part of the
    default Kali setup. The following screenshot shows the home screen of SPARTA.
    In the left pane, you can simply add the IP/host you want to probe:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/3d9279c5-aaaa-43c9-8ba0-ec456b281166.png)'
  prefs: []
  type: TYPE_IMG
- en: Upon feeding the IP/host to SPARTA, it quickly gets into the action by triggering
    various tools and scripts starting with Nmap. It does a quick port scan and goes
    further with service identification. It also provides screenshots of various web
    interfaces the target might be running and, most interestingly, it also automatically
    tries to retrieve passwords for various services running on the target system.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot shows sample results from one of the SPARTA scans:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/b62518f4-daa2-430c-8501-98345f57c5ae.png)'
  prefs: []
  type: TYPE_IMG
- en: Recon-ng
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Recon-ng is an extremely powerful and flexible tool that is capable of performing
    both passive as well as active information gathering. It has got numerous modules
    that can be plugged in and triggered to gather information as required. It functions
    quite similar to Metasploit.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot shows various modules available as part of Recon-ng:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/7a8cebdf-2c44-45f4-8160-75a80a0fe739.png)'
  prefs: []
  type: TYPE_IMG
- en: 'We can select any module of our choice and then execute it, as shown in the
    following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/531deaa9-fb62-48ca-9c08-bce9d4370d3a.png)'
  prefs: []
  type: TYPE_IMG
- en: Recon-ng is really a tool providing a wealth of information about the target
    system. You can explore various modules of Recon-ng to better understand its aspects
    and usability.
  prefs: []
  type: TYPE_NORMAL
- en: Dmitry
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Dmitry is another versatile tool in Kali Linux that is capable of both passive
    as well as active information gathering. It can perform whois lookups and reverse
    lookups. It can also search for subdomains, email addresses, and perform port
    scans as well. It''s very easy to use, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/040c7da3-255e-4993-8e21-661ecd8e9434.png)'
  prefs: []
  type: TYPE_IMG
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: The preceding command performs whois lookup and retrieves site information from
    Netcraft and then writes the output to file `output.txt`.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we learned about the importance of information gathering along
    with various types of information gathering, such as passive and active. We also
    looked at the use of various tools to assist us with the process of information
    gathering.
  prefs: []
  type: TYPE_NORMAL
