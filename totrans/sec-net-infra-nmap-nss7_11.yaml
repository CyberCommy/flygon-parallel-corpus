- en: Security Assessment Prerequisites
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 安全评估先决条件
- en: 'Before we can start working practically with security assessments, there''s
    essentially a lot of groundwork that needs to be done, including planning, scoping,
    choosing the correct tests, resource allocation, test plans, and getting the documentation
    signed and approved. All these prerequisites will help ensure the smooth conduct
    of the security assessment. The topics to be discussed in this chapter are as
    follows:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们可以开始实际进行安全评估之前，实际上需要做很多基础工作，包括规划、范围确定、选择正确的测试、资源分配、测试计划以及获得文件签署和批准。所有这些先决条件将有助于确保安全评估的顺利进行。本章将讨论以下主题：
- en: Target scoping and planning
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 目标范围和规划
- en: Gathering requirements
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 收集需求
- en: Deciding upon the type of vulnerability assessment
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 决定漏洞评估的类型
- en: Estimating the resources and deliverables
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 资源和可交付成果的估算
- en: Preparing a test plan and test boundaries
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 准备测试计划和测试边界
- en: Getting approval and signing NDAs
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 获得批准并签署保密协议
- en: Target scoping and planning
  id: totrans-8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 目标范围和规划
- en: 'Defining and deciding upon a formal scope is one of the most important factors
    of a vulnerability assessment. While there may be a lot of information and guidelines
    available on using various vulnerability assessment tools and techniques, the
    preparation phase of vulnerability assessment is quite often overlooked. Ignoring
    properly complete pre-engagement activities may lead to potential problems, such
    as the following:'
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 定义和决定正式范围是漏洞评估中最重要的因素之一。虽然可能有很多关于使用各种漏洞评估工具和技术的信息和指南，但漏洞评估的准备阶段往往被忽视。忽视充分完成前期活动可能会导致潜在问题，例如以下问题：
- en: Scope creep
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 范围蔓延
- en: Customer dissatisfaction
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 客户不满意
- en: Legal trouble
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 法律问题
- en: The scope of a project is intended to precisely define what is to be tested.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 项目的范围旨在准确定义需要进行测试的内容。
- en: 'Theoretically, it may seem best to test each and every asset present in the
    network; however, it may not be practically possible. A detailed discussion with
    all the business units could help you gather a list of critical assets. These
    assets could then be included in the scope of the vulnerability assessment. Some
    of the common assets included in the vulnerability assessment scope are as follows:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
  zh: 从理论上讲，测试网络中的每个资产似乎是最好的选择；然而，这可能并不实际可行。与所有业务部门进行详细讨论可以帮助您收集关键资产清单。然后，这些资产可以包括在漏洞评估范围内。漏洞评估范围中包括的一些常见资产如下：
- en: Communication lines
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 通信线路
- en: E-commerce platforms
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 电子商务平台
- en: Any internet-facing websites
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 任何面向互联网的网站
- en: Special-purpose devices (modems, radios, and so on)
  id: totrans-18
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 特殊用途设备（调制解调器、无线电等）
- en: Applications and application APIs
  id: totrans-19
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用程序和应用程序API
- en: Email gateways
  id: totrans-20
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 电子邮件网关
- en: Remote access platforms
  id: totrans-21
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 远程访问平台
- en: Mail servers
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 邮件服务器
- en: DNS
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: DNS
- en: Firewalls
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 防火墙
- en: FTP servers
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: FTP服务器
- en: Database servers
  id: totrans-26
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数据库服务器
- en: Web servers
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Web服务器
- en: 'While the preceding list of assets looks quite obvious in regards to candidates
    to be included in the vulnerability assessment scope, there might be a few other
    assets that are often ignored but could open up an entry point for the attacker.
    Such assets include the following:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 在关于应该包括在漏洞评估范围内的候选资产的上述清单中，可能有一些其他经常被忽视但可能为攻击者打开入口的资产。这些资产包括以下内容：
- en: Printers
  id: totrans-29
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 打印机
- en: Wireless access points
  id: totrans-30
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 无线接入点
- en: Shared drives
  id: totrans-31
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 共享驱动器
- en: IP cameras
  id: totrans-32
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: IP摄像头
- en: Smart TVs
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 智能电视
- en: Biometric access control systems
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 生物识别门禁系统
- en: A detailed outline of the scope will help the vulnerability assessment team
    plan resources and a time schedule.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 范围的详细概述将帮助漏洞评估团队规划资源和时间表。
- en: Gathering requirements
  id: totrans-36
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 收集需求
- en: Before we can even think of starting the vulnerability assessment, it is extremely
    important to very clearly understand customer requirements. The customer may be
    internal or external to the organization. For a VA tester, it is important to
    know what the customer is expecting from the test. In order to identify and document
    the customer requirements, the following things need to be done.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 在我们甚至考虑开始漏洞评估之前，非常重要的是非常清楚地了解客户的需求。客户可能是组织内部或外部的。对于VA测试人员来说，了解客户对测试的期望是很重要的。为了识别和记录客户需求，需要完成以下工作。
- en: Preparing a detailed checklist of test requirements
  id: totrans-38
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 准备详细的测试要求清单
- en: 'The tester needs to set up multiple meetings with the customer to understand
    their requirements. The outcome should include but not be limited to the following:'
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 测试人员需要与客户安排多次会议，以了解他们的需求。结果应包括但不限于以下内容：
- en: Security compliance that the customer wants to comply with
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 客户希望遵守的安全合规性清单
- en: Requirements and code of conduct (if any) stated in respective security compliance
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在各自的安全合规性中规定的要求和行为准则（如果有）
- en: List of network segments in scope
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 受范围限制的网络段清单
- en: List of network security devices in scoped network segments
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 受范围限制的网络段中的网络安全设备清单
- en: List of assets to scan (along with IP ranges)
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 要扫描的资产清单（以及IP范围）
- en: List of assets exposed to a public network (along with IP ranges)
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 暴露在公共网络中的资产清单（以及IP范围）
- en: List of assets that have network-wide access (along with IP ranges)
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 具有网络范围访问权限的资产清单（以及IP范围）
- en: List of business-critical assets (along with IP ranges)
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 业务关键资产清单（以及IP范围）
- en: List of acceptable vulnerability assessment tools in the customer environment
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 客户环境中可接受的漏洞评估工具清单
- en: Availability of licenses for tools suggested by customer or accomplice
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 客户或合作伙伴建议的工具的许可证可用性
- en: List of tools that are strictly prohibited in the customer environment
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在客户环境中严格禁止使用的工具清单
- en: Recent vulnerability assessment reports if available
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 最近的漏洞评估报告（如果有）
- en: Suitable time frame and testing hours
  id: totrans-52
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 合适的时间框架和测试时间
- en: Some security compliance demands periodic vulnerability assessments over the
    infrastructure in scope. For example, PCI/DSS demands a half-yearly vulnerability
    assessment for business-critical assets and yearly for noncritical assets that
    are covered under the scope of the PCI/DSS certification.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
- en: The tester and customer need to keep such compliance-driven requirements in
    mind while preparing the schedule for an assessment. At the same time, it's always
    beneficial to consider ongoing and critical changes in an environment that is
    part of the assessment scope. If the time frame enforced by the security compliance
    permits it, it's best to perform the assessment after completing critical changes,
    which will help in providing a long-lasting view of current security posture.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
- en: 'Another interesting part of scheduling and planning in a vulnerability assessment
    is testing hours. Usually, automated scanning profiles are used to perform vulnerability
    assessments and consume lots of network traffic (requests/responses per port per
    host/asset) and may also consume considerable resources on assets/hosts being
    scanned. In rare scenarios, it may happen that a certain asset/host stops responding,
    going into **denial of service** (**DoS**) mode and/or full-closed mode. This
    could happen with the business-critical system as well. Now imagine a business-critical
    system/service not responding to any requests in peak business hours. This could
    impact other services as well, covering a broader user space. This may lead to
    loss of data, reputation, and revenue. Also, it would present a challenge in recovering
    and restoring business functions in such a chaotic scenario. Hence, performing
    vulnerability assessments outside of business hours is always recommended. Advantages
    of doing so would be:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
- en: No extra overhead over the network as there is no usual business/legitimate
    traffic
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Automated scans finishing in comparatively less time as more network bandwidth
    is available
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Implications of vulnerability assessments, if any, can be observed quickly as
    network traffic is already reduced
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Impact and side effects can be treated (restoration/recovery) with ease as a
    risk of business/revenue and reputation loss is minimized to acceptable limits
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: But there could be some exceptions to this approach where the tester needs to
    run assessments in business hours as well. One of the scenarios could be needed
    to assess user workstations for vulnerabilities. As user workstations will be
    available only in business peak hours, only that network segment should be scanned
    in business hours.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
- en: 'To sum up, the outcome of this phase is:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
- en: Business and compliance needs for conducting the vulnerability assessment
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The time frame for conducting the vulnerability assessment (may be enforced
    by some security compliance)
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Business hours and nonbusiness hours
  id: totrans-64
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Testing hours for critical assets and noncritical assets
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Testing hours for end-user workstation list with respective IPs
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Identifying stakeholders
  id: totrans-67
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Vulnerability management has a top-to-bottom approach. The following are the
    stakeholders that might be involved in and/or impacted by the vulnerability assessment:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
- en: '**Executive/top management**: To achieve the desired success in the vulnerability
    assessment program, top management should support the activity by allocating all
    required resources.'
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**IT security head**: This could be dedicated or additional responsibility
    assigned to the competent personnel. Usually, this position directly reports to
    executive/top management, providing a bird''s-eye view of security posture to
    the top management. In order to maintain security compliance, this position leads
    multiple IT security programs run in an organization.'
  id: totrans-70
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**VA lead tester**: This position refers to a subject matter expert who usually
    reports to the IT security head. The VA lead is responsible for:'
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Signing a **Statement of Work** (**SoW**)
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Maintaining an NDA
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Checking for the legal aspects of conducting such tests in a particular environment
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Gathering requirements and defining scope
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Planning vulnerability assessments
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Managing required tools, devices, and the licenses required for the vulnerability
    assessment
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Managing the team and the team activities that are part of the vulnerability
    assessment
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Maintaining a **single point of contact** (**SPOC**) between all stakeholders
    involved in the vulnerability assessment program
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Keeping all stakeholders updated on activities that are part of the vulnerability
    assessment
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Generating and signing an executive summary of the vulnerability assessment
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**VA tester**: VA testers conduct the following activities that are necessary
    to conduct the VA program:'
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Configuring and updating an automated scanner tool/device
  id: totrans-83
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Monitoring automated scans for any disruption or unsolicited impact
  id: totrans-84
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Conducting manual tests
  id: totrans-85
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Conducting **proof of concepts** (**PoCs**)
  id: totrans-86
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Generating detailed reports
  id: totrans-87
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Providing timely updates to the VA lead tester
  id: totrans-88
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Asset owners**: Every service/system/application/network/device that is part
    of a vulnerability assessment is involved in the program. Owners are responsible for
    responding to any disruption that may happen. Owners should be aware of a detailed
    plan of assessment for assets under their ownership and should have restoration
    and recovery plans ready to reduce impact.'
  id: totrans-89
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Third-party service providers**: Ownership of **Commercial Of The Shelf** (**COTS**)
    applications belongs to the respective service providers. If scope demands assessment
    over such COTS assets, involvement of respective third parties is necessary. Recently,
    organizations have been opting for more and more cloud services. Hence, the SPOC
    of the respective cloud service providers needs to be involved in the program
    to ensure the smooth execution of VA.'
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**End users**: Rarely, end users may also be impacted by reparation of the
    VA program.'
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Deciding upon the type of vulnerability assessment
  id: totrans-92
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: After understanding the requirements of the customer, the tester needs to create
    his own test model based on the expectations of the vulnerability management program,
    the environment, past experience, and the exposure that every type provides.
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
- en: The following are the basic types of vulnerability assessment that the tester
    needs to understand.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
- en: Types of vulnerability assessment
  id: totrans-95
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The following diagram provides an overview of the different types of vulnerability
    assessments:'
  id: totrans-96
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/e55e5405-268d-4a63-8c4a-75fc0f804325.png)'
  id: totrans-97
  prefs: []
  type: TYPE_IMG
- en: Types of vulnerability assessment based on the location
  id: totrans-98
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Based on the location the test is conducted from, the vulnerability assessment
    could be divided into two main types:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
- en: External vulnerability assessment
  id: totrans-100
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Internal vulnerability assessment
  id: totrans-101
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: External vulnerability assessment
  id: totrans-102
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'External vulnerability assessment is the best fit for assets exposed over public
    networks hosting public services. It is done from outside the target network and
    thus helps simulate the actual scenario of a real attacker attacking the target.
    The primary intent behind conducting the external vulnerability assessment is
    to uncover potential weaknesses in the security of the target system, as illustrated
    in the following diagram:'
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/7985547e-e21e-4db2-8fd4-f2207e202f5b.png)'
  id: totrans-104
  prefs: []
  type: TYPE_IMG
- en: An external vulnerability assessment is mainly focused on the servers, infrastructure,
    and the underlying software components related to the target. This type of testing
    will involve in-depth analysis of publicly available information about the target,
    a network enumeration phase where all active target hosts are identified and analyzed,
    and the behavior of intermediate security screening devices such as firewalls.
    Vulnerabilities are then identified, verified, and the impact gets assessed. It
    is the most traditional approach to vulnerability assessment.
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
- en: Internal vulnerability assessment
  id: totrans-106
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Internal vulnerability assessment is carried out on assets that are exposed
    to the private networks (internal to the company) hosting internal services. An
    internal vulnerability assessment is primarily conducted to ensure that the network
    insiders cannot gain unauthorized access to any of the systems by misusing their
    own privileges, illustrated as follows:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/b5fade48-e458-401c-8f45-fb14dd4c1922.png)'
  id: totrans-108
  prefs: []
  type: TYPE_IMG
- en: The internal vulnerability assessment is used to identify weaknesses in a particular
    system inside the organization's network. When the vulnerability assessment team
    performs the tests from within the target network, all external gateways, filters,
    and firewalls get bypassed and the tests are targeted directly at the systems
    in scope. The internal vulnerability assessment may involve testing from various
    network segments to check virtual isolation.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
- en: Based on knowledge about environment/infrastructure
  id: totrans-110
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The following are the types of vulnerability assessments that simulate exposure
    from an attacker's point of view, based on the attacker's knowledge of the environment/infrastructure.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
- en: Black-box testing
  id: totrans-112
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the black-box vulnerability assessment approach, the VA tester carries out
    all the tests without having any prior knowledge of the target system. This type
    of test most closely simulates real-world attacks. In an ideal black-box test
    scenario, the VA tester would probably know only the name of the target organization.
    He would have to start gathering information about the target from scratch and
    then gradually build and execute various attack scenarios. This type of testing
    usually takes a longer time to complete and is more resource intensive.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
- en: White-box testing
  id: totrans-114
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A white-box vulnerability assessment is a test conducted with complete knowledge
    and understanding of the infrastructure, defense mechanisms, and communication
    channels of the target on which the test is being conducted. This test is specifically
    intended to simulate insider attacks which are usually performed with full privileges
    and complete access to the target system. In order to initiate a white-box vulnerability
    assessment, the target organization shares all details, such as asset inventory,
    network topology diagrams, and so on, with the VA tester.
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
- en: Gray-box testing
  id: totrans-116
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: As the name suggests, a gray-box test is a combination of both a black-box and
    white-box test. In this type of testing, the VA tester has partial knowledge about
    the infrastructure, defense mechanisms, and communication channels of the target
    on which the test is to be conducted. It attempts to simulate those attacks that
    are performed by an insider or outsider with limited access privileges. This is
    comparatively less time and resource-intensive compared to a black-box test.
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
- en: Announced and unannounced testing
  id: totrans-118
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In an announced vulnerability assessment, the attempt to compromise the target
    systems is done with full cooperation and prior knowledge of the target IT staff.
    The VA tester could possibly discuss prioritizing specific systems for compromise with
    the IT staff. In an unannounced vulnerability assessment, the vulnerability assessment
    team gives no prior intimation to the target staff. It's kind of a surprise test
    with the intent of examining the security preparedness and responsiveness of the
    target organization. Only the higher management is kept informed about the tests.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
- en: Automated testing
  id: totrans-120
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Instead of utilizing personal expertise, some organizations and security testing
    teams prefer to automate security testing. This is typically done with help of
    a tool which is run against the host of target systems in order to assess the
    security posture. The tool tries to simulate real-world attacks that an intruder
    might use. Based on whether the attack succeeded or failed, the tool generates
    a detailed report of the findings. The automated test can be easy and quick to
    perform, however it may produce a lot of false positives. Automated testing can
    also not assess architecture-level security flaws (design flaws), business logic
    flaws, and any other procedural shortcomings.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 一些组织和安全测试团队不使用个人专业知识，而是更喜欢自动化安全测试。这通常是通过工具来完成的，该工具针对目标系统的主机运行，以评估安全姿态。该工具尝试模拟入侵者可能使用的真实世界攻击。根据攻击是否成功，工具会生成详细的报告。自动化测试可能易于快速执行，但可能会产生大量的假阳性。自动化测试也无法评估架构级别的安全缺陷（设计缺陷）、业务逻辑缺陷和任何其他程序上的缺陷。
- en: Authenticated and unauthenticated scans
  id: totrans-122
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 经过身份验证和未经身份验证的扫描
- en: In order to perform an authenticated scan, an  scanning tool can be configured
    with credentials controlled by a centralized directory (domain controller/AD/LDAP).
    While performing a scan, the scanner tries to establish a **Remote Procedure Call** (**RPC**)
    with the assets using configured credentials and, on successful login, executes
    tests on the same privilege level to that of the provided credentials.
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
  zh: 为了执行经过身份验证的扫描，扫描工具可以配置为使用由集中目录（域控制器/AD/LDAP）控制的凭据。在执行扫描时，扫描器尝试使用配置的凭据与资产建立**远程过程调用**（**RPC**），成功登录后，以提供的凭据的特权级别执行相同特权级别的测试。
- en: An authenticated scan reports weaknesses exposed to the authenticated users
    of the system, as all the hosted services can be accessed with a right set of
    credentials. An unauthenticated scan reports weaknesses from a public viewpoint
    (this is what the system looks like to the unauthenticated users) of the system.
  id: totrans-124
  prefs: []
  type: TYPE_NORMAL
  zh: 经过身份验证的扫描报告了向系统的经过身份验证用户暴露的弱点，因为所有托管服务都可以使用正确的凭据访问。未经身份验证的扫描从系统的公共视角报告了弱点（这是系统对未经身份验证用户的外观）。
- en: 'The advantages of authenticated scans over unauthenticated are as follows:'
  id: totrans-125
  prefs: []
  type: TYPE_NORMAL
  zh: 经过身份验证的扫描相对于未经身份验证的优势如下：
- en: Simulates a view of a security posture from a user's point of view
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 模拟用户视角下的安全姿态
- en: Provides comprehensive scans covering more attack surfaces exposed
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 提供全面的扫描，覆盖更多暴露的攻击面
- en: The report provides detailed vulnerabilities exposed on assets that can be exploited
    by a malicious user
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 报告提供了资产上暴露的详细漏洞，这些漏洞可以被恶意用户利用
- en: Less false positives
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 假阳性较少
- en: Increased accuracy in reports
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 报告的准确性提高了
- en: 'The disadvantages of authenticated scans over unauthenticated are as follows:'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 经过身份验证的扫描相对于未经身份验证的劣势如下：
- en: Takes more time to complete the scan as it covers more scanning signatures
  id: totrans-132
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 完成扫描需要更多时间，因为它涵盖了更多的扫描签名
- en: Adds the overhead of managing credentials used for scanning
  id: totrans-133
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 增加了用于扫描的凭据管理的开销
- en: Involvement of intense test signatures may disrupt services hosted by an asset
  id: totrans-134
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 强烈测试签名的参与可能会干扰资产托管的服务
- en: Agentless and agent-based scans
  id: totrans-135
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 无代理和基于代理的扫描
- en: The latest automated scanning tools facilitate agents that install a scanning
    service on respective assets. This service usually runs with the highest possible
    privileges. Once the trigger from the scanner is received by a service running
    on the host, the service fetches the respective scanning profile for that particular
    asset from the scanner running scans natively on the asset itself.
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 最新的自动化扫描工具提供了安装在相应资产上的扫描服务的代理。该服务通常以最高可能的特权运行。一旦扫描器接收到来自主机上运行的服务的触发器，该服务就会从扫描器本身在资产上本地运行的扫描中获取该特定资产的相应扫描配置文件。
- en: 'The advantages of the agent-based scan over an agentless scan are as follows:'
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: 基于代理的扫描相对于无代理扫描的优势如下：
- en: No overhead on the network as scans are running natively on the system
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对网络没有额外开销，因为扫描在系统上本地运行
- en: No need to wait for nonbusiness hours to initiate testing on noncritical assets
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 无需等待非营业时间来启动对非关键资产的测试
- en: Scanning intervals can be reduced, which helps in keeping security posture up
    to date
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 扫描间隔可以缩短，有助于保持安全姿态的最新状态
- en: No need to maintain separate credentials dedicated to scanning
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 无需维护专门用于扫描的凭据
- en: Provides comprehensive scans covering more attack surfaces exposed
  id: totrans-142
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 提供全面的扫描，覆盖更多暴露的攻击面
- en: The report provides detailed vulnerabilities exposed on assets
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 报告提供了资产上暴露的详细漏洞
- en: Less false positives
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 假阳性较少
- en: Increased accuracy in reports
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 报告的准确性提高了
- en: 'The disadvantages of an agent-based scan over an agentless scan are as follows:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 基于代理的扫描相对于无代理扫描的劣势如下：
- en: Agents might not support special devices (modems, radios, and so on) and all
    the operating systems and firmware
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 代理可能不支持特殊设备（调制解调器、无线电等）和所有操作系统和固件。
- en: Installing an agent on every compatible asset—even-though this would be a onetime
    activity in a large environment, this would be a challenge
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在每个兼容资产上安装代理——尽管这在大型环境中只需一次活动，但这将是一个挑战
- en: Managing and protecting the agent itself—as the agent is running a service with
    higher privileges, these agents need to be managed and protected very cautiously
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 管理和保护代理本身——因为代理正在以更高的特权运行服务，这些代理需要非常谨慎地管理和保护
- en: Manual testing
  id: totrans-150
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 手动测试
- en: Manual vulnerability assessment is one of the best-preferred options. It benefits
    from the expertise of the well-trained security professional. A manual testing
    approach involves detailed scoping, planning, information gathering, vulnerability
    scanning, assessment, and exploitation. Hence, it is certainly more time and resource-consuming
    than the automated test, however, it is less likely to produce false positives.
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
- en: Quite often, organizations and vulnerability assessment teams prefer to use
    a combination of automated and manual testing in order to get the best out of
    both.
  id: totrans-152
  prefs: []
  type: TYPE_NORMAL
- en: Estimating the resources and deliverables
  id: totrans-153
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: As is applicable for any project, the success of the vulnerability assessment
    depends on estimations that are close to the actual. Output from the scoping and
    planning phases helps in estimating the most important factor in a vulnerability
    assessment—the time required to complete the assessment.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
- en: If a tester is having a very good experience running assessments over a scoped
    environment or similar, then the estimation is done on the basis of previous experience.
    If a tester is new to the environment then previous tests reports and communications
    are referred to for estimation. Additionally, a tester considers additions and
    changes in scope, involvement of third-party services / service providers, if
    any, and updates the estimates accordingly.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
- en: Once rough estimates are ready, time padding is considered and time is added
    over the anticipated time required. This time padding is usually set at 20%. This
    helps the tester to deal with any unsolicited challenges that they may face during
    execution.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
- en: 'The following are a few of the unsolicited challenges/problems that one can
    face during the execution of the vulnerability assessment:'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
- en: '**Network security devices blocking scans**: Network security devices such
    as firewalls, **intrusion prevention systems** (**IPS**), and **unified threat
    management** (**UTM**) detect scanning traffic as malicious traffic and block
    all the requests sent by the vulnerability scanner. Once alerts are generated
    on the respective network security devices, the tester needs to ask the network
    administrator to whitelist automated scanner IPs and manual testing machine IPs.'
  id: totrans-158
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '‎**Assets not responding as side effects of certain tests**: Some scanning
    signatures leave assets in DoS mode. In such cases, a tester needs to identify
    such assets and fine-tune the scanning profiles so that comprehensive scanning
    can be performed on these systems. Often, such scan-sensitive systems are closed
    source and out-of-the-box solutions.'
  id: totrans-159
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '‎**Scan impacting business critical service(s) and hence scanning needs to
    be stopped abruptly**: Some vulnerability scanning signatures may break certain
    services on systems. As the business is always the priority, scanning has to be
    stopped and business-critical services need to be recovered. A tester needs to
    perform scanning on such assets separately with less intensive and/or fine-tuned
    scanning profiles in nonbusiness hours.'
  id: totrans-160
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Blocking user IDs allocated for scanning**: While performing authenticated
    scans because of heavy traffic to centralized **Identity Access Management Systems** (**IDAM**),
    login attempts may get classified as malicious and scanning accounts may get blocked.'
  id: totrans-161
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '‎**Slowing down the network because of scanning traffic and hence delays are
    introduced in report generation**: While performing automated scans, aggressive
    and intensive scanning profiles creates overhead on network traffic. This may
    slow down the network or put some of the network devices in the fail-closed state,
    preventing scanning requests from reaching assets.'
  id: totrans-162
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Usually, this padding is not completely utilized. In such cases, to be fair
    to the customer, the tester can use this extra time to add more value to the vulnerability
    report. For example:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
- en: Exploring identified critical vulnerabilities in-depth to find out the implications
    of vulnerabilities on overall infrastructure security
  id: totrans-164
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Running some more manual POCs over critical, highly severe vulnerabilities reported
    to minimize false positives
  id: totrans-165
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Conducting a detailed walkthrough of a vulnerability report for the stakeholders
  id: totrans-166
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Providing additional guidance on vulnerability closure
  id: totrans-167
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Time estimations are done in the form of man-hours required for testing but
    the tester should also consider that deploying more personnel for a project is
    not always going to reduce timelines.
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
- en: For example, when an automated vulnerability assessment suite/scanner initiates
    testing over a network segment or group of assets, the time required to conduct
    tests depends on the infrastructure involved, the number of assets to scan, the
    performance of assets, network traffic, the intensity of test profiles, and many
    other external factors. As tester interaction is hardly required for automated
    scanning, deploying more testers in this phase is not going to reduce the time.
    However, it's not the case with manual testing. Manual test cases can be executed
    in parallel by multiple testers at a time, reducing timelines considerably.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
- en: Another factor to consider is the extent or intensity of the tests to run on
    assets. For critical assets, in-depth testing is required with more intense scanning
    profiles, whereas for noncritical assets just an overview is usually enough. Running
    intense scan profiles for automated as well as manual testing takes considerably
    more time than that of normal scanning profiles.
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
- en: The outcome of a time estimation exercise is definite drop-dead dates. A vulnerability
    assessment should always begin on the preplanned date and should be completed
    on the estimated end date. As vulnerability assessment covers vast infrastructure,
    many system owners and third parties are actively involved in the exercise. The
    additional responsibility to support vulnerability assessment is usually an overhead
    for the stakeholders involved. Hence, in order to keep them organized, synchronized,
    motivated, and supported during the VA exercise, finite drop-dead dates are very
    important.
  id: totrans-171
  prefs: []
  type: TYPE_NORMAL
- en: Preparing a test plan
  id: totrans-172
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'A vulnerability assessment is often an ongoing exercise that is repeated at
    regular intervals. However, for a given time period, a vulnerability assessment
    does have a specific start point and an endpoint irrespective of what type of
    test is performed. Thus, in order to ensure a successful vulnerability assessment,
    a detailed plan is necessary. The plan can have several elements as follows:'
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
- en: '**Overview**: This section provides a high-level orientation for the test plan.'
  id: totrans-174
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Purpose**: This section states the overall purpose and intent of conducting
    the test. There may be some regulatory requirements or any explicit requirement
    from the customer.'
  id: totrans-175
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Applicable laws and regulations**: This section lists all the applicable
    laws and regulations with respect to the test being planned. These may include
    local as well as international laws.'
  id: totrans-176
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Applicable standards and guidelines**: This section lists all the applicable
    standards and guidelines, if any, with respect to the test being planned. For
    example, in the case of web application vulnerability assessment, standards such
    as OWASP may be followed.'
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Scope**: Scope is an important section of the plan as it essentially lists
    the systems that will undergo the testing. An improper scope could seriously impact
    the test deliverable going forward. The scope must be outlined in detail, including
    hosts and IP addresses of target systems, web applications, and databases if any,
    and the privileges that will be used for testing.'
  id: totrans-178
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Assumptions**: This section mainly outlines that the prerequisites for the
    test be available in a timely manner to the VA tester. This will ensure that there
    won''t be any delays due to operational issues. This could also include the fact
    that the systems under scope won''t undergo major upgrades or changes during the
    test.'
  id: totrans-179
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Methodology**: This section relates to the type of methodology that will
    be adopted for the test. It could be a black box, gray box, or white box depending
    on the organization''s requirements.'
  id: totrans-180
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Test plan**: This section details who will be performing the test, the daily
    schedule, detailed tasks, and contact information.'
  id: totrans-181
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Rules of engagement**: This section lists exclusive terms and conditions
    that need to be followed during the test. For example, an organization may wish
    to exclude a certain set of systems from automated scanning. Such explicit conditions
    and requirements can be put forward in rules of engagement.'
  id: totrans-182
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Stakeholder communication**: This section lists all the stakeholders that
    will be involved throughout the test process. It is extremely important to keep
    all the stakeholders updated about the progress of the test in a timely manner.
    The stakeholders to be included must be approved by senior management.'
  id: totrans-183
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Liabilities**: This section highlights the liabilities of any action or event
    that may occur during the test which could possibly have an adverse impact on
    the business operations. The liabilities are on both sides, that is, the organization
    and the VA tester.'
  id: totrans-184
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Authorized approvals and signatures**: Once all the preceding sections are
    carefully drafted and agreed upon, it''s necessary that the plan gets signed by
    the relevant authority.'
  id: totrans-185
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A comprehensive test plan is also referred to as the **Statement of Work** (**SoW**).
  id: totrans-186
  prefs: []
  type: TYPE_NORMAL
- en: Getting approval and signing NDAs
  id: totrans-187
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Based on specific requirements, an organization may choose to conduct any type
    of vulnerability assessment as discussed in the section earlier. However, it is
    important that the vulnerability assessment is approved and authorized by senior
    management. Though most of the professional vulnerability assessment is conducted
    in quite a controlled manner, there still remains the possibility of something
    becoming disruptive. In such a case, preapproved support from senior management
    is crucial.
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
- en: An NDA is one of the most important documents that a VA tester has to sign before
    the test begins. This agreement ensures that the test results are handled with
    high confidentiality and the findings are disclosed only to authorized stakeholders.
    An organization's internal vulnerability assessment team might not require the
    signing of an NDA for each and every test, however, it is absolutely required
    for any test being conducted by an external team.
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
- en: Confidentiality and nondisclosure agreements
  id: totrans-190
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Any individual performing the vulnerability assessment who is external to the
    organization needs to sign confidentiality and nondisclosure agreements prior
    to test initiation. The entire process of vulnerability assessment involves multiple
    documents that contain critical information. These documents, if leaked to any
    third-party, could cause potential damage. Hence, the VA tester and the organization
    must mutually agree and duly sign the terms and conditions included in the confidentiality
    and nondisclosure agreement. The following are some of the benefits of signing
    confidentiality and nondisclosure agreements:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
- en: Ensures that the organization's information is treated with high confidentiality
  id: totrans-192
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Provides cover for a number of other areas such as negligence and liability
    in case of any mishaps
  id: totrans-193
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The confidentiality and nondisclosure agreements are both powerful tools. Once
    the agreement is duly signed, the organization even has the right to file a lawsuit
    against the tester if the information is disclosed to unauthorized parties, intentionally
    or unintentionally.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  id: totrans-195
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: There are lots of prerequisites before one can actually start a vulnerability
    assessment for an infrastructure. In this chapter, we tried to cover all such
    prerequisites in brief. From the next chapter onward, we will be dealing with
    the actual vulnerability assessment methodology.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
