- en: Chapter 5. Compliance Checks
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Nessus is well-known as a vulnerability scanner, but it also provides the option
    to do compliance checks. Using this option, it can be cross-checked whether the
    secure configuration settings of an infrastructure, such as servers, network devices,
    database, and desktop, are in compliance with the defined policy or best practices
    an organization is following.
  prefs: []
  type: TYPE_NORMAL
- en: The compliance check audit is an important and necessary feature required as
    per the current security needs of an organization. All security-aware organizations
    define and implement secure configuration settings for their IT and network infrastructures
    to prevent them from being compromised by security threats that can be realized
    due to any misconfiguration. Also, such compliance requirements for security hardening
    and checking the implementation also arise because of regulatory requirements
    when a company has to adhere to different compliance regulations, such as ISO
    27001 for a information security management system, HIPAA for the health industry,
    and SOX for a financial domain.
  prefs: []
  type: TYPE_NORMAL
- en: To check the compliance of servers, network devices against these defined controls,
    or a secure configuration, a regular compliance check activity is required. Conducting
    such compliance checks manually, especially when the size of the infrastructure
    is large, and even when post sampling and controls to be checked per device are
    large in number, will be a tedious and time-consuming job. This may also result
    in the possibility of errors and time consumed in a to-and-fro exchange between
    operation and compliance teams for the preparation, validation, and correction
    of artifacts.
  prefs: []
  type: TYPE_NORMAL
- en: The compliance check option offered by Nessus will help to conduct such a check
    in an automated manner. Nessus also offers options to modify the compliance files
    for them to be in line with an organization's device-hardening policies.
  prefs: []
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '**Vulnerability Scan** will typically identify well-know vulnerabilities present
    in the system, for which a plugin is available, and will identify missing patches.'
  prefs: []
  type: TYPE_NORMAL
- en: '**Auditing** will check the compliance of the infrastructure with the secure
    configuration defined in the local policy.'
  prefs: []
  type: TYPE_NORMAL
- en: Resulting less vulnerabilities during a vulnerability scan doesn't mean that
    the system is securely configured. For example, if the password policy of an organization
    mandates a minimum of 10 characters because it handles sensitive information,
    a server might have patches updated or have relatively less vulnerabilities in
    the output of a VA scan conducted. This is because the server will not ensure
    that a password policy of 10 characters is configured. This feature is available
    with Nessus professional feed.
  prefs: []
  type: TYPE_NORMAL
- en: Nessus compliance checks are available for major platforms such as server OSes
    (Windows and Unix), databases, desktops, and network devices, as well as audit
    standards such as PCI DSS.
  prefs: []
  type: TYPE_NORMAL
- en: 'This chapter will cover the following major areas:'
  prefs: []
  type: TYPE_NORMAL
- en: Audit polices
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How to configure the Nessus compliance check policy
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Compliance reporting in Nessus
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The compliance check option for different types of infrastructures
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Audit policies
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: To conduct these compliance audits, policies are available in the files with
    the `.audit` extension, which are available for different infrastructure elements
    such as databases, Windows, and Cisco. These audit files also contain the common
    checkpoints covered under well-known standards such as SOX and PCI-DSS. These
    files also have recommendations from well-known security governance and advisory
    bodies such as NIST and CERT.
  prefs: []
  type: TYPE_NORMAL
- en: These audit files can be tweaked in line with the local policy or hardening
    documents. Tenable offers options to download these audit files from its support
    site and provides documentation to understand the syntax of these files to create
    them with customizations as per your requirements. Tenable also offers tools to
    convert a Windows policy file with the `.inf` extension to one with the `.audit`
    extension.
  prefs: []
  type: TYPE_NORMAL
- en: To enable the use of the compliance check option, an end user first needs to
    click on he **+ Add Policy**. The compliance check option is available under **Policies**
    | **Plugins** **Preferences**.
  prefs: []
  type: TYPE_NORMAL
- en: Out of the various Nessus plugins available, the plugin family of interest for
    a compliance check is **Policy Compliance**. This plugin check covers different
    infra components such as servers and the network.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot shows the **Policy Compliance** plugin family:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Audit policies](img/7440OS_05_01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: To use customized audit files, use the **Preferences** option under **Policies**.
    Under the **Preferences** tab, there is a drop-down menu to choose different compliance
    checks such as **Cisco IOS Compliance Checks** and **Database Compliance Checks**.
    Here, a user will also get an option to choose and upload more than one audit
    file that will be used to perform the compliance checks.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot shows the **Database Compliance Checks** option selected:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Audit policies](img/7440OS_05_02.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Credentials
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: For Nessus to do a compliance check, credentials should be provided for it to
    log in to the system to do local checks. The credentials used should be those
    of a privileged account, that is, a super user privilege in case of a Unix account
    with administrative privilege to read the local machine policy. In case of a database
    compliance check, database credentials will be required. In case of a Cisco IOS
    compliance check, the enable password is required to do a configuration audit.
    The credentials can be added under **Policies** | **Credentials** as it was done
    during the VA scanning.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot is an example of how to provide credentials in case
    of a Cisco configuration audit:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Credentials](img/7440OS_05_03.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Compliance reporting
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: To get a report specific to the compliance status of the target in question,
    Nessus provides options such as **Compliance Check** and **Compliance Check (Executive)**
    while saving the report. Using any of these options, one can get the compliance
    status of the system against the controls as present in the `.audit` file. This
    is represented in the report by mentioning if the compliance has failed, passed,
    or skipped along with an executive summary. Inconclusive tests are reported under
    errors and warnings.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot showcases the report generated using the **Compliance
    Check** and **Compliance Check Summary** options:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Compliance reporting](img/7440OS_05_04.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Auditing infrastructure
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Compliance plugins are available under the **Policy Compliance** plugin family.
    This section lists the plugins available under this family, which showcase the
    kind of infrastructure for which a compliance audit can be done. For each type
    of infrastructure element, such as servers, networks, and databases, the appropriate
    policy file, credentials, and plugin needs to be selected as mentioned in the
    preceding sections in this chapter.
  prefs: []
  type: TYPE_NORMAL
- en: Windows compliance check
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Using this plugin, one can check the compliance parameters set under the **Policies**
    option of the Windows framework. The examples of some of the checks conducted
    under Windows audit include the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Registry setting
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: File permissions
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Password policy
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Lockout policy
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Auditing policy
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: User rights policy
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Service audits
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Windows File Content
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The **Windows File Content** option allows Nessus to check Windows file types
    (Excel, Adobe, or text files), which may contain sensitive data such as **Personal
    Identifiable Information** (**PII**) and credit card details.
  prefs: []
  type: TYPE_NORMAL
- en: Unix compliance check
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Nessus can do a compliance check on different flavors of Unix such as Solaris,
    Red Hat, AIX, HP-UX, SUSE, Gentoo, and freebsd. Key checks include the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Password management
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: File permissions
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Password file management
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Permission management
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Root access management
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Running processes
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Cisco IOS compliance checks
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Using this plugin, a Cisco machine running a configuration file for Cisco IOS
    devices can be checked. Compliance checks can be done against saved, running,
    or startup configurations. Examples include the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Access list applied to interfaces
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: SNMP community strings are protected by ACLs
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Unrequited services are disabled
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: An SNMP default community string is changed
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Database compliance checks
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Nessus can also check compliance of the different databases against security
    policies. Databases that are supported include MS SQL, Oracle, MySQL PostgreSQL,
    IBM DB2, and Informix/DRDA. To ensure the completeness of a report, the account
    used to log in to the database should have an SYSDBA or SA permission. Database
    compliance check plugins typically use `SELECT` queries to fetch security configurations
    from the database. Following are few examples:'
  prefs: []
  type: TYPE_NORMAL
- en: Checking for logins with no expiration details
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Checking if unauthorized stored procedures are enabled
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: PCI DSS compliance
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '**Payment Card Industry Data Security Standard** (**PCI-DSS**) is a well-known
    standard used for payment cards. Nessus offers PCI DSS compliance plugins to check
    the configuration against the requirement in this standard.'
  prefs: []
  type: TYPE_NORMAL
- en: VMware vCenter/vSphere Compliance Check
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The VMware vCenter/vSphere Compliance Check plugin uses the VMware SOAP API
    to audit ESX VMware, ESXi, and vCenter/vSphere virtualization software. Credential
    information to conduct an audit can be added to **VMware vCenter SOAP API Settings**
    in the **Advanced** section of a policy. Examples include the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Missing patches
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Missing security updates
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Some other platforms that are included in Nessus''s compliance check options
    include the following (please cross-check the updated documentation on Tenable''s
    official website, [https://support.tenable.com/](https://support.tenable.com/))
    A few sections of this chapter has been referenced from learning material available
    on Nessus website [http://www.tenable.com](http://www.tenable.com):'
  prefs: []
  type: TYPE_NORMAL
- en: IBM iSeries compliance checks
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Juniper Junos compliance checks
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: NetApp Data ONTAP compliance checks
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Palo Alto Network PAN-OS compliance checks
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Check Point GAiA compliance checks
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Tip
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The compliance plugins are only available to professional feed customers.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Nessus provides options of doing automated compliance checks using the tool,
    apart from vulnerability scanning. Using this option, it can be cross-checked
    whether the secure configuration settings of the infrastructure such as servers,
    network devices, and databases are in compliance with the defined policy or best
    practices an organization is following. A compliance requirement is also derived
    from different compliance standards adhered to by an organization. This feature
    is available to professional feed subscribers.
  prefs: []
  type: TYPE_NORMAL
- en: The **Policy Compliance** plugin family is available for compliance check scanning.
    The plugin family includes, but is not limited to, servers, network devices, and
    standards such as PCI DSS. The Nessus **Results** tab also offers a **Compliance**
    option while saving the output to specifically generate a compliance report. These
    compliance checks can be modified by using the`.audit` files. Appropriate credentials
    of the underlying infrastructure on which a compliance audit is being performed
    need to be updated in the tool.
  prefs: []
  type: TYPE_NORMAL
