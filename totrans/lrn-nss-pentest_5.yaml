- en: Chapter 5. Compliance Checks
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第5章。合规性检查
- en: Nessus is well-known as a vulnerability scanner, but it also provides the option
    to do compliance checks. Using this option, it can be cross-checked whether the
    secure configuration settings of an infrastructure, such as servers, network devices,
    database, and desktop, are in compliance with the defined policy or best practices
    an organization is following.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: Nessus以漏洞扫描器而闻名，但它也提供了进行合规性检查的选项。使用这个选项，可以交叉检查基础设施（如服务器、网络设备、数据库和桌面）的安全配置设置是否符合组织正在遵循的定义的政策或最佳实践。
- en: The compliance check audit is an important and necessary feature required as
    per the current security needs of an organization. All security-aware organizations
    define and implement secure configuration settings for their IT and network infrastructures
    to prevent them from being compromised by security threats that can be realized
    due to any misconfiguration. Also, such compliance requirements for security hardening
    and checking the implementation also arise because of regulatory requirements
    when a company has to adhere to different compliance regulations, such as ISO
    27001 for a information security management system, HIPAA for the health industry,
    and SOX for a financial domain.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 合规性检查审计是一个重要且必要的功能，根据组织当前的安全需求。所有具有安全意识的组织都为其IT和网络基础设施定义和实施安全配置设置，以防止它们因任何错误配置而受到安全威胁的威胁。此外，由于监管要求，当公司必须遵守不同的合规性法规时，也会出现对安全加固和实施检查的合规性要求，例如信息安全管理系统的ISO
    27001、医疗行业的HIPAA和金融领域的SOX。
- en: To check the compliance of servers, network devices against these defined controls,
    or a secure configuration, a regular compliance check activity is required. Conducting
    such compliance checks manually, especially when the size of the infrastructure
    is large, and even when post sampling and controls to be checked per device are
    large in number, will be a tedious and time-consuming job. This may also result
    in the possibility of errors and time consumed in a to-and-fro exchange between
    operation and compliance teams for the preparation, validation, and correction
    of artifacts.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 检查服务器、网络设备是否符合这些定义的控制措施或安全配置，需要进行定期的合规性检查活动。手动进行这样的合规性检查，特别是当基础设施规模较大，甚至在每台设备的采样和要检查的控制数量较多时，将是一项繁琐且耗时的工作。这可能还会导致错误的可能性，以及在操作和合规团队之间进行准备、验证和修正工作时所消耗的时间。
- en: The compliance check option offered by Nessus will help to conduct such a check
    in an automated manner. Nessus also offers options to modify the compliance files
    for them to be in line with an organization's device-hardening policies.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: Nessus提供的合规性检查选项将有助于以自动化的方式进行此类检查。Nessus还提供了修改合规性文件的选项，使其符合组织的设备加固政策。
- en: Tip
  id: totrans-5
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: '**Vulnerability Scan** will typically identify well-know vulnerabilities present
    in the system, for which a plugin is available, and will identify missing patches.'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: '**漏洞扫描**通常会识别系统中存在的众所周知的漏洞，为此插件是可用的，并会识别缺失的补丁。'
- en: '**Auditing** will check the compliance of the infrastructure with the secure
    configuration defined in the local policy.'
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: '**审计**将检查基础设施是否符合本地政策中定义的安全配置。'
- en: Resulting less vulnerabilities during a vulnerability scan doesn't mean that
    the system is securely configured. For example, if the password policy of an organization
    mandates a minimum of 10 characters because it handles sensitive information,
    a server might have patches updated or have relatively less vulnerabilities in
    the output of a VA scan conducted. This is because the server will not ensure
    that a password policy of 10 characters is configured. This feature is available
    with Nessus professional feed.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 在漏洞扫描期间减少漏洞并不意味着系统已经安全配置。例如，如果一个组织的密码策略要求最少10个字符，因为它处理敏感信息，那么一台服务器可能已经更新了补丁，或者在进行VA扫描时漏洞相对较少。这是因为服务器不会确保配置了10个字符的密码策略。这个功能在Nessus专业版中是可用的。
- en: Nessus compliance checks are available for major platforms such as server OSes
    (Windows and Unix), databases, desktops, and network devices, as well as audit
    standards such as PCI DSS.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: Nessus的合规性检查适用于主要平台，如服务器操作系统（Windows和Unix）、数据库、桌面和网络设备，以及PCI DSS等审计标准。
- en: 'This chapter will cover the following major areas:'
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将涵盖以下主要领域：
- en: Audit polices
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 审计策略
- en: How to configure the Nessus compliance check policy
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如何配置Nessus合规性检查策略
- en: Compliance reporting in Nessus
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Nessus中的合规性报告
- en: The compliance check option for different types of infrastructures
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不同类型基础设施的合规性检查选项
- en: Audit policies
  id: totrans-15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 审计策略
- en: To conduct these compliance audits, policies are available in the files with
    the `.audit` extension, which are available for different infrastructure elements
    such as databases, Windows, and Cisco. These audit files also contain the common
    checkpoints covered under well-known standards such as SOX and PCI-DSS. These
    files also have recommendations from well-known security governance and advisory
    bodies such as NIST and CERT.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 要进行这些合规性审计，文件中提供了`.audit`扩展名的策略，适用于不同的基础设施元素，如数据库、Windows和Cisco。这些审计文件还包含了SOX和PCI-DSS等众所周知标准所涵盖的常见检查点。这些文件还包含了来自众所周知的安全治理和咨询机构，如NIST和CERT的建议。
- en: These audit files can be tweaked in line with the local policy or hardening
    documents. Tenable offers options to download these audit files from its support
    site and provides documentation to understand the syntax of these files to create
    them with customizations as per your requirements. Tenable also offers tools to
    convert a Windows policy file with the `.inf` extension to one with the `.audit`
    extension.
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 这些审计文件可以根据本地政策或加固文件进行调整。Tenable提供了从其支持站点下载这些审计文件的选项，并提供了解这些文件语法的文档，以便根据您的要求进行定制。Tenable还提供了将具有`.inf`扩展名的Windows策略文件转换为具有`.audit`扩展名的文件的工具。
- en: To enable the use of the compliance check option, an end user first needs to
    click on he **+ Add Policy**. The compliance check option is available under **Policies**
    | **Plugins** **Preferences**.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
- en: Out of the various Nessus plugins available, the plugin family of interest for
    a compliance check is **Policy Compliance**. This plugin check covers different
    infra components such as servers and the network.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot shows the **Policy Compliance** plugin family:'
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
- en: '![Audit policies](img/7440OS_05_01.jpg)'
  id: totrans-21
  prefs: []
  type: TYPE_IMG
- en: To use customized audit files, use the **Preferences** option under **Policies**.
    Under the **Preferences** tab, there is a drop-down menu to choose different compliance
    checks such as **Cisco IOS Compliance Checks** and **Database Compliance Checks**.
    Here, a user will also get an option to choose and upload more than one audit
    file that will be used to perform the compliance checks.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot shows the **Database Compliance Checks** option selected:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
- en: '![Audit policies](img/7440OS_05_02.jpg)'
  id: totrans-24
  prefs: []
  type: TYPE_IMG
- en: Credentials
  id: totrans-25
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: For Nessus to do a compliance check, credentials should be provided for it to
    log in to the system to do local checks. The credentials used should be those
    of a privileged account, that is, a super user privilege in case of a Unix account
    with administrative privilege to read the local machine policy. In case of a database
    compliance check, database credentials will be required. In case of a Cisco IOS
    compliance check, the enable password is required to do a configuration audit.
    The credentials can be added under **Policies** | **Credentials** as it was done
    during the VA scanning.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot is an example of how to provide credentials in case
    of a Cisco configuration audit:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
- en: '![Credentials](img/7440OS_05_03.jpg)'
  id: totrans-28
  prefs: []
  type: TYPE_IMG
- en: Compliance reporting
  id: totrans-29
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: To get a report specific to the compliance status of the target in question,
    Nessus provides options such as **Compliance Check** and **Compliance Check (Executive)**
    while saving the report. Using any of these options, one can get the compliance
    status of the system against the controls as present in the `.audit` file. This
    is represented in the report by mentioning if the compliance has failed, passed,
    or skipped along with an executive summary. Inconclusive tests are reported under
    errors and warnings.
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot showcases the report generated using the **Compliance
    Check** and **Compliance Check Summary** options:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
- en: '![Compliance reporting](img/7440OS_05_04.jpg)'
  id: totrans-32
  prefs: []
  type: TYPE_IMG
- en: Auditing infrastructure
  id: totrans-33
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Compliance plugins are available under the **Policy Compliance** plugin family.
    This section lists the plugins available under this family, which showcase the
    kind of infrastructure for which a compliance audit can be done. For each type
    of infrastructure element, such as servers, networks, and databases, the appropriate
    policy file, credentials, and plugin needs to be selected as mentioned in the
    preceding sections in this chapter.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
- en: Windows compliance check
  id: totrans-35
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Using this plugin, one can check the compliance parameters set under the **Policies**
    option of the Windows framework. The examples of some of the checks conducted
    under Windows audit include the following:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
- en: Registry setting
  id: totrans-37
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: File permissions
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Password policy
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Lockout policy
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Auditing policy
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: User rights policy
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Service audits
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Windows File Content
  id: totrans-44
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The **Windows File Content** option allows Nessus to check Windows file types
    (Excel, Adobe, or text files), which may contain sensitive data such as **Personal
    Identifiable Information** (**PII**) and credit card details.
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
- en: Unix compliance check
  id: totrans-46
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Nessus can do a compliance check on different flavors of Unix such as Solaris,
    Red Hat, AIX, HP-UX, SUSE, Gentoo, and freebsd. Key checks include the following:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
- en: Password management
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: File permissions
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Password file management
  id: totrans-50
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Permission management
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Root access management
  id: totrans-52
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Running processes
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Cisco IOS compliance checks
  id: totrans-54
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Using this plugin, a Cisco machine running a configuration file for Cisco IOS
    devices can be checked. Compliance checks can be done against saved, running,
    or startup configurations. Examples include the following:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 使用此插件，可以检查运行Cisco IOS设备配置文件的Cisco设备。合规性检查可以针对已保存、运行或启动的配置进行。示例包括以下内容：
- en: Access list applied to interfaces
  id: totrans-56
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 接口应用的访问列表
- en: SNMP community strings are protected by ACLs
  id: totrans-57
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: SNMP社区字符串受ACL保护
- en: Unrequited services are disabled
  id: totrans-58
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 未被禁用的不必要服务
- en: An SNMP default community string is changed
  id: totrans-59
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 更改了SNMP默认社区字符串
- en: Database compliance checks
  id: totrans-60
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 数据库合规性检查
- en: 'Nessus can also check compliance of the different databases against security
    policies. Databases that are supported include MS SQL, Oracle, MySQL PostgreSQL,
    IBM DB2, and Informix/DRDA. To ensure the completeness of a report, the account
    used to log in to the database should have an SYSDBA or SA permission. Database
    compliance check plugins typically use `SELECT` queries to fetch security configurations
    from the database. Following are few examples:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: Nessus还可以检查不同数据库是否符合安全策略的合规性。支持的数据库包括MS SQL、Oracle、MySQL PostgreSQL、IBM DB2和Informix/DRDA。为了确保报告的完整性，用于登录数据库的帐户应具有SYSDBA或SA权限。数据库合规性检查插件通常使用`SELECT`查询从数据库中获取安全配置。以下是一些示例：
- en: Checking for logins with no expiration details
  id: totrans-62
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查是否存在没有到期详细信息的登录
- en: Checking if unauthorized stored procedures are enabled
  id: totrans-63
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 检查未经授权的存储过程是否已启用
- en: PCI DSS compliance
  id: totrans-64
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: PCI DSS合规性
- en: '**Payment Card Industry Data Security Standard** (**PCI-DSS**) is a well-known
    standard used for payment cards. Nessus offers PCI DSS compliance plugins to check
    the configuration against the requirement in this standard.'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: '**支付卡行业数据安全标准**（**PCI-DSS**）是一种用于支付卡的知名标准。Nessus提供PCI DSS合规性插件，以检查配置是否符合该标准的要求。'
- en: VMware vCenter/vSphere Compliance Check
  id: totrans-66
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: VMware vCenter/vSphere合规性检查
- en: 'The VMware vCenter/vSphere Compliance Check plugin uses the VMware SOAP API
    to audit ESX VMware, ESXi, and vCenter/vSphere virtualization software. Credential
    information to conduct an audit can be added to **VMware vCenter SOAP API Settings**
    in the **Advanced** section of a policy. Examples include the following:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: VMware vCenter/vSphere合规性检查插件使用VMware SOAP API来审计ESX VMware、ESXi和vCenter/vSphere虚拟化软件。进行审计的凭据信息可以添加到策略的**VMware
    vCenter SOAP API设置**中的**高级**部分。示例包括以下内容：
- en: Missing patches
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 缺少补丁
- en: Missing security updates
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 缺少安全更新
- en: 'Some other platforms that are included in Nessus''s compliance check options
    include the following (please cross-check the updated documentation on Tenable''s
    official website, [https://support.tenable.com/](https://support.tenable.com/))
    A few sections of this chapter has been referenced from learning material available
    on Nessus website [http://www.tenable.com](http://www.tenable.com):'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: Nessus合规性检查选项中还包括以下其他平台（请在Tenable官方网站[https://support.tenable.com/](https://support.tenable.com)上交叉检查更新的文档）本章的部分内容参考自Nessus网站[http://www.tenable.com](http://www.tenable.com)上可用的学习材料：
- en: IBM iSeries compliance checks
  id: totrans-71
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: IBM iSeries合规性检查
- en: Juniper Junos compliance checks
  id: totrans-72
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Juniper Junos合规性检查
- en: NetApp Data ONTAP compliance checks
  id: totrans-73
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: NetApp Data ONTAP合规性检查
- en: Palo Alto Network PAN-OS compliance checks
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Palo Alto Network PAN-OS合规性检查
- en: Check Point GAiA compliance checks
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Check Point GAiA合规性检查
- en: Tip
  id: totrans-76
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 提示
- en: The compliance plugins are only available to professional feed customers.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
  zh: 合规性插件仅适用于专业订阅客户。
- en: Summary
  id: totrans-78
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 摘要
- en: Nessus provides options of doing automated compliance checks using the tool,
    apart from vulnerability scanning. Using this option, it can be cross-checked
    whether the secure configuration settings of the infrastructure such as servers,
    network devices, and databases are in compliance with the defined policy or best
    practices an organization is following. A compliance requirement is also derived
    from different compliance standards adhered to by an organization. This feature
    is available to professional feed subscribers.
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: Nessus提供使用该工具进行自动合规性检查的选项，除了漏洞扫描。使用此选项，可以交叉检查基础设施的安全配置设置（如服务器、网络设备和数据库）是否符合组织正在遵循的定义策略或最佳实践。合规性要求也源自组织遵守的不同合规性标准。此功能仅适用于专业订阅用户。
- en: The **Policy Compliance** plugin family is available for compliance check scanning.
    The plugin family includes, but is not limited to, servers, network devices, and
    standards such as PCI DSS. The Nessus **Results** tab also offers a **Compliance**
    option while saving the output to specifically generate a compliance report. These
    compliance checks can be modified by using the`.audit` files. Appropriate credentials
    of the underlying infrastructure on which a compliance audit is being performed
    need to be updated in the tool.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: '**策略合规性**插件系列可用于合规性检查扫描。该插件系列包括但不限于服务器、网络设备和PCI DSS等标准。Nessus的**结果**选项卡还提供了一个**合规性**选项，可以在保存输出时专门生成合规性报告。这些合规性检查可以通过使用`.audit`文件进行修改。需要在工具中更新正在执行合规性审计的基础基础设施的适当凭据。'
