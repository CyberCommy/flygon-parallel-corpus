- en: Chapter 7. Forensic Analysis of Android Applications
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 第7章。Android应用程序取证分析
- en: 'This chapter will cover application analysis, using free and open source tools.
    It will focus on analyzing the data that would be recovered using any of the logical
    or physical techniques detailed in [Chapters 4](part0031.xhtml "Chapter 4. Extracting
    Data Logically from Android Devices") and [Chapter 5](part0040.xhtml "Chapter 5. Extracting
    Data Physically from Android Devices"). It will also rely heavily on the storage
    methods discussed in [Chapter 2](part0019.xhtml "Chapter 2. Setting Up an Android
    Forensic Environment"). We will see numerous SQLite databases, XML files, and
    other file types from various locations within the file hierarchy described in
    the second chapter. By the end of this chapter, you should be familiar with the
    following topics:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 本章将介绍应用程序分析，使用免费和开源工具。它将重点分析使用[第4章](part0031.xhtml "第4章。从Android设备逻辑上提取数据")和[第5章](part0040.xhtml
    "第5章。从Android设备物理上提取数据")中详细介绍的任何逻辑或物理技术恢复的数据。它还将大量依赖于[第2章](part0019.xhtml "第2章。设置Android取证环境")中讨论的存储方法。我们将看到第二章中描述的文件层次结构中各个位置的众多SQLite数据库、XML文件和其他文件类型。在本章结束时，您应该熟悉以下主题：
- en: 'An overview of application analysis:'
  id: totrans-2
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 应用程序分析概述：
- en: Contacts/Calls/SMS
  id: totrans-3
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 联系人/通话/短信
- en: Wi-Fi
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Wi-Fi
- en: User dictionary
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 用户词典
- en: 'Third-party applications and various methods used by popular applications to
    store and obfuscate data listed as follows:'
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 列出了第三方应用程序和流行应用程序用于存储和混淆数据的各种方法。
- en: Plain text
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 纯文本
- en: Epoch time
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 时代时间
- en: WebKit time
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: WebKit时间
- en: Misnaming file extensions
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 错误命名文件扩展名
- en: Julian dates
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 儒略日期
- en: Base64 encoding
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Base64编码
- en: Encryption
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 加密
- en: Basic steganography
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基本隐写术
- en: SQLCipher
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: SQLCipher
- en: Basic application reverse engineering
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 基本应用程序逆向工程
- en: Application analysis
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 应用程序分析
- en: Forensically analyzing an application is as much of an art as it is a science.
    There are myriad ways an application can store or obfuscate its data. Different
    versions of the same application may even store the same data differently. A developer
    is really only limited by their imagination (and Android platform restrictions)
    when it comes to choosing how to store their data. As a result of these factors,
    application analysis is a constantly shifting target. The methods that an examiner
    uses one day may be completely irrelevant the next.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 对应用程序进行取证分析既是一门艺术，也是一门科学。应用程序可以存储或混淆数据的方式多种多样。甚至同一应用程序的不同版本可能以不同的方式存储相同的数据。当开发者选择如何存储他们的数据时，他们实际上只受到他们的想象力（和Android平台的限制）的限制。由于这些因素，应用程序分析是一个不断变化的目标。一天使用的方法可能在第二天就完全无关紧要了。
- en: The end goal of forensically analyzing an application is consistently the same,
    to understand what the app was used for and find user data.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 对应用程序进行取证分析的最终目标始终是相同的，即了解应用程序的用途并找到用户数据。
- en: In this chapter, we will look at the current version of many common applications.
    As apps can, and do, change how they store data through updates, nothing in this
    chapter is a definitive guide for how to analyze that application. Instead, we
    will look at a broad range of applications to show a variety of different methods
    used by applications to store their data. For the most part, we will look at very
    common applications (millions of downloads from Google Play), except for cases
    where looking at an obscure app can reveal interesting new ways of storing data.
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: 在本章中，我们将查看许多常见应用程序的当前版本。由于应用程序可以通过更新改变它们存储数据的方式，因此本章中的内容并不是分析该应用程序的权威指南。相反，我们将查看广泛的应用程序范围，展示应用程序用于存储数据的各种不同方法。在大多数情况下，我们将查看非常常见的应用程序（从Google
    Play下载了数百万次），除非查看一个不常见的应用程序可以揭示存储数据的有趣新方法。
- en: Note
  id: totrans-21
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: While we made every attempt to be thorough in our usage of each application
    when populating our test data, it is entirely possible that not every feature
    of every application was used. The apps analyzed in the following sections are
    examples of how to examine data from that application, but may not include every
    possible bit of data that may be recovered.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 虽然我们在填充测试数据时尽力全面地使用了每个应用程序的功能，但有可能并没有使用每个应用程序的每个功能。以下部分中分析的应用程序是如何检查该应用程序的数据的示例，但可能并不包括可能恢复的每一小部分数据。
- en: All of our testing used the default settings of each application, as if the
    application was downloaded and immediately used. Different settings may affect
    the data that is stored and the location of the data on the device.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 我们所有的测试都使用了每个应用程序的默认设置，就好像应用程序是下载并立即使用的一样。不同的设置可能会影响存储的数据以及设备上数据的位置。
- en: Also, this analysis was done on a Nexus 5 running Android 5.0.1\. Certain manufacturers,
    such as HTC and Samsung, may provide applications that duplicate functionality
    from these apps (such as a home screen widget that accesses Facebook). These apps
    may store data in different locations. Some files we analyze may not be present
    on other versions.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，这项分析是在运行Android 5.0.1的Nexus 5上进行的。某些制造商，如HTC和三星，可能提供复制这些应用程序功能的应用程序（例如访问Facebook的主屏幕小部件）。这些应用程序可能会将数据存储在不同的位置。我们分析的一些文件可能在其他版本上不存在。
- en: Why do app analysis?
  id: totrans-25
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 为什么要进行应用程序分析？
- en: 'For starters, even standard phone functions, such as contacts, calls, and SMS,
    are done through applications on Android devices. So, even acquiring basic data
    requires us to analyze an application. Second, a person''s app usage can tell
    you a lot about them: where they''ve been (and when they were there), who they''ve
    communicated with, and even what they may be planning in the future.'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，即使是标准的手机功能，如联系人、通话和短信，也是通过Android设备上的应用程序完成的。因此，即使获取基本数据也需要我们分析一个应用程序。其次，一个人的应用程序使用情况可以告诉你很多关于他们的信息：他们去过哪里（以及何时去过），他们与谁交流过，甚至他们可能在未来计划做什么。
- en: Many phones can come out of the box with more than 20 preinstalled applications.
    A Yahoo study in 2014 revealed that users have, on average, 95 apps installed
    on their device. A Nielsen study showed that the average user uses 26 apps per
    month. An examiner has no real way of knowing which of these apps could contain
    information useful for an investigation, and therefore, all of them must be analyzed.
    An examiner may be tempted to skip over certain apps that would appear to have
    little useful data, such as games. This would be a bad idea, though. Many popular
    games, such as *Words with Friends* or *Clash of Clans*, have a built-in chat
    feature that could yield useful information. The following analysis will focus
    heavily on messaging applications, as our experience shows that these tend to
    be the most valuable in forensic analysis.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
- en: The layout of this chapter
  id: totrans-28
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'For each application we examine, we will provide a package name, version number
    if possible, and files of interest. For example:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
- en: 'Package name: `com.android.providers.contacts`'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
- en: 'Version: Default version with Android 5.0.1 (not listed within app)'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
- en: 'Files of interest:'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
- en: '`/files/`'
  id: totrans-33
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`photos/`'
  id: totrans-34
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: All apps store their data in the `/data/data` directory by default. Apps could
    also use the SD card if they ask for this permission when the app is installed.
    The package name is the name of the directory for the application in the `/data/data`
    directory. Files of interest are from the root of the package name (that is, /`data/data/com.android.providers.contacts/files/photos`
    for the preceding example). Paths to data on the SD card are shown beginning with
    `/sdcard` (that is, `/sdcard/com.facebook.orca`). Do not expect to find data paths
    beginning with `/sdcard` in the `/data/data` directory of the application!
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
- en: We will begin by looking at some of Google's applications, because these are
    preinstalled on the vast majority of devices (though they do not have to be).
    Then, we will look at third-party applications that can be found on Google Play.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
- en: Determining what apps are installed
  id: totrans-37
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To see what applications are on the device, an examiner could navigate to `/data/data`
    and run the `ls` command. However, this doesn''t provide well-formatted data that
    will look good in a forensic report. We suggest that you pull the `/data/system/packages.list`
    file. This file lists the package name for every app on the device and path to
    its data (if this file does not exist on the device, the `adb shell pm list packages
    -f` command is a good alternative). For example, here is an entry for Google Chrome
    (the full file on our test device contained 120 entries):'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
- en: '![Determining what apps are installed](img/image00389.jpeg)'
  id: totrans-39
  prefs: []
  type: TYPE_IMG
- en: Note
  id: totrans-40
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'This is the first method of data storage: plain text. Often, we will see apps
    store data in plain text, including data you wouldn''t expect (such as passwords).'
  id: totrans-41
  prefs: []
  type: TYPE_NORMAL
- en: 'Perhaps of greater interest is the `/data/system/package-usage.list` file,
    which shows the last time a package (or application) was used. It''s not perfect;
    the times shown in the file did not correlate exactly with the last time we used
    the app. It appears that the app updating or receiving notifications (even if
    the user does not view them) may affect the time. However, it is good for a general
    indication of the last apps the user accessed:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
- en: '![Determining what apps are installed](img/image00390.jpeg)'
  id: totrans-43
  prefs: []
  type: TYPE_IMG
- en: If you're wondering where the time is in the preceding line, it's in a format
    known as Linux epoch time.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
- en: Understanding Linux epoch time
  id: totrans-45
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '**Linux epoch time**, also known as Unix time or Posix time, is stored as the
    number of seconds (or milliseconds) since midnight on 1 January, 1970, UTC. A
    10-digit value indicates it is in seconds, while a 13-digit value is indicative
    of a millisecond value (at least for times likely to be found on a smartphone,
    as 9-digit second and 12-digit millisecond values haven''t occurred since 2001).'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
- en: In the preceding example, the value is `1422206858650`; Google Chrome was last
    used 1 billion, 422 million, 206 thousand, 858 seconds, and 650 milliseconds since
    midnight on 1 January, 1970! Don't worry; we don't know what date/time that is
    either. There are many scripts and tools available for download to convert this
    value to a human-readable format. We prefer the free tool **DCode**, which can
    be found at [http://www.digital-detective.net/digital-forensic-software/free-tools/](http://www.digital-detective.net/digital-forensic-software/free-tools/).
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 在上面的例子中，该值为`1422206858650`；Google Chrome自1970年1月1日午夜以来已经使用了10亿4220万6858秒和650毫秒！别担心；我们也不知道那是什么日期/时间。有许多可供下载的脚本和工具可用于将此值转换为人类可读格式。我们更喜欢免费工具**DCode**，可以在[http://www.digital-detective.net/digital-forensic-software/free-tools/](http://www.digital-detective.net/digital-forensic-software/free-tools/)找到。
- en: 'In DCode, simply select **Unix: Millisecond Value** from the drop-down list,
    type in the value in the **Value to Decode** field, and click on **Decode**:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 在DCode中，只需从下拉列表中选择**Unix：毫秒值**，在**解码值**字段中输入值，然后单击**解码**：
- en: '![Understanding Linux epoch time](img/image00391.jpeg)'
  id: totrans-49
  prefs: []
  type: TYPE_IMG
  zh: '![理解Linux时代时间](img/image00391.jpeg)'
- en: The **Add Bias** field can be selected to convert the time to the desired time
    zone.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: '**添加偏差**字段可以选择将时间转换为所需的时区。'
- en: Alternatively, there is also a very useful online epoch converter at [http://www.epochconverter.com/](http://www.epochconverter.com/).
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
  zh: 另外，还有一个非常有用的在线时代转换器，网址为[http://www.epochconverter.com/](http://www.epochconverter.com/)。
- en: Using either method, we can see that Google Chrome was actually last used on
    January 25, 2015, at 17:27:38.650 UTC. Linux epoch time is frequently used on
    Android devices to store date/time values and will come up repeatedly in our application
    analysis.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 使用任一方法，我们可以看到Google Chrome实际上是在2015年1月25日17:27:38.650 UTC最后使用的。Linux时代时间经常用于Android设备上存储日期/时间值，并将在我们的应用程序分析中反复出现。
- en: Note
  id: totrans-53
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: 'This is the second data storage method: Linux epoch time.'
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 这是第二种数据存储方法：Linux时代时间。
- en: Wi-Fi analysis
  id: totrans-55
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Wi-Fi分析
- en: 'Wi-Fi is not technically an application (as evidenced by the fact that it is
    not recovered from `/data/data`), but it is an invaluable source of data that
    should be examined. So, we''ll briefly discuss it here. Wi-Fi connection data
    is found in `/data/misc/wifi/wpa_supplicant.conf`. The `wpa_supplicant.conf` file
    contains a list of access points that the user has chosen to connect to automatically
    (this is set by default when a new access point is connected to). Access points
    that the user has "forgotten" through the device settings will not be shown. If
    the access point requires a password, that would also be stored in the file in
    plain text. In the following example, the `NETGEAR60` access point required a
    password (`ancientshoe601`), while `hhonors` did not:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: Wi-Fi在技术上不是一个应用程序（这可以从它没有从`/data/data`中恢复出来来证明），但它是一个宝贵的数据来源，应该被检查。因此，我们在这里简要讨论一下。Wi-Fi连接数据可以在`/data/misc/wifi/wpa_supplicant.conf`中找到。`wpa_supplicant.conf`文件包含了用户选择自动连接的访问点列表（当连接到新的访问点时，默认设置为自动连接）。用户通过设备设置“忘记”的访问点将不会显示。如果访问点需要密码，密码也会以明文存储在文件中。在下面的例子中，`NETGEAR60`访问点需要密码（`ancientshoe601`），而`hhonors`不需要：
- en: '![Wi-Fi analysis](img/image00392.jpeg)'
  id: totrans-57
  prefs: []
  type: TYPE_IMG
  zh: '![Wi-Fi分析](img/image00392.jpeg)'
- en: Note
  id: totrans-58
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: The presence of a **Service Set ID** (**SSID**) in this file does NOT mean that
    this device connected to that access point. These settings are saved to a user's
    Google account and added to the device when that account is set up. An examiner
    can only conclude that the user connected to these access points from some Android
    device, but not necessarily the device being examined.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 在这个文件中存在**服务集标识符**（SSID）并不意味着这个设备连接到了该访问点。这些设置保存在用户的Google账户中，并在设置该账户时添加到设备中。检查员只能得出用户从某个Android设备连接到这些访问点的结论，但不一定是正在检查的设备。
- en: Contacts/call analysis
  id: totrans-60
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 联系人/通话分析
- en: Contacts and call logs are stored in the same database. Contacts do not have
    to be added explicitly by the user. They may be autofilled when an e-mail is sent
    through Gmail, or a person is added on Google+, or possibly many other ways.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 联系人和通话记录存储在同一个数据库中。联系人不一定要由用户明确添加。当通过Gmail发送电子邮件时，或者在Google+上添加一个人，或者可能还有其他许多方式时，它们可能会被自动填充。
- en: 'Package name: `com.android.providers.contacts`'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 包名：`com.android.providers.contacts`
- en: 'Version: Default version with Android 5.0.1 (not listed within app)'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 版本：默认版本与Android 5.0.1（未在应用程序中列出）
- en: 'Files of interest:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 感兴趣的文件：
- en: '`/files/`'
  id: totrans-65
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/files/`'
- en: '`photos/`'
  id: totrans-66
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`photos/`'
- en: '`profile/`'
  id: totrans-67
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`profile/`'
- en: '`/databases/`'
  id: totrans-68
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/databases/`'
- en: '`contacts2.db`'
  id: totrans-69
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`contacts2.db`'
- en: The `files` directory contains photos for the user's contacts in the `photos`
    directory and the user's profile photo in the `profile` directory.
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: '`files`目录包含了用户联系人的`photos`目录中的照片和用户的个人资料照片在`profile`目录中。'
- en: 'The `contacts2.db` database contains all of the information about calls made
    to and from the device and all contacts in the user''s Google account. It contains
    the following tables:'
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: '`contacts2.db`数据库包含了设备上所有通话记录和用户Google账户中的所有联系人的信息。它包含以下表格：'
- en: '| Table | Description |'
  id: totrans-72
  prefs: []
  type: TYPE_TB
  zh: '| 表格 | 描述 |'
- en: '| --- | --- |'
  id: totrans-73
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `accounts` | This shows the accounts on the device that have access to the
    contacts list. At least one of the accounts will show the user''s Google account
    e-mail address. This list may include third-party apps installed that have permission
    to access the contacts list (we will see this in the Tango, Viber, and WhatsApp
    sections). |'
  id: totrans-74
  prefs: []
  type: TYPE_TB
  zh: '| `accounts` | 这显示了设备上具有访问联系人列表权限的账户。至少一个账户将显示用户的Google账户电子邮件地址。此列表可能包括已安装的第三方应用程序，这些应用程序具有访问联系人列表的权限（我们将在Tango、Viber和WhatsApp部分看到这一点）。'
- en: '| `calls` | This contains information regarding all calls to and from the device.
    The `number` column shows the remote user''s phone number, whether the call was
    sent or received. The `date` column is the date/time of the call, stored in the
    Linux epoch format. The `duration` column is the length of the call, in seconds.
    The `type` column indicates the type of call:'
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: '| `calls` | 这包含有关设备的所有呼入和呼出电话的信息。“number”列显示远程用户的电话号码，无论是发送还是接收的呼叫。“date”列是呼叫的日期/时间，以Linux时代格式存储。“duration”列是呼叫的长度，以秒为单位。“type”列指示呼叫的类型：'
- en: '`1` = incoming'
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`1` = 收到的'
- en: '`2` = outgoing'
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`2` = 发出的'
- en: '`3` = missed'
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`3` = 未接'
- en: The `name` column shows the remote user's name, if the number was stored in
    the contact list. The `geocoded_location` column shows the location of the phone
    number based on the area code (for US numbers) or country code. |
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
  zh: “name”列显示远程用户的名称，如果该号码存储在联系人列表中。“geocoded_location”列显示基于区号（对于美国号码）或国家代码的电话号码的位置。
- en: '| `contacts` | This contains partial information for contacts (more data can
    be found in the `raw_contacts` table). The `name_raw_contact_id` value corresponds
    to the `_id` value in the `raw_contacts` table. The `photo_file_id` value corresponds
    to the filename found in the `/files/photos` directory. The `times_contacted`
    and `last_time_contacted` columns show the number of times that contact was called
    from or made a call to the device, and the time of the last call in the Linux
    epoch format. |'
  id: totrans-80
  prefs: []
  type: TYPE_TB
  zh: '| `contacts` | 这包含联系人的部分信息（更多数据可以在“raw_contacts”表中找到）。“name_raw_contact_id”值对应于“raw_contacts”表中的“_id”值。“photo_file_id”值对应于“/files/photos”目录中找到的文件名。“times_contacted”和“last_time_contacted”列显示从设备呼叫或接听该联系人电话的次数，以及最后一次呼叫的时间（Linux时代格式）。'
- en: '| `data` | This table contains all of the information for each contact: e-mail
    address, phone numbers, and so on. The `raw_contact_id` column is a unique value
    for each contact that can be correlated with the `_id` value in `raw_contact_id`
    to identify the contact. Note that each contact may have several rows, as seen
    by the identical `raw_contact_id` values. There are 15 data columns (`data1` to
    `data15`) that contain some information about the contact, but there are no discernible
    patterns. The same column may contain the contact name, an e-mail address, a Google+
    profile, and so on. The value in the `data14` column correlates to the filenames
    of the images in the `/files/profiles` path. The `data15` column contains a thumbnail
    of the contact''s profile photo. |'
  id: totrans-81
  prefs: []
  type: TYPE_TB
  zh: '| `data` | 该表包含每个联系人的所有信息：电子邮件地址、电话号码等。“raw_contact_id”列是每个联系人的唯一值，可以与“raw_contact_id”中的“_id”值相关联以识别联系人。请注意，每个联系人可能有多行，如相同的“raw_contact_id”值所示。有15个数据列（“data1”到“data15”）包含有关联系人的一些信息，但没有可辨认的模式。同一列可能包含联系人姓名、电子邮件地址、Google+个人资料等。“data14”列中的值与“/files/profiles”路径中图像的文件名相关联。“data15”列包含联系人个人资料照片的缩略图。'
- en: '| `deleted_contacts` | This contains a `contact_id` value and `deleted_contact_timestamp`
    in the Linux epoch format. However, this cannot be correlated back to any other
    tables to identify the name of the contact that was deleted. It may be possible
    to use the deleted data-recovery techniques in [Chapter 6](part0048.xhtml "Chapter 6. Recovering
    Deleted Data from an Android Device"), *Recovering Deleted Data from an Android
    Device*, to recover the contact names, though. The `contact_id` value corresponds
    to the `contact_id` column in the `raw_contacts` table. |'
  id: totrans-82
  prefs: []
  type: TYPE_TB
  zh: '| `deleted_contacts` | 这包含“contact_id”值和以Linux时代格式的“deleted_contact_timestamp”。然而，这不能与任何其他表相关联以确定已删除的联系人的名称。可能可以使用[第6章](part0048.xhtml
    "第6章。从Android设备中恢复已删除的数据")中的已删除数据恢复技术来恢复联系人名称。“contact_id”值对应于“raw_contacts”表中的“contact_id”列。'
- en: '| `groups` | This shows groups in the contact list, either automatically generated
    or created by the user. The title of the group is the name of the group. There
    does not appear to be a way to identify users in each group. |'
  id: totrans-83
  prefs: []
  type: TYPE_TB
  zh: '| `groups` | 这显示联系人列表中的组，可以是自动生成的或用户创建的。组的标题是组的名称。似乎没有办法识别每个组中的用户。'
- en: '| `raw_contacts` | This contains all information for every contact in the contact
    list. The `display_name` column shows the contact''s name, if it is available.
    To determine the contact''s phone number, e-mail address, or other information,
    the `_id` column value must be matched back to the `raw_contact_id` value in the
    data table. The `sync3` column shows a timestamp, but based on our testing, this
    cannot be assumed to be the time the contact was added. We had contacts several
    years old that were synced this month. The `times_contacted` and `last_time_contacted`
    columns only apply for phone calls; sending an e-mail or SMS to a contact did
    not increment these values.We were unable to identify any means to determine whether
    a contact was added through the phone interface, added as a friend on Google+,
    or added through other methods. |'
  id: totrans-84
  prefs: []
  type: TYPE_TB
  zh: '| `raw_contacts` | 这包含联系人列表中每个联系人的所有信息。“display_name”列显示联系人的名称，如果可用。要确定联系人的电话号码、电子邮件地址或其他信息，必须将“_id”列的值与数据表中的“raw_contact_id”值匹配。“sync3”列显示时间戳，但根据我们的测试，不能假定这是联系人添加的时间。我们有一些几年前的联系人在本月同步了。“times_contacted”和“last_time_contacted”列仅适用于电话呼叫；向联系人发送电子邮件或短信不会增加这些值。我们无法确定任何方法来确定联系人是通过电话界面添加的，还是作为Google+上的朋友添加的，或者是通过其他方法添加的。'
- en: SMS/MMS analysis
  id: totrans-85
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 短信/彩信分析
- en: SMS and MMS messages are stored in the same database. In our experience, this
    database is also used, regardless of what application is used to send the SMS/MMS
    (that is, sending an SMS through Google Hangouts will populate this database,
    not the Hangouts database examined here). However, third-party apps may also record
    the data in their own databases.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: 短信和彩信消息存储在同一个数据库中。根据我们的经验，无论使用何种应用程序发送短信/彩信（即，通过Google Hangouts发送短信将填充此数据库，而不是在此处检查的Hangouts数据库），都会使用此数据库。但是，第三方应用程序也可能将数据记录在其自己的数据库中。
- en: 'Package name: `com.android.providers.telephony`'
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
  zh: 包名称：“com.android.providers.telephony”
- en: 'Version: Default version with Android 5.0.1 (not listed within app)'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
- en: 'Files of interest:'
  id: totrans-89
  prefs: []
  type: TYPE_NORMAL
- en: '`/app_parts`'
  id: totrans-90
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/databases/`'
  id: totrans-91
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`mmssms.db`'
  id: totrans-92
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`telephony.db`'
  id: totrans-93
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The `app_parts` directory contains attachments sent as an MMS, both sent and
    received.
  id: totrans-94
  prefs: []
  type: TYPE_NORMAL
- en: 'The `telephony.db` database is small, but contains one potentially useful source
    of information. The table in telephony.db is described as follows:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-96
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-97
  prefs: []
  type: TYPE_TB
- en: '| `siminfo` | This contains historical data for all SIMs that have been used
    in the device, including the ICCID, phone number (if it was stored on the SIM),
    and the **mobile country code** (**MCC**) / **mobile network code** (**MNC**),
    which can be used to identify the network provider. |'
  id: totrans-98
  prefs: []
  type: TYPE_TB
- en: 'The `mmssms.db` database contains all information regarding SMS and MMS messages
    as described in the following table:'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-100
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-101
  prefs: []
  type: TYPE_TB
- en: '| `part` | This contains information about files attached to an MMS. Each message
    will have at least two parts: an SMIL header and the attachment. This can be seen
    in the `mid` and `ct` columns, as well as the file type attached. The `_data`
    column provides the path to find the file on the device. |'
  id: totrans-102
  prefs: []
  type: TYPE_TB
- en: '| `pdu` | This contains metadata about each MMS. The `date` column identifies
    when the message was sent or received, in the Linux epoch format. The `_id` column
    appears to correspond to the mid value in the part column; correlating these values
    will show the time a specific image was sent. The `msg_box` column shows the direction
    of the message (`1` = received and `2` = sent). |'
  id: totrans-103
  prefs: []
  type: TYPE_TB
- en: '| `sms` | This contains metadata about each SMS (it does not include MMS information).
    The `address` column shows the phone number of the remote user, regardless of
    whether it was a sent or received message. The `person` column contains a value
    that can be looked up in the `contacts2.db` database and corresponds with `raw_contact_id`
    in the `data` table. The `person` column would be blank if it was a sent message
    or if the remote user is not in the contacts list. The `date` column shows the
    timestamp when a message was sent in the Linux epoch format. The `type` column
    shows the direction of the message (`1` = received, `2` = sent). The `body` column
    displays the content of the message. The `seen` column indicates whether or not
    the message was read (`0` = unread, `1` = read); all sent messages will be marked
    as unread. |'
  id: totrans-104
  prefs: []
  type: TYPE_TB
- en: '| `words`, `words_content`, `words_segdir` | This appears to contain duplicate
    content of messages; the exact purpose of this table is unclear. |'
  id: totrans-105
  prefs: []
  type: TYPE_TB
- en: User dictionary analysis
  id: totrans-106
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The **user dictionary** is an incredible source of data for an examiner. While
    it is not necessarily a standalone application, its data is stored in /`data/data
    directory` as if it were. The user dictionary is populated any time the user types
    a word that isn't recognized and chooses to save the word to avoid it being flagged
    by autocorrect. Interestingly, our test device contained dozens of words that
    we never typed or saved on the device. This data appears to sync with a user's
    Google account and persists across multiple devices. Words synced from the account
    were added in alphabetical order at the top of the database, while words added
    manually afterwards were populated in the order they were added at the bottom.
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
- en: 'Package name: `com.android.providers.userdictionary`'
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
- en: 'Version: Default version with Android 5.0.1 (not listed within app)'
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
- en: 'Files of interest:'
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
- en: '`/databases/user_dict.db`'
  id: totrans-111
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The table in the user dictionary is described as follows:'
  id: totrans-112
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-113
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-114
  prefs: []
  type: TYPE_TB
- en: '| `words` | The `word` column contains the word that was added to the dictionary.
    The `frequency` column should likely be ignored; it displayed the same value (250)
    regardless of the number of times we used the word. |'
  id: totrans-115
  prefs: []
  type: TYPE_TB
- en: 'Here are sample entries from a user dictionary:'
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
- en: '![User dictionary analysis](img/image00393.jpeg)'
  id: totrans-117
  prefs: []
  type: TYPE_IMG
- en: Gmail analysis
  id: totrans-118
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Gmail is an e-mail service provided by Google. A Gmail account is often asked
    for, though is not required, when the device is being set up for the first time.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: Gmail是谷歌提供的电子邮件服务。在首次设置设备时，通常会要求使用Gmail帐户，但并非必需。
- en: 'Package name: `com.google.android.gm`'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
  zh: 包名称：`com.google.android.gm`
- en: 'Version: Default version with Android 5.0.1 (not listed within app)'
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 版本：默认版本与Android 5.0.1（未在应用程序中列出）
- en: 'Files of interest:'
  id: totrans-122
  prefs: []
  type: TYPE_NORMAL
  zh: 感兴趣的文件：
- en: '`/cache`'
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/cache`'
- en: '`/databases/`'
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/databases/`'
- en: '`mailstore.<username>@gmail.com.db`'
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`mailstore.<username>@gmail.com.db`'
- en: '`databases/suggestions.db`'
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`databases/suggestions.db`'
- en: '`/shared_prefs/`'
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/shared_prefs/`'
- en: '`MailAppProvider.xml`'
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`MailAppProvider.xml`'
- en: '`Gmail.xml`'
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Gmail.xml`'
- en: '`UnifiedEmail.xml`'
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`UnifiedEmail.xml`'
- en: The `/cache` directory within the application folder contains recent files that
    were attached to e-mails, both sent and received. These attachments are saved
    here even if they are not explicitly downloaded by the user.
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
  zh: 应用文件夹中的`/cache`目录包含最近附加到电子邮件中的文件，包括已发送和已接收的文件。即使用户没有明确下载这些附件，它们也会保存在这里。
- en: 'The `mailstore.<username>@gmail.com.db` file contains a variety of useful information.
    Interesting tables within the database include the following:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
  zh: '`mailstore.<username>@gmail.com.db`文件包含各种有用的信息。数据库中的有趣表包括以下内容：'
- en: '| Table | Description |'
  id: totrans-133
  prefs: []
  type: TYPE_TB
  zh: '| 表 | 描述 |'
- en: '| --- | --- |'
  id: totrans-134
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `attachments` | This contains information about attachments, including their
    size and file path on the device (the `/cache` directory mentioned earlier). Each
    row also contains a `messages_conversation` value. This value can be compared
    with the `conversations` table to correlate an attachment with the e-mail it was
    included within. The `filename` column identifies the path on the device where
    the file is located. |'
  id: totrans-135
  prefs: []
  type: TYPE_TB
  zh: '| `附件` | 这包含有关附件的信息，包括它们在设备上的大小和文件路径（前面提到的`/cache`目录）。每行还包含一个`messages_conversation`值。这个值可以与`conversations`表进行比较，以将附件与其所包含的电子邮件相关联。`filename`列标识了文件在设备上的路径。|'
- en: '| `conversations` | In older versions, entire e-mail conversations could be
    recovered. In the current version, Google no longer stores the entire conversation
    on the device, possibly assuming that the user will have a data connection to
    download the full conversation. Instead, only the subject line and a "snippet"
    can be recovered. The snippet is roughly the amount of text that would appear
    in the notification bar or inbox screen of the app. The `fromCompact` column identifies
    the sender and any other recipients. |'
  id: totrans-136
  prefs: []
  type: TYPE_TB
  zh: '| `对话` | 在旧版本中，可以恢复整个电子邮件对话。在当前版本中，Google不再在设备上存储整个对话，可能是因为假定用户将有数据连接来下载完整的对话。相反，只能恢复主题行和“片段”。片段大致是在应用程序的通知栏或收件箱屏幕上显示的文本量。`fromCompact`列标识了发件人和其他收件人。|'
- en: The `suggestions.db` database contains terms that were searched within the application.
  id: totrans-137
  prefs: []
  type: TYPE_NORMAL
  zh: '`suggestions.db`数据库包含在应用程序中搜索的术语。'
- en: The XML files within the `shared_prefs` directory can confirm the account(s)
    that were used with the application. `Gmail.xml` contained another account that
    was linked with our test account, but never used with the application. `UnifiedEmail.xml`
    contained a partial list of senders who e-mailed the account, but with no discernible
    rationale. Many senders were on the list, but far from all, and they appeared
    in no particular order. `Gmail.xml` also contained the last time that the application
    was synced in the Linux epoch format.
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: '`shared_prefs`目录中的XML文件可以确认与应用程序一起使用的帐户。`Gmail.xml`包含了另一个与我们的测试帐户关联但从未与应用程序一起使用的帐户。`UnifiedEmail.xml`包含了给该帐户发送电子邮件的发件人的部分列表，但没有明显的原因。列表中有许多发件人，但远非全部，并且它们没有按特定顺序出现。`Gmail.xml`还包含了应用程序上次同步的时间，以Linux纪元格式表示。'
- en: Google Chrome analysis
  id: totrans-139
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Google Chrome分析
- en: Google Chrome is a web browser and is the default browser on Nexus and many
    other devices. Chrome data on the device is somewhat unique, in that, it contains
    data not just from the device, but from all devices on which the user has logged
    in to Chrome. This means that it is entirely possible (even very likely) that
    data from the user browsing on their desktop computer will be found in the databases
    on their phone. However, this also leads to huge amounts of data for an examiner
    to sort through, but that's a good problem to have.
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: Google Chrome是一款网络浏览器，也是Nexus和许多其他设备上的默认浏览器。设备上的Chrome数据有些独特，因为它不仅包含来自设备的数据，还包含用户在所有登录到Chrome的设备上的数据。这意味着用户在桌面电脑上浏览的数据很可能会在他们手机的数据库中找到。然而，这也导致了大量的数据需要鉴定人员整理，但这是一个好问题。
- en: 'Package name: `com.android.chrome`'
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
  zh: 包名称：`com.android.chrome`
- en: 'Version: 40.0.2214.89'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
  zh: 版本：40.0.2214.89
- en: 'Files of interest:'
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
  zh: 感兴趣的文件：
- en: '`/app_chrome/Default/`'
  id: totrans-144
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/app_chrome/Default/`'
- en: '`Sync Data/SyncData.sqlite3`'
  id: totrans-145
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Sync Data/SyncData.sqlite3`'
- en: '`Bookmarks`'
  id: totrans-146
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`书签`'
- en: '`Cookies`'
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Cookies`'
- en: '`Google Profile Picture.png`'
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Google Profile Picture.png`'
- en: '`History`'
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`历史`'
- en: '`Login Data`'
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`登录数据`'
- en: '`Preferences`'
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`偏好设置`'
- en: '`Top Sites`'
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`热门网站`'
- en: '`Web Data`'
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Web数据`'
- en: '`/app_ChromeDocumentActivity/`'
  id: totrans-154
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`/app_ChromeDocumentActivity/`'
- en: All of the files listed earlier in the `/app_chrome/Default` folder, except
    for the one `.png` file, Bookmarks, and Preferences, are SQLite databases despite
    the lack of a file extension.
  id: totrans-155
  prefs: []
  type: TYPE_NORMAL
  zh: '`/app_chrome/Default`文件夹中列出的所有文件，除了一个`.png`文件、书签和偏好设置之外，都是SQLite数据库，尽管没有文件扩展名。'
- en: The `SyncData.sqlite3` database is interesting because it appears to contain
    a list of data that has been synced from the user's account on the device back
    to Google's servers. Our database, with a very active Chrome account, contained
    over 2700 entries and included browsing history, autofill form information, passwords,
    and bookmarks. As an example, we were able to find a term one of the authors had
    searched for from 2012, seen in the following screenshot. This is interesting
    because the user purchased this phone in 2014, but previous data is still synced
    to the device.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: '`SyncData.sqlite3`数据库很有趣，因为它似乎包含了从用户设备同步到谷歌服务器的数据列表。我们的数据库中，一个活跃的Chrome账户包含了超过2700条条目，包括浏览历史、自动填充表单信息、密码和书签。举例来说，我们能够找到其中一位作者从2012年搜索过的一个词，如下截图所示。这很有趣，因为用户是在2014年购买了这部手机，但之前的数据仍然同步到了设备上。'
- en: '![Google Chrome analysis](img/image00394.jpeg)'
  id: totrans-157
  prefs: []
  type: TYPE_IMG
  zh: '![Google Chrome分析](img/image00394.jpeg)'
- en: '| Table | Description |'
  id: totrans-158
  prefs: []
  type: TYPE_TB
  zh: '| 表 | 描述 |'
- en: '| --- | --- |'
  id: totrans-159
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `metas` | There are many columns in the database that contain timestamps,
    and in our database, they all appear to be within seconds of each other for each
    entry. It is unclear which time corresponds to the exact time an entry was added,
    but all of the times roughly correspond with the time of the activity in the user''s
    account. The columns with timestamps are `mtime`, `server_mtime`, `ctime`, `server_ctime`,
    `base_version`, and `server_version`.The `non_unique_name` and `server_non_unique_name`
    columns show the content that was synced. For example, one of our entries shows:`autofill_entry`
    &#124; `LNAME` &#124; `Tindall`Other entries in these columns include URLs visited,
    passwords, and even devices that the account has used. |'
  id: totrans-160
  prefs: []
  type: TYPE_TB
  zh: '| `metas` | 数据库中有许多列包含时间戳，在我们的数据库中，它们似乎都是每个条目的时间相差不到一秒。目前还不清楚哪个时间对应于条目被添加的确切时间，但所有时间大致对应于用户账户中的活动时间。具有时间戳的列包括`mtime`、`server_mtime`、`ctime`、`server_ctime`、`base_version`和`server_version`。`non_unique_name`和`server_non_unique_name`列显示了被同步的内容。例如，我们的一个条目显示：`autofill_entry`
    &#124; `LNAME` &#124; `Tindall`这些列中的其他条目包括访问过的URL、密码，甚至是账户使用过的设备。'
- en: 'The `Bookmarks` file is a plain-text file that contains information about the
    bookmarks synced with the account. It includes the name of each site that is bookmarked,
    the URL, and the date/time it was bookmarked, stored in a format we have not come
    across yet: the WebKit format. To decode the values, see the Decoding the WebKit
    time format section.'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: '`Bookmarks`文件是一个纯文本文件，包含了与账户同步的书签信息。它包括了每个被书签的网站名称、URL以及被书签的日期/时间，以我们尚未遇到的格式存储：WebKit格式。要解码这些值，请参阅解码WebKit时间格式部分。'
- en: Note
  id: totrans-162
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意
- en: 'This is the third method of data storage: the WebKit time format.'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 这是第三种数据存储方法：WebKit时间格式。
- en: The `Cookies` database stores cookie information for sites visited (depending
    on the site and Chrome settings), including the name of the site, date the cookie
    was saved, and the last time the cookie was accessed, in the WebKit time format.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
  zh: '`Cookies`数据库存储了访问过的网站的cookie信息（取决于网站和Chrome设置），包括网站名称、cookie保存日期以及上次访问cookie的时间，以WebKit时间格式显示。'
- en: The `Google Profile Picture.PNG` file is the user's profile picture.
  id: totrans-165
  prefs: []
  type: TYPE_NORMAL
  zh: '`Google Profile Picture.PNG`文件是用户的个人资料图片。'
- en: 'The `History` database contains the user''s web history stored in the following
    tables:'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
  zh: '`History`数据库包含了用户的网络历史，存储在以下表中：'
- en: '| Table | Description |'
  id: totrans-167
  prefs: []
  type: TYPE_TB
  zh: '| 表 | 描述 |'
- en: '| --- | --- |'
  id: totrans-168
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `keyword_search_terms` | This contains a list of terms that were searched
    to use Google within Chrome. The `term` column shows what was searched, while
    `url_id` can be correlated with the URLs table to see the time of the search.
    |'
  id: totrans-169
  prefs: []
  type: TYPE_TB
  zh: '| `keyword_search_terms` | 这包含了在Chrome中使用Google搜索的搜索词列表。`term`列显示了搜索的内容，而`url_id`可以与URL表相关联，以查看搜索的时间。
    |'
- en: '| `segments` | This table contains some URLs that were visited, but not all.
    It is not clear what causes data to be entered into this table. |'
  id: totrans-170
  prefs: []
  type: TYPE_TB
  zh: '| `segments` | 这个表包含了一些被访问过的URL，但并非全部。目前还不清楚是什么导致数据被输入到这个表中。 |'
- en: '| `urls` | This contains the browsing history for the Google account across
    all devices, not just the device the database was pulled from. Our history went
    back approximately 3 months and contained 494 entries, although the Google account
    is much older than that, and we have certainly visited more than 494 pages in
    that time. It is unclear exactly what causes this discrepancy or determines the
    cut-off date for the history.The `id` column is a unique value for each row in
    the table. The `url` and `title` columns contain the URL visited and the name
    of the page. The `visit_count` column appears to be an accurate count of how many
    times the URL was visited. The value in `typed_count` column is always equal to
    or lesser than the value in the `visit_count` column, but we do not know exactly
    what it indicates. For some sites, the discrepancy can be accounted for by factoring
    in the number of times the site was visited through a bookmark rather than typing
    the URL, but this does not hold true for all cases. The `last_visit_time` column
    is the last time the URL was visited, in the WebKit time format. |'
  id: totrans-171
  prefs: []
  type: TYPE_TB
  zh: '| `urls` | 这包含了Google账户在所有设备上的浏览历史，而不仅仅是从数据库中提取的设备。我们的历史记录大约可以追溯到3个月前，包含了494条记录，尽管Google账户的历史要比这更久，我们在那段时间内肯定访问了超过494个页面。目前还不清楚是什么导致了这种差异，或者决定了历史记录的截止日期。`id`列是表中每行的唯一值。`url`和`title`列包含了访问的URL和页面名称。`visit_count`列似乎是URL被访问的准确次数。`typed_count`列的值始终等于或小于`visit_count`列的值，但我们不确定它具体表示什么。对于一些网站，这种差异可以通过考虑通过书签访问网站的次数来解释，而不是直接输入URL，但并非所有情况都适用。`last_visit_time`列是URL最后被访问的时间，以WebKit时间格式显示。
    |'
- en: '| `visits` | This contains a row for each visit to the URLs in the urls table;
    the number of entries in this table for a URL corresponds to the value in the
    `visit_count` column of the `url` table. The `url` column value correlates to
    the value in the `id` column of the `url` table. The time of each visit can be
    found in the `visit_time` column, again in the WebKit time format. |'
  id: totrans-172
  prefs: []
  type: TYPE_TB
  zh: '| `访问` | 这包含了urls表中每次访问的行；此表中对于一个URL的条目数量对应于`url`表中的`visit_count`列的值。`url`列的值与`url`表中的`id`列的值相关联。每次访问的时间可以在`visit_time`列中找到，同样以WebKit时间格式。
    |'
- en: The `Login Data` database contains login information saved in Chrome and is
    synced across all devices that use the Google account.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
  zh: '`登录数据`数据库包含在Chrome中保存的登录信息，并在使用Google账户的所有设备上同步。'
- en: '| Table | Description |'
  id: totrans-174
  prefs: []
  type: TYPE_TB
  zh: '| 表 | 描述 |'
- en: '| --- | --- |'
  id: totrans-175
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `logins` | The `origin_url` is the site the user visited initially, and `action_url`
    is the URL of the login page if the user is redirected to one. If the first page
    visited is the login page, then both URLs are the same. The `username_value` and
    `password_value` columns show the username and password stored for that URL in
    plain text; and no, we''re not going to include a screenshot of our database!
    The `date_created` is the date/time that the login information was first saved,
    in the WebKit time format. The `date_synced` column is the date/time on which
    the login data was synced locally to the device, again in the WebKit time format.
    The `times_used` column shows the number of times that login information was autofilled
    by Chrome after it was saved (excluding the first login, so some values may be
    0). |'
  id: totrans-176
  prefs: []
  type: TYPE_TB
  zh: '| `logins` | `origin_url`是用户最初访问的网站，`action_url`是如果用户被重定向到登录页面，则是登录页面的URL。如果访问的第一个页面是登录页面，则两个URL相同。`username_value`和`password_value`列显示了以明文存储的该URL的用户名和密码；不，我们不会包含我们数据库的截图！`创建日期`是登录信息首次保存的日期/时间，以WebKit时间格式存储。`同步日期`列是登录数据在本地设备上同步的日期/时间，同样以WebKit时间格式。`使用次数`列显示了Chrome保存后自动填充登录信息的次数（不包括第一次登录，因此有些值可能为0）。
    |'
- en: '`Preferences file` is a text file and contains the Google account(s) the user
    has signed into Chrome with.'
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
  zh: '`首选项文件`是一个文本文件，包含用户使用Chrome登录的Google账户。'
- en: The `Top Sites` database contains the sites that are most frequently visited,
    as these are shown by default when Chrome opens.
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: '`热门网站`数据库包含最常访问的网站，因为这些网站在Chrome打开时默认显示。'
- en: The `Web Data` database contains information the user has saved in order to
    automatically fill in forms on websites.
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
  zh: '`Web Data`数据库包含用户保存的信息，以便在网站上自动填写表单。'
- en: '| Table | Description |'
  id: totrans-180
  prefs: []
  type: TYPE_TB
  zh: '| 表 | 描述 |'
- en: '| --- | --- |'
  id: totrans-181
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `autofill` | This contains a list of fields on web-based forms and the value
    the user typed. The `name` column shows the name of the field that was typed in,
    while the `value` column shows what the user typed. The `date_created` and `date_last_used`
    columns are self-explanatory and are stored in the Linux epoch format.Note that
    while this is potentially very valuable information (for example, our database
    contained a few usernames not stored elsewhere), there is also very little context
    available. The URL where the information is not stored may not be determinable.
    |'
  id: totrans-182
  prefs: []
  type: TYPE_TB
  zh: '| `autofill` | 这包含基于网页的表单上的字段列表和用户输入的值。`名称`列显示了用户输入的字段名称，而`值`列显示了用户输入的内容。`创建日期`和`最后使用日期`列是不言自明的，并以Linux纪元格式存储。请注意，虽然这可能是非常有价值的信息（例如，我们的数据库中包含了一些其他地方没有存储的用户名），但可用的上下文信息非常少。信息未存储的URL可能无法确定。
    |'
- en: '| `autofill_profile_emails` | This contains all values the user has saved to
    autofill the `e-mail` field on a web form. |'
  id: totrans-183
  prefs: []
  type: TYPE_TB
  zh: '| `autofill_profile_emails` | 这包含用户保存的所有值，用于自动填充网页表单上的`电子邮件`字段。 |'
- en: '| `autofill_profile_names` | This contains all values the user has saved to
    autofill the `First`, `Middle`, `Last`, and `Full Name` fields on a web form.
    |'
  id: totrans-184
  prefs: []
  type: TYPE_TB
  zh: '| `autofill_profile_names` | 这包含用户保存的所有值，用于自动填充网页表单上的`名`、`中间名`、`姓`和`全名`字段。
    |'
- en: '| `autofill_profile_phonwa` | This contains all values the user has saved to
    autofill the `Phone Number` field on a web form. |'
  id: totrans-185
  prefs: []
  type: TYPE_TB
  zh: '| `autofill_profile_phonwa` | 这包含用户保存的所有值，用于自动填充网页表单上的`电话号码`字段。 |'
- en: '| `autofill_profiles` | This contains all values the user has saved to autofill
    address information fields on a web form. |'
  id: totrans-186
  prefs: []
  type: TYPE_TB
  zh: '| `autofill_profiles` | 这包含用户保存的所有值，用于自动填充网页表单上的地址信息字段。 |'
- en: The `/app_ChromeDocumentActivity`/ directory contains files with history for
    recent tabs that were open on the device. URLs can be recovered from these files
    for sites that were visited.
  id: totrans-187
  prefs: []
  type: TYPE_NORMAL
  zh: '`/app_ChromeDocumentActivity`/目录包含了在设备上最近打开的标签的历史记录文件。可以从这些文件中恢复被访问的网站的URL。'
- en: Decoding the WebKit time format
  id: totrans-188
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 解码WebKit时间格式
- en: 'Here is a sample WebKit time value: `13066077007826684`.'
  id: totrans-189
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是一个样本WebKit时间值：`13066077007826684`。
- en: At first glance, it appears to be very similar to the Linux epoch time, just
    slightly longer (perhaps it is storing nanoseconds?). An examiner who attempts
    to decode this as epoch time will get a date in May 2011, which may seem accurate,
    but is, in fact, several years off from the correct date!
  id: totrans-190
  prefs: []
  type: TYPE_NORMAL
  zh: 乍一看，它似乎与Linux纪元时间非常相似，只是稍微长一些（也许它存储的是纳秒？）。试图将其解码为纪元时间的审查员将得到2011年5月的日期，这可能看起来准确，但实际上比正确日期晚了几年！
- en: The WebKit time is an epoch time. It is just based on a different starting point
    than the Linux epoch time. The WebKit epoch time is the number of microseconds
    since midnight on January 1, 1601\. Yes, we said the year 1601\. Once we know
    where the epoch begins, converting to a recognizable format simply becomes a math
    problem. However, once again, we'd rather use DCode.
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
  zh: WebKit时间是一个纪元时间。它只是以不同的起始点为基础，而不是Linux纪元时间。WebKit纪元时间是自1601年1月1日午夜以来的微秒数。是的，我们说的是1601年。一旦我们知道纪元开始的地方，转换为可识别的格式就变成了一个数学问题。然而，再一次，我们宁愿使用DCode。
- en: 'This time, in DCode, choose Google Chrome Value in the **Decode Format** drop-down
    selection and click on **Decode**:'
  id: totrans-192
  prefs: []
  type: TYPE_NORMAL
  zh: 这一次，在DCode中，选择**解码格式**下拉选择中的Google Chrome值，然后单击**解码**：
- en: '![Decoding the WebKit time format](img/image00395.jpeg)'
  id: totrans-193
  prefs: []
  type: TYPE_IMG
  zh: '![解码WebKit时间格式](img/image00395.jpeg)'
- en: The actual value of our example is November 2, 2014 at 18:04:33 UTC. This is
    significantly different from the value we would have come up with if we thought
    it was a Linux epoch time!
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
- en: Google Maps analysis
  id: totrans-195
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Maps is a map/navigation application provided by Google.
  id: totrans-196
  prefs: []
  type: TYPE_NORMAL
- en: 'Package name: `com.google.android.apps.maps`'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
- en: 'Version: 9.2.0 (#902013124)'
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
- en: 'Files of interest:'
  id: totrans-199
  prefs: []
  type: TYPE_NORMAL
- en: '`/cache/http/`'
  id: totrans-200
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/databases/`'
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`gmm_myplaces.db`'
  id: totrans-202
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`gmm_storage.db`'
  id: totrans-203
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The `/cache/http` folder contains many files, with `.0` and `.1` file extensions.
    The `.0` files are web requests for the corresponding `.1` file. The `.1` files
    are predominantly images and can be viewed by changing their extension appropriately.
    On our test device, they were either `.jpg` or `.png` files. These files were
    predominantly locations near the user, not necessarily locations the user specifically
    searched for.
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
- en: Note
  id: totrans-205
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'This is the fourth data storage method: misnamed file extensions.'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
- en: Always verify the header of a file that can't be opened, or use automated tools,
    such as EnCase, to detect the mismatched header/file extension. A good resource
    to verify a file's signature is [http://www.garykessler.net/library/file_sigs.html](http://www.garykessler.net/library/file_sigs.html).
  id: totrans-207
  prefs: []
  type: TYPE_NORMAL
- en: The `gmm_myplaces.db` database contains locations saved by the user. This file
    syncs with the user's Google account, so these locations were not necessarily
    saved using the application.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
- en: 'The `gmm_storage.db` database contains search hits and locations that were
    navigated to the following table:'
  id: totrans-209
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-210
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-211
  prefs: []
  type: TYPE_TB
- en: '| `gmm_storage_table` | The `_key_pri` column appears to identify the type
    of the location. bundled appears to be a hit that came up on a search, while `ArrivedAtPlacemark`
    identifies locations that were actually navigated to. The `_data` column contains
    the address for the location. |'
  id: totrans-212
  prefs: []
  type: TYPE_TB
- en: Google Hangouts analysis
  id: totrans-213
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**Hangouts** is a chat/SMS application provided by Google. Hangouts is the
    default SMS client on Android devices.'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
- en: 'Package name: `com.google.android.gm`'
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
- en: 'Version: Default version with Android 5.0.1 (not listed within the app)'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
- en: 'Files of interest:'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
- en: '`/cache/volleyCache/`'
  id: totrans-218
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/databases/babel#.db` (our device had babel0.db and babel1.db)'
  id: totrans-219
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/shared_prefs/accounts.xml`'
  id: totrans-220
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The `cache` directory contains `.0` files, as discussed in the Google Maps example
    earlier. The files contain a URL to fetch the profile pictures of contacts, as
    well as a `.jpg` embedded within the file. Visiting the URL or carving the `.jpg`
    from the file will recover the contact's picture.
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
- en: 'The `babel#.db` file contains all messaging data. On our test device, `babel0.db`
    was blank, and `babel1.db` had all of the data for the active account. There are
    many tables within this database worth looking at:'
  id: totrans-222
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-223
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-224
  prefs: []
  type: TYPE_TB
- en: '| `conversations` | This contains conversation data. There is a unique `conversation_id`
    value for each chat. The `latest_message_timestamp` column is the time of the
    most recent chat, in the Linux epoch format. The `generated_name` column has a
    list of all participants in the chat, minus the account on the device. The `snippet_text`
    column is the content of the most recent message; like Gmail, the entire chat
    is not stored on the device. The `latest_message_author_full_name` and `latest_message_author_first_name`
    columns identify the author of the `snippet_text` column. The `inviter_full_name`
    and `inviter_first_name` columns identify which person initiated the conversation.
    |'
  id: totrans-225
  prefs: []
  type: TYPE_TB
- en: '| `dismissed_contacts` | This has a list of names of former contacts that had
    been messaged. These are labeled as "Hidden Contacts" within the app. |'
  id: totrans-226
  prefs: []
  type: TYPE_TB
- en: '| `messages` | As expected, this contains a detailed message history for each
    conversation. The `text` column contains the content of the message, and the `timestamp`
    column is the date/time in the Linux epoch format. The `remote_url` column is,
    once again, a URL to retrieve images shared in the message. Again, it can be accessed
    publically. The `author_chat_id` is a value that can be correlated with the participants
    table to identify the author of each message. |'
  id: totrans-227
  prefs: []
  type: TYPE_TB
- en: '| `participants` | This contains a list of people chatted with. It includes
    full names, profile picture URLs, and a `chat_id` value to identify the person
    in the messages table. |'
  id: totrans-228
  prefs: []
  type: TYPE_TB
- en: The `accounts.xml` file has a `phone_verification` field that contains the phone
    number associated with the Google account when Hangouts is configured to send
    SMS. This could be highly useful, because it is frequently difficult to obtain
    the device's phone number as it is often not stored on the device.
  id: totrans-229
  prefs: []
  type: TYPE_NORMAL
- en: Google Keep analysis
  id: totrans-230
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Keep is a note-taking application provided by Google. It can also be used to
    set reminders, either at a certain date/time or when the user is at a specified
    location.
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
- en: 'Package name: `com.google.android.keep`'
  id: totrans-232
  prefs: []
  type: TYPE_NORMAL
- en: 'Version: Default version with Android 5.0.1 (not listed within app)'
  id: totrans-233
  prefs: []
  type: TYPE_NORMAL
- en: 'Files of interest:'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
- en: '`/databases/keep.db`'
  id: totrans-235
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/files/1/image/original`'
  id: totrans-236
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The `files/1/image/original` directory contains photos taken using the app.
    Notes and reminders can both be associated with an image.
  id: totrans-237
  prefs: []
  type: TYPE_NORMAL
- en: 'The `keep.db` contains all of the information about notes and reminders. There
    are, once again, several tables of interest:'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-239
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-240
  prefs: []
  type: TYPE_TB
- en: '| `alert` | This contains information about location-based reminders. The `reminder_id`
    column can be correlated with entries in the reminder table. The `reminder_detail`
    table contains the latitude and longitude set for the reminder. The `scheduled_time`
    column is the date/time the reminder was set, in the Linux epoch time. |'
  id: totrans-241
  prefs: []
  type: TYPE_TB
- en: '| `blob` | This contains metadata about images in the `/files` directory mentioned
    earlier, including the filename and size. The `blob_id` column can be correlated
    with the `_id` column in the `blob_node` table. |'
  id: totrans-242
  prefs: []
  type: TYPE_TB
- en: '| `blob_node` | This contains the time-created value for the images in the
    `/files` directory, in the Linux epoch time. |'
  id: totrans-243
  prefs: []
  type: TYPE_TB
- en: '| `list_item` | This stores data for each note on the device. The `text` column
    contains the full text of each note. The `list_parent_id` column is a unique value
    for each note. If multiple rows have the same value, it means they were created
    as a list within the same note. The `time_created` and `time_last_updated` columns
    are the time the note was created and the time it was last synced with the Google
    servers, in the Linux epoch time. |'
  id: totrans-244
  prefs: []
  type: TYPE_TB
- en: '| `reminder` | This contains data about each reminder set within the app. If
    the reminder is time based, the `julian_date` and `time_of_day` columns will be
    populated. |'
  id: totrans-245
  prefs: []
  type: TYPE_TB
- en: Converting a Julian date
  id: totrans-246
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '**Julian dates** are similar to the Linux epoch format, simply starting with
    a different date. The Julian date system counts the number of days since noon
    on January 1, 4713 BC. The United States Naval Observatory has an excellent Julian
    date calculator. To obtain the Julian date from the database, simply combine the
    two columns with a decimal in between. Here is an example:'
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
- en: '![Converting a Julian date](img/image00396.jpeg)'
  id: totrans-248
  prefs: []
  type: TYPE_IMG
- en: The preceding date would correspond to the Julian date 2457042.46800000\. When
    this value is input to the website, we can find out that the date the reminder
    is set for is January 19, 2015 at 23:13:55:2 UTC. The `location_name`, `latitude`,
    `longitude`, and `location_address` columns would be populated if a reminder is
    set as location based. Finally, the `time_created` and `time_last_updated` columns
    are the time the note was created and the time it was last synced with the Google
    servers, in the Linux epoch time.
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
- en: Note
  id: totrans-250
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The fifth data-storage method is Julian date.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
- en: Google Plus analysis
  id: totrans-252
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Google Plus is the Google-based social network. It allows us to share text/videos/images,
    add friends, follow people, and message. Google Plus may also, depending on the
    user's settings, automatically upload all pictures taken on the user's device.
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
- en: 'Package name: `com.google.android.apps.plus`'
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
- en: 'Version: 4.8.0.81189390'
  id: totrans-255
  prefs: []
  type: TYPE_NORMAL
- en: 'Files of interest:'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
- en: '`/databases/es0.db`'
  id: totrans-257
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The `Es0.db` database contains all the information an examiner would expect
    to find from a social-media account:'
  id: totrans-258
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-259
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-260
  prefs: []
  type: TYPE_TB
- en: '| `all_photos` | This contains a URL to download images shared by and with
    the user as well as the creation date/time in the Linux epoch format. |'
  id: totrans-261
  prefs: []
  type: TYPE_TB
- en: '| `activites` | This contains data displayed in the user''s stream (that is,
    their news feed). The created and modified time for each post is, once again,
    stored in the Linux epoch time. The title and comment columns will contain the
    post title and at least some of the comments from it. The `permalink` column contains
    a URL that can be followed to view the post, if it was shared publically. If the
    post is shared privately, the content can still be recovered from the embed table.
    The `relateds` column contains the hashtags automatically generated for the post
    by Google; this would also populate even if the post is private. |'
  id: totrans-262
  prefs: []
  type: TYPE_TB
- en: '| `activity_contacts` | This contains a list of names for people whose posts
    are in the activities table. |'
  id: totrans-263
  prefs: []
  type: TYPE_TB
- en: '| `all_photos` | This contains a list of *all* photos the user has backed up
    to Google Plus, whether they were shared or not. The values in the `image_url`
    column can be used to download any of the user''s photos and is publically available.
    Removing `-d` at the end of the URL will view the image without downloading it.
    The `timestamp` column is the date/time the image was taken, based on the image
    metadata. It does not indicate when the image was uploaded. |'
  id: totrans-264
  prefs: []
  type: TYPE_TB
- en: '| `all_tiles` | This contains an unknown subset of `all_photos`, but also includes
    images shared with the user. |'
  id: totrans-265
  prefs: []
  type: TYPE_TB
- en: '| `circle_contact` | This contains a list of people the user has added to their
    circles. It does not include names, but some of the `link_person_id` values include
    e-mail addresses. The `link_circle_id` value can be correlated with the circles
    table to identify the name of each circle. The `link_person_id` value can then
    be correlated with the `contacts` table to identify which user is in which circle.
    |'
  id: totrans-266
  prefs: []
  type: TYPE_TB
- en: '| `circles` | This has all the circles the user has created, as well as a count
    of the number of users in each one. |'
  id: totrans-267
  prefs: []
  type: TYPE_TB
- en: '| `contacts` | This contains a list of all contacts in the user''s circles.
    |'
  id: totrans-268
  prefs: []
  type: TYPE_TB
- en: '| `events` | This lists all events the user has been invited to, whether they
    attended or not. The `name` column is the title of the event. The `creator_gaia_id`
    column can be correlated with the `gaia_id` column in the contacts table to identify
    the event creator. The `start_time` and `end_time` columns are the time of the
    event, in the Linux epoch format. The `event_data` column has the description
    of the event entered by the creator, as well as information about the location
    if added. It also lists all the other users who were invited to the event. |'
  id: totrans-269
  prefs: []
  type: TYPE_TB
- en: '| `squares` | This contains a list of groups the user has joined. |'
  id: totrans-270
  prefs: []
  type: TYPE_TB
- en: Facebook analysis
  id: totrans-271
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Facebook is a social-media application with more than 1 billion downloads from
    Google Play.
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
- en: 'Package name: `com.facebook.katana`'
  id: totrans-273
  prefs: []
  type: TYPE_NORMAL
- en: 'Version: 25.0.0.19.30'
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
- en: 'Files of interest:'
  id: totrans-275
  prefs: []
  type: TYPE_NORMAL
- en: '`/files/video-cache/`'
  id: totrans-276
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/cache/images/`'
  id: totrans-277
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/databases/`'
  id: totrans-278
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`bookmarks_db2`'
  id: totrans-279
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`contacts_db2`'
  id: totrans-280
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`nearbytiles_db`'
  id: totrans-281
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`newsfeed_db`'
  id: totrans-282
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`notifications_db`'
  id: totrans-283
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`prefs_db`'
  id: totrans-284
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`threads_db2`'
  id: totrans-285
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The `/files/video-cache` directory contains videos from the user's newsfeed,
    though there does not appear to be a way to correlate them back to the user who
    posted them.
  id: totrans-286
  prefs: []
  type: TYPE_NORMAL
- en: The `/cache/images` directory contains images from the user's newsfeed as well
    as the profile photos of contacts. This directory contains a multitude of other
    directories (65 on our test phone), and each directory can contain multiple `.cnt`
    files. The `.cnt` files are typically `.jpg` files or other image formats.
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
- en: The `bookmarks_db2` database is a list of items that appear on the side of the
    user's newsfeed, such as groups and applications. Many of these bookmarks are
    automatically generated by Facebook, but may also be created by the user.
  id: totrans-288
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-289
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-290
  prefs: []
  type: TYPE_TB
- en: '| `bookmarks` | This contains all of the info within the database. The `bookmark_name`
    column is the name of the bookmark displayed to the user. The `bookmark_pic` column
    has a publically accessible URL to view the `bookmark` icon displayed to the user.
    The `bookmark_type` column identifies the type of the group. Our testing showed
    `profile`, `group`, `app`, `friend_list`, `page`, and `interest_list`. Finally,
    the `bookmark_unread_count` column shows how many messages in the group have not
    been read by the user. |'
  id: totrans-291
  prefs: []
  type: TYPE_TB
- en: 'The `contacts_db2` database predictably contains information about all of the
    user''s contacts stored in the following tables:'
  id: totrans-292
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-293
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-294
  prefs: []
  type: TYPE_TB
- en: '| `contacts` | This contains all information about the user''s contacts. The
    `fbid` column is a unique ID that is used to identify the contact in other databases.
    The `first_name`, `last_name`, and `display_name` columns show the contact''s
    name. The `small_picture_url`, `big_picture_url`, and `huge_picture_url` columns
    contain public links to the contact''s profile picture. The `communication_rank`
    column appears to be a number identifying how often the contact communicates with
    the user (taking into account messages, comments, and possibly other factors);
    a higher number indicates more communication with that contact. The `added_time_ms`
    column shows the time (in the Linux epoch format) the contact was added as a friend.
    The `bday_day` and `bday_month` columns show the contact''s birth date, but not
    the year. The `data` column contains a duplicate of all the rest of the data in
    the database, but also contains the contact''s location, which is not found elsewhere
    in the database. |'
  id: totrans-295
  prefs: []
  type: TYPE_TB
- en: The `nearbytiles_db` database contains locations near the user that may interest
    them. This is apparently populated constantly, even if the user does not view
    the locations. It is interesting because, while it isn't a fine location (most
    of our tests showed locations within 6–10 miles of our location), it is a rough
    idea of places a user has been.
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-297
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-298
  prefs: []
  type: TYPE_TB
- en: '| `nearby_tiles` | This contains the `latitude` and `longitude` values for
    locations near the user, as well as the time the location was retrieved from the
    Facebook servers in the Linux epoch format. |'
  id: totrans-299
  prefs: []
  type: TYPE_TB
- en: 'The `newsfeed_db` database contains data shown to the user in their newsfeed.
    Depending on the usage of the app, it can be a very large file containing the
    table:'
  id: totrans-300
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-301
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-302
  prefs: []
  type: TYPE_TB
- en: '| `home_stories` | The `fetched_at` column shows the time the story was pulled
    from the Facebook servers and likely corresponds closely with the time the user
    was using the application or saw the story. The `story_data` column contains the
    story stored as a blob of data. When viewed in a hex or text editor, the username
    of the person posting the story can be found. The content of the post can also
    be found in plain text and is often preceded by a tag that says `text`. An example
    of this is shown in the following screenshot. |'
  id: totrans-303
  prefs: []
  type: TYPE_TB
- en: '![Facebook analysis](img/image00397.jpeg)'
  id: totrans-304
  prefs: []
  type: TYPE_IMG
- en: Note
  id: totrans-305
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Note that the actual content of this one cell in the `story_data` column. It
    contained over 10,000 bytes of data, though the actual message is only around
    50 bytes.
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
- en: 'The `notifications_db` database contains notifications sent to the user stored
    in the following table:'
  id: totrans-307
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-308
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-309
  prefs: []
  type: TYPE_TB
- en: '| `gql_notifications` | The `seen_state` column shows whether or not the notification
    has been seen and read. The `updated` column contains the time the notification
    was updated (that is, sent if it is unread or the time it was read) in the Linux
    epoch format. The `gql_payload` column contains the content of the notification
    as well as the sender, similar to the `story_data` column in `newsfeed_db`. The
    message content again is frequently preceded by the flag `text`. A much smaller
    amount of data showing the text of the notification can be found in the `summary_graphql_text_with_entities`
    and `short_summary_graphql_text_with_entities` columns. The `profile_picture_uri`
    contains a public URL to view the sender''s profile picture, and the `icon_url`
    column has a link to view the icon associated with the notification. |'
  id: totrans-310
  prefs: []
  type: TYPE_TB
- en: 'The `prefs_db` database contains application preferences stored as follows:'
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-312
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-313
  prefs: []
  type: TYPE_TB
- en: '| `preferences` | The `/auth/user_data/fb_username` row shows the user''s Facebook
    username. The `/config/gk/last_fetch_time_ms` value is the timestamp of the app''s
    last communication with Facebook servers, but may not be an exact time of the
    user''s last interaction with the app. The `/fb_android/last_login_time` value
    shows the last time the user logged in through the app. The database contains
    many other timestamps. When put together, these timestamps can be used to build
    a decent profile of the app''s usage. The `/auth/user_data/fb_me_user` value contains
    data about the user, including their name, e-mail address, and phone number. |'
  id: totrans-314
  prefs: []
  type: TYPE_TB
- en: 'The `threads_db` database contains messaging information described as follows:'
  id: totrans-315
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-316
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-317
  prefs: []
  type: TYPE_TB
- en: '| `messages` | Each message has a unique ID in the `msg_id` column. The `text`
    column contains the message in plain text. The `sender` column identifies the
    Facebook ID and name of the message sender. The `timestamp_ms` column is the time
    the message was sent, in the Linux epoch format. The `attachments` column contains
    a public URL to retrieve attached images. The `coordinates` column would have
    the sender''s latitude and longitude if they have opted to show their location.
    The `source` column identifies whether the message was sent via the website or
    app. |'
  id: totrans-318
  prefs: []
  type: TYPE_TB
- en: Facebook Messenger analysis
  id: totrans-319
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Facebook Messenger is a messaging app separate from the main Facebook application.
    It has over 500,000,000 downloads in the Play Store.
  id: totrans-320
  prefs: []
  type: TYPE_NORMAL
- en: 'Package name: `com.facebook.orca`'
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
- en: 'Version: 18.0.0.27.14'
  id: totrans-322
  prefs: []
  type: TYPE_NORMAL
- en: 'Files of interest:'
  id: totrans-323
  prefs: []
  type: TYPE_NORMAL
- en: '`/cache/`'
  id: totrans-324
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`audio/`'
  id: totrans-325
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`fb_temp/`'
  id: totrans-326
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`image/`'
  id: totrans-327
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/sdcard/com.facebook.orca`'
  id: totrans-328
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/files/ rti.mqtt.analytics.xml`'
  id: totrans-329
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/databases/`'
  id: totrans-330
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`call_log.sqlite`'
  id: totrans-331
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`contacts_db2`'
  id: totrans-332
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`prefs_db`'
  id: totrans-333
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`threads_db2`'
  id: totrans-334
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The `/cache/audio` directory contains audio messages sent through the application.
    The files have a `.cnt` file extension, but are actually `.riff` files that can
    be played with Windows Media Player, VLC media player, and other programs.
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
- en: The `/cache/fb_temp` path contains temp files for images and video sent through
    the application. It is unclear how long these files will remain. In our testing,
    we sent and received a total of five files, and all five were still in the temp
    folder one week later.
  id: totrans-336
  prefs: []
  type: TYPE_NORMAL
- en: The `/cache/image` directory contains a multitude of other directories (33 on
    our test phone), and each directory can contain multiple `.cnt` files. The file
    header should be verified on each file, as some were video files and some were
    images. Several of the files from the `fb_temp` folder were found, as well as
    the profile pictures of some contacts.
  id: totrans-337
  prefs: []
  type: TYPE_NORMAL
- en: The `fb_temp` folder on the SD card contains sent images and video only.
  id: totrans-338
  prefs: []
  type: TYPE_NORMAL
- en: The application also includes an option (disabled by default) to download all
    the received images/video to the device's gallery. If this option is selected,
    all received images/video would be found on the SD card.
  id: totrans-339
  prefs: []
  type: TYPE_NORMAL
- en: The `/files/rti.mqtt.analytics.xml` file has the user's Facebook UID.
  id: totrans-340
  prefs: []
  type: TYPE_NORMAL
- en: 'The `call_log.sqlite` database contains a log of calls made through the application.
    The `person_summary` table contains the relevant data described as follows:'
  id: totrans-341
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-342
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-343
  prefs: []
  type: TYPE_TB
- en: '| `person_summary` | The `user_id` column contains the Facebook ID of the remote
    user. This can be correlated with the `fbid` column in `contacts_db2` to determine
    the user''s name. The `last_call_time` column contains the time of the previous
    call in the Linux epoch format. This table does not contain information about
    the direction of the call (sent or received). |'
  id: totrans-344
  prefs: []
  type: TYPE_TB
- en: 'The `contacts_db2` file is a SQLite database, despite the lack of a file extension.
    Useful tables within this database include the following ones:'
  id: totrans-345
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-346
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-347
  prefs: []
  type: TYPE_TB
- en: '| `contacts` | This table includes the contacts the user has added, as well
    as the contacts that were scraped from the user''s phone book (if the phone book
    contact uses Facebook Messenger). It contains the first and last names of each
    contact, as well as that contact''s Facebook ID (as discussed in the `call_log.sqlite`
    table earlier). The `added_time_ms` column shows the time each user was added
    into the app. This can give some insight into whether the contact was added manually
    or automatically. A large group of contacts added within milliseconds of each
    other were likely created automatically when the app was installed. The `small_picture_url`,
    `big_picture_url`, and `huge_picture_url` columns contain public links to the
    contact''s profile picture. A contact''s phone number can be found in the blob
    of information within the data column.It should be noted that we have no idea
    where some of the contacts in this database came from. They were not Facebook
    friends with our account and were not contacts in our device''s phone book, but
    were added at the same time that the phone book was scraped. Our best guess is
    that some contacts in our phone have phone numbers that Facebook associated with
    other users. |'
  id: totrans-348
  prefs: []
  type: TYPE_TB
- en: '| `favorite_contacts` | The `favorite_contacts` table shows contacts that have
    been added as favorites by the user. They are identified by the `fbid` column,
    which can be correlated back to the contacts table. |'
  id: totrans-349
  prefs: []
  type: TYPE_TB
- en: 'The `prefs_db` database contains useful metadata about the app and the account:'
  id: totrans-350
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-351
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-352
  prefs: []
  type: TYPE_TB
- en: '| `preferences` | The `/messenger/first_install_time` value indicates the time
    the application was installed, in the Linux epoch time. The `/auth/user_data/fb_username`
    value shows the username associated with the application. The `/config/neue/validated_phonenumber`
    value shows the phone number associated with the application. The users first
    and last names can be found in the `/auth/user_data/fb_me_user` value. |'
  id: totrans-353
  prefs: []
  type: TYPE_TB
- en: 'Finally, the `threads_db2` database contains data about messages:'
  id: totrans-354
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-355
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-356
  prefs: []
  type: TYPE_TB
- en: '| `group_clusters` | This shows folders the user has created. |'
  id: totrans-357
  prefs: []
  type: TYPE_TB
- en: '| `group_conversations` | This contains the `thread_key` value for each group
    chat. This can be correlated with the `messages` table. |'
  id: totrans-358
  prefs: []
  type: TYPE_TB
- en: '| `messages` | The `thread_key` value is a unique ID generated for each chat
    session. The `text` column has the contents of each text message sent and received.
    This also identifies voice calls using the phrases "You called Facebook User.",
    "Facebook User called you.", and "You missed a call from Facebook User.". The
    `sender` column identifies which user sent each message (or made each call). The
    `timestamp_ms` column shows the time each message was sent, in the Linux epoch
    format. The `attachments` column will show data for each sent or received attachment.
    The file type is also visible in the data. The `pending_send_media_attachment`
    column shows the path on the device to recover sent attachments. Finding received
    attachments directly does not appear possible, although they were recovered in
    the `/cache/images` directory discussed earlier. There was no way to correlate
    them with a specific message or sender. |'
  id: totrans-359
  prefs: []
  type: TYPE_TB
- en: Skype analysis
  id: totrans-360
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Skype is a voice-/video-calling app, as well as a messaging app owned by Microsoft.
    It has over 100,000,000 installs on Google Play.
  id: totrans-361
  prefs: []
  type: TYPE_NORMAL
- en: 'Package name: `com.skype.raider`'
  id: totrans-362
  prefs: []
  type: TYPE_NORMAL
- en: 'Version: 5.1.0.58677'
  id: totrans-363
  prefs: []
  type: TYPE_NORMAL
- en: 'Files of interest:'
  id: totrans-364
  prefs: []
  type: TYPE_NORMAL
- en: '`/cache/skype-4228/DbTemp`'
  id: totrans-365
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/sdcard/Android/data/com.skype.raider/cache/`'
  id: totrans-366
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/files/`'
  id: totrans-367
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`shared.xml`'
  id: totrans-368
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`<username>/thumbnails/`'
  id: totrans-369
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`<username>/main.db`'
  id: totrans-370
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`<username>/chatsync`'
  id: totrans-371
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The `/cache/skype-4228/DbTemp` directory contained multiple files with no extension.
    One of these files (`temp-5cu4tRPdDuQ3ckPQG7wQRFgU` on our device) was actually
    a SQLite database that contained the SSID and **Media Access Control** (**MAC**)
    of the wireless access points it had been connected to.
  id: totrans-372
  prefs: []
  type: TYPE_NORMAL
- en: The SD card path will contain any images or files received in a chat. If a file
    is downloaded, it would be in the `Downloads` folder in the root of the SD.
  id: totrans-373
  prefs: []
  type: TYPE_NORMAL
- en: 'The `shared.xml` file listed the account''s username as well as the last IP
    address that connected to Skype:'
  id: totrans-374
  prefs: []
  type: TYPE_NORMAL
- en: '![Skype analysis](img/image00398.jpeg)'
  id: totrans-375
  prefs: []
  type: TYPE_IMG
- en: The `<username>/thumbnails` directory contained the user's profile picture.
  id: totrans-376
  prefs: []
  type: TYPE_NORMAL
- en: 'The `main.db` database, like it sounds, contains the app usage history. Some
    important tables to look at are as follows:'
  id: totrans-377
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-378
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-379
  prefs: []
  type: TYPE_TB
- en: '| `Accounts` | This shows the accounts used on the device and the associated
    e-mail addresses. |'
  id: totrans-380
  prefs: []
  type: TYPE_TB
- en: '| `CallMembers` | This includes call logs from the app. The `duration` table
    is the duration of the call, and the `start_timestamp` column is the start time
    in the Linux epoch format; neither of these columns is populated if the call is
    not answered. The `creation_timestamp` column is the actual beginning of the call.
    It is populated as soon as the call is initiated within the app, so even unanswered
    calls are shown in this column. The `ip_address` column shows the IP address of
    the user for connected calls. The `type` column indicates whether the call was
    outgoing or incoming (1=incoming, 2=outgoing). The `guid` column also shows the
    direction of the call, listing each participant from left to right, with the user
    on the left-hand side being the one who initiated the call. The `call_db_id` column
    can be correlated with the `Calls` table to find further information about the
    call. |'
  id: totrans-381
  prefs: []
  type: TYPE_TB
- en: '| `Calls` | This is very similar to `CallMembers`, but with less information.
    It is worth noting that the `begin_timestamp` column in this table is identical
    to `creation_timestamp` in `CallMembers`. There is an `is_incoming` column to
    show the direction of the call; `0` indicates outgoing, and `1` indicates incoming.
    Finally, it should be noted that the duration of some calls did *not* match the
    `CallMembers` table. One of the durations was a second longer than the other table
    indicated. It appears that the `CallMembers` table calculates duration based on
    `start_timestamp`, while the `Calls` table calculates duration based on `begin_timestamp`.
    The difference in duration is likely caused by the amount of time it took the
    user to accept the call. |'
  id: totrans-382
  prefs: []
  type: TYPE_TB
- en: '| `ChatMembers` | This shows the users in each chat. The `adder` column lists
    the user that initiated the chat. |'
  id: totrans-383
  prefs: []
  type: TYPE_TB
- en: '| `Chats` | This lists each unique chat session. The `timestamp` column is
    the date/time the conversation began, in the Linux epoch format. The `dialog_partner`
    column shows users in the chat, excluding the account on the device. The `posters`
    column shows every user who has made a comment in the chat and includes the account
    on the device if it has posted. The `participants` column is similar to the `dialog_partner`
    column, but includes the user''s account. Finally, the `dbpath` column contains
    the name of the chat backup file found in the `<username>/chatsync` directory.
    This will become important further in this analysis. |'
  id: totrans-384
  prefs: []
  type: TYPE_TB
- en: '| `Contacts` | This is actually a very misleading table. In our test, we added
    two users to our contact list; the `Contacts` table has 233 entries! The `is_permanent`
    column indicates the status of the users listed in this table; if it is `1`, the
    user would be added as an actual contact within the application. The other 231
    entries appear to be names that came up in results when we searched for contacts,
    but we never communicated with or added them. |'
  id: totrans-385
  prefs: []
  type: TYPE_TB
- en: '| `Conversations` | We have no idea what the difference between `Conversations`
    and `Chats` is. They mostly contain the same information and, in fact, appear
    to be referencing the same chat sessions. |'
  id: totrans-386
  prefs: []
  type: TYPE_TB
- en: '| `Messages` | This contains every individual message from chats/conversations.
    The `convo_id` column has a unique value for each conversation; any messages with
    the same `convo_id` value are from the same conversation. The `author` and `from_dispname`
    columns show who wrote each message. The `timestamp` column, once again, shows
    the date/time of the message in the Linux epoch format. The `type` column indicates
    the type of message that was sent. Here are the values from our testing:'
  id: totrans-387
  prefs: []
  type: TYPE_NORMAL
- en: '`50`: friend request'
  id: totrans-388
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`51`: request accepted'
  id: totrans-389
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`61`: plain text message'
  id: totrans-390
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`68`: file transfer'
  id: totrans-391
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`30`: call begin (voice or video)'
  id: totrans-392
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`39`: call end (voice or video)'
  id: totrans-393
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`70`: video message'
  id: totrans-394
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The `body_xml` column has the content of the message. For plain-text messages
    and friend requests, the content is simply what the message said. File transfers
    show the size and name of the file. Video messages say that they are video messages,
    but provide no other information. Calls would show the duration if it was connected,
    and no duration if they were missed/ignored. The `identities` column shows who
    sent each message, but may be blank if it was sent by the user account on the
    device. The `reason` column appears to be for calls and shows either `no_answer`
    or `busy` to explain why a call was not connected. |
  id: totrans-395
  prefs: []
  type: TYPE_NORMAL
- en: '| `Participants` | This is similar to `ChatMembers`. It shows each user involved
    with a chat/conversation. |'
  id: totrans-396
  prefs: []
  type: TYPE_TB
- en: '| `SMSes` | Our testing did not include SMS messaging. However, each column
    in this table appears self-explanatory. |'
  id: totrans-397
  prefs: []
  type: TYPE_TB
- en: '| `Transfers` | This shows information about files transferred. This includes
    the filename, size, and path on the device. The `partner_dispname` column identifies
    which user began the file transfer. |'
  id: totrans-398
  prefs: []
  type: TYPE_TB
- en: '| `VideoMessages` | This shows the author and creation timestamp of video messages.
    Note that video messages are *not* stored on the device. Accessing them will be
    covered in a separate section later on in the chapter. |'
  id: totrans-399
  prefs: []
  type: TYPE_TB
- en: '| `VoiceMails` | Our testing did not include voice mails. However, each column
    in this table appears self-explanatory. |'
  id: totrans-400
  prefs: []
  type: TYPE_TB
- en: Recovering video messages from Skype
  id: totrans-401
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: As noted earlier, video messages are not stored on the device. Luckily, for
    us, they can be accessed via the Internet. The first step is to verify that a
    video message was sent by looking in the `Messages` table in the `body_xml` column.
    Next, note the `convo_id` field for the message shown in the following screenshot.
  id: totrans-402
  prefs: []
  type: TYPE_NORMAL
- en: '![Recovering video messages from Skype](img/image00399.jpeg)'
  id: totrans-403
  prefs: []
  type: TYPE_IMG
- en: Our video message is in `convo_id` `257`.
  id: totrans-404
  prefs: []
  type: TYPE_NORMAL
- en: 'Third, look in the `Chats` table for `convo_id` in the `conv_dbid` column and
    find the `dbpath` value. This will be the name of the conversation''s backup file
    as shown in the following screenshot:'
  id: totrans-405
  prefs: []
  type: TYPE_NORMAL
- en: '![Recovering video messages from Skype](img/image00400.jpeg)'
  id: totrans-406
  prefs: []
  type: TYPE_IMG
- en: To find the backup file, look in `files/<username>/chatsync`. There will be
    a folder for each conversation; the name of the folder is the first two digits
    of the backup name. Our backup will be in folder `28`.
  id: totrans-407
  prefs: []
  type: TYPE_NORMAL
- en: 'Open the backup file in a hex editor, and search for `videomessage`. You should
    find a URL and a code to access the video:'
  id: totrans-408
  prefs: []
  type: TYPE_NORMAL
- en: '![Recovering video messages from Skype](img/image00401.jpeg)'
  id: totrans-409
  prefs: []
  type: TYPE_IMG
- en: Note
  id: totrans-410
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Actually, accessing the URL may require an additional warrant or legal permission,
    depending on your local jurisdiction. As this data is not on the device and is
    private, viewing it without legal guidance could invalidate any evidence found
    in the video.
  id: totrans-411
  prefs: []
  type: TYPE_NORMAL
- en: Snapchat analysis
  id: totrans-412
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Snapchat is an image-sharing and text-messaging service with over 100,000,000
    downloads. Its signature feature is that images and videos sent will "self-destruct"
    after a time limit set by the sender, from 1-10 seconds. Furthermore, if a user
    takes a screenshot of the image, the sender is notified. Text chats do not have
    an expiration timer.
  id: totrans-413
  prefs: []
  type: TYPE_NORMAL
- en: 'Package name: `com.snapchat.android`'
  id: totrans-414
  prefs: []
  type: TYPE_NORMAL
- en: 'Version: 8.1.2'
  id: totrans-415
  prefs: []
  type: TYPE_NORMAL
- en: 'Files of interest:'
  id: totrans-416
  prefs: []
  type: TYPE_NORMAL
- en: '`/cache/stories/received/thumbnail/`'
  id: totrans-417
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/sdcard/Android/data/com.snapchat.android/cache/my_media/`'
  id: totrans-418
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/shared_prefs/com.snapchat.android_preferences.xml`'
  id: totrans-419
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/databases/tcspahn.db`'
  id: totrans-420
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The `/cache/stories/received/thumbnail` path contains thumbnails of pictures
    taken by the user on the device. The `/sdcard` path contains full-sized images.
    These remain even after the time limit has expired, and the recipient can no longer
    access them. The files in both of these locations may not have proper file extensions.
  id: totrans-421
  prefs: []
  type: TYPE_NORMAL
- en: The `com.snapchat.android_preferences.xml` file contains the e-mail address
    used to create an account and the phone number of the device registered with the
    account.
  id: totrans-422
  prefs: []
  type: TYPE_NORMAL
- en: 'The `tcspahn.db` database contains all other information about the app''s usage:'
  id: totrans-423
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-424
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-425
  prefs: []
  type: TYPE_TB
- en: '| `Chat` | This lists all text chats. It shows the sender, recipient, and timestamp
    in the Linux epoch time and the text of the message. |'
  id: totrans-426
  prefs: []
  type: TYPE_TB
- en: '| `ContactsOnSnapchat` | This shows all the users in the user''s phonebook
    who also have Snapchat installed. The `isAddedAsFriend` column would show a `1`
    value if the user has actually been added as a contact. |'
  id: totrans-427
  prefs: []
  type: TYPE_TB
- en: '| `Conversation` | This has information about each open conversation. It includes
    the sender and recipient and the timestamp of the last sent and received snaps
    in the Linux epoch format. |'
  id: totrans-428
  prefs: []
  type: TYPE_TB
- en: '| `Friends` | This is similar to `ContactsOnSnapchat`, but only includes users
    who have been added as a friend. It includes the timestamp when each user added
    the other. |'
  id: totrans-429
  prefs: []
  type: TYPE_TB
- en: '| `ReceivedSnaps` | This contains metadata about received images and videos.
    Once the image/video is viewed, it appears to be removed from this table at some
    point. It contains a timestamp for each message, a status, information whether
    or not a snap was screenshot, and the sender. |'
  id: totrans-430
  prefs: []
  type: TYPE_TB
- en: '| `SentSnaps` | This contains metadata about sent images and videos. Once the
    image/video is viewed, it appears to be removed from this table at some point.
    It contains a timestamp for each message, a status, and the recipient. |'
  id: totrans-431
  prefs: []
  type: TYPE_TB
- en: Viber analysis
  id: totrans-432
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Viber is a messaging and voice-/video-calling app with over 100,000,000 downloads.
  id: totrans-433
  prefs: []
  type: TYPE_NORMAL
- en: 'Package name: `com.viber.voip`'
  id: totrans-434
  prefs: []
  type: TYPE_NORMAL
- en: 'Version: 5.2.1'
  id: totrans-435
  prefs: []
  type: TYPE_NORMAL
- en: 'Files of interest:'
  id: totrans-436
  prefs: []
  type: TYPE_NORMAL
- en: '`/files/preferences/`'
  id: totrans-437
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`activated_sim_serial`'
  id: totrans-438
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`display_name`'
  id: totrans-439
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`reg_viber_phone_num`'
  id: totrans-440
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/sdcard/viber/media/`'
  id: totrans-441
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/User Photos/`'
  id: totrans-442
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/Viber Images/`'
  id: totrans-443
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/Viber Videos/`'
  id: totrans-444
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/databases/`'
  id: totrans-445
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`viber_data`'
  id: totrans-446
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`viber_messages`'
  id: totrans-447
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The files in `/files/preferences` contain the SIM card's **Integrated Circuit
    Card ID** (**ICCID**), the name the user displays in the app, and the phone number
    used to register with the app.
  id: totrans-448
  prefs: []
  type: TYPE_NORMAL
- en: The files in the `/sdcard/viber/media` path are the profile photos of people
    in the user's contact list who use Viber (regardless of whether they have been
    added as friends in the app) and all images and video sent through the app.
  id: totrans-449
  prefs: []
  type: TYPE_NORMAL
- en: 'The `viber_data` file is a database, even though it does not have the `.db`
    file extension. It contains information about the user''s contacts:'
  id: totrans-450
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-451
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-452
  prefs: []
  type: TYPE_TB
- en: '| `calls` | This table did not populate, even though we made calls from within
    the app. |'
  id: totrans-453
  prefs: []
  type: TYPE_TB
- en: '| `phonebookcontact` | This table could be extremely valuable from a forensic
    standpoint. When Viber is first opened, it scrapes the user''s phonebook and adds
    all the entries it finds to this database. This means it may contain historical
    data about the user''s contacts. If he later deletes an entry from the phone book,
    it may still be recovered in this database. This table only includes names of
    contacts in the phonebook. |'
  id: totrans-454
  prefs: []
  type: TYPE_TB
- en: '| `phonebookdata` | This is similar to phonebook contact, except that it includes
    e-mail addresses and phone numbers for contacts in the device''s phonebook. |'
  id: totrans-455
  prefs: []
  type: TYPE_TB
- en: '| `vibernumbers` | This shows the Viber phone number for each contact in the
    device''s phonebook that uses the app. The value in `actual_photo` corresponds
    with the filenames in the `/sdcard/viber/media/User Photos` directory. |'
  id: totrans-456
  prefs: []
  type: TYPE_TB
- en: 'The `viber_messages` file is a database, even though it does not have the `.db`
    file extension. It contains information about the app''s usage:'
  id: totrans-457
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-458
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-459
  prefs: []
  type: TYPE_TB
- en: '| `conversations` | This contains a unique ID, the recipient, and date for
    each unique conversation. |'
  id: totrans-460
  prefs: []
  type: TYPE_TB
- en: '| `messages` | This contains each individual message from all conversations.
    The address is the phone number of the remote party in the conversation. The `date`
    column is in the Linux epoch format. The `type` column corresponds to incoming
    or outgoing; `1` is an outgoing message, and `0` is incoming. The `location_lat`
    and `location_lng` columns will be populated if a location is shared. Shared files
    can be sent with text to describe them; this is found in the `description` column.
    |'
  id: totrans-461
  prefs: []
  type: TYPE_TB
- en: '| `messages_calls` | This table did not populate, even though we made calls
    from within the app. |'
  id: totrans-462
  prefs: []
  type: TYPE_TB
- en: '| `participants_info` | This has the profile information for each account that
    has been in a conversation with the user. |'
  id: totrans-463
  prefs: []
  type: TYPE_TB
- en: Tango analysis
  id: totrans-464
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Tango is a voice-/text-/video-messaging application. It has over 100,000,000
    downloads in the Play Store.
  id: totrans-465
  prefs: []
  type: TYPE_NORMAL
- en: 'Package name: `com.sgiggle.production`'
  id: totrans-466
  prefs: []
  type: TYPE_NORMAL
- en: Note
  id: totrans-467
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: This package name is seemingly innocuous and could be overlooked by an examiner
    thinking it was a game. This is an example of why every application should be
    analyzed.
  id: totrans-468
  prefs: []
  type: TYPE_NORMAL
- en: 'Version: 3.13.128111'
  id: totrans-469
  prefs: []
  type: TYPE_NORMAL
- en: 'Files of interest:'
  id: totrans-470
  prefs: []
  type: TYPE_NORMAL
- en: '`/sdcard/Android/data/com.sgiggle.production/files/storage/appdata/`'
  id: totrans-471
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`TCStorageManagerMediaCache_v2/`'
  id: totrans-472
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`conv_msg_tab_snapshots/`'
  id: totrans-473
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/files/`'
  id: totrans-474
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`tc.db`'
  id: totrans-475
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`userinfo.xml.db`'
  id: totrans-476
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The `/TCStorageManagerMediaCache_v2` path on the SD card contains images that
    were sent and received with the application as well as profile pictures of contacts.
    However, it also contains many images that were never seen or used in the application.
    They appear to either be images for ads or stock emoji-type images that can be
    attached to conversations. The filenames found here can be correlated with `tc.db`
    to find the exact image that was used in a conversation.
  id: totrans-477
  prefs: []
  type: TYPE_NORMAL
- en: The `conv_msg_tab_snapshots` path on the SD card contains files with a `.dat`
    extension. When viewed in a hex editor, we were able to find snippets of conversations
    in plain text, as well as paths and URLs to images sent and received in conversations.
    It is unclear what causes these files to exist, but it may be possible to retrieve
    content from these files that may have been deleted in `tc.db`.
  id: totrans-478
  prefs: []
  type: TYPE_NORMAL
- en: 'The `tc.db` database is what Tango uses to store all message information:'
  id: totrans-479
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-480
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-481
  prefs: []
  type: TYPE_TB
- en: '| `conversations` | This contains a unique ID in the `conv_id` column for each
    conversation. |'
  id: totrans-482
  prefs: []
  type: TYPE_TB
- en: '| `messages` | This contains messages sent and received through the app. The
    `msg_id` column is a unique identifier for each message, and the `conv_id` column
    identifies which conversation the message is from. The `send_time` column identifies
    the time a message was sent or when it was received, depending on the direction.
    The `direction` column shows the direction of the message; `1` = sent and `2`
    = received. The `type` column identifies the type of the message. Based on our
    testing, they are as follows:'
  id: totrans-483
  prefs: []
  type: TYPE_NORMAL
- en: '`0` = plain text message'
  id: totrans-484
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`1` = video message'
  id: totrans-485
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`2` = audio message'
  id: totrans-486
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`3` = image'
  id: totrans-487
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`4` = location/coordinates'
  id: totrans-488
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`35` = voice call'
  id: totrans-489
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`36` = attempted voice call (missed by either party)'
  id: totrans-490
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`58` = attached stock image, such as the emojis found in the TCStorageManagerMediaCache_v2
    path'
  id: totrans-491
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Finally, the `payload` column contains the content of the message. The data
    is Base64 encoded, which will be discussed in detail in the following section.
    |
  id: totrans-492
  prefs: []
  type: TYPE_NORMAL
- en: The `user_info_xml.db` database contains metadata about the account, such as
    the user's name and phone number. However, its data is entirely Base64 encoded,
    like the messages in `tc.db`.
  id: totrans-493
  prefs: []
  type: TYPE_NORMAL
- en: Note
  id: totrans-494
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The next data-storage method is Base64.
  id: totrans-495
  prefs: []
  type: TYPE_NORMAL
- en: Decoding Tango messages
  id: totrans-496
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Base64 is an encoding scheme that is commonly used for data transport. It is
    not considered encryption, because it has a known method for decoding and does
    not require a unique key to decode the data. Base64 contains ASCII-printable characters,
    but the underlying data is binary (which will make our output somewhat messy!).
    An example from the `payload` column in the `messages` table of `tc.db` looks
    like this:'
  id: totrans-497
  prefs: []
  type: TYPE_NORMAL
- en: '`EhZtQzVtUFVQWmgxWnNRUDJ6aE44cy1nGAAiQldlbGNvbWUgdG8gVGFuZ28hIEhlcmUncyBob3cgdG8gY29ubmVjdCwgZ2V0IHNvY2lhbCwgYW5kIGhhdmUgZnVuIYABAKoBOwoFVGFuZ28SABoWbUM1bVBVUFpoMVpzUVAyemhOOHMtZyILCgcKABIBMRoAEgAqADD///////////8BsAHYioX1rym4AYKAgAjAAQHQAQDoAdC40ELIAgTQAgDqAgc4MDgwODg5yAMA2AMA2AXTHw==`'
  id: totrans-498
  prefs: []
  type: TYPE_NORMAL
- en: Note
  id: totrans-499
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The equal signs at the end of our message. This is a strong indicator that the
    data is Base64 encoded. The input that will be encoded needs to be divisible by
    3, for the math behind Base64 to work properly. If the input is not divisible
    by 3, it would be padded, resulting in the equal signs seen in the output.
  id: totrans-500
  prefs: []
  type: TYPE_NORMAL
- en: 'For example, consider the following table:'
  id: totrans-501
  prefs: []
  type: TYPE_NORMAL
- en: '| Input string | Number of characters/bytes | Output |'
  id: totrans-502
  prefs: []
  type: TYPE_TB
- en: '| --- | --- | --- |'
  id: totrans-503
  prefs: []
  type: TYPE_TB
- en: '| `Hello`, `World` | 12 | `SGVsbG8sIFdvcmxk` |'
  id: totrans-504
  prefs: []
  type: TYPE_TB
- en: '| `Hello, World!` | 13 | `SGVsbG8sIFdvcmxkIQ==` |'
  id: totrans-505
  prefs: []
  type: TYPE_TB
- en: '| `Hello, World!!` | 14 | `SGVsbG8sIFdvcmxkISE=` |'
  id: totrans-506
  prefs: []
  type: TYPE_TB
- en: You can see that the 12-byte input (divisible by 3) has no padding, while the
    other two inputs have padding because they are not divisible by 3\. This is important
    because it shows that while the equal signs are a strong indicator of Base64,
    the lack of an equal sign does not mean it isn't Base64!
  id: totrans-507
  prefs: []
  type: TYPE_NORMAL
- en: Now that we understand a little about Base64 and recognize that our `payload`
    column is very likely encoded in Base64, we need to decode it. There are websites
    that will allow the user to paste in encoded data, and it will be decrypted (such
    as [www.base64decode.org](http://www.base64decode.org)). However, it is inconvenient
    for large amount of data as each message must be input individually (and putting
    evidentiary data on the Internet is also frowned upon in most cases). Likewise,
    it can be decoded on the command line of Linux-based systems, but is equally inconvenient
    for large amounts of data.
  id: totrans-508
  prefs: []
  type: TYPE_NORMAL
- en: 'Our solution was to build a Python script that pulls the Base64 data from the
    database, decodes it, and writes it back out to a new file:'
  id: totrans-509
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  id: totrans-510
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'To run the code, simply paste this code into a new file named `tcdb.py`, place
    the script in the same directory as `tc.db`, and on the command line, navigate
    to that directory and run:'
  id: totrans-511
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  id: totrans-512
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'The script will make a file named `tcdb_out.txt` in the same directory. Opening
    the file in a text editor (or importing it into Excel as a tab-delimited file)
    will show the `msg_id` value so that the examiner can correlate the message back
    to the messages table. The decoded payload shows a plain text message (noted as
    type `0` in the database):'
  id: totrans-513
  prefs: []
  type: TYPE_NORMAL
- en: '![Decoding Tango messages](img/image00402.jpeg)'
  id: totrans-514
  prefs: []
  type: TYPE_IMG
- en: Note
  id: totrans-515
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Note that the message content is now visible in plain text and is preceded by
    the conversation ID. There is also a ton of binary data cluttering up our output;
    this is likely metadata or other information used by Tango. If the message was
    received, the user's name will also be in the output (above it is Tango).
  id: totrans-516
  prefs: []
  type: TYPE_NORMAL
- en: 'There are other message types worth looking at, also. Here is a decoded payload
    entry for a video message:'
  id: totrans-517
  prefs: []
  type: TYPE_NORMAL
- en: '![Decoding Tango messages](img/image00403.jpeg)'
  id: totrans-518
  prefs: []
  type: TYPE_IMG
- en: Note that with the video message, we can see two URLs. They are both public,
    meaning anyone with the link can access them. The URL ending in thumbnail is a
    thumbnail of the video, while the other URL will download the complete video in
    the `.mp4` format. The path to the SD card and filename for the image is also
    shown.
  id: totrans-519
  prefs: []
  type: TYPE_NORMAL
- en: Image and audio messages are stored in a very similar format and contain URLs
    to either view or download the file. They also contain the path to the file on
    the SD card.
  id: totrans-520
  prefs: []
  type: TYPE_NORMAL
- en: 'Here is a sample location message:'
  id: totrans-521
  prefs: []
  type: TYPE_NORMAL
- en: '![Decoding Tango messages](img/image00404.jpeg)'
  id: totrans-522
  prefs: []
  type: TYPE_IMG
- en: This time, we can see the exact coordinates the user was at as well as the address.
    Again, a path on the SD card is also present and will show the map view of the
    location. As with other message types, a received message would also show the
    sender's name.
  id: totrans-523
  prefs: []
  type: TYPE_NORMAL
- en: 'Finally, let''s take a look at the `userinfo.xml.db` database. Here is what
    it looks like before being decoded properly:'
  id: totrans-524
  prefs: []
  type: TYPE_NORMAL
- en: '![Decoding Tango messages](img/image00405.jpeg)'
  id: totrans-525
  prefs: []
  type: TYPE_IMG
- en: 'We wrote another script very similar to the first to parse the `userinfo.xml.db`
    database:'
  id: totrans-526
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  id: totrans-527
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The only difference in the code is that the filenames, table names, and values
    changed. This time, both the columns in the database are base64 encoded. Again,
    the code can be run by placing it in the same location as `userinfo.xml.db` and
    running it using the following command:'
  id: totrans-528
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  id: totrans-529
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Here is the relevant portion of the resulting output file, showing the personal
    data the user used to register the account:'
  id: totrans-530
  prefs: []
  type: TYPE_NORMAL
- en: '![Decoding Tango messages](img/image00406.jpeg)'
  id: totrans-531
  prefs: []
  type: TYPE_IMG
- en: Further down in the output, there is also a list of all of the user's contacts
    who use Tango. The output also includes the contacts' names and phone numbers.
  id: totrans-532
  prefs: []
  type: TYPE_NORMAL
- en: WhatsApp analysis
  id: totrans-533
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: WhatsApp is a popular chat-/video-messaging service with over 500,000,000 downloads
    in Google Play.
  id: totrans-534
  prefs: []
  type: TYPE_NORMAL
- en: 'Package name: `com.whatsapp`'
  id: totrans-535
  prefs: []
  type: TYPE_NORMAL
- en: 'Version: 2.11.498'
  id: totrans-536
  prefs: []
  type: TYPE_NORMAL
- en: 'Files of interest:'
  id: totrans-537
  prefs: []
  type: TYPE_NORMAL
- en: '`/files/`'
  id: totrans-538
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`Avatars/`'
  id: totrans-539
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`me`'
  id: totrans-540
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`me.jpeg`'
  id: totrans-541
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/shared_prefs/`'
  id: totrans-542
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`RegisterPhone.xml`'
  id: totrans-543
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`VerifySMS.xml`'
  id: totrans-544
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/databases/`'
  id: totrans-545
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`msgstore.db`'
  id: totrans-546
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`wa.db`'
  id: totrans-547
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/sdcard/WhatsApp/`'
  id: totrans-548
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`Media/`'
  id: totrans-549
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`Databases/`'
  id: totrans-550
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The `/files/avatars` directory contains thumbnails of the profile pictures of
    contacts that use the app, and `me.jpg` is a full-size version of the user's profile
    picture. The `me` file contains the phone number associated with the account
  id: totrans-551
  prefs: []
  type: TYPE_NORMAL
- en: The phone number associated with the account can also be recovered in `/shared_prefs/RegisterPhone.xml`.
    The `/shared_prefs/VerifySMS.xml` file shows the time that the account was verified
    (in the Linux epoch format, of course), indicating when the user first began using
    the app.
  id: totrans-552
  prefs: []
  type: TYPE_NORMAL
- en: 'The `msgstore.db` database, like it sounds, contains messaging data:'
  id: totrans-553
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-554
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-555
  prefs: []
  type: TYPE_TB
- en: '| `chat_list` | The `key_remote_jid` column shows each account the user has
    communicated with. The value in the table is the remote user''s phone number.
    For example, if the value is `13218675309@s.whatsapp.net`, the remote user''s
    number is `1-321-867-5309`. |'
  id: totrans-556
  prefs: []
  type: TYPE_TB
- en: '| `group_participants` | This contains metadata about group chats. |'
  id: totrans-557
  prefs: []
  type: TYPE_TB
- en: '| `messages` | This shows all the message data. Once again, the `key_remote_jid`
    field identifies the remote sender. The `key_from_me` value indicates the direction
    of the message (`0` = received, and `1` = sent). The data column contains the
    text of messages, and timestamp is the sent or received time in the Linux epoch
    format.For attachments, `media_mime_type` identifies the file format. The `media_size`
    and `media_name` columns should be self-explanatory. If the attachment had a caption,
    the text would be shown in the `media_caption` column. If the attachment was a
    location, the `latitude` and `longitude` columns would be populated appropriately.
    The `thumb_image` column has a lot of useless data in it, but also contains the
    path of the attachment on the device. The `raw_data` column contains thumbnails
    for images and videos. |'
  id: totrans-558
  prefs: []
  type: TYPE_TB
- en: 'The `wa.db` database is used to store contact information:'
  id: totrans-559
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-560
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-561
  prefs: []
  type: TYPE_TB
- en: '| `wa_contacts` | Like other apps, WhatsApp scrapes and stores the user''s
    entire phone book and stores the information in its own database. It contains
    the contacts'' names and phone numbers, as well as their statuses if the contacts
    are WhatsApp users. |'
  id: totrans-562
  prefs: []
  type: TYPE_TB
- en: The SD card is a treasure trove of WhatsApp data. The `/sdcard/WhatsApp/Media`
    folder contains a folder for each type of media (Audio, Calls, Images, Video,
    and Voice Notes), and stores all attachments of that type in the folder. Sent
    media is stored in a directory called, unimaginatively, `Sent`. Received media
    is simply stored in the root of the folder.
  id: totrans-563
  prefs: []
  type: TYPE_NORMAL
- en: The `Databases` directory is an even greater source of information. WhatsApp
    makes a backup of `msgstore.db` nightly and stores the backups here. This allows
    an examiner to see historical data that may have been deleted. If I delete a chat
    today, but you look at a backup from yesterday, you would be able to access the
    data I deleted. The app is even kind enough to put the date in the filename, for
    example, `msgstore-2015-01-21.1.db`. The only catch is that these backups are
    encrypted!
  id: totrans-564
  prefs: []
  type: TYPE_NORMAL
- en: Decrypting WhatsApp backups
  id: totrans-565
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Luckily, there is a tool available to decrypt the backups. It can be found here,
    along with detailed installation instructions at [http://forum.xda-developers.com/showthread.php?t=1583021](http://forum.xda-developers.com/showthread.php?t=1583021).
    Unfortunately, it hasn't been updated in some time and doesn't seem to work on
    newer versions of the app.
  id: totrans-566
  prefs: []
  type: TYPE_NORMAL
- en: We are not aware of an easy, automated extraction tool for newer versions of
    WhatsApp. However, with the version of WhatsApp we tested, we had great success
    using the instructions at [http://forum.xda-developers.com/android/apps-games/how-to-decode-whatsapp-crypt8-db-files-t2975313](http://forum.xda-developers.com/android/apps-games/how-to-decode-whatsapp-crypt8-db-files-t2975313).
    Note that this must be done on a Linux computer. Once the steps have been successfully
    followed, the result should be a database identical to `msgstore.db` explained
    earlier.
  id: totrans-567
  prefs: []
  type: TYPE_NORMAL
- en: This is possible because WhatsApp stores the decryption key on the device, in
    the `/files` directory.
  id: totrans-568
  prefs: []
  type: TYPE_NORMAL
- en: Note
  id: totrans-569
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Data storage method 7 is using encrypted files.
  id: totrans-570
  prefs: []
  type: TYPE_NORMAL
- en: Kik analysis
  id: totrans-571
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Kik is a messaging app with over 50,000,000 downloads from the Play Store.
  id: totrans-572
  prefs: []
  type: TYPE_NORMAL
- en: 'Package name: `kik.android`'
  id: totrans-573
  prefs: []
  type: TYPE_NORMAL
- en: 'Version: 7.9.0'
  id: totrans-574
  prefs: []
  type: TYPE_NORMAL
- en: 'Files of interest:'
  id: totrans-575
  prefs: []
  type: TYPE_NORMAL
- en: '`/cache/`'
  id: totrans-576
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`chatPicsBig/`'
  id: totrans-577
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`contentpics/`'
  id: totrans-578
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`profPics/`'
  id: totrans-579
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/files/staging/thumbs`'
  id: totrans-580
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/shared_prefs/KikPreferences.xml`'
  id: totrans-581
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/sdcard/Kik/`'
  id: totrans-582
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/databases/kikDatabase.db`'
  id: totrans-583
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The `chatPicsBig` and `contentpics` directories in `/cache` contain images that
    were sent and received with the application. The files in `contentpics` contain
    what appears to be Kik metadata embedded before the image. The `.jpg` has to be
    carved out of these files. In our testing, all of the files in `contentpics` were
    also stored in `chatPicsBig`, though this may change with more extensive app usage.
    The user's profile picture is found in the `/profPics` directory.
  id: totrans-584
  prefs: []
  type: TYPE_NORMAL
- en: Note
  id: totrans-585
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Data storage method 8 is using basic steganography, which means, a file is stored
    within a larger file.
  id: totrans-586
  prefs: []
  type: TYPE_NORMAL
- en: The `/files/staging/thumbs` directory contains thumbnails of images sent and
    received with the application. Our testing found the same images in this location
    as the `/cache` directories, but again, it is possible this would vary with more
    extensive application usage.
  id: totrans-587
  prefs: []
  type: TYPE_NORMAL
- en: The `KikPreferences.xml` file in `/shared_prefs` shows the user's username and
    e-mail address used with the application. Interestingly, it also contains an unsalted
    SHA1 hash of the user's password.
  id: totrans-588
  prefs: []
  type: TYPE_NORMAL
- en: The `/sdcard/Kik` directory contains full-sized images that were sent and received
    in the application. The filenames can be correlated with `messagesTable` in the
    `kikDatabase.db` database to identify which message contained the image.
  id: totrans-589
  prefs: []
  type: TYPE_NORMAL
- en: 'The `kikDatabase.db` database contains all of the messaging data from the application
    stored in the following tables:'
  id: totrans-590
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-591
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-592
  prefs: []
  type: TYPE_TB
- en: '| `KIKContentTable` | This table contains metadata about sent and received
    images. Each message is assigned a unique `content_id` value that corresponds
    to the filenames in the `sdcard/Kik` directory. The preview and icon values for
    each image correspond to the filenames found at `/files/staging/thumbs`. Each
    image also contains a `file-URL` value. This is a public URL that can be accessed
    to view the file. |'
  id: totrans-593
  prefs: []
  type: TYPE_TB
- en: '| `KIKcontactsTable` | This table shows the `user_name` and `display_name`
    values for each contact. The `in_roster` value appears to be set for contacts
    the user has specifically added (if it is set to `1`). Contacts with an `in_roster`
    value of `0` appear to be default contacts added automatically. The `jid` column
    is a unique value for each contact. |'
  id: totrans-594
  prefs: []
  type: TYPE_TB
- en: '| `messagesTable` | This table contains all data for messages sent and received
    with the app. The `body` column shows the text data sent in a message. The `partner_jid`
    value can be correlated back to the `jid` column in `KIKcontactTable` to identify
    the remote user. The `was_me` column is used to indicate the direction of the
    message (`0` = sent, and `1` = received). The `read_state` column shows whether
    the message has been read or not; `500` = read and `400` = unread. The timestamp,
    yet again, is in the Linux epoch format. The `content_id` column is populated
    for message attachments and can be correlated back to `KIKContentTable` for more
    information. |'
  id: totrans-595
  prefs: []
  type: TYPE_TB
- en: WeChat analysis
  id: totrans-596
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: WeChat is a messaging app with over 100,000,000 downloads in the Play Store.
  id: totrans-597
  prefs: []
  type: TYPE_NORMAL
- en: 'Package name: `com.tencent.mm`'
  id: totrans-598
  prefs: []
  type: TYPE_NORMAL
- en: 'Version: `6.0.2`'
  id: totrans-599
  prefs: []
  type: TYPE_NORMAL
- en: 'Files of interest:'
  id: totrans-600
  prefs: []
  type: TYPE_NORMAL
- en: Note
  id: totrans-601
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Some of the following paths contain an asterisk (*). This is used to indicate
    a unique string that will differ for each account. Our device had `7f804fdbf79ba9e34e5359fc5df7f1eb`
    in place of the asterisk.
  id: totrans-602
  prefs: []
  type: TYPE_NORMAL
- en: '`/files/host/*.getdns2`'
  id: totrans-603
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/shared_prefs/`'
  id: totrans-604
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`com.tencent.mm_preferences.xml`'
  id: totrans-605
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`system_config_prefs.xml`'
  id: totrans-606
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/sdcard/tencent/MicroMsg/`'
  id: totrans-607
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`diskcache/`'
  id: totrans-608
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`WeChat/`'
  id: totrans-609
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/sdcard/tencent/MicroMsg/*/`'
  id: totrans-610
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`image2/`'
  id: totrans-611
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`video/`'
  id: totrans-612
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`voice2/`'
  id: totrans-613
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`/MicroMsg/`'
  id: totrans-614
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`CompatibleInfo.cfg`'
  id: totrans-615
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`*/EnMicroMsg.db`'
  id: totrans-616
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The `*.getdns2` files found in `/files/host` can be opened as text files or
    in a hex editor. There is a section called [`clientip`] that shows the IP address
    from which the user connected as well as the time of the connection in the Linux
    epoch format. Our device contained three of these files to show three different
    connections, though increased application usage may generate more than three of
    these files.
  id: totrans-617
  prefs: []
  type: TYPE_NORMAL
- en: The `com.tencent.mm_preferences.xml` file in `/shared_prefs` records the device's
    phone number in the `login_user_name` field. The `system_config_prefs.xml` file
    contains the path to the user's profile picture on the device as well as a `default_uin`
    value that will be needed later.
  id: totrans-618
  prefs: []
  type: TYPE_NORMAL
- en: The SD card contains a wealth of WeChat data. The `/tencent/MicroMsg/diskcache`
    directory contained an image that was never used with the application. We think
    it was put there when attaching a different image as WeChat loads a view of many
    images from the device's gallery. The `/WeChat` directory within `/sdcard/tencent/MicroMsg`
    contained images sent from the device.
  id: totrans-619
  prefs: []
  type: TYPE_NORMAL
- en: 'The `/video`, `/voice`, and `/voice2` folders within `/sdcard/tencent/MicroMsg/*`
    contain exactly what they say: video and voice files sent using the app.'
  id: totrans-620
  prefs: []
  type: TYPE_NORMAL
- en: WeChat is fairly unique, in that, it does not utilize a `/databases` directory
    within the app's directory structure. `MicroMsg` is its equivalent. `CompatibleInfo.cfg`
    contains the device's IMEI, which will be useful later.
  id: totrans-621
  prefs: []
  type: TYPE_NORMAL
- en: 'The `*` directory within `/MicroMsg` contains the `EnMicroMsg.db` database.
    There''s only one problem: the database is encrypted using **SQLCipher**! SQLCipher
    is an open source extension for SQLite that encrypts the entire database. Luckily,
    like other apps that use encryption that we''ve seen, the key to decrypting the
    file is on the device.'
  id: totrans-622
  prefs: []
  type: TYPE_NORMAL
- en: Note
  id: totrans-623
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Data storage method 9 is using SQLCipher, which involves full-database encryption.
  id: totrans-624
  prefs: []
  type: TYPE_NORMAL
- en: Decrypting the WeChat EnMicroMsg.db database
  id: totrans-625
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Fortunately for us, Forensic Focus has an excellent article on doing exactly
    this at [http://articles.forensicfocus.com/2014/10/01/decrypt-wechat-enmicromsgdb-database/](http://articles.forensicfocus.com/2014/10/01/decrypt-wechat-enmicromsgdb-database/).
  id: totrans-626
  prefs: []
  type: TYPE_NORMAL
- en: They even provide a Python script to do the work for us at [https://gist.github.com/fauzimd/8cb0ca85ecaa923df828/download#](https://gist.github.com/fauzimd/8cb0ca85ecaa923df828/download#).
  id: totrans-627
  prefs: []
  type: TYPE_NORMAL
- en: 'To run the Python script, simply put the EnMicroMsg.db file and the system_config_prefs.xml
    files in the same directory as the script and, in the command-line, type:'
  id: totrans-628
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  id: totrans-629
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: The script will then prompt you for the **International Mobile Station Equipment
    Identity** (**IMEI**) of the device. This can be found in the `/MicroMsg/CompatibleInfo.cfg`
    file, printed somewhere on the device (behind the battery, on the SIM card tray
    or etched on the back of the device), or by typing `*#06#` in the phone dialer.
  id: totrans-630
  prefs: []
  type: TYPE_NORMAL
- en: The script should run. Place a file called `EnMicroMsg-decrypted.db` in the
    directory.
  id: totrans-631
  prefs: []
  type: TYPE_NORMAL
- en: 'Finally, we can now examine the `EnMicroMsg-decrypted.db` database with respect
    to the following tables stored in it:'
  id: totrans-632
  prefs: []
  type: TYPE_NORMAL
- en: '| Table | Description |'
  id: totrans-633
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-634
  prefs: []
  type: TYPE_TB
- en: '| `ImgInfo2` | This contains path information for sent and received images.
    The `bigImgPath` column contains the filename for the image. This can be searched
    on the SD card to find the picture. Alternatively, images are stored in the `/sdcard/tencent/MicroMsg/*/image2`
    directory in folders that correspond to the filename. For example, the file named
    `3b9edb119e04869ecd7d1b21a10aa59f.jpg` can be found in the `image2` directory
    in the `/3b/9e` path. The folders are broken down by the first 2 bytes of the
    name and then by the second 2 bytes of the name. The `thumbImgPath` column contains
    the name of thumbnails for the images. |'
  id: totrans-635
  prefs: []
  type: TYPE_TB
- en: '| `message` | This contains all the message information for the app. The `isSend`
    column indicates the message direction (`0` = received, `1` = sent). The `createTime`
    table is the timestamp of the message, in the Linux epoch format. The `talker`
    column contains a unique ID for the remote user. This can be correlated with the
    `rcontact` table to identify the remote user. The `content` column shows the data
    of messages sent as text and identifies video calls as "voip_content_voice". The
    `imgPath` column contains the path to image thumbnails, which can be correlated
    with the `ImgInfo2` table to locate the full-sized images. It also includes filenames
    for audio files, which can be searched for or located in the `/sdcard/tencent/MicroMsg/*/voice2`
    directory. |'
  id: totrans-636
  prefs: []
  type: TYPE_TB
- en: '| `rcontact` | This contains a list of contacts and includes many that are
    added by default by the app. The `username` column can be correlated with the
    `talker` column in the `message` table. The `nickname` column shows the user''s
    name. The `type` column is an indicator of whether the contact was added manually
    or automatically (`1` = device user, `3` = added by user, and `33` = added by
    app). The exception to this is the user "weixin", which is automatically added,
    but has a type value of `3`. |'
  id: totrans-637
  prefs: []
  type: TYPE_TB
- en: '| `userinfo` | This table contains information about the user, including their
    name and phone number. |'
  id: totrans-638
  prefs: []
  type: TYPE_TB
- en: Application reverse engineering
  id: totrans-639
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The vast majority of Android applications are written in Java. In order to truly
    reverse engineer Java code, one should generally be able to engineer Java code
    first. Teaching Java is well beyond the scope of this book. We will, however,
    show a few useful reversing methods that we think will be useful and can be done
    by an average mobile forensic examiner. Many hundreds of tutorials and guides
    have been written online for Android reversing, from the very basic to the highly
    advance.
  id: totrans-640
  prefs: []
  type: TYPE_NORMAL
- en: Anyone looking for more information on the subject should easily be able to
    find what they are looking for. As always, [www.xda-developers.com](http://www.xda-developers.com)
    is an incredibly useful resource, and entire books have been dedicated to the
    subject. There is also an incredibly detailed, updated list of tools by Ashish
    Bhatia that can be found at [https://github.com/ashishb/android-security-awesome](https://github.com/ashishb/android-security-awesome).
  id: totrans-641
  prefs: []
  type: TYPE_NORMAL
- en: Obtaining the application's APK file
  id: totrans-642
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Applications are installed via `.apk` files. The APK file for an app is stored
    on the device, even after the application is installed (and is removed when an
    app is deleted). This APK contains the compiled Java code for the app, the icons
    and fonts used in the app, and an `AndroidManifest.xml` file that declares the
    permissions the application needs.
  id: totrans-643
  prefs: []
  type: TYPE_NORMAL
- en: The `APK` file for applications that are installed through Google Play can be
    found in the `/data/app` directory. Another method to find the APK location is
    to use the `adb` shell `pm path <package_name>` command. The APK file for preinstalled
    system applications (that cannot be deleted without root) can be found in the
    /system/app directory. The APK file itself is stored in a directory named after
    its package name, followed by a dash and a number. For example, the package name
    for Kik is `kik.android`, and the APK in `/data/app` is stored as `inkik.android-1`.
  id: totrans-644
  prefs: []
  type: TYPE_NORMAL
- en: 'Here is the list of APK directories in `/data/app` for the device we tested:'
  id: totrans-645
  prefs: []
  type: TYPE_NORMAL
- en: '![Obtaining the application''s APK file](img/image00407.jpeg)'
  id: totrans-646
  prefs: []
  type: TYPE_IMG
- en: Note that every application we tested has an APK file in this directory, as
    well as many apps that we did not look at.
  id: totrans-647
  prefs: []
  type: TYPE_NORMAL
- en: 'Obtaining the APK file is as simple as using the adb pull command. To pull
    the Kik APK, we will use the following command:'
  id: totrans-648
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  id: totrans-649
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'This should pull a `lib` directory and a `base.apk` file, which will be in
    the current directory the command was run from:'
  id: totrans-650
  prefs: []
  type: TYPE_NORMAL
- en: '![Obtaining the application''s APK file](img/image00408.jpeg)'
  id: totrans-651
  prefs: []
  type: TYPE_IMG
- en: Disassembling an APK file
  id: totrans-652
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'For starters, the APK file is actually just a ZIP compressed file. Renaming
    the extension to .zip will allow an examiner to open the container and browse
    the files contained in it:'
  id: totrans-653
  prefs: []
  type: TYPE_NORMAL
- en: '![Disassembling an APK file](img/image00409.jpeg)'
  id: totrans-654
  prefs: []
  type: TYPE_IMG
- en: However, you might not be able to view the AndroidManifest.xml file. There are
    many tools and methods to fully disassemble the APK, and these can be found in
    the list we linked to above. Our personal favorite tool, though, is one that allows
    you to simply right-click on the APK and disassemble it (on Windows only). The
    APK_OneClick tool can be found at [http://forum.xda-developers.com/showthread.php?t=873466](http://forum.xda-developers.com/showthread.php?t=873466).
  id: totrans-655
  prefs: []
  type: TYPE_NORMAL
- en: The **Java Runtime Environment** (**JRE**) will have to be installed. It can
    be found at [http://www.oracle.com/technetwork/java/javase/downloads/jre8-downloads-2133155.html](http://www.oracle.com/technetwork/java/javase/downloads/jre8-downloads-2133155.html).
  id: totrans-656
  prefs: []
  type: TYPE_NORMAL
- en: 'Once the tool and the JRE have been installed, an examiner can simply right-click
    on the APK and select **Disassemble APK and Decode Resources**:'
  id: totrans-657
  prefs: []
  type: TYPE_NORMAL
- en: '![Disassembling an APK file](img/image00410.jpeg)'
  id: totrans-658
  prefs: []
  type: TYPE_IMG
- en: 'A pop-up window will appear to show the progress and will disappear if no problems
    are encountered:'
  id: totrans-659
  prefs: []
  type: TYPE_NORMAL
- en: '![Disassembling an APK file](img/image00411.jpeg)'
  id: totrans-660
  prefs: []
  type: TYPE_IMG
- en: 'If the disassembly ended successfully, there will now be a folder called `base-disasm`
    in the same directory as the APK. Browsing the directory will show many of the
    same files and folders we saw when the APK was renamed to a `.zip` file:'
  id: totrans-661
  prefs: []
  type: TYPE_NORMAL
- en: '![Disassembling an APK file](img/image00412.jpeg)'
  id: totrans-662
  prefs: []
  type: TYPE_IMG
- en: Determining an application's permissions
  id: totrans-663
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Knowing what an app has permission for can be very useful for an examiner. For
    starters, it can help narrow down where data is stored. An app without permission
    to write data to the SD card, for example, won't store any data there. One of
    the most commonly heard defenses when a suspect is caught with illicit material
    is that, of course, the suspect has no idea how it got there and it was placed
    there by a virus. If he says a particular app put that data on his SD card, an
    examiner can show that the app couldn't have done that because it didn't have
    permission to write to the SD card. These are just a few basic examples, but again,
    this is very basic reverse engineering!
  id: totrans-664
  prefs: []
  type: TYPE_NORMAL
- en: 'The `AndroidManifest.xml` file from the disassembled APK discussed earlier
    will contain the app''s permissions. These are the equivalent of what the user
    is shown and has to approve when the app is installed:'
  id: totrans-665
  prefs: []
  type: TYPE_NORMAL
- en: '![Determining an application''s permissions](img/image00413.jpeg)'
  id: totrans-666
  prefs: []
  type: TYPE_IMG
- en: For the specifics of what each permission allows the app to do, Google maintains
    a list at [http://developer.android.com/reference/android/Manifest.permission.html](http://developer.android.com/reference/android/Manifest.permission.html).
  id: totrans-667
  prefs: []
  type: TYPE_NORMAL
- en: Viewing the application's code
  id: totrans-668
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'To view the application''s code using the APK_OneClick tool, simply right-click
    on the APK and select **Browse Java Code of APK**. Again, a window will pop up
    temporarily showing progress and will disappear if no errors are encountered.
    Once it completes, a Java Decompiler window will appear, allowing the examiner
    to browse through the Java code as follows:'
  id: totrans-669
  prefs: []
  type: TYPE_NORMAL
- en: '![Viewing the application''s code](img/image00414.jpeg)'
  id: totrans-670
  prefs: []
  type: TYPE_IMG
- en: Summary
  id: totrans-671
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This chapter has been an in-depth study of specific Android applications, and
    how/where they store their data. We looked at 19 specific applications and discovered
    9 different methods of storing and obfuscating data. Knowing that applications
    store their data in a variety of ways should help an examiner have a better understanding
    of an app's data that they are examining. This knowledge should, hopefully, push
    them to look harder when they can't find data they expect the app to have. An
    examiner has to be able to adapt to the changing world of application analysis.
    As applications constantly update, an examiner has to be able to update their
    own methods and abilities in order to keep up.
  id: totrans-672
  prefs: []
  type: TYPE_NORMAL
- en: The next chapter will take a look at several free and open source tools to image
    and analyze Android devices and reverse engineer applications to discover where
    their data is stored.
  id: totrans-673
  prefs: []
  type: TYPE_NORMAL
