- en: Assessment
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Chapter 1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Yes, there is. There's a CWE list maintained by MITRE that can be found at [https://cwe.mitre.org/](https://cwe.mitre.org/).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The OWASP Top 10 can be found at [https://owasp.org/www-project-top-ten/](https://owasp.org/www-project-top-ten/),
    while the SANS Top 25 can be found at [https://www.sans.org/top25-software-errors/](https://www.sans.org/top25-software-errors/).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Many of the tools that are used in a typical penetration test are open source,
    such as Nmap, and the Metasploit framework. However, there are some really efficient
    tools on the market that can be used as well, including BurpSuite Professional
    and Nessus Professional.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: An OSSTMM penetration test can be one of six different types, depending on the
    nature and scope of the engagement. PTES-based penetration tests are categorized
    under very generic test types, such as white box, gray box, and black box. As
    PTES is the *industry standard*, most penetration tests use the PTES methodology.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Chapter 2
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Metasploit community edition and Metasploit Framework are open source. Metasploit
    Pro is the commercial edition, which comes with a lot of extra features. Check
    out the following link for more information: [https://www.rapid7.com/products/metasploit/download/editions/](https://www.rapid7.com/products/metasploit/download/editions/)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Metasploit Framework Version 5 comes allows us to encrypt our payloads with `AES` or `RC4` encryption.
    You just have to generate the payload using the `--encrypt` option in MSFVenom.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: No, you cannot. Currently, Metasploit Framework only supports PostgreSQL as
    the backend.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The Metasploit Framework database can be connected directly via port `5432`.
    If you want to communicate with the database over a secure channel, you can connect
    Metasploit Framework to the database using the PostgreSQL web service, which runs
    over HTTP/HTTPS.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Chapter 3
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: From basic network recon to chain tasks, there are a lot of features that you
    can use. In Metasploit CE, many features are locked and are only available for
    the Metasploit Pro Edition.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: To use a custom SSL certificate, replace the default SSL certificate that comes
    with Metasploit with the web UI by going to `<path/to/metasploit>/opt/metasploit/nginx/cert` and
    replacing the files that are there with your own.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The web interface is compatible with Google Chrome 10+, Mozilla Firefox 18+,
    Internet Explorer 10+, and Iceweasel 18+.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Yes, it does. RESTful APIs are available across all editions of Metasploit products.
    Check out [https://metasploit.help.rapid7.com/docs/standard-api-methods-reference](https://metasploit.help.rapid7.com/docs/standard-api-methods-reference) to
    view the standard Metasploit API documentation.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Yes, it does. You can check the custom reporting format and configure it accordingly
    in the Metasploit web interface itself. Check out the following link for more
    information, at [https://metasploit.help.rapid7.com/docs/about-reports](https://metasploit.help.rapid7.com/docs/about-reports).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Chapter 4
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The HTTP header detection module grabs the HTTP headers in the server response.
    If the administrator has already blocked/removed the HTTP header, this module
    will not provide you with any output. The module works fine.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: By default, the Metasploit web interface comes with NMAP version 4.x (pre-installed)
    in the package, which is used to perform host discovery and port scans. For better
    results, you can install and use the latest version of NMAP.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Yes, you can. The web interface only provides a **Graphical User Interface** (**GUI**)
    for the Metasploit framework, so you can add your own custom modules as well.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You can place a reverse proxy in front of the page. You'll have to first authenticate
    yourself with an HTTP basic authentication mechanism and then you can use the
    login page to authenticate with the Metasploit web interface. For further information,
    check the documentation at [https://docs.nginx.com/nginx/admin-guide/web-server/reverse-proxy/](https://docs.nginx.com/nginx/admin-guide/web-server/reverse-proxy/).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Chapter 5
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Yes, you can. There are many famous dictionaries available on GitHub that can
    be used for better enumeration results.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Metasploit gives you the power to modify or add your own modules, which can
    run the execution based on different modules. You have the flexible option of
    coding a custom module or you can code your own Metasploit plugin, which can be
    used to automate the whole enumeration process in a single command.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Regular expressions are used to filter out the search efficiently. Using the
    regex, you can perform a more focused scraping instead of a more junk-oriented
    one.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Chapter 6
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: It all depends upon the frequency and concurrence of the scan running. A minimum
    of two client nodes and a master node could be used for a distributed scan, but
    you can make your decision based on the number of systems you want to scan.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The WMAP plugin, when loaded in Metasploit, will save all the results in the
    database connected to it. Note: There is no specific feature in this plugin that
    will generate a report on WMAP.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: All the formats supported by the Metasploit Framework are mentioned in the `db_import` command.
    Please refer to that.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: WMAP is a plugin written in Ruby. You can edit the file and modify the code
    according to your needs. Please read the `LICENCE` file before making any modifications.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: WMAP has a limit of 25 jobs per node. This is done to prevent nodes from being
    over-burdened.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Chapter 7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Not really. Nessus can be installed on any server and you just need to provide
    the network IP and port with credentials for authentication. Metasploit will automatically
    authenticate with the remotely installed Nessus instance.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Metasploit supports Nexpose, Nessus, and OpenVAS vulnerability scanners as pluggable
    modules. For other vulnerability scanners, you may have to code your own plugin
    module.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Yes. You can use Nessus Professional with Metasploit. You just need to activate
    the Nessus Pro license first.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The number of concurrent systems in scanning is the same as the number allowed
    as per your Nessus subscription.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Chapter 8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Yes. If WordPress is installed with the default configuration, the reconnaissance
    techniques discussed in this chapter are enough to get information on all versions
    of WordPress.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If the `wp-admin` directory is not accessible, you can always try the `wp-login.php` file.
    The file is accessible to users with normal privilege settings and for the `wp-admin` directory
    as well. In case you're still not able to access it, try adding the `wp-login.php?action=register` query
    to the URI.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Yes, it is. WordPress is an open source CMS that is used widely. Unlike WordPress
    core, some of the themes and templates are under the paid subscription license.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Chapter 9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Joomla is a CMS written in PHP and will run on those operating systems that
    have PHP installed.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If you already using a detection technique unknown to the community, you can
    add the technique to the Metasploit code. At the same time, you can send a `push` request
    to the Metasploit GitHub repository, which should help the community as well.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: There are multiple ways to find the version installed. You can even read the
    source code to find the headers or parameters that will disclose the Joomla version.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The goal of a pentester is to find the vulnerability and exploit it to the extent
    that it would convince the organization's management to not overlook the security
    aspect of the web application. Backdooring the application would defy this logic
    and it is unethical to do so.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Chapter 10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Different Drupal versions have different architectures and different features.
    If an exploit is based on Drupal's core components, it can be used for older versions
    as well. Other module- and plugin-based exploits may not work in the case of different
    Drupal versions.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: It is a good practice to install Drupal locally to test an exploit. If we are
    successful in exploiting Drupal locally, then we can use the same exploit on a
    remote Drupal site.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Sometimes, there's a **Web Application Firewall** (**WAF**) placed in front
    of the web application, meaning that an exploit doesn't run successfully. In that
    case, we can either obfuscate or encode the payload used in the exploit and bypass
    WAF protection.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If we have access to the Drupal administrator account, we can enable the PHP
    filters' module and configure the permissions for it. Once the permissions are
    set, we can write a web shell on the site. We can even upload a web shell by exploiting
    arbitrary file upload vulnerabilities (this works on some versions of Drupal).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: While performing file and directory enumeration, if we come across a `.swp` file,
    we can use this to our advantage. A SWP (pronounced *swap*) file is a state file
    that stores the changes that have happened in a file. Sometimes, administrators
    edit the Drupal configuration file (`settings.php`), meaning that a `.swp` file
    is created. If we can access the `settings.php.swp` file, we can get our hands
    on globally set variables such as database usernames and passwords, which can
    be used for further exploitation.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Chapter 11
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: JBoss comes in different versions and releases. The community edition is free
    to download, but you need to buy a license to support it. You can view the licensing
    information at [https://www.redhat.com/en/store/red-hat-jboss-enterprise-application-platform?extIdCarryOver=true&sc_cid=701f2000001Css5AAC](https://www.redhat.com/en/store/red-hat-jboss-enterprise-application-platform?extIdCarryOver=true&sc_cid=701f2000001Css5AAC).
  prefs: []
  type: TYPE_NORMAL
- en: Chapter 12
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: You can identify them by using Shodan, ZoomEye, Censys.io, and similar services.
    You can also identify them by performing port scans and service enumeration. Sometimes,
    the Tomcat service won't be running on a common port (such as `80`, `443`, `8080`,
    and so on). In that case, perform a full port scan and identify the service through
    the server response.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Not necessarily. The `Release-Notes.txt` and `Changelog.html` files are only
    available on the default installation. If the server administrator has removed
    these files, you need to look for other ways (mentioned in this chapter) to detect
    and identify the Apache Tomcat instance.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: This generally happens when an anti-virus program detects the JSP web shell.
    To bypass such security measures, you can obfuscate the web shell.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: In OOB-based OGNL injections, there are two ways that you can exploit this vulnerability—via
    DNS interactions or via HTTP interactions. In both cases, you need to set up your
    own instance and configure the DNS server (for DNS interactions) or HTTP web server
    (for HTTP interactions). Exploiting OOB-based OGNLs is easier when performing
    the attack with HTTP interactions.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Chapter 13
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: You can use Shodan, ZoomEye, Censys, and so on to identify the Jenkins instance.
    By default, the Jenkins service runs on port `8080`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: There are multiple ways to identify Jenkins, but the most common way is to use
    HTTP headers. The `X-Hudson`, `X-Jenkins`, `X-Jenkins-Session`, and `X-Permission-Implied-By` headers
    are the custom HTTP headers used by Jenkins.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'You can play with the HTTP headers to see if there''s any kind of header blocking
    your access to the Jenkins instance. You can also add an `X-Forwarded-For: 127.0.0.1`header
    to bypass any kind of ingress access restriction.'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Jenkins is an open source tool that's built in Java, which helps with CI and
    CD by using the plugins-based mechanisms available. If you have access to the
    Jenkins instance, you can disrupt the CI/CD pipeline in order to bring down the
    production/non-production environment. Since Jenkins holds all the code for the
    applications, you can download the source code to get the hardcoded credentials
    and sensitive information, which can then be used for further exploitation.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Chapter 14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: You can perform web application fuzzing on any server that is running a web
    service (including SSL).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Burp Suite is a Java-based tool that can be used on Microsoft Windows, but for **Wfuzz** and **ffuf**,
    you have to install Python on Windows as these tools are Python-based.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: No. Performing fuzz testing is optional in a regular penetration test and it
    needs to be discussed with the client. If the client asks for it, then it will
    be mandatory; otherwise, pen testing can be done without fuzzing. However, it's
    always a good practice to perform fuzzing anyway because you may find a critical-severity
    vulnerability that has been missed by the scanner.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: These range from technical vulnerabilities, such as **Remote Code Executions** (**RCE**), **SQL
    Injections** (**SQLi**), and **Cross-Site Scripting** (**XSS**) to logical vulnerabilities
    such as account takeovers, parameter manipulations, response manipulations, and
    authentication token bypasses.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Chapter 15
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The metalanguage that's used for Microsoft Word was designed to be as simple
    as possible while still serving enough features that it was possible to create
    a basic penetration test report. It is a language that is used for creating custom
    templates in Serpico (as defined in their GitHub repository). To learn more about
    metalanguage in Serpico, please refer to [https://github.com/SerpicoProject/Serpico/wiki/Serpico-Meta-Language-In-Depth](https://github.com/SerpicoProject/Serpico/wiki/Serpico-Meta-Language-In-Depth).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: A generic penetration testing report should include the vulnerability name,
    vulnerability description, affected endpoint, steps of reproduction (proof of
    concept), business impact, remediation, and references.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Guinevere, Prithvi, and many more open source automated reporting tools are publicly available and
    can be used for easy report generation.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Yes. Both Dradis Framework and Serpico are written in Ruby and they're cross-platform
    supported tools that can be run on Microsoft Windows. The only requirement is
    that the Ruby packages need to be installed on the Windows system.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
