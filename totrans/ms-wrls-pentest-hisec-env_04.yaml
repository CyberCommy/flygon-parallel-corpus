- en: Chapter 4. Penetrating Wireless Networks
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, you will learn how to plan an attack and crack WEP/WPA/WPA2
    wireless networks, and will learn MAC spoofing to gain unauthorized access to
    a network. You will also learn how to protect yourself from these kinds of threats.
    This chapter will have hands-on, step-by-step instructions with Kali Linux. Keep
    in mind that you will only be able to follow the cracking section of this chapter
    if you have any of the wireless cards or adapters mentioned towards the end of
    [Chapter 1](ch01.html "Chapter 1. Preparing for an Effective Wireless Penetration
    Test"), *Preparing for an Effective Wireless Penetration Test*.
  prefs: []
  type: TYPE_NORMAL
- en: 'Before we begin, there are a few things that you should know before we crack
    any wireless networks:'
  prefs: []
  type: TYPE_NORMAL
- en: Cracking any wireless network without authorization is illegal
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If you are caught without authorization, you will face the consequences according
    to law within your area
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Please only demonstrate techniques on your own network
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Planning an attack
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Before we run any wireless scans or cracks on any wireless encryption, the first
    thing we need to do is plan an attack. We need to make sure we have everything
    we need to run a wireless penetration test and ask ourselves as many questions
    as possible so that we don't run into any obstacles on the way. Let's begin with
    a list of requirements and then the steps we will take to crack a wireless network.
  prefs: []
  type: TYPE_NORMAL
- en: '![Planning an attack](img/3183OS_04_02.jpg)'
  prefs: []
  type: TYPE_IMG
- en: What you'll need for the attack?
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Here, we have a list of what is essential to conduct a full wireless attack:'
  prefs: []
  type: TYPE_NORMAL
- en: '**A compatible wireless adapter**: Note that it must support packet injection'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**The Kali Linux operating system**: All our security tools are preinstalled'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Pen and paper to take notes**: This will help us to keep organized'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The plan for attacking wireless networks
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The following are the steps to plan a wireless attack:'
  prefs: []
  type: TYPE_NORMAL
- en: Scan for a list of wireless networks in the area.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Take note of the BSSID, channel number, and encryption.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'List several attack methods that you will use to attack:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Airodump
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Aircrack
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Dictionary attack
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Default logins
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Password guessing
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Proceed with each method.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Record both successful and unsuccessful results.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Try again.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Wireless password cracking
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: There are many different methods to crack a wireless encryption. I will be covering
    the most common methods to crack wireless networks. In the next few sections,
    I will discuss what each wireless encryption is in great detail and then will
    demonstrate how to crack those wireless encryption types. Let's begin!
  prefs: []
  type: TYPE_NORMAL
- en: WEP encryption
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '**Wired Equivalent Privacy** (**WEP**) encryption is a standard Wi-Fi wireless
    network security algorithm used to protect personal and business networks. WEP
    keys are created by the network administrator to allow groups of devices on a
    local network to securely connect. When each packet is sent from the client to
    the wireless access point, it is encoded in a sequence of hexadecimal digits.
    These digits include numbers 0 to 9 and letters A to F.'
  prefs: []
  type: TYPE_NORMAL
- en: '![WEP encryption](img/3183OS_04_04.jpg)'
  prefs: []
  type: TYPE_IMG
- en: The longer the WEP key is, the stronger the WEP encryption is by bits. For example,
    if you have a WEP key with 10 characters, it could be between 40 to 60 bits, whereas
    a WEP key with more complex 58 characters would be a lot stronger, in the area
    of 256 bits. Some networks still rely on WEP encryption because an individual
    or business may still have older devices connecting over Wi-Fi. As of today, there
    are some warehouses or factories that still use WEP encryption because they simply
    do not want to invest in new technologies that may risk breaking their production
    network.
  prefs: []
  type: TYPE_NORMAL
- en: Cracking WEP encryption
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In this section, we will go through step-by-step instructions on how to crack
    WEP encryption.
  prefs: []
  type: TYPE_NORMAL
- en: '![Cracking WEP encryption](img/3183OS_04_05.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Open the Terminal, type the following command, and press *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'This command will start the `wlan0` interface in monitor mode. **Monitor mode**
    is a feature that allows your computer to listen to every wireless packet within
    range of your wireless card. This mode will allow us to inject packets into a
    wireless network. The following is the output:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Cracking WEP encryption](img/3183OS_04_07.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Then type the following command and press *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'This command enables monitor mode on the wireless interface. The following
    is the output:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Cracking WEP encryption](img/3183OS_04_08.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Type the following command and press *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'The following are the components of the command:'
  prefs: []
  type: TYPE_NORMAL
- en: '`-c`: This is the channel'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-w`: This gives write access to a file'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`--bssid`: This is the wireless access point MAC address'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The following is the output of the previous command:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Cracking WEP encryption](img/3183OS_04_09.jpg)'
  prefs: []
  type: TYPE_IMG
- en: You will need to replace what is in bold with your network information.
  prefs: []
  type: TYPE_NORMAL
- en: 'Type the follow command and press *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'The following are the components of the command:'
  prefs: []
  type: TYPE_NORMAL
- en: '`-1`: This is the number of packets per burst'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-q`: This is the number of seconds between keep-alives'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-e`: This sets the target AP SSID'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-a`: This sets the access point MAC address'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-h`: This sets the source MAC address (`00:11:22:33:44:55` is the spoofed
    MAC address)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-ignore-negative-one`: This resolves the fixed channel on `mon0`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'If you have issues running this command, try to take the interface down after
    enabling monitor mode. Here is how you can do that:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'Then, run the following command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'This should resolve the channel `-1` error message, as shown:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Cracking WEP encryption](img/3183OS_04_10.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Type the following command and press *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '![Cracking WEP encryption](img/3183OS_04_11.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Time to crack the WEP key! Type the following command and press *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: Here, `capture-01.cap` is the filename containing the data. It can be the full
    packet or an IVs-only file. There must be a minimum of four IVs.
  prefs: []
  type: TYPE_NORMAL
- en: The WEP key is only displayed if 100 percent of the hex key has been converted
    to ASCII. Once you have received the key, you can try connecting to the wireless
    network.
  prefs: []
  type: TYPE_NORMAL
- en: '![Cracking WEP encryption](img/3183OS_04_12.jpg)'
  prefs: []
  type: TYPE_IMG
- en: If you were able to crack the network key, congratulations, you have successfully
    cracked a WEP encrypted network! If you don't succeed, don't worry about it. Each
    network and wireless access point is different. It also depends on the signal
    between you and the access point as well as the encryption being used.
  prefs: []
  type: TYPE_NORMAL
- en: Cracking WPA and WPA2 encryption
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: WPA and WPA2 are two different security algorithms used to protect wireless
    networks. WPA uses TKIP while WPA2 uses both (TKIP and AES). As of today, most
    common wireless routers and access points create a quick and hassle-free method
    of connecting to a secure network. WPS is a feature that allows an easy setup
    for secure networks; however, WPS can easily be cracked with the right security
    tools that are available in Kali Linux. WPA was designed to replace WEP because
    security agencies found out that serious flaws made it easy to gain unauthorized
    access in a matter of minutes. Despite WPA being much harder to crack, it is still
    possible to crack WPA and even the latest WPA2 encryption algorithms.
  prefs: []
  type: TYPE_NORMAL
- en: In this section, I will demonstrate cracking WPA and WPA2 wireless networks.
  prefs: []
  type: TYPE_NORMAL
- en: 'Open the Terminal and type the following command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: 'This command will start the `wlan0` interface in monitor mode:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Cracking WPA and WPA2 encryption](img/3183OS_04_14.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Type the following command and press *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: This will allow us to inject packets into a wireless network.
  prefs: []
  type: TYPE_NORMAL
- en: '![Cracking WPA and WPA2 encryption](img/3183OS_04_15.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Type the following command and press *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: 'The following are the components of the preceding command:'
  prefs: []
  type: TYPE_NORMAL
- en: '`-i`: This is the wireless interface'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-c`: This is the channel number'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-e`: This sets the target access point'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-b`: This sets the target MAC address'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-vv`: This sets the verbose option twice to increase verbosity and display
    each pin number as it is attempted'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`--no-nacks`: This ensures better reliability of the target access point'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The following is the output:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Cracking WPA and WPA2 encryption](img/3183OS_04_16.jpg)'
  prefs: []
  type: TYPE_IMG
- en: You will need to change what is highlighted in bold. This process can take between
    2 to 10 hours to complete. If it fails, this could be because of the wireless
    signal strength is bad or WPS is not implemented on this device.
  prefs: []
  type: TYPE_NORMAL
- en: What is Reaver?
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Reaver is a free open source tool that can exploit and crack a WPA or WPA2 encrypted
    wireless network. It is also designed to perform brute force attacks on WPS enabled
    wireless access points.
  prefs: []
  type: TYPE_NORMAL
- en: How does Reaver work?
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Now that you know what Reaver is, we need to briefly discus how it works. Reaver
    takes advantage of a feature in wireless devices called WPS. **Wi-Fi Protected
    Setup** (**WPS**) allows an easy setup for those who do not know how to set up
    wireless security on wireless. It generates a PIN that is hard coded to that particular
    device. Reaver exploits the flaws in the PINs which takes just moments to reveal
    the WPA or WPA2 passphrase.
  prefs: []
  type: TYPE_NORMAL
- en: Protecting yourself against Reaver
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: To easily protect yourself from Reaver, disable the WPS feature from your wireless
    device. If you are a business, use WPA2-PSK (AES). If you are a home user, use
    WPA2 Personal AES. Never generate a password, use a strong complex passphrase
    and update the passphrase frequently.
  prefs: []
  type: TYPE_NORMAL
- en: WPA/WPA2 cracking results
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'As you can see in the following screenshot, we have cracked the WPA/WPA2 encryption.
    If you are trying connecting to the wireless network, it will ask for either a
    PIN or WPA PSK key. Enter either of these and you should have full access to that
    wireless network, as shown:'
  prefs: []
  type: TYPE_NORMAL
- en: '![WPA/WPA2 cracking results](img/3183OS_04_17.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Spoofing your MAC address
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: I certainly hope you know by now that MAC address filtering isn't really secure.
    In my opinion, it's a lot less effective than WEP encryption because it is easy
    to fake. This doesn't mean MAC address filtering is pointless to use. It does
    keep out a lot of attackers that solely aim on the weakest link networks. Whatever
    you do, do not rely on MAC filtering by itself! WEP encryption is better than
    no encryption at all.
  prefs: []
  type: TYPE_NORMAL
- en: '![Spoofing your MAC address](img/3183OS_04_18.jpg)'
  prefs: []
  type: TYPE_IMG
- en: It does not take a lot of skill to do this. All you have to do is listen to
    the network traffic on over wireless and change your MAC address to that of someone
    who is already connected. With automation scripts or applications, changing your
    MAC address is easy as 1, 2, 3\. Next, I'll demonstrate how to spoof your MAC
    address using a tool called **macchanger**.
  prefs: []
  type: TYPE_NORMAL
- en: Open the Terminal.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Type the following command and press *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: This command turns off or disables the wireless interface.
  prefs: []
  type: TYPE_NORMAL
- en: 'To turn `wlan0` back on, type the following command and press *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: 'The following is the output:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Spoofing your MAC address](img/3183OS_04_20.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Type the following command and press *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: 'This command randomly generates a fake MAC address for the wireless interface:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Spoofing your MAC address](img/3183OS_04_21.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Type the following command and press *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: 'This command allows you to assign a MAC address to spoof on the wireless interface,
    as shown:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Spoofing your MAC address](img/3183OS_04_22.jpg)'
  prefs: []
  type: TYPE_IMG
- en: That's all there is to it! Very easy huh? Just knowing this can help bypass
    paid hotspot networks where a user must pay money for an extended amount of time.
    Coffee shops, restaurants, airports, and hotels will have these kind of networks.
    When a user pays, their MAC address gets added to the allowed list of MAC addresses
    to access the Internet.
  prefs: []
  type: TYPE_NORMAL
- en: Protect yourself from wireless attacks
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We always need to know how to protect ourselves from such threats and attacks.
  prefs: []
  type: TYPE_NORMAL
- en: '![Protect yourself from wireless attacks](img/3183OS_04_23.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Next, we will be discussing how to protect yourself from these attacks:'
  prefs: []
  type: TYPE_NORMAL
- en: Stronger encryption will reduce the risk of an attack
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: MAC filtering can also help reduce the risk of an attack
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Only use WEP if your devices aren't compatible with WPA/WPA2; however, it is
    not recommended as it is unsecure
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Create a separate VLAN for a business network to limit access
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Disable or turn off WPS settings
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Create a strong, complex passphrase
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Should change the passphrase every 3 or 4 months
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Do not use default passwords configured by the manufacturer
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Use EAP rather than PSK
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Change the default SSID name
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: That's it for this chapter! I hope you enjoyed the demonstrations I put together
    for you. This chapter has been pretty fun and interesting for both of us. Let's
    take a few moments to look back at what you learned in this chapter.
  prefs: []
  type: TYPE_NORMAL
- en: In this chapter, we put together a plan for an attack. Next, we listed several
    methods for an attack. Then, we covered detailed information on WEP, WPA, and
    WPA2 encryption. Finally, we listed several ways to reduce the risk of a wireless
    attack.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will cover how to identify hosts on the wireless network,
    determine network size, and detect vulnerable devices and systems on that network.
    I'm quite sure you are just as excited as I am. Let's move on!
  prefs: []
  type: TYPE_NORMAL
