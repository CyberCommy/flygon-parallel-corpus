- en: Setting Up Kali - Part 2
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In the previous chapter, we started building our very own penetration testing
    lab. However, a lab environment is not complete without the installation of two
    of the most popular operating systems: Microsoft Windows and Ubuntu. As a penetration
    tester, it''s always recommended to practice your skills on both Windows and Linux
    environments, since both are used in corporate environments by end users, such
    as employees and executive staff members, on a daily basis. Usually, system administrators
    don''t always install the latest security updates on their employees'' systems,
    which leaves the computers vulnerable to the latest cyber threats. A penetration
    tester should learn how to perform various attacks on Windows and Linux.'
  prefs: []
  type: TYPE_NORMAL
- en: 'The following topics will be covered in this chapter:'
  prefs: []
  type: TYPE_NORMAL
- en: Installing Windows as a **virtual machine** (**VM**)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Installing Ubuntu 8.10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Troubleshooting Kali Linux
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Technical requirements
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The following are the technical requirements for this chapter:'
  prefs: []
  type: TYPE_NORMAL
- en: Oracle VM VirtualBox or VMware Workstation Pro
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Microsoft Windows 10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Microsoft Windows Server 2016
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ubuntu Desktop
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ubuntu Server
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Kali Linux
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Installing Windows as a VM
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Since more organizations use the Windows operating system as the main operating
    system for their employees' workstation/desktop, you need to understand how to
    perform a penetration test on the Windows platform.
  prefs: []
  type: TYPE_NORMAL
- en: 'One of the benefits offered by Microsoft is the 90-day trial of their operating
    systems through the Microsoft Evaluation Center. In this section, I''ll demonstrate
    how to set up a Windows VM in our penetration testing lab:'
  prefs: []
  type: TYPE_NORMAL
- en: 'First, you''ll need to download the ISO image of Windows 10 and Windows Server
    2016 using the following URLs:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '**Windows 10**: [https://www.microsoft.com/en-us/evalcenter/evaluate-windows-10-enterprise](https://www.microsoft.com/en-us/evalcenter/evaluate-windows-10-enterprise)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Windows Server 2016**: [https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2016](https://www.microsoft.com/en-us/evalcenter/evaluate-windows-server-2016)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The installation procedures for Windows Desktop and Windows Server are the same.
  prefs: []
  type: TYPE_NORMAL
- en: 'Once the ISO file has been downloaded successfully, open your hypervisor and
    choose New Virtual Machine:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/66d4c81c-6fce-4b95-8167-e9a69d632304.png)'
  prefs: []
  type: TYPE_IMG
- en: 'If you''re using VMware, the New Virtual Machine Wizard will prompt you to
    continue your setup in either the Typical (recommended) or Custom (advanced) mode.
    For this exercise, I have chosen the typical option as it comprises a few simple
    steps:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/70bb8d68-67c3-49ea-bb19-7522e6e25703.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Next, choose the Installer disc image file (iso): option to add the ISO file
    by clicking on Browse. Once the file has been added successfully, click on Next
    to continue:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/965092f8-22c6-48d7-b576-aa124969335d.png)'
  prefs: []
  type: TYPE_IMG
- en: 'VMware will present a custom window, allowing you to insert the product key
    (obtained from the Microsoft Evaluation Center during the registration phase)
    and create an administrator account during the installation phase. Simply complete
    the details, use the dropdown box to select the version of the operating system
    you are about to install, and click on Next:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/e4314238-0794-4fd7-9387-df108db0bd6e.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Next, you''ll have the option to name the VM and choose a location to store
    its configurations. This step can be left as the default setting:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/1ee6dc37-f808-4e19-88a1-49499ae4ec6a.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Next, you''ll have the option to create a new virtual hard disk for the Windows
    VM. I have chosen its size to be 100 GB and to split its files into multiple pieces
    for easier portability:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/eef4e800-73a1-48a6-97ec-3c2326150b8b.png)'
  prefs: []
  type: TYPE_IMG
- en: You can choose any size for the hard disk, as long as it's the recommended size
    or above. The system requirements can be found at [https://docs.microsoft.com/en-us/windows-server/get-started/system-requirements](https://docs.microsoft.com/en-us/windows-server/get-started/system-requirements).
  prefs: []
  type: TYPE_NORMAL
- en: 'The final window will show you a summary of the configurations. You can customize
    the hardware resources by clicking on the Customize Hardware... option:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/c8981b6f-7152-420b-9852-f5e34f488bd7.png)'
  prefs: []
  type: TYPE_IMG
- en: Upon clicking Finish, the Windows 10/Server 2016 VM will appear in your library.
    You can also modify the hardware configurations when the VM is powered off.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Now, it's time to power on the Windows VM. Ensure that you choose your corresponding
    language, time, and keyboard format.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Choose the Install now option to begin the installation phase.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Choose the version of Windows you''d like to install. If you''re using Windows
    Server 2016, use the Datacenter edition. If you''re using Windows 10, choose the
    Enterprise edition:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/b2db6879-086f-4385-8097-721d1c365859.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Next, you''ll need to read and accept the **End User License Agreement** (**EULA**),
    followed by the type of installation on the virtual **hard disk drive** (**HDD**).
    Since it''s a new installation, select the Custom: Install Windows only (advanced) option,
    as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/c3ff5ecd-2735-4119-899f-9a7ce09ed586.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Select the virtual HDD as the installation destination, as shown in the following screenshot, and
    click Next to continue:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/98ad5299-f58c-4277-80d2-c7c76320a95c.png)'
  prefs: []
  type: TYPE_IMG
- en: The installation process may take a while, depending on the amount of CPU and
    RAM resources that have been allocated to the VM.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Once this process has been completed, Windows will present a login window to
    you.
  prefs: []
  type: TYPE_NORMAL
- en: Now that we have installed a Windows VM, we will look at how to create additional
    user accounts on Microsoft Windows.
  prefs: []
  type: TYPE_NORMAL
- en: Creating a user account
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this section, I''ll guide you through creating a user account on Windows:'
  prefs: []
  type: TYPE_NORMAL
- en: Firstly, you need to access the Control Panel and click on the User Accounts option.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You'll see all the local user accounts on your system. Select Manage another
    account.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Next, click on Add a user account.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Windows 10/Server 2016 will provide you with a window asking for various details
    such as username, password, and a hint (to help you remember your password) so
    that you can create a new user account on the local system.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Now that you have the knowledge to create new user accounts, we will look at
    disabling automatic updates on Microsoft Windows Server.
  prefs: []
  type: TYPE_NORMAL
- en: Opting out of automatic updates
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Vendors deliver updates to their software products and operating systems for
    many reasons, such as adding new features, improving performance, and fixing issues
    such as security bugs and crashes. Disabling automatic updates on Windows will
    ensure that your operating system maintains the same level of security that was
    established at installation while you practice in your lab.
  prefs: []
  type: TYPE_NORMAL
- en: 'Using Windows 10 and Windows Server 2016, Microsoft has removed the function
    of disabling Windows Update from the Control Panel. In this section, I''ll demonstrate
    how to disable the Windows Update function within Windows Server 2016:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Firstly, open Command Prompt and enter `sconfig`, as shown in the following
    screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/e1bf9cac-2377-4d73-a263-cdd9deb01bb2.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The following screen will appear. Use option `5` to access `Windows Update
    Settings`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/e81e8108-7079-4061-8b00-7b40759c9d7a.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The interactive menu will ask how you would like Windows to handle the checking
    and installation of updates—`(A)utomatic`, `(D)ownloadOnly`, or `(M)anual`. We
    will choose the `Manual` option:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/5202929e-4d45-41ae-835f-a55b642d1a22.png)'
  prefs: []
  type: TYPE_IMG
- en: Windows will then provide confirmation of our selection. `Manual` ensures that
    Windows does not check for any updates without our permission.
  prefs: []
  type: TYPE_NORMAL
- en: Now that you can disable automatic updates, let's take a look at setting a static
    IP address on your Windows VM.
  prefs: []
  type: TYPE_NORMAL
- en: Setting a static IP address
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: It's quite important to set static IP addresses on network resources and appliances.
    A static IP address will ensure that the IP address does not change and, therefore,
    that users on the network will always be able to access the resources/server once
    network connectivity is established.
  prefs: []
  type: TYPE_NORMAL
- en: 'Having a server within an organization or within our lab will definitely require
    an address that does not change. To do this, follow these steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'To begin, log on to your Windows Server 2016 and click the Windows icon in
    the bottom-left corner to view the Start menu. Click on Server Manager, as shown
    in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/6c707d08-f4c9-4ada-9af2-347fbc8d290a.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Server Manager is a single dashboard that allows a server administrator to
    control, manage, and monitor Windows Server using a **graphical user interface**
    (**GUI**). On the left-hand side of the window, select Local Server, and then
    click the Ethernet0 section, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/cf0b18e3-f0f5-4170-a43e-9b7dee7b5c1d.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The Network Connections window will open, displaying all the network adapters
    that are available on your virtual Windows Server 2016 machine. To add a static
    IP address to a network adapter, simply right-click on the adapter and select
    Properties, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/b3314117-a9bf-4cd7-9e06-8954a75bb8c6.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Select Internet Protocol Version 4 (TCP/IPv4) | Properties, as shown in the
    following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/c8a9a9d0-3a32-4702-b09e-228867e9b0f1.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Now, you''ll have the option to assign a static IP address, subnet mask, and
    default gateway, as well as **Domain Name Server** (**DNS**) configurations:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/2eefb777-5691-4d01-a1df-3413f602ffb0.png)'
  prefs: []
  type: TYPE_IMG
- en: Please ensure that your IP address configurations are within the same subnet
    as your DHCP server (of your hypervisor) and the other VMs. Your IP address should
    be between `10.10.10.2` and `10.10.10.254`, the subnet mask should be `255.255.255.0`,
    and the default gateway should be `10.10.10.1` for each of the VMs in your lab.
  prefs: []
  type: TYPE_NORMAL
- en: Now that you are able to configure static IP addresses for Windows, let's look
    at how to add additional network interfaces.
  prefs: []
  type: TYPE_NORMAL
- en: Adding additional interfaces
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: At times, having an additional **network interface card** (**NIC**) can be useful
    in many ways, such as ensuring network redundancy and even enabling NIC Teaming,
    which combines more than one NIC into one logical interface for combined throughput.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s add an additional NIC to a VM:'
  prefs: []
  type: TYPE_NORMAL
- en: 'To add an additional NIC to your VM, simply access the settings for the VM:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/bf36fd13-6862-44a2-bff9-ef4fc859fec8.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Click on Add.... This will allow you to choose from a variety of virtual hardware
    components:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/8ea844ec-3e6c-4572-b061-12e4ccca6d3a.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Select Network Adapter and click Finish, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/115ddd1f-c0dd-47ca-9717-cb845bd0c97c.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The new NIC will be added to the VM and you''ll have the option to configure
    it as per your preferences:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/0ddac02e-9774-48bd-bfea-cb6e692f5aaf.png)'
  prefs: []
  type: TYPE_IMG
- en: When the operating system has rebooted, the virtual NIC will be present within
    the Network Sharing Center in Windows.
  prefs: []
  type: TYPE_NORMAL
- en: 'Having completed this section, you have now done the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Installed Microsoft Windows
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Created a user account
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Disabled Windows automatic updates
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Configured a static IP address on Windows Server
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Added additional interfaces for a VM via the hypervisor
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In the next section, we will take a deep dive into installing Ubuntu within
    our penetration testing lab.
  prefs: []
  type: TYPE_NORMAL
- en: Installing Ubuntu 8.10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section, we will be installing an Ubuntu (Linux) VM in our lab environment
    for testing purposes. As I mentioned previously, an awesome penetration tester
    or ethical hacker is someone who has a lot of knowledge and experience of many
    operating systems.
  prefs: []
  type: TYPE_NORMAL
- en: It's quite good to have a broad understanding and knowledge of various types
    of environments and operating systems as it will make security auditing and penetration
    testing much easier for you. We are going to use the Ubuntu 8.10 operating system
    within our lab.
  prefs: []
  type: TYPE_NORMAL
- en: The Linux operating system comes in many flavors, such as Fedora, CentOS, Arch
    Linux, openSUSE, Mint Linux, Ubuntu, and RedHat.
  prefs: []
  type: TYPE_NORMAL
- en: 'There are three ways to get started installing Ubuntu on your lab, as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Navigate to Ubuntu's website at [www.ubuntu.com](http://www.ubuntu.com) and
    go to the Download page to obtain a copy of the latest version of Ubuntu.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Since our exercise is going to use a specific version of Ubuntu, we will search
    for `Ubuntu 8.10` on Google to quickly find the official relevant repository:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![](img/2a9caa92-46d7-4127-affb-8ea047ac2452.png)'
  prefs: []
  type: TYPE_IMG
- en: You can also use [http://old-releases.ubuntu.com/releases/8.10/](http://old-releases.ubuntu.com/releases/8.10/)
    to download both Ubuntu Server and Desktop ISO images.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Once the ISO file has been successfully downloaded onto your desktop computer,
    create a virtual environment within Oracle VM VirtualBox or VMware Workstation
    using the following parameters:'
  prefs: []
  type: TYPE_NORMAL
- en: '**CPU**: 1 core'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**RAM**: 1-2 GB'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**HDD**: 60 GB'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**NIC**: VMnet1'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: You can also adjust the hardware configurations as you see fit.
  prefs: []
  type: TYPE_NORMAL
- en: As you may recall, in the previous section, *Installing Windows as a VM*, we
    walked through the process of setting up a virtual environment. The procedure
    for creating a virtual environment for Linux is essentially the same as that for
    Windows when using a hypervisor, the only differences being in choosing the Ubuntu
    ISO (Linux operating system) and using the previously specified parameters (that
    is, for the CPU, RAM, and so on).
  prefs: []
  type: TYPE_NORMAL
- en: 'The following are the instructions for installing Ubuntu Server in our lab:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Once you have powered on the VM, you''ll be presented with the following screen.
    Choose Install Ubuntu Server and hit *Enter*:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/36019fae-d4cd-4934-91c8-6c44b1f3a7f5.png)'
  prefs: []
  type: TYPE_IMG
- en: The setup wizard will ask to specify your language.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Then, you'll be asked to choose your country or territory.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'The installation wizard will ask whether you want your keyboard layout detected.
    Choose No and continue:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/0f424784-c5e6-447e-8cb6-a846a7d2925f.png)'
  prefs: []
  type: TYPE_IMG
- en: 'During the setup process, you will be asked to assign a hostname to the Ubuntu
    server, which you can leave as the default, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/f5419497-cb50-450e-ae5f-94132e9bd8d5.png)'
  prefs: []
  type: TYPE_IMG
- en: During this phase, you'll also be asked to specify your time zone. Choose an
    appropriate zone.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Select the **Guided – use entire disk** option and hit *Enter* to continue.
    This will allow the Ubuntu operating system to wipe the entire disk drive and
    install itself on it, thereby occupying the entire disk:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/7858a394-9a76-4691-8eb2-693faafaf3cf.png)'
  prefs: []
  type: TYPE_IMG
- en: 'You will be asked to choose the destination where you wish to install the Ubuntu
    server; choose the disk that has **sda** *(*primary disk partition) in brackets:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/d5f64f36-f9ef-4938-9f28-9acd3a013108.png)'
  prefs: []
  type: TYPE_IMG
- en: '**sda** is used to represent the primary partition of the primary disk drive
    on the Linux operating system. This is the location where you would normally install
    any operating system on a disk drive.'
  prefs: []
  type: TYPE_NORMAL
- en: 'Before the installation is executed, select Yes to confirm the configurations:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/245a1065-88f0-485d-938e-a0847c2f7a65.png)'
  prefs: []
  type: TYPE_IMG
- en: You will then be asked to provide your full name and you'll also be required
    to create a user account. Next, assign a password to the user account.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Once the user account creation process has been completed, you will be asked
    whether you would like to set up an encrypted private directory. I have used the
    default (No), as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/2ee99760-9785-42a2-bcc5-0e35c54f7cc0.png)'
  prefs: []
  type: TYPE_IMG
- en: 'At this point, the installation process will take a few minutes to complete.
    Afterward, you''ll be required to set the system clock:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/5b29258c-7922-4f7d-a28a-cb67d638c91e.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Next, specify how the operating system should check for updates. I have chosen
    the **No automatic updates **option, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/a58ef089-59bf-4b0a-b7d0-318064e4fd56.png)'
  prefs: []
  type: TYPE_IMG
- en: 'On the following screen, you can still choose to install various services.
    I have used the default setting (no software/service selected) once again and
    selected Continue:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/1c246d67-b4bc-4301-aead-b71d33cc7abc.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Once the installation has been completed, the Ubuntu server will boot into
    its login window, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/ba27f94f-9d5c-42e6-80fe-b309bff3b296.png)'
  prefs: []
  type: TYPE_IMG
- en: Your Ubuntu VM is now all set up and ready for future exercises.
  prefs: []
  type: TYPE_NORMAL
- en: Now that you have installed a few VMs in your virtual lab environment, let's
    take a few more minutes to walk through and discuss the importance of creating
    **snapshots** regularly when working with virtualization.
  prefs: []
  type: TYPE_NORMAL
- en: Creating and using snapshots
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Creating a snapshot can save you a lot of time in restoring the previous state
    of a VM. A snapshot works like an instant system restore point. Taking snapshots
    of a VM prior to and after major changes will help you recover from any critical
    issues you may be experiencing within a VM.
  prefs: []
  type: TYPE_NORMAL
- en: 'To create a snapshot on both VirtualBox and VMware Workstation, perform the
    following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: On VirtualBox, select the VM of your choice.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Click the menu icon, as highlighted in the following screenshot, and select
    Snapshots.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Using VMware Workstation, select a VM of your choice. The snapshot menu on
    VMware Workstation Pro is located in the toolbar, as indicated in the following
    screenshot, on the right-hand side:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/829cd7b7-d510-418c-af58-4d679b0cd8cb.png)'
  prefs: []
  type: TYPE_IMG
- en: I would recommend creating a snapshot once the installation of a VM is successful,
    and before and after any major changes or configurations are made on a VM. Creating
    a snapshot uses disk space on your local storage drive. However, snapshots can
    be deleted at any time.
  prefs: []
  type: TYPE_NORMAL
- en: Having completed this section, you are now able to efficiently install Linux
    within a virtualized environment and understand the benefits of working with snapshots.
  prefs: []
  type: TYPE_NORMAL
- en: Troubleshooting Kali Linux
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Now that you have access to Kali Linux, you may find yourself encountering
    some problems. These may include the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Network adapter and USB incompatibility
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: VM memory problems
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Let's go through how to resolve these issues should they come up.
  prefs: []
  type: TYPE_NORMAL
- en: Network adapter and USB incompatibility
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: One of the most commonly found issues that students encounter after importing
    the Kali Linux VM within VirtualBox is incompatibility. This incompatibility is
    usually to do with the network adapter or USB settings on VirtualBox. If these
    issues aren't resolved, the VM will not be able to start.
  prefs: []
  type: TYPE_NORMAL
- en: 'To determine whether there is an issue, we can perform the following actions:'
  prefs: []
  type: TYPE_NORMAL
- en: Open the VM settings on Oracle VM VirtualBox.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: If you see Invalid settings detected, the VM will be unable to start. Click
    on one of the icons (such as the network icon or the USB icon) and the relevant
    error message will appear.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'The following screenshot indicates that there''s an issue with the virtual
    network adapter on the VM. As we can see, there is no actual adapter attached.
    Perform the following actions:'
  prefs: []
  type: TYPE_NORMAL
- en: Simply click the Name drop-down menu, as shown in the following screenshot.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Select an appropriate network adapter, such as **Adapter 1**, to resolve the
    issue:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/11a4c6b2-3e71-4c3d-8831-1c170bce2ebe.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Now that we have fixed the potential problem with the network adapter, let''s
    look at what happens if the USB software bus is incompatible. You would usually
    see a USB icon displayed at the bottom of the Settings window. Clicking on it
    will display the following message:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/cfd86190-1b57-4a47-a2d7-b9f3eed2b3e2.png)'
  prefs: []
  type: TYPE_IMG
- en: The use of the VirtualBox extension pack will resolve this issue by enabling
    USB 2.0 or 3.0\. This will ensure that the VM is compatible and is able to send
    and receive data to the host's USB ports.
  prefs: []
  type: TYPE_NORMAL
- en: 'To resolve this issue, simply access the USB settings and select the appropriate
    USB controller (preferably USB 1.1 or 2.0), as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/5cdfe7bf-2ff4-4360-8c03-d5cd3c1aedff.png)'
  prefs: []
  type: TYPE_IMG
- en: Within the Oracle VM VirtualBox settings interface, if you look carefully, the
    bottom of the window includes icons with warning signs on each. Hovering over
    each icon at the bottom will provide you with a description of the issue that
    is preventing the VM from starting.
  prefs: []
  type: TYPE_NORMAL
- en: VM memory problems
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'A lot of students sometimes create a VM and assign more memory than is available
    to the hypervisor. This can cause either the VM to not start or instability on
    your host operating system. To resolve this issue, do the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Open the VM settings.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Open the System tab.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Next, adjust the base memory so that it sits within the green zone (random
    access memory is what we''re talking about here):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![](img/3118192e-d9c6-489a-b8cd-481a673c694d.png)'
  prefs: []
  type: TYPE_IMG
- en: The hypervisor will always inform you of any issues. However, please ensure
    that you enable the virtualization feature in your processor. To do this, you'll
    need to access your computer's BIOS/UEFI settings to turn on virtualization.
  prefs: []
  type: TYPE_NORMAL
- en: If you encounter any of these problems, you are now equipped with the answers
    to fix them.
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: During the course of this chapter, we continued from the previous chapter and
    expanded our lab environment by deploying and setting up both Windows and Ubuntu
    VMs. Additionally, we took a look at the two most commonly found issues when deploying
    Kali Linux in a virtual environment.
  prefs: []
  type: TYPE_NORMAL
- en: Having completed this chapter, you have the skills to install Windows and Ubuntu
    servers in a virtual lab environment, create user accounts and opt out of automatic
    updates, add additional network interfaces to a VM, and create snapshots using
    the hypervisor manager, VirtualBox, and VMware Workstation Pro. This concludes
    our objective of building a virtual penetration testing lab environment.
  prefs: []
  type: TYPE_NORMAL
- en: Now that we have our own lab set up and ready, it's time to dive into our next
    chapter, which is about getting comfortable with Kali Linux 2019.
  prefs: []
  type: TYPE_NORMAL
- en: Further reading
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The following links are recommended for additional reading:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Kali Linux documentation**: [https://docs.kali.org/](075f58ca-ff2a-48c7-9b90-17ddd4e408c9.xhtml)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Windows 10**: [https://docs.microsoft.com/en-us/windows/windows-10/](https://docs.microsoft.com/en-us/windows/windows-10/)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Windows Server 2016**: [https://docs.microsoft.com/en-us/windows-server/index](https://docs.microsoft.com/en-us/windows-server/index)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Ubuntu**: [https://tutorials.ubuntu.com/tutorial/tutorial-install-ubuntu-desktop](https://tutorials.ubuntu.com/tutorial/tutorial-install-ubuntu-desktop)
    and [https://tutorials.ubuntu.com/tutorial/tutorial-install-ubuntu-server](https://tutorials.ubuntu.com/tutorial/tutorial-install-ubuntu-server)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
