- en: Chapter 2. Scanning
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Vulnerability scanning, or in other terms, identification of vulnerabilities
    in the target infrastructure, is the key activity performed by any vulnerability
    scanner such as Nessus. While using such scanners to perform a Vulnerability Assessment,
    it is of prime importance to configure the scan parameter, in the most efficient
    way, keeping the target infrastructure in mind. This will result in getting the
    most effective scan results in the optimized scan time.
  prefs: []
  type: TYPE_NORMAL
- en: 'This chapter will introduce how to set up Nessus for vulnerability scanning.
    Scan configuration in Nessus involves two major steps, namely configuration of
    a scan policy and launching a scan using the configured policy. The key areas
    that will be covered in this chapter are as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Scan prerequisites
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Policy configuration
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Credential and noncredential scan
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Scan configuration
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Scan execution and results
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Scan prerequisites
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A successful vulnerability scan requires a proper setup of Nessus with certain
    prerequisites. This will make sure that all approvals are documented, all backups
    are in place, and the scanning windows have been agreed before you scan. Nessus
    cannot reach the target with a firewall in between that is blocking the traffic/packets.
  prefs: []
  type: TYPE_NORMAL
- en: We will now see the most common prerequisites, which are applicable to most
    of the Nessus scans; however, I encourage you to be analyzing as per your scanning
    environment and the organization's applicability.
  prefs: []
  type: TYPE_NORMAL
- en: Scan-based target system admin credentials
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: It is always recommended to run with a credentials scan for better results;
    this means that before you scan a target system, you should obtain the target
    system's credentials or have someone who can key-in the target system administrative
    credentials in the Nessus GUI without sharing with you before you start the scan.
    This will help Nessus to probe the target system more and more to uncover maximum
    vulnerabilities. If you are performing a Blackbox scan where you will not have
    access to the credentials, this particular prerequisite stands inapplicable.
  prefs: []
  type: TYPE_NORMAL
- en: Direct connectivity without a firewall
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: It is recommended to have direct connectivity of Nessus with the target systems
    for better results; this means there should not be a firewall or any other device
    blocking traffic in between of Nessus and the target systems. If a firewall is
    in between of Nessus and the target systems, a firewall rule should be configured
    to allow all traffic in between of Nessus and the target systems. Don't forget
    to remove or deactivate this rule immediately after scan completion. This is required
    because Nessus generates a lot of malicious packets/traffic to the target systems
    for probing the vulnerabilities. In case a firewall is in place, this will drop
    all such malicious packets from reaching the target system.
  prefs: []
  type: TYPE_NORMAL
- en: Scanning window to be agreed upon
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: It is the owner of the target system who can let you know the best suitable
    time for the vulnerability scan depending on the peak and off-peak load on the
    target systems. This suitable time window is called the **scanning window**. If
    you are running a scan on the production systems, it is very important to agree
    on a scanning window, preferably with the target system owners. It is recommended
    to run Nessus scans during off-peak hours when the target system has minimum load.
  prefs: []
  type: TYPE_NORMAL
- en: Scanning approvals and related paper work
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: It is important to have a clear discussion with the target system owners to
    make them understand the impacts, which might take place due to a malicious scan,
    which may or may not be an intrusive scan. Each party should understand the risk
    of carrying out vulnerability scans and agree to it. This should be documented
    for legal purposes. Also, a non-disclosure agreement should be duly signed by
    each person of the team conducting the Vulnerability Assessment or Penetration
    Test.
  prefs: []
  type: TYPE_NORMAL
- en: Backup of all systems including data and configuration
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: It is important to make a full backup of the target system before a scan is
    carried out. This will ensure if something goes wrong with the target machine
    due to the vulnerability scan, the latest backup can be restored immediately to
    put the target machine back. Backup administrators should make sure they perform
    a full backup, which includes all data, configurations, integration information,
    code, release notes and special configurations, IOS, and so on.
  prefs: []
  type: TYPE_NORMAL
- en: Updating Nessus plugins
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Nessus plugins should be updated with the latest definitions before running
    the scan; this will make sure your Nessus is loaded with all the latest checks
    to discover the latest vulnerabilities.
  prefs: []
  type: TYPE_NORMAL
- en: Creating a scan policy as per target system OS and information
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A scan policy should be configured before running the scan as per the target
    system operating systems and environments. The policy should be configured in
    Nessus accordingly. How to create a policy is illustrated in the next section
    of this chapter.
  prefs: []
  type: TYPE_NORMAL
- en: Configuring a scan policy to check for an organization's security policy compliance
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Every organization has its own security policies. Nessus provides a capability
    to customize scan policy based on the organization's policy; for example, password
    complexity. While configuring a Nessus policy, you should be careful to customize
    the password policy as per the target organization's password policy. An organization's
    password policy might say any password configured is noncompliant if the password
    length is less than six characters, whereas other organizations might say less
    than eight characters is a noncompliance. Nessus gives you the flexibility to
    customize the policy based on your requirements before you run the scan.
  prefs: []
  type: TYPE_NORMAL
- en: Gathering information of target systems
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In the previous chapter, we saw the different phases of Vulnerability Assessment.
    One of the phases before scanning is gathering information, which is again a prerequisite
    to the scanning phase. You should gather all the possible information from public
    websites, Internet, and internal staff (in case of an internal scan or a grey-box
    scan). This information is useful to tweak your Nessus scan policy to configure
    or select the required checks based on the information you obtain about the target
    system, also it will help in mapping the network to include the IP address.
  prefs: []
  type: TYPE_NORMAL
- en: Sufficient network bandwidth to run the scan
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: It is important to run the scan with a good network bandwidth; if you run the
    scan on a low bandwidth, there are chances that packets may be dropped in between
    and your scan may get interrupted in between. To avoid all such circumstances,
    it is always recommended to run the scan when you have good network bandwidth.
    This will also help you in timely completion of the scan.
  prefs: []
  type: TYPE_NORMAL
- en: Target system support staff
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: It is recommended to have target system administrators or an expert support
    staff to analyze the health and performance of target systems. If they are available
    during the scanning window, they can continuously monitor target systems and sound
    alarms. If the system is not performing properly, stop the scan; or if something
    goes wrong, the system can be recovered.
  prefs: []
  type: TYPE_NORMAL
- en: Policy configuration
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Policy configuration is the primary step performed prior to scanning. Policy
    configuration, in simple terms, means setting up Nessus with the most optimized
    configuration for scanning based on the target infrastructure.
  prefs: []
  type: TYPE_NORMAL
- en: 'The key parameters that can be configured while setting up a policy are as
    follows:'
  prefs: []
  type: TYPE_NORMAL
- en: Name of the policy
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Type of port scanning required
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Performance of scan in terms of maximum checks per scan in parallel and so on,
    which will decide on the scan time
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Option of entering credentials for the infrastructure being scanned locally
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Option to select the most appropriate plugins
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Advance preference option to provide different drop-down options to choose configuration
    to further fine tune the policy depending on the target; for example, database-compliance
    checks, Cisco IOS compliance checks, and so on
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![Policy configuration](img/7440OS_02_01.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Nessus provides an option to upload a scan policy if you already have it from
    somewhere else. Similarly, the option to export and copy an existing policy is
    also available. If you have multiple Nessus systems, you may want to use export
    and upload options to have the same policies on all Nessus systems. You can also
    delete a policy if you are no longer using it.
  prefs: []
  type: TYPE_NORMAL
- en: Default policy settings
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: By default, there are four default policy templates that are preloaded in the
    Nessus scanner; these templates will enable the user to start scanning using these
    basic policies and to get an idea of how a typical policy configuration will look
    or to customize them as per our requirement.
  prefs: []
  type: TYPE_NORMAL
- en: 'The default policies are listed as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: External network scan
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Internal network scan
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: PCI DSS audit policy
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Web application testing policy
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: These policies are self-explanatory. If you want to scan an external network,
    use the external network scan policy; if you want to scan the internal network,
    use the internal network scan policy; if you want to conduct a scan for the PCI
    DSS purpose, use the PCI DSS audit policy, and lastly, if you want to scan an
    application for web-application-related vulnerabilities, such as cross-site request
    forgery, cross-site scripting, and SQL injections, use the web application testing
    policy.
  prefs: []
  type: TYPE_NORMAL
- en: It is recommended to use these default policies as base templates to create
    your own customized policies. You may want to copy the existing default policy
    and save it with a new name as per your scanning requirements.
  prefs: []
  type: TYPE_NORMAL
- en: New policy creation
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The next section will familiarize you with the different options available while
    setting up a scan policy in Nessus. To start configuring a new scan policy, click
    on the **+ New Policy** option under the policy tab. Under this tab, there are
    four policy setting options available, namely **General Settings**, **Credentials**,
    **Plugins**, and **Preferences**.
  prefs: []
  type: TYPE_NORMAL
- en: General Settings
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The **General Settings** tab enables the user to set general information, such
    as scan name, scan setting type, and description. The settings available under
    this setting are basic, port scanning, performance, and advanced.
  prefs: []
  type: TYPE_NORMAL
- en: 'The **Basic** setting includes the following options:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Name**: This option allows assigning a unique name to the policy'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Visibility**: This option allows the policy to be shared with others or keep
    for private use; only administrative users are allowed to share the policy'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Description**: This option provides an option to add a description to the
    policy for future reference; for example, the description of a policy configured
    for database scanning can be updated in a way for the user to recall and use the
    policy as per the purpose it was set for'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Allow Port- Scan Report Edit**: This option allows you to delete the items
    in the report post port scanning; typically, this should be disabled while conducting
    the scan from the compliance perspective to showcase that the report was not tampered,
    as shown in the following screenshot:'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![General Settings](img/7440OS_02_02.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'The **Port Scanning** setting includes the following options:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Port Scan Range**: It specifies the number of ports to be scanned. **default**
    indicates 4,790 common ports found in the Nessus-services file, **ALL** indicates
    all 65,365 ports. A specific port range can also be specified by using the `-`
    symbol. Also, scanning different range of ports for TCP and UDP in the same policy
    can be done using `t:` and `u:` followed by a port range. A different range of
    ports for TCP/UDP in the same policy can be specified using a comma sign; for
    example, `T 90;1000,U:350-400`.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Consider Unscanned Port as Closed**: If this option is selected in the policy,
    Nessus will consider the port as closed if Nessus is not able to scan the port.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Nessus SNMP Scanner**: It allows Nessus to target the SNMP service while
    scanning; this is complimented by adding the SNMP setting in the policy''s **Preference**
    section for better scan results.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**netstat portscanner (SSH)**: This option uses the `netstat` command available
    over SSH connection to find open ports in a UNIX system. This command requires
    authentication credentials.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Ping the remote host**: This option helps to find live systems by pinging
    the ports. Based on the ping response, Nessus will identify it as open.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Netstat Port Scanner (WMI)**: This option uses the `netstat` command available
    over the WMI connection to find open ports in a Windows system. This command requires
    authentication credentials.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Nessus TCP Scanner**: This option is Nessus in-built option to find open
    TCP ports.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Nessus SYN Scanner**: This option uses Nessus in-built SYN scan feature to
    identify an open port.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '![General Settings](img/7440OS_02_03.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'The **Performance** setting includes the following options:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Max Checks Per Host**: This option enables Nessus to perform maximum number
    of checks that Nessus launched against a single target machine at one time.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Max Hosts Per Scan**: This option enables Nessus to scan maximum number of
    hosts Nessus will scan in parallel.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Network Receive Timeout (seconds)**: This option shows the maximum time Nessus
    will wait for a host to respond. This value is set to 5 seconds as default and
    can also be superseded by the value mentioned in a particular plugin. This can
    be set to a higher value in case of slow connection.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Max Simultaneous TCP Sessions Per Host**: This option limits the maximum
    number of TCP sessions to a single target machine.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Max Simultaneous TCP Sessions Per Scan**: This option limits the maximum
    number of TCP sessions for the whole period of scanning, no matter how many target
    machines are scanned.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Reduce Parallel Connections on Congestion**: This option enables Nessus to
    reduce the number of packets being sent on the network to avoid choking the network
    bandwidth.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Use Kernel Congestion Detection (Linux Only)**: This feature is available
    for Nessus scanners deployed on Linux. Once this option is enabled, Nessus will
    monitor CPU and other internal parameters and will modify the resource utilization
    accordingly.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The **Advanced** setting includes the following options:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Safe checks**: This option disables plugins, which might have an impact on
    the target machine. It is important to select this option to run a safe scan.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Silent dependencies**: This option, if checked, includes a list of dependencies
    not in the report.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Log Scan Details to Server**: This option logs additional information to
    the Nessus server log; this helps to evaluate a scan from the plugin''s perspective,
    that is, it helps to determine whether a particular plugin was launched and used.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Stop host scan on disconnect**: If this option is enabled, Nessus will stop
    scanning the target machine, if it feels the target machine is not responding
    back to the packets being sent. This may happen due to some reason, such as the
    target machine being turned off or traffic to the target machines is blocked.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Avoid sequential scans**: A list of hosts under the scope of scanning can
    be fed to Nessus; if this option is chosen, Nessus will conduct the scan in a
    random manner instead of going sequentially.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Designate hosts by their DNS name**: This option enables the use of hostname
    in the report prepared post scanning instead of the IP address of the target machine.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Credentialed scan
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Nessus offers a feature to perform credentialed or authenticated scans. With
    this option, Nessus is able to log in to the local system to find local system
    level vulnerabilities, such as missing patches and operating system settings.
    Typically, these vulnerabilities are not highlighted by Nessus in case of a noncredential
    scan over the network. In short, the credential scan option helps to find local
    vulnerabilities of the system after logging in to the system using the credential
    provided. A credential scan performs the same operations as the local user of
    the system; it depends on the level of access granted to the local user account
    used by Nessus.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot shows the option to configure a credential scan for
    **Windows credentials**, **SSH settings**, **Kerberos configuration**, and **Cleartext
    protocol settings**:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Credentialed scan](img/7440OS_02_06.jpg)'
  prefs: []
  type: TYPE_IMG
- en: The Windows credentials option
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: Under the Windows credential option, Nessus captured the **Server Messaging
    Block** (**SMB**) configuration details. SMB is a file sharing protocol, which
    will help Nessus to unearth local vulnerabilities in a Windows system. It is always
    recommended to use an account with administrative privileges for the best possible
    results of a credentialed scan.
  prefs: []
  type: TYPE_NORMAL
- en: Windows usernames, passwords, and domains
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: The SMB domain field is optional and Nessus will be able to log in with domain
    credentials without this field. The username, password, and optional domain refer
    to an account that the target machine is aware of.
  prefs: []
  type: TYPE_NORMAL
- en: 'Even if credentials are not used, Nessus will attempt to log in to a Windows
    server with the following combinations:'
  prefs: []
  type: TYPE_NORMAL
- en: Administrator without a password
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A random username and password to test guest accounts
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: No username or password to test null sessions
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Nessus supports several different types of authentication methods for Windows-based
    systems. Each of these methods take a username, password, and domain name (sometimes
    optional for authentication). The setting option enables you to specify the use
    of NTLM or Kerberos option.
  prefs: []
  type: TYPE_NORMAL
- en: '![Windows usernames, passwords, and domains](img/7440OS_02_07.jpg)'
  prefs: []
  type: TYPE_IMG
- en: The SSH settings option
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: The **SSH settings** option from the drop-down menu allows you to enter credentials
    for scanning UNIX systems. Credentials are used to obtain local information from
    remote UNIX systems. The field for entering the SSH username for the account will
    perform the checks on the target UNIX system along with either the SSH password
    or the SSH public key, and private key pair. There is also a field for entering
    the passphrase for the SSH key, if it is required.
  prefs: []
  type: TYPE_NORMAL
- en: The most effective credentialed scans are those when the supplied credentials
    have `root` privileges. As many sites do not permit a remote login as `root`,
    Nessus users can invoke `su`, `sudo`, `su+sudo`, or `dzdo` with a separate password
    for an account that has been set up to have `su` or `sudo` privileges.
  prefs: []
  type: TYPE_NORMAL
- en: If an SSH `known_hosts` file is available and provided as part of the scan policy,
    Nessus will only attempt to log in to hosts in this file. The preferred SSH port
    can be set to direct Nessus to connect to SSH, if it is running on a port other
    than 22\. If an account, other than root, is to be used for privilege escalation,
    it can be mentioned under the **Elevate Privileges with** option.
  prefs: []
  type: TYPE_NORMAL
- en: Best practices recommend using SSH keys for authentication rather than SSH passwords.
    This will assure that the same username and password used for auditing the SSH
    server are not used to attempt a log in to a system that may not be under your
    control.
  prefs: []
  type: TYPE_NORMAL
- en: '![The SSH settings option](img/7440OS_02_08.jpg)'
  prefs: []
  type: TYPE_IMG
- en: The Kerberos configuration option
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: The **Kerberos configuration** option allows you to specify credentials using
    Kerberos keys from a remote system.
  prefs: []
  type: TYPE_NORMAL
- en: The Cleartext protocols settings option
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: In case a secure encrypted option is not available to do a credential scan,
    Nessus offers a feature of scan over cleartext protocol for `telnet`, `rsh`, `rexec`.
    In this option, the password travels unsafely in the Cleartext channel. This option
    also allows you to check the patching level.
  prefs: []
  type: TYPE_NORMAL
- en: '![The Cleartext protocols settings option](img/7440OS_02_11.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Plugins
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Plugins are the files used by Nessus for vulnerability checks. These plugins
    are updated on a regular basis with the latest vulnerability checks as they become
    available.
  prefs: []
  type: TYPE_NORMAL
- en: The plugins are divided into product families to enable an accurate and effective
    grouping of similar plugins together. Thus, by choosing the appropriate plugins
    family, a large number of applicable/not applicable plugins can be enabled or
    disabled efficiently and with minimal clicks.
  prefs: []
  type: TYPE_NORMAL
- en: Also, Nessus releases new plugins as and when new vulnerabilities are released.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot shows how the **Policy Plugin Configurations** window
    will look:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Plugins](img/7440OS_02_12.jpg)'
  prefs: []
  type: TYPE_IMG
- en: The following table represents the plugin color and their meaning. Basically,
    this represents the number of plugins enabled from a particular plugin family.
  prefs: []
  type: TYPE_NORMAL
- en: '| Color | Meaning |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| Green | It represents that all the plugins in a family are enabled. |'
  prefs: []
  type: TYPE_TB
- en: '| Grey | It represents that all the plugins in the family are disabled. |'
  prefs: []
  type: TYPE_TB
- en: '| Blue | It represents a mixed selection where within a plugins family, some
    of the plugins are selected and some deselected. |'
  prefs: []
  type: TYPE_TB
- en: The details of plugins selected will also be represented in the report against
    the vulnerability found due to a particular plugin.
  prefs: []
  type: TYPE_NORMAL
- en: Filtering
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: On top of the **Plugins** page, a filtering option is available. This option
    allows choosing plugins, which is enabled with a policy by applying filters.
  prefs: []
  type: TYPE_NORMAL
- en: '![Filtering](img/7440OS_02_13.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Filters can be added and removed by using the **ADD Filter** and **CLEAR Filters**
    button, respectively. Nessus also gives a **Match** option with **Any** and **All**.
    The **Any** option means that any one of the filter options specified is met.
    The **All** option means that the entire filter condition, which is mentioned
    should be specified.
  prefs: []
  type: TYPE_NORMAL
- en: By using filter options, the most optimized scanning plugins can be chosen.
    Also, it is recommended to first display all filters and apply the policy using
    the filtering option.
  prefs: []
  type: TYPE_NORMAL
- en: 'The details of the different plugin families and filtration criteria can be
    looked into in the *Tenable documentation*:'
  prefs: []
  type: TYPE_NORMAL
- en: '*"The "Denial of Service" family contains some plugins that could cause outages
    on a network if the "Safe Checks" option is not enabled, but does contain some
    useful checks that will not cause any harm. The "Denial of Service" family can
    be used in conjunction with "Safe Checks" to ensure that any potentially dangerous
    plugins are not run. However, it is recommended that the "Denial of Service" family
    not be used on a production network."*'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Preferences
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Preferences are the deeper settings of a Nessus policy, which are dynamic in
    nature. Dynamic means the options in the drop-down menu to configure preference
    settings may vary depending on the plugins and feed license.
  prefs: []
  type: TYPE_NORMAL
- en: These settings can be chosen by the person creating the scan policy depending
    on the target system's requirement. For example, if you plan to scan a database
    then while creating the policy, select **Database Settings** from the **Preferences**
    drop-down menu. This particular setting allows you to key in database details
    with the database credentials to probe the database further. This will allow your
    Nessus scan to discover more vulnerability.
  prefs: []
  type: TYPE_NORMAL
- en: I recommend the Nessus website, [http://www.tenable.com](http://www.tenable.com),
    for the latest settings and their explanations.
  prefs: []
  type: TYPE_NORMAL
- en: Scan configuration
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A sequential reading of this chapter is required for readers before jumping
    into this section. In the previous sections, we have explained the prerequisites
    one should take care of before running a scan. Also, it has been discussed how
    a scan policy should be configured and customized as per the target organizations
    security policy and what the differences are between a credential and a noncredential
    scan.
  prefs: []
  type: TYPE_NORMAL
- en: Configuring a new scan
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: How to initiate and execute a scan is illustrated in this section. To initiate
    a scan, we assume that the scan prerequisites that were previously mentioned in
    this chapter have been executed. For initiating a scan, log in to Nessus by using
    your Nessus credentials and click on **Scan Queue** from the uppermost bar of
    Nessus.
  prefs: []
  type: TYPE_NORMAL
- en: The **Scan Queue** bar has two buttons, namely **New Scan** and **Options**,
    which is a drop-down menu that provides you with options to resume a scan, pause
    a scan, or stop a running scan. Click on the **New Scan** button to initiate a
    new scan.
  prefs: []
  type: TYPE_NORMAL
- en: This has two options in the left-most panel, one for general settings and an
    other for e-mail settings.
  prefs: []
  type: TYPE_NORMAL
- en: General settings
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: General settings are the settings of a new scan such as what will be the name
    of the scan, do you want to run it now or save it as a template, which scan can
    be run later or you may want to schedule a scan for a desired time, and on which
    scan it will automatically take place. You can also select the policy which you
    want to use for this new scan from the policy's drop-down menu. Also, this is
    the place where you provide IPs that you want to scan. This also provides you
    with the ability to upload a file, which has a list of IPs to be scanned during
    this new scan.
  prefs: []
  type: TYPE_NORMAL
- en: '![General settings](img/7440OS_02_15.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'The following table describes the settings given in the preceding screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '| General scan setting | Description |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| **Name** | How you want to name your scan |'
  prefs: []
  type: TYPE_TB
- en: '| **Type** | This has the following three options in a drop-down menu:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Run Now**: If you want to run the scan right now'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Template**: If you want to save the scan as a template that you can run later'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Scheduled**: If you want to schedule the scan for a desired time, the scan
    will initiate automatically at this time'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '|'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Policy** | This is again a drop-down menu that lists all your Nessus scan
    policies. We discussed about creating a policy in the previous section. This policy
    should be selected from the drop-down menu, which will be used for the scan. |'
  prefs: []
  type: TYPE_TB
- en: '| **Scan Targets** | All IPs, which need to be scanned should be listed here.
    |'
  prefs: []
  type: TYPE_TB
- en: '| **Upload Targets** | If you have a text file, which has a list of IPs to
    be scanned, the same can be imported here in Nessus. |'
  prefs: []
  type: TYPE_TB
- en: In the end, you have a **Run Scan** button that will initiate the scan.
  prefs: []
  type: TYPE_NORMAL
- en: E-mail settings
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'E-mail settings can be configured for a scan if your Nessus is configured with
    an SMTP server. This is used to e-mail the scan results automatically post completion.
    Recipients'' e-mail IDs can be keyed in here in the **Recipient(s)** input box.
    Also, report filters can be configured. In this case, results will be e-mailed
    to the recipients if the report filter matches, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![E-mail settings](img/7440OS_02_16.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'The following table describes the settings given in the previous screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '| Email Scan Result Settings | Description |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| **Recipient(s)** | To whom you want to send the automated e-mails of the
    scan results, e-mail IDs of the recipients to be given here. |'
  prefs: []
  type: TYPE_TB
- en: '| **Report Filters** | Report filters can be configured here to match a particular
    condition or filter. If that matches, an automated e-mail of the result will trigger
    to the recipients. |'
  prefs: []
  type: TYPE_TB
- en: At the end, you have a **Run Scan** button that will initiate the scan.
  prefs: []
  type: TYPE_NORMAL
- en: Scan execution and results
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In the previous section, we have seen how a scan should be initiated. Once you
    click on **Run Scan**, the scan takes place.
  prefs: []
  type: TYPE_NORMAL
- en: Results of completed scans can be seen under the **Results** tab. A double-click
    on the scan result will open the detailed view of a particular scan result. This
    has three different tabs, namely **Hosts**, **Vulnerabilities**, and **Export
    results**. Under the **Hosts** tab, the host summary can be seen. This has a severity-wise
    count (critical, high, medium, low, and informational) of vulnerabilities.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following screenshot shows that a host is scanned, which has 37 critical,
    130 high, 140 medium, 0 low, and 49 informational vulnerabilities:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Scan execution and results](img/7440OS_02_18.jpg)'
  prefs: []
  type: TYPE_IMG
- en: The next tab is **Vulnerabilities**; this shows the vulnerabilities' summary
    with the risk severity of each vulnerability. Double-clicking on any vulnerability
    will take you to a detailed view of that vulnerability, which details synopsis,
    description, solution, vulnerability web links, plugin information, risk information,
    vulnerability information, reference information, plugin output, and so on. A
    risk severity modification option is also available in the detailed view.
  prefs: []
  type: TYPE_NORMAL
- en: 'The final tab is **Export Results**; this provides an option to export a Nessus
    scan results report in different formats, such as HTML, PDF, and CSV. One can
    also select what is required to be included in the report from the following options:'
  prefs: []
  type: TYPE_NORMAL
- en: Host summary and executive summary
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Vulnerabilities by host
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Vulnerabilities by plugin
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Compliance check executive
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Compliance check
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: One or many of these options can be chosen depending on the requirements.
  prefs: []
  type: TYPE_NORMAL
- en: 'A few sections of this chapter have been referenced from the learning material
    available on Nessus website: [http://www.tenable.com](http://www.tenable.com).'
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we learned to set up Nessus for vulnerability scanning. Scan
    configuration in Nessus involves two major steps, namely configuration of a scan
    policy and launching a scan using the configured policy.
  prefs: []
  type: TYPE_NORMAL
- en: Scan prerequisites including deciding on the scope of the scan, getting approval
    in place, deciding on the scan window, updating plugins, making a backup, having
    proper network access opened, identifying the point of contact, and deciding on
    credential or noncredential scanning were also discussed.
  prefs: []
  type: TYPE_NORMAL
- en: Among the prerequisites, the first key step is to set up the scan policy, which
    will include four default policy templates (external, internal, PCI DSS, and web
    application). Nessus also offers an option to create a customized policy using
    the **New Policy** option.
  prefs: []
  type: TYPE_NORMAL
- en: There are four setting options available while creating a new policy, namely
    **General Settings** and **Advance settings** (including the name of the policy,
    visibility, port scanning options, scan performance, and safe checks), credentialed
    scan (with this option, Nessus is able to log in to the local system to find local
    system level vulnerabilities, such as missing patches, and operating system settings).
    The options available to add credentials for different infrastructures is explained
    under this section, **Plugins** (includes choosing the right family of security
    check based on the type of infrastructure under scope of scanning, such as Windows,
    Cisco, and database). The Denial of Service plugin should be avoided, unless specifically
    asked for, as it may cause downtime. The **Preferences** menu includes advance
    and deeper level of settings, which should be configured as per the infrastructure
    under scan.
  prefs: []
  type: TYPE_NORMAL
- en: Setting up of a policy is followed by actual scanning; the key activities include
    choosing a new scan, the **General settings** options that include **Name**, **Type**,
    and **Policy** for scanning, which can be default or customized, and **Scan targets**
    including the IP of the infrastructure to be scanned (a text file can be used
    for the same). It is also explained how scan result can be mailed post completion
    of a scan. Finally, an option to retrieve the scan result from the **Result**
    tab is explained in brief.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will learn about performing scan results analysis, which
    will cover false positive analysis, vulnerability analysis, exploiting vulnerabilities,
    and so on.
  prefs: []
  type: TYPE_NORMAL
