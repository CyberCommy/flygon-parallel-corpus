- en: Hardening Techniques and Countermeasures
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Getting into the field of penetration testing and offensive security is always
    quite exciting; it's fun to learn the art of exploitation on systems and networks.
    At times, your career path may shift a bit from hacking into a client's network
    to assisting an organization in securing its network infrastructure from hackers
    and other potential threats. Over the past few years, so many cyberattacks have
    been reported every day. Let's not forget about the organizations that have not
    reported a cyberattack within their local network as they are trying to protect
    their organizational reputation, and lastly, those who have not yet detected an
    intrusion on their network.
  prefs: []
  type: TYPE_NORMAL
- en: Quite often, organizations create jobs to hire new people as cybersecurity professionals
    but the titles and job descriptions are not purely in line with penetration testing,
    but rather as a security administrator or security engineer. These roles usually
    consist of the function of a purple team, as mentioned in [](209bef8c-2e18-43ca-921c-6e551196d0fe.xhtml)[Chapter
    2](209bef8c-2e18-43ca-921c-6e551196d0fe.xhtml), *Understanding the Phases of the
    Pentesting Process*. The purple team's is as a combination of the red and blue
    teams, where they act on both the offensive and defensive sides in cybersecurity
    to detect, mitigate, and implement countermeasures for cyberattacks in an organization.
  prefs: []
  type: TYPE_NORMAL
- en: In this chapter, we are going to learn about various hardening techniques to
    improve the security posture of a system. Furthermore, we will take a look at
    countermeasures that can be implemented in an organization on their infrastructure
    to prevent and mitigate cyberattacks.
  prefs: []
  type: TYPE_NORMAL
- en: As we are about to conclude this book, it's equally important for a penetration
    tester to understand different hardening and mitigation techniques on various
    platforms to prevent security threats and reduce risk.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we will cover the following topics:'
  prefs: []
  type: TYPE_NORMAL
- en: Common security threats
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Securing network appliances
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Securing client operating systems
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Securing server operating systems
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Securing mobile device platforms
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Let's begin!
  prefs: []
  type: TYPE_NORMAL
- en: Security threats and countermeasures
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section, we are going to take a look at various security threats and
    how to implement countermeasures.
  prefs: []
  type: TYPE_NORMAL
- en: Viruses
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: A virus is a malicious piece of code that is designed to cause harm to a system,
    such as a computer. Viruses are not executed on their own usually but require
    the action of a person; this action can be done by simply clicking or running
    a virus-infected file, which will trigger the malicious code execution.
  prefs: []
  type: TYPE_NORMAL
- en: A notable type of virus is known as the **worm**. A worm is a self-replicating
    virus that can propagate throughout a network without any assistance from humans.
  prefs: []
  type: TYPE_NORMAL
- en: Imagine creating a program that can self-replicate without user interaction
    and overwhelm system resources so much that a worm-infected system becomes almost,
    if not completely, unusable. Once a worm virus has been created and its self-replicating
    process is triggered, disinfecting a network is quite difficult.
  prefs: []
  type: TYPE_NORMAL
- en: To prevent malware infections from viruses and worms, it is recommended having
    endpoint protection, such as antivirus or anti-malware protection enabled on all
    host devices, such as desktops and servers system. However, it is quite important
    to ensure each antivirus client is always up to date with the latest virus definitions
    to protect the host optimally.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following are some antivirus vendors:'
  prefs: []
  type: TYPE_NORMAL
- en: ZoneAlarm
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Kaspersky Lab
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Bitdefender
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Avast
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Symantec
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The following is a screenshot of the ZONEALARM Extreme Security user interface:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/48d94862-ccb8-440b-856d-9d1c340a1b5f.png)'
  prefs: []
  type: TYPE_IMG
- en: 'You may be wondering whether it is mandatory to purchase commercial antivirus
    software to be protected. On the Microsoft Windows platform, there''s a built-in/preloaded
    anti-malware protection that is created by Microsoft known as **Windows Defender**
    and it is free. Windows Defender provides real-time protection against various
    types of threats. The following screenshot shows PC status:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/41dc82c0-4238-48c9-bf7b-de5db3913b53.png)'
  prefs: []
  type: TYPE_IMG
- en: 'In recent years, crypto-malware surfaced in the digital world and caused significant
    damage to a lot of systems globally as almost no one was prepared to prevent or
    mitigate this new type of threat; this type of malware is known as **ransomware**.
    Ransomware''s objectives are quite simple: Once a victim system is infected, the
    malware encrypts the entire system making it unstable and holds the data on the
    disk drives as hostage until a ransom is paid. However, the encryption key that
    is used to encrypt the disk drives of a victim''s system is frequently changed
    to prevent the victim from decrypting the drives and removing the ransomware.
    The following is a screenshot of a variant of the *WannaCry* ransomware on a victim''s
    system:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/3bb34cfc-3704-4c89-be3e-ebb8405c6293.png)'
  prefs: []
  type: TYPE_IMG
- en: When infected with ransomware, the only window presented on the victim's system
    is the payment screen. One of the most valuable assets within an organization
    is data. Hackers saw the value in data and therefore created crypto-malware to
    hold this particular asset hostage. However, it is not recommended to pay the
    ransom at all, we know the data is very valuable and may contain important financial
    records and sensitive information. Once a victim provides their credit card information,
    there is absolutely no guarantee the attacker will provide the decryption key;
    instead, they may steal the funds from the victim's credit card.
  prefs: []
  type: TYPE_NORMAL
- en: Many threat intelligence and prevention companies, such as Check Point Software
    Technologies ([https://www.checkpoint.com/](https://www.checkpoint.com/)), Kaspersky
    Lab ([https://www.kaspersky.co.in/](https://www.kaspersky.co.in/)) and Bitdefender
    ([https://www.bitdefender.com/](https://www.bitdefender.com/)), have developed
    anti-ransomware protection to help prevent and decrypt an infected system.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following is a screenshot of the ZoneAlarm Anti-Ransomware client:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/7ceca56a-e7f5-4bf7-b6f3-2b7106a6c11a.png)'
  prefs: []
  type: TYPE_IMG
- en: Once anti-ransomware protection is installed on a system, it automatically updates
    once an internet connection is detected. Should a ransomware attempt to install
    itself on the local system, the anti-ransomware protection will disinfect the
    system and decrypt any files affected by the ransomware.
  prefs: []
  type: TYPE_NORMAL
- en: 'Countermeasures for protecting against ransomware include the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Install anti-ransomware protection on client systems.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Back up data regularly.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Install the latest updates on your operating systems.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Keep antivirus applications up to date.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Other common viruses
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Here are some other common viruses:'
  prefs: []
  type: TYPE_NORMAL
- en: '**Trojans**:A Trojan horse virus disguises itself to look like a legitimate
    software or application but has a malicious payload within its core. The idea
    is to trick a victim into running the application on their system; once the Trojan
    is executed, the malicious payload unloads itself in the background without the
    user''s knowledge. Some Trojans are used to create *backdoors* for hackers to
    gain unauthorized entry into victim''s system, these are known as **Remote Access
    Trojans** (**RATs**).'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Spyware**:Spyware is a type of virus that installs itself on a victim''s
    system, gathers information about the user, such as their activities, and sends
    the information back to its creator. An example of spyware is a keylogger that
    remains hidden on a victim''s system and gathers a user''s keystrokes.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '**Rootk****its**: The Rootkit virus''s main objective is to become part of
    a kernel of a computer. Rootkits are usually invisible to the operating system
    and antivirus application. Its purpose is to obtain root-level privileges on the
    victim computer, this will give the malware full access rights on the system,
    allowing it to do anything.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Malware is usually distributed via the following mediums:'
  prefs: []
  type: TYPE_NORMAL
- en: Email
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Network file sharing
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Internet or drive-by downloads
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Social engineering
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Here are some countermeasures and mitigation for malware:'
  prefs: []
  type: TYPE_NORMAL
- en: Install anti-malware protection on all systems.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ensure anti-malware applications are always up to date.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Periodically run virus scans on all systems.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Install the latest updates on your operating system.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Enable spam filtering on your email server.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Do not click on any suspicious email messages or web URLs.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Client system security
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this section, we are going to focus on securing operating systems. In an
    organization, the IT department usually has a baseline for each unique system.
    A security baseline dictates how an operating system should be installed and configured
    to ensure security requirements are met.
  prefs: []
  type: TYPE_NORMAL
- en: 'A security baseline for an operating system usually consists of the following:'
  prefs: []
  type: TYPE_NORMAL
- en: Disable any unnecessary services on the operating system.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Install system updates and patches regularly.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Enforce a password complexity policy.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Disable or remove any unnecessary user accounts.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ensure endpoint protection, such as an antivirus, is installed and updated.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Enable system logging for accountability.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The Windows baseline
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Creating a baseline for Microsoft Windows is actually pretty simple. The following
    objectives can be used as a checklist for establishing a baseline:'
  prefs: []
  type: TYPE_NORMAL
- en: The operating system installation should be done on a single partition on the
    disk drive using the NTFS filesystem.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Install the latest patches and enable Windows Automatic Updates to ensure all
    vulnerabilities are patched accordingly.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Enable and Configure Windows Firewall.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Install and update the antivirus protection.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Disable any unnecessary services.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A baseline is a point from which future references can be made as a measurement
    to determine whether a process or system is operating within normal capacity.
  prefs: []
  type: TYPE_NORMAL
- en: The **Microsoft Baseline Security Analyzer** (**MBSA**) allows systems administrators
    and security professionals to scan either a local system or a network of Windows-based
    systems for any security misconfigurations.
  prefs: []
  type: TYPE_NORMAL
- en: The MBSA can be found at [https://www.microsoft.com/en-us/download/details.aspx?id=19892](https://www.microsoft.com/en-us/download/details.aspx?id=19892).
  prefs: []
  type: TYPE_NORMAL
- en: 'Take the following steps to create a baseline:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Once Microsoft Baseline is installed, open the application. You''ll be presented
    with the following window:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![image](img/f3406b42-78f6-4bea-addd-ad06c757a5e4.png)'
  prefs: []
  type: TYPE_IMG
- en: Click on Scan a computer. You'll have the option to either use a hostname or
    the IP address of a computer as the target to scan. In this exercise, we'll use
    the default hostname in the Computer name field.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Click on Start Scan, as shown in the following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![image](img/813e826d-dc97-48f1-8c38-ee73235777bf.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The results will automatically be populated in a new window, as shown in the
    following screenshot:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '![image](img/ac62be8d-1163-4be4-8d02-e57687c556e3.png)'
  prefs: []
  type: TYPE_IMG
- en: The results will indicate various security issues and misconfigurations that
    will require the attention of the system administrator. Each issue that's detected
    is given a severity rating to identify the most critical security issue on the
    system easily.
  prefs: []
  type: TYPE_NORMAL
- en: The Windows registry
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The Windows registries store all the system''s configurations and records –
    all the actions from the time a system has booted until it is turned off. The
    registry, better known as **hives**, maintains its records with the use of registry
    keys. A hive is a logical group of keys, subkeys, and values in the registry that
    has a set of supporting files containing backups of its data. The registry is
    a hierarchical database that contains data critical to the operation of Windows
    and the applications and services that run on Windows. There''s a unique key for
    each action, configuration, task, and so on. Monitoring any abnormal changes or
    activities can help to detect a security compromise. One tool to monitor and audit
    the Windows registry is **Process Monitor**:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/9a57e444-2edb-48f7-bc4b-3304f23bff66.png)'
  prefs: []
  type: TYPE_IMG
- en: Process Monitor is part of the **Sysinternals** suite of utilities from Microsoft.
    To download Process Monitor, visit [https://docs.microsoft.com/en-us/sysinternals/downloads/procmon](https://docs.microsoft.com/en-us/sysinternals/downloads/procmon).
  prefs: []
  type: TYPE_NORMAL
- en: User accounts
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Each user on a system should have their own user account, but sometimes a user
    is no longer with an organization or has moved to another department or location
    and their user account remains enabled on a particular system. Disabling unnecessary
    user accounts on a system is good security practice.
  prefs: []
  type: TYPE_NORMAL
- en: To disable user accounts on Windows, open the Control Panel | User Accounts
    | Manage Accounts.
  prefs: []
  type: TYPE_NORMAL
- en: Disable or remove the guest account on Microsoft Windows. This prevents a user
    from accessing your computer using the guest user account.
  prefs: []
  type: TYPE_NORMAL
- en: Patch management
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The patch management process consists of the following objectives:'
  prefs: []
  type: TYPE_NORMAL
- en: Use tools to detect updates and patches automatically.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Conduct an assessment of the vulnerabilities found to determine their severity
    level and the patches required to remediate the issue.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Acquire the patches required to resolve the security issues.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Test the patches on a nonproduction machine to determine whether the security
    issues are resolved.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Deploy the tested patches to systems within the organization.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Maintain all systems.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Microsoft Windows provides an option to download and install updates, patches,
    and service packs automatically. To adjust the options of Windows Update, navigate
    to Control Panel | Windows Update | Change settings:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/807d5c6e-98f7-49c5-b97a-9c3ce1645d06.png)'
  prefs: []
  type: TYPE_IMG
- en: Windows Firewall
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The Microsoft Windows operating system has a built-in firewall that prevents
    malicious traffic from entering and leaving the local system. To ensure Windows
    Firewall is enabled, navigate to Control Panel | Windows Firewall, as shown in
    the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/2c76a7c0-b039-4f78-9efe-d1ef853fade2.png)'
  prefs: []
  type: TYPE_IMG
- en: 'To adjust the configuration, such as create, modify, or delete rules on the
    firewall, click on Advanced settings, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/4399a95e-164a-470e-af6b-552e59f00143.png)'
  prefs: []
  type: TYPE_IMG
- en: Disabling services
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Having unused services active on an operating system can be a potential security
    risk as an attacker can attempt to compromise a system by leveraging a vulnerability
    in a running service. It is important to disable any unnecessary services on an
    operating system.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following is a noncomprehensive list of services that should be disabled
    if not being used:'
  prefs: []
  type: TYPE_NORMAL
- en: File Transfer Protocol (FTP)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Telnet
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Universal Plug and Play (UPnP)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: SQL Server
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Internet Information Services (IIS)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'To disable a service on Microsoft Windows, open Control Panel | Administrative
    Tools | Services:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/8cd545c4-ae02-48ec-a75e-1ccd0361f12d.png)'
  prefs: []
  type: TYPE_IMG
- en: 'You''ll be able to start, stop, and restart any of the available services.
    To make a modification, simply double-click on a service:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/513faeed-4b19-4493-b793-20250febb50f.png)'
  prefs: []
  type: TYPE_IMG
- en: The Linux baseline
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'As we learned in the previous section, a security baseline typically involves
    creating images that allow for the secure, easy deployment of machines. The following
    is a guide to creating a security baseline for Linux operating systems:'
  prefs: []
  type: TYPE_NORMAL
- en: Ensure the Linux operating system is always up to date with the latest security
    patches. This action can be done using the `yum update` or `apt-get update &&
    apt-get upgrade` commands.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ensure a strong password policy is enforced.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Disable any unused services.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Enable disk encryption.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Enable logging and auditing.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Configure firewall policies.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Disable USB devices.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Secure web services.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Create backup and retention policies.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Avoid using unsecured services, such as HTTP, Telnet, and FTP.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Both the Linux and Windows security policies are used interchangeably on both
    operating systems.
  prefs: []
  type: TYPE_NORMAL
- en: Security scanner for Linux
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**Buck-security** ([http://www.buck-security.net/buck-security.html](http://www.buck-security.net/buck-security.html))
    is a security scanner designed for Ubuntu- and Debian-based Linux operating systems.'
  prefs: []
  type: TYPE_NORMAL
- en: 'To install buck-security, you''ll need to download the files from its official
    GitHub repository. Use the `git clone https://github.com/davewood/buck-security` command
    to execute this function, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/ab4ec73f-ff9f-427a-9cc4-ccc170037a0a.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Next, change directory into the `buck-security` folder using the `cd buck-security` command.
    Once you''re in the `buck-security` directory, you can  execute the tool to perform
    a security audit on your local system. To execute the utility, use the `./buck-security`
    command as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/e85a3718-d844-4615-a6f0-1f551ec7cad4.jpg)'
  prefs: []
  type: TYPE_IMG
- en: '**Lynis** is another security auditing and compliance tool designed for both
    Linux and macOS operating systems. It has the capabilities of performing both
    security audits and a nonprivilege scan on both local or remote systems. According
    to the developers, Lynis is typically used for security auditing, compliance testing,
    penetration testing, vulnerabilities assessments, and system hardening.'
  prefs: []
  type: TYPE_NORMAL
- en: Further information on Lynis can be found on their official website: [https://cisofy.com/lynis](https://cisofy.com/lynis).
  prefs: []
  type: TYPE_NORMAL
- en: To get started with Lynis, you'll need to download the project files from the
    official GitHub repository using `git clone https://github.com/CISOfy/lynis`.
  prefs: []
  type: TYPE_NORMAL
- en: Next, change directory into the `lynis` folder using `cd lynis`.
  prefs: []
  type: TYPE_NORMAL
- en: To perform a local security scan, we can simply use the `./lynis audit system` or
    `lynis audit system` command.
  prefs: []
  type: TYPE_NORMAL
- en: To perform a remote security scan, use the `lynis system remote <ip address
    of remote host>` command.
  prefs: []
  type: TYPE_NORMAL
- en: 'To perform a non-privilege scan, which is useful for penetration testing, use
    the `lynis --pentest` command:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/40eb922c-2797-44cf-af86-8a2cee8e8fbc.jpg)'
  prefs: []
  type: TYPE_IMG
- en: Disabling services in Linux
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To determine the running services on a Linux-based system, the `ps ax` command
    will display a list of services that are currently running with their PID, as
    shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/25ffd561-ab13-4183-baff-45b6edf554b0.png)'
  prefs: []
  type: TYPE_IMG
- en: As we can see, the PIDs are listed for their corresponding service. You may
    be tasked to stop or kill a service; to terminate it immediately on the local
    system, use the `kill -9 <PID>` command.
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s say you would like to see any running service/process that has the `firefox` string –
    use the `ps –A |grep firefox` command:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/4176c3e4-fd53-4600-a7d9-5c97c85ad196.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The output shows the `firefox-esr` service is currently running on the local
    system, which uses the `2340` PID. We can use the PID and the `kill` command to
    terminate this service, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/f019b51d-0843-44da-acec-a05497c7823a.jpg)'
  prefs: []
  type: TYPE_IMG
- en: 'Another utility that can assist in determining the running services in Linux
    is the `netstat` command. Using the `netstat –lp` command will display the network
    protocols that are currently in a listening state and the corresponding program:'
  prefs: []
  type: TYPE_NORMAL
- en: '![image](img/8994be9a-b88a-4475-a0c6-2c0f9b630d95.png)'
  prefs: []
  type: TYPE_IMG
- en: Using the `update-rc.d –f <server-name> remove | stop` command will disable
    an unwanted service in Linux.
  prefs: []
  type: TYPE_NORMAL
- en: Hardening networking devices
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'To minimize the attack surface of a router, use the following checklist:'
  prefs: []
  type: TYPE_NORMAL
- en: Change all default passwords.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Create strong passwords.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Disable the HTTP server and its configurations.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Disable ping response, such as ICMP Echo Replies.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Apply **access control lists** (**ACLs**) for traffic filtering.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Disable unsecured services, such as Telnet.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Update the firmware and operating system to the latest stable version.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Disable unnecessary services.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'The following checklist can be used as a foundation for hardening a switch:'
  prefs: []
  type: TYPE_NORMAL
- en: Apply port security.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Enforce password policies for a strong password and complexity.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Use SSH rather than Telnet.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Disable **Dynamic Trunking Protocol** (**DTP**). DTP enables links to become
    trunks automatically.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Do not use VLAN 1.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Enable spanning-tree root guard and BPDU guard.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Enable DHCP snooping.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Hardening mobile devices
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Sometimes, when discussing the topic of smartphones, we hear an Android user
    mention that they have *rooted* their device. What is rooting? Within the Android
    ecosystem, *rooting* is refers to the  root-level access on the mobile device.
    Like Linux, the root user account is considered to be a user with super/full privileges
    on the system; since Android is Linux-based, gaining full administration privileges
    is called **rooting**.
  prefs: []
  type: TYPE_NORMAL
- en: Having a device with full access rights is awesome, which means you can install
    and modify the applications and system resources to fit your needs. However, rooting
    comes with many security risks for Android users. First, the device's warranty
    becomes null or void if it's rooted and it has a higher possibility of being infected
    with malware. During the process of rooting, a device may cause it to become unusable,
    or what Android users refer to as *brick* (unusable). While a user is able to
    install and make system modifications on a rooted device, this prevents the Android
    device from receiving and/or installing **over-the-air** (**OTA**) updates from
    the manufacturer.
  prefs: []
  type: TYPE_NORMAL
- en: System updates are very important for any device, whether it's a desktop, server,
    router, switch, firewall, or a mobile device, such as a smart device. System updates
    are created and rolled out for the purpose of fixing bugs and security issues.
    Therefore, a rooted device is more susceptible to being compromised.
  prefs: []
  type: TYPE_NORMAL
- en: Similar to rooting an Android device to gain full/super-user privileges, the
    corresponding term is *jailbreaking* for Apple devices. Jailbreaking provides
    the mobile user with root-level privileges and allows you to download apps from
    sources outside of Apple's App Store.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following is a guide to developing a security checklist/baseline for both
    Android and iOS devices:'
  prefs: []
  type: TYPE_NORMAL
- en: Ensure the operating system is kept up to date.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Do not root the Android device.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Only download and install mobile apps from official App store, such as the Google
    Play Store and Apple's App Store.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Download and install an antivirus application from a trusted security vendor.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ensure lock screens are enabled.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ensure the password lock is enabled on your iPhone/iPad or Android device.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Ensure you change default passwords.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Disable add-ons and JavaScript in the web browser.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we looked at common security threats and possible countermeasures
    and mitigation techniques. We discussed the need for a security baseline for systems
    within an organization, and looked at a few tools to assist us in measuring the
    security risk on both the Windows and Linux operating systems. Then, we discussed
    the various hardening techniques for networking appliances, such as routers and
    switches, and we closed by learning about hardening mobile devices.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will explore building an environment for a lab.
  prefs: []
  type: TYPE_NORMAL
