- en: Enumeration and Vulnerability Assessment
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This chapter is about exploring various tools and techniques for enumerating
    the targets in scope and performing a vulnerability assessment on them.
  prefs: []
  type: TYPE_NORMAL
- en: The reader will learn how to enumerate target systems using various tools and
    techniques discussed in this chapter and will learn how to assess vulnerabilities
    using specialized tools such as OpenVAS.
  prefs: []
  type: TYPE_NORMAL
- en: 'We will cover the following topics in this chapter:'
  prefs: []
  type: TYPE_NORMAL
- en: What is enumeration
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Enumerating services
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Using Nmap scripts
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Vulnerability assessments using OpenVAS
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: What is enumeration?
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: We have already seen the importance of information gathering in the previous
    chapter. Enumeration is the next logical step once we have some basic information
    about our target. For example, let's assume country A needs to launch an attack
    on country B. Now, country A does some reconnaissance and gets to know that country
    B has 25 missiles capable of hitting back. Now, country A needs to find out exactly
    what type, make, and model the missiles of country B are. This enumeration will
    help country A develop the attack plan more precisely.
  prefs: []
  type: TYPE_NORMAL
- en: Similarly, in our case, let's assume we have come to know that our target system
    is running some web application on port `80`. Now we need to further enumerate
    what type of web server it is, what technology is used by the application, and
    any other relevant details. This will really help us in selecting accurate exploits
    and in attacking the target.
  prefs: []
  type: TYPE_NORMAL
- en: Enumerating services
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Before we get started with enumerating services on our target, we''ll do a
    quick port-scan on our target system. This time, we will be using a tool called
    **Unicornscan**, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/11715f84-e61d-48dd-86f6-dfca1b5ceb2c.png)'
  prefs: []
  type: TYPE_IMG
- en: 'The port-scan returns a list of open ports on our target system, as shown in
    the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/b4bd5d15-f974-4f0a-aa4f-4b60ff7208af.png)'
  prefs: []
  type: TYPE_IMG
- en: Now that we have a list of open ports on our target system, the next task is
    to associate services corresponding to these open ports and further enumerate
    their versions. Enumerating services is extremely critical as it builds a solid
    foundation for further attacks. In this section, we will be discussing techniques
    for enumerating various services, mostly using Nmap.
  prefs: []
  type: TYPE_NORMAL
- en: HTTP
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The **Hypertext Transfer Protocol** (**HTTP**) is the most common protocol used
    for serving web content. By default, it runs on port `80`. Enumerating HTTP can
    reveal a lot of interesting information, including the applications it is serving.
  prefs: []
  type: TYPE_NORMAL
- en: 'Nikto is a specialized tool for enumerating the HTTP service and is part of
    the default Kali Linux installation. The following screenshot shows various available
    options in the Nikto tool:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/a73507db-7fa9-4b89-b9ca-d37464abe714.png)'
  prefs: []
  type: TYPE_IMG
- en: 'We can enumerate an HTTP target using the `nikto -host <target IP address>` command,
    as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/270978a8-4812-41fe-9d4f-145c408a3dc5.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Nmap can also be effectively used for enumerating HTTP. The following screenshot
    shows HTTP enumeration performed using Nmap script. The syntax is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '![](img/e43f8871-efe8-4df3-8e18-fa3f2f176f86.png)'
  prefs: []
  type: TYPE_IMG
- en: The output of the `http-enum` Nmap script shows server information along with
    various interesting directories that can be further explored.
  prefs: []
  type: TYPE_NORMAL
- en: FTP
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The **File Transfer Protocol** (**FTP**) is a commonly used protocol for transferring
    files across systems. The FTP service runs by default on port `21`. Enumerating
    FTP can reveal interesting information such as the server version and if it allows
    for anonymous logins. We can use Nmap to enumerate FTP service using syntax, as
    follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'The following screenshot shows the output of FTP enumeration using Nmap. It
    reveals that the FTP server is vsftpd 2.3.4, and it allows for anonymous logins:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/ce123056-c328-4471-b55a-e6746f6fc040.png)'
  prefs: []
  type: TYPE_IMG
- en: SMTP
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The **Simple Mail Transfer Protocol** (**SMTP**) is the service responsible
    for transmission of electronic mail. The service by default runs on port `25`.
    It is useful to enumerate the SMTP service in order to know the server version
    along with the command it accepts. We can use the Nmap syntax, as follows, to
    enumerate the SMTP service:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'The following screenshot shows the output of the enumeration command we fired.
    It tells us that the SMTP server is of type Postfix and also gives us the list
    of commands it is accepting:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/2b09fbb2-d6f6-403d-affb-4ba1edebefc6.png)'
  prefs: []
  type: TYPE_IMG
- en: SMB
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**Server Message Block** (**SMB**) is a very commonly used service for sharing
    files, printers, serial ports, and so on. Historically, it has been vulnerable
    to various attacks. Hence, enumerating SMB can provide useful information for
    planning further precise attacks. In order to enumerate SMB, we would use the
    following syntax and scan ports `139` and `445`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'The following screenshot shows the output of our SMB enumeration scan. It tells
    us the version of SMB in use and the workgroup details:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/6a1acfcc-eaaa-45f9-ae2c-0eab66db304a.png)'
  prefs: []
  type: TYPE_IMG
- en: DNS
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The **Domain Name System** (**DNS**) is the most widely used service for translating
    domain names into IP addresses and vice versa. The DNS service by default runs
    on port `53`. We can use the Nmap syntax, as follows, to enumerate the DNS service:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'The following screenshot shows that the type of DNS server on the target system
    is ISC bind version 9.4.2:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/51bb6af3-99bb-4ad5-9fbd-7553f54d7d7d.png)'
  prefs: []
  type: TYPE_IMG
- en: SSH
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**Secure Shell** (**SSH**) is a protocol used for transmitting data securely
    between two systems. It is an effective and secure alternative to Telnet. The
    SSH service by default runs on port `22`. We can use the Nmap syntax, as follows,
    to enumerate the SSH service:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'The following screenshot shows the output of the SSH enumeration command we
    executed. It tells us that the target is running OpenSSH 4.7p1:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/71467a9c-eaec-4f82-aac4-ec5c49515034.png)'
  prefs: []
  type: TYPE_IMG
- en: VNC
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '**Virtual Network Computing** (**VNC**) is a protocol used mainly for remote
    access and administration. The VNC service by default runs on port `5900`. We
    can use the Nmap syntax, as follows, to enumerate VNC service:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 'The following screenshot shows the output of the VNC enumeration command we
    executed. It tells us that the target is running VNC with protocol version 3.3:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/38569288-0ad9-4a6c-b3f6-f7e583be409c.png)'
  prefs: []
  type: TYPE_IMG
- en: Using Nmap scripts
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Nmap is much more than a normal port scanner. It is extremely versatile in terms
    of the functionalities it offers. Nmap scripts are like add-ons, which can be
    used for performing additional tasks. There are literally hundreds of such scripts
    available. In this section, we will be looking at a few of the Nmap scripts.
  prefs: []
  type: TYPE_NORMAL
- en: http-methods
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The `http-methods` script will help us enumerate various methods that are allowed
    on the target web server. The syntax for using this script is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'The following screenshot shows the output of the Nmap script we executed. It
    tells us that the target web server is allowing the GET, HEAD, POST, and OPTIONS
    methods:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/7558ad10-6dbf-4dcf-b857-ca64fbe482e9.png)'
  prefs: []
  type: TYPE_IMG
- en: smb-os-discovery
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The `smb-os-discovery` script will help us enumerate the OS version based on
    the SMB protocol. The syntax for using this script is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: 'The following screenshot shows the enumeration output telling us that the target
    system is running a Debian-based OS:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/adbaef84-5346-4ef3-8c35-ecbd0b04a9a6.png)'
  prefs: []
  type: TYPE_IMG
- en: http-sitemap-generator
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The `http-sitemap-generator` script will help us create a hierarchical sitemap
    of the application hosted on the target web server. The syntax for using this
    script is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: 'The following screenshot shows a site map generated for the application hosted
    on a target web server:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/8ef60b9c-5f25-4f4b-9403-82d277d09f6f.png)'
  prefs: []
  type: TYPE_IMG
- en: mysql-info
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'The `mysql-info` script will help us enumerate the MySQL server and possibly
    gather information such as the server version, protocol, and salt. The syntax
    for using this script is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: 'The following screenshot shows the output of the Nmap script we executed. It
    tells us that the target MySQL server version is `5.0.51a-3ubuntu5` and also the
    value for salt:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/d9c98ad8-d2d3-48f8-a626-f2118ff52415.png)'
  prefs: []
  type: TYPE_IMG
- en: Vulnerability assessments using OpenVAS
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Now that we have got familiar with enumeration, the next logical step is performing
    vulnerability assessments. This includes probing each service for possible open
    vulnerabilities. There are many tools, both commercial as well as open source,
    available for performing vulnerability assessments. Some of the most popular tools
    are Nessus, Nexpose, and OpenVAS.
  prefs: []
  type: TYPE_NORMAL
- en: OpenVAS is a framework consisting of several tools and services that provide
    an effective and powerful vulnerability management solution. More detailed information
    on the OpenVAS framework is available at [http://www.openvas.org/](http://www.openvas.org/).
  prefs: []
  type: TYPE_NORMAL
- en: 'The latest Kali Linux distribution doesn''t come with OpenVAS by default. Hence,
    you need to manually install and set up the OpenVAS framework. Following is the
    set of commands that you can use to set up the OpenVAS framework on Kali Linux
    or any Debian-based Linux distribution:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: 'After running the preceding commands in the Terminal, the OpenVAS framework
    should be installed and ready for use. You can access it through the browser at
    the `https://localhost:9392/login/login.html` URL, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/ecc606f5-6a9b-4191-a722-74f84301ca3c.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Once you enter the credentials, you can see the initial Dashboard as shown
    in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/50e488c1-28c0-4dac-a9c9-e60c803eb5ca.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Now it''s time to get started with the first vulnerability scan. In order to
    initiate a vulnerability scan, open the Task Wizard, as shown in the following
    screenshot, and enter the IP address of the target to be scanned:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/7939d8d6-984e-4ad6-a2a6-fb9b9426dd77.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Once the target IP address is entered in the Task Wizard, the scan gets triggered
    and progress can be tracked as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/e9000655-5aaf-4ac3-aaac-eccdc7cb97c4.png)'
  prefs: []
  type: TYPE_IMG
- en: 'While the scan is in progress, you can view the Dashboard to get a summary
    of vulnerabilities found during the scan as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/86b205e0-95ef-4be9-8508-a86a940b5388.png)'
  prefs: []
  type: TYPE_IMG
- en: 'Once the scan is complete, you can check the result to see all the detailed
    findings along with severity levels. You can individually click on each vulnerability
    to find out more details, as shown in the following screenshot:'
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/ecf61831-bd12-4000-8ac0-539b9f412947.png)'
  prefs: []
  type: TYPE_IMG
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we learned the importance of enumeration along with various
    tools and techniques for performing effective enumeration on our target systems.
    We also looked at an overview of the OpenVAS vulnerability management framework,
    which can be used for performing targeted vulnerability assessments.
  prefs: []
  type: TYPE_NORMAL
