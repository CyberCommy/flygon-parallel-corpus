- en: MySQL 8 - Installing and Upgrading
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this chapter, we will cover the following recipes:'
  prefs: []
  type: TYPE_NORMAL
- en: Installing MySQL using YUM/APT
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Installing MySQL 8.0 using RPM or DEB files
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Installing MySQL on Linux using Generic Binaries
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Starting or Stopping MySQL 8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Uninstalling MySQL 8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Managing MySQL Server with systemd
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Downgrading from MySQL 8.0
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Upgrading to MySQL 8.0
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Installing MySQL utilities
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Introduction
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this chapter, you will learn about the installing, upgrading, and downgrading
    steps of MySQL 8\. There are five different ways to install or upgrade; the three
    most widely-used installation methods are covered in this chapter:'
  prefs: []
  type: TYPE_NORMAL
- en: Software repositories (YUM or APT)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: RPM or DEB files
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Generic Binaries
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Docker (not covered)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Source code compilation (not covered)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: If you have already installed MySQL and want to upgrade, go through the upgrade
    steps in the *Upgrade to MySQL 8* section. If your installation is corrupt, go
    through the uninstallation steps also in the *Upgrade to MySQL 8* section.
  prefs: []
  type: TYPE_NORMAL
- en: 'Before installation, make a note of OS and CPU architecture. The convention
    followed is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '**MySQL Linux RPM package distribution identifiers**'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Distribution value** | **Intended use** |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| el6, el7 | Red Hat Enterprise Linux, Oracle Linux, CentOS 6 or 7 |'
  prefs: []
  type: TYPE_TB
- en: '| fc23, fc24, fc25 | Fedora 23, 24, or 25 |'
  prefs: []
  type: TYPE_TB
- en: '| sles12 | SUSE Linux Enterprise Server 12 |'
  prefs: []
  type: TYPE_TB
- en: '**MySQL Linux RPM package CPU identifiers**'
  prefs: []
  type: TYPE_NORMAL
- en: '| **CPU value** | **Intended processor type or family** |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| i386, i586, i686 | Pentium processor or better, 32-bit |'
  prefs: []
  type: TYPE_TB
- en: '| x86_64 | 64-bit x86 processor |'
  prefs: []
  type: TYPE_TB
- en: '| ia64 | Itanium (IA-64) processor |'
  prefs: []
  type: TYPE_TB
- en: '**MySQL Debian and Ubuntu 7 and 8 installation packages CPU identifiers**'
  prefs: []
  type: TYPE_NORMAL
- en: '| **CPU value** | **Intended processor type or family** |'
  prefs: []
  type: TYPE_TB
- en: '| i386 | Pentium processor or better, 32-bit |'
  prefs: []
  type: TYPE_TB
- en: '| amd64 | 64-bit x86 processor |'
  prefs: []
  type: TYPE_TB
- en: '**MySQL Debian 6 Installation package CPU identifiers**'
  prefs: []
  type: TYPE_NORMAL
- en: '| **CPU value** | **Intended processor type or family** |'
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  prefs: []
  type: TYPE_TB
- en: '| i686 | Pentium processor or better, 32-bit |'
  prefs: []
  type: TYPE_TB
- en: '| x86_64 | 64-bit x86 processor |'
  prefs: []
  type: TYPE_TB
- en: Installing MySQL using YUM/APT
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: The most common and easiest way of installation is through software repositories
    where you add official Oracle MySQL repositories to your list and install MySQL
    through package management software.
  prefs: []
  type: TYPE_NORMAL
- en: 'There are mainly two types of repository software:'
  prefs: []
  type: TYPE_NORMAL
- en: YUM (Centos, Red Hat, Fedora and Oracle Linux)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: APT (Debian, Ubuntu)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Let''s look at steps for installing MySQL 8 in the following ways:'
  prefs: []
  type: TYPE_NORMAL
- en: Using YUM repositories
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Find the Red Hat or CentOS version:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: Add the MySQL Yum repository to your system's repository list. This is a one-time
    operation that can be performed by installing an RPM provided by MySQL.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You can download the MySQL YUM Repository from [http://dev.mysql.com/downloads/repo/yum/](http://dev.mysql.com/downloads/repo/yum/)
    and choose the file depending on your OS.
  prefs: []
  type: TYPE_NORMAL
- en: 'Install the downloaded release package with the following command, replacing
    the name with the platform- and version-specific package name of the downloaded
    RPM package:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: 'Or you can copy the link location and install directly using RPM (you can skip
    the next step after installing):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: 'Verify the installation:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 'Set the release series. At the time of writing this book, MySQL 8 is not a **general
    availability** (**GA**) release. So MySQL 5.7 will be selected as the default
    release series. To install MySQL 8, you have to set the release series to 8:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: 'Disable `mysql57-community` and enable `mysql80-community`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'Verify that `mysql80-community` is enabled:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 'Install MySQL 8:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'You can check the installed packages using the following:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: Using APT repositories
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Add the MySQL APT repository to your system's repository list. This is a one-time
    operation that can be performed by installing a `.deb` file provided by MySQL
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: You can download the MySQL APT repository from [http://dev.mysql.com/downloads/repo/apt/](http://dev.mysql.com/downloads/repo/apt/).
  prefs: []
  type: TYPE_NORMAL
- en: 'Or you can copy the link location and use `wget` to download directly on to
    the server. You might need to install `wget` (`sudo apt-get install wget`):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: 'Install the downloaded release package with the following command, replacing 
    the name with platform- and version-specific package name of the downloaded APT
    package:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: During the installation of the package, you will be asked to choose the versions
    of the MySQL server and other components. Press *Enter* for selecting and the
    Up and Down keys for navigating.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Select MySQL Server and Cluster (Currently selected: mysql-5.7).'
  prefs: []
  type: TYPE_NORMAL
- en: Select mysql-8.0 preview (At the time of writing, MySQL 8.0 is not GA). You
    might get a warning such as MySQL 8.0-RC Note that MySQL 8.0 is currently an RC.
    It should only be installed to preview upcoming features of MySQL, and is not
    recommended for use in production environments. (**RC** is short for **release
    candidate**).
  prefs: []
  type: TYPE_NORMAL
- en: 'If you want to change the release version, execute the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: 'Update package information from the MySQL APT repository with the following
    command (this step is mandatory):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: 'Install MySQL. During installation, you''ll need to provide a password for
    the root user for your MySQL installation. Remember the password; if you forget
    it, you''ll have to reset the root password (refer to the *Resetting root password* section).
    This installs the package for the MySQL server, as well as the packages for the
    client and for the database common files:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: 'Verify packages. `ii` indicates that the package is installed:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: Installing MySQL 8.0 using RPM or DEB files
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Installing MySQL using repositories requires access to public internet. As a
    security measure, most of the production machines are not connected to the internet.
    In that case, you can download the RPM or DEB files on the system administration
    and copy them to the production machine.
  prefs: []
  type: TYPE_NORMAL
- en: 'There are mainly two types of installation files:'
  prefs: []
  type: TYPE_NORMAL
- en: RPM (CentOS, Red Hat, Fedora, and Oracle Linux)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: DEB (Debian, Ubuntu)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'There are multiple packages that you need to install. Here is a list and short
    description of each one:'
  prefs: []
  type: TYPE_NORMAL
- en: '`mysql-community-server`: Database server and related tools.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`mysql-community-client`: MySQL client applications and tools.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`mysql-community-common`: Common files for server and client libraries.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`mysql-community-devel`: Development header files and libraries for MySQL database
    client applications, such as the Perl MySQL module.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`mysql-community-libs`: The shared libraries (`libmysqlclient.so*`) that certain
    languages and applications need to dynamically load and use MySQL.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`mysql-community-libs-compat`: The shared libraries for older releases. Install
    this package if you have applications installed that are dynamically linked against
    older versions of MySQL but you want to upgrade to the current version without
    breaking the library dependencies.'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Let''s look at how to do it using the following types of bundles:'
  prefs: []
  type: TYPE_NORMAL
- en: Using the RPM bundle
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Download the MySQL RPM tar bundle from the MySQL Downloads page, [http://dev.mysql.com/downloads/mysql/](http://dev.mysql.com/downloads/mysql/),
    choosing your OS and CPU architecture. At the time of writing,  MySQL 8.0 is not
    GA. If it is still in the development series, select the Development Releases
    tab for getting MySQL 8.0 and the choose the OS and version:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: 'Untar the package:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: 'Install MySQL:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: 'RPM cannot solve the dependency issues and the installation process might run
    issues. If you are facing such issues, use the `yum` command listed here (you
    should have access to dependent packages):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: 'Verify the installation:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: Using the APT bundle
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Download the MySQL APT TAR from the MySQL Downloads page, [http://dev.mysql.com/downloads/mysql/](http://dev.mysql.com/downloads/mysql/):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE20]'
  prefs: []
  type: TYPE_PRE
- en: 'Untar the packages:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE21]'
  prefs: []
  type: TYPE_PRE
- en: 'Install the dependencies. You may need to install the `libaio1` package if
    it is not already installed:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE22]'
  prefs: []
  type: TYPE_PRE
- en: 'Upgrade `libstdc++6` to the latest:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE23]'
  prefs: []
  type: TYPE_PRE
- en: 'Upgrade `libmecab2` to the latest. If `universe` is not included, then add
    the following line to the end of the file (for example, `zesty`):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE24]'
  prefs: []
  type: TYPE_PRE
- en: 'Preconfigure the MySQL server package with the following command. It asks you
    to set the root password:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE25]'
  prefs: []
  type: TYPE_PRE
- en: 'Install the database common files package, the client package, the client metapackage,
    the server package, and the server metapackage (in that order); you can do that
    with a single command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE26]'
  prefs: []
  type: TYPE_PRE
- en: 'Install the shared libraries:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE27]'
  prefs: []
  type: TYPE_PRE
- en: 'Verify the installation:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE28]'
  prefs: []
  type: TYPE_PRE
- en: Installing MySQL on Linux using Generic Binaries
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Installing using the software packages requires some dependencies to be installed
    first and can conflict with other packages. In that case, you can install MySQL
    using the generic binaries available on the downloads page. Binaries are precompiled
    using advanced compilers and are built with the best possible options for optimal
    performance.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: MySQL has a dependency on the `libaio` library. The `data directory` initialization,
    and subsequent server startup steps, will fail if this library is not installed
    locally.
  prefs: []
  type: TYPE_NORMAL
- en: 'On YUM-based systems:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE29]'
  prefs: []
  type: TYPE_PRE
- en: 'On APT-based systems:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE30]'
  prefs: []
  type: TYPE_PRE
- en: 'Download the TAR binary from the MySQL Downloads page, at [https://dev.mysql.com/downloads/mysql/](https://dev.mysql.com/downloads/mysql/),
    then choose Linux - Generic as the OS and select the version. You can download
    directly onto your server directly using the `wget` command:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE31]'
  prefs: []
  type: TYPE_PRE
- en: 'Install MySQL using the following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Add the `mysql` group and the `mysql` user. All the files and directories should
    be under the `mysql` user:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE32]'
  prefs: []
  type: TYPE_PRE
- en: 'This is the installation location (you can change it to another location):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE33]'
  prefs: []
  type: TYPE_PRE
- en: 'Untar the binary file. Keep the untarred binary file at the same location and
    symlink it to the installation location. In this way, you can keep multiple versions
    and it is very easy to upgrade. For example, you can download another version
    and untar it to a different location; while upgrading, all you need to do is to
    change the symlink:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE34]'
  prefs: []
  type: TYPE_PRE
- en: '[PRE35]'
  prefs: []
  type: TYPE_PRE
- en: 'Make the symlink:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE36]'
  prefs: []
  type: TYPE_PRE
- en: 'Create the necessary directories and change the ownership to `mysql`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE37]'
  prefs: []
  type: TYPE_PRE
- en: 'Initialize `mysql`, which generates a temporary password:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE38]'
  prefs: []
  type: TYPE_PRE
- en: 'Set up the RSA for SSL. Refer to Chapter 14, *Setting up Encrypted Connections
    using X509 Section*, for more details on SSL. Note that a temporary password is
    generated for `root@localhost: eJQdj8C*qVMq`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE39]'
  prefs: []
  type: TYPE_PRE
- en: 'Change the ownership of binaries to `root` and `data` files to `mysql`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE40]'
  prefs: []
  type: TYPE_PRE
- en: 'Copy the startup script to `init.d`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE41]'
  prefs: []
  type: TYPE_PRE
- en: 'Export the binary of `mysql` to the `PATH` environment variable:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE42]'
  prefs: []
  type: TYPE_PRE
- en: Refer to *Starting or Stopping MySQL 8* section to start MySQL.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'After installation, you will get the following directories inside `/usr/local/mysql`:'
  prefs: []
  type: TYPE_NORMAL
- en: '| **Directory** | **Contents of directory** |'
  prefs: []
  type: TYPE_TB
- en: '| `bin` | `mysqld` server, client, and utility programs |'
  prefs: []
  type: TYPE_TB
- en: '| `data` | Log files, databases |'
  prefs: []
  type: TYPE_TB
- en: '| `docs` | MySQL manual in info format |'
  prefs: []
  type: TYPE_TB
- en: '| `man` | Unix manual pages |'
  prefs: []
  type: TYPE_TB
- en: '| `include` | Include (header) files |'
  prefs: []
  type: TYPE_TB
- en: '| `lib` | Libraries |'
  prefs: []
  type: TYPE_TB
- en: '| `share` | Miscellaneous support files, including error messages, sample configuration
    files, SQL for database installation |'
  prefs: []
  type: TYPE_TB
- en: There's more...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'There are other installation methods, such as:'
  prefs: []
  type: TYPE_NORMAL
- en: Compiling from the source code. You can compile and build MySQL from the source
    code provided by Oracle where you have the flexibility to customize build parameters,
    compiler optimizations, and the installation location. It is highly recommended
    to use precompiled binaries provided by Oracle, unless you want specific compiler
    options or you are debugging MySQL.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: This method is not covered as it is used very rarely and it requires several
    development tools, which is beyond the scope of this book. For installation through
    source code, you can refer to the reference manual, at [https://dev.mysql.com/doc/refman/8.0/en/source-installation.html](https://dev.mysql.com/doc/refman/8.0/en/source-installation.html).
  prefs: []
  type: TYPE_NORMAL
- en: Using Docker. The MySQL server can also be installed and managed using Docker
    image. Refer to [https://hub.docker.com/r/mysql/mysql-server/](https://hub.docker.com/r/mysql/mysql-server/)
    for installation, configuration, and also how to use MySQL under Docker.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Starting or Stopping MySQL 8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: After the installation is completed, you can start/stop MySQL using the following
    commands, which vary from different platforms and installation methods. `mysqld`
    is the `mysql` server process. All the startup methods invoke the `mysqld` script.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Let's look at it in detail. Along with the starting and stopping, we will also
    learn something about checking the status of the server. Let's see how.
  prefs: []
  type: TYPE_NORMAL
- en: Starting the MySQL 8.0 server
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'You can start the server with the following commands:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Using `service`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE43]'
  prefs: []
  type: TYPE_PRE
- en: 'Using `init.d`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE44]'
  prefs: []
  type: TYPE_PRE
- en: If you do not find the startup script (when you are doing binary installation),
    you can copy from the location where you untarred.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE45]'
  prefs: []
  type: TYPE_PRE
- en: 'If your installation includes `systemd` support:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE46]'
  prefs: []
  type: TYPE_PRE
- en: 'If the `systemd` support is not there, MySQL can be started using `mysqld_safe`.
    `mysqld_safe` is the launcher script for `mysqld` that safeguards the `mysqld`
    process. If `mysqld` is killed, `mysqld_safe` attempts to start the process again:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE47]'
  prefs: []
  type: TYPE_PRE
- en: After start,
  prefs: []
  type: TYPE_NORMAL
- en: The server is initialized.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The SSL certificate and key files are generated in the `data directory`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The `validate_password` plugin is installed and enabled.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'A superuser account, `root''@''localhost`, is created. A password for the superuser
    is set and stored in the error log file (not for binary installation). To reveal
    it, use the following command:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE48]'
  prefs: []
  type: TYPE_PRE
- en: You can connect to MySQL using that temporary password.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE49]'
  prefs: []
  type: TYPE_PRE
- en: 'Change the root password as soon as possible by logging in with the generated
    temporary password and setting a custom password for the superuser account:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE50]'
  prefs: []
  type: TYPE_PRE
- en: Stopping the MySQL 8.0 server
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Stopping MySQL and checking the status are similar to starting it, except for
    the change of one word:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Using `service`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE51]'
  prefs: []
  type: TYPE_PRE
- en: 'Using `init.d`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE52]'
  prefs: []
  type: TYPE_PRE
- en: 'If your installation includes the `systemd` support (refer to the *Managing
    MySQL Server* *with systemd* section):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE53]'
  prefs: []
  type: TYPE_PRE
- en: 'Using `mysqladmin`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE54]'
  prefs: []
  type: TYPE_PRE
- en: Checking the status of the MySQL 8.0 server
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Using `service`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE55]'
  prefs: []
  type: TYPE_PRE
- en: 'Using `init.d`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE56]'
  prefs: []
  type: TYPE_PRE
- en: 'If your installation includes the `systemd` support (refer to the *Managing
    MySQL Server with systemd* section):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE57]'
  prefs: []
  type: TYPE_PRE
- en: Uninstalling MySQL 8
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: If you have messed up with installation or you do not want MySQL 8 version,
    you can uninstall using the following steps. Before uninstalling, make sure to
    make backup files (refer to Chapter 7, *Backups*), if required, and stop MySQL.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Uninstalling will be dealt in a different way on different systems. Let's look
    at how.
  prefs: []
  type: TYPE_NORMAL
- en: On YUM-based systems
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Check whether there are any existing packages:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE58]'
  prefs: []
  type: TYPE_PRE
- en: 'Remove the packages. You may be notified that there are other packages dependent
    on MySQL. If you plan on installing MySQL again, you can ignore the warning by
    passing the `--nodeps` option:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE59]'
  prefs: []
  type: TYPE_PRE
- en: 'For example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE60]'
  prefs: []
  type: TYPE_PRE
- en: 'To remove all packages:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE61]'
  prefs: []
  type: TYPE_PRE
- en: On APT-based systems
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Check whether there are any existing packages:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE62]'
  prefs: []
  type: TYPE_PRE
- en: 'Remove the packages using the following:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE63]'
  prefs: []
  type: TYPE_PRE
- en: 'Or remove them using:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE64]'
  prefs: []
  type: TYPE_PRE
- en: 'Verify that the packages are uninstalled:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE65]'
  prefs: []
  type: TYPE_PRE
- en: '`rc` indicates that the packages have been removed (`r`), and only config files
    (`c`) have been kept.'
  prefs: []
  type: TYPE_NORMAL
- en: Uninstalling Binaries
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'It is very simple to uninstall a binary installation. All you need to do is
    to remove the symlink:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Change the directory to the installation path:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE66]'
  prefs: []
  type: TYPE_PRE
- en: 'Check where `mysql` is pointing to, which will show the path it is referencing
    to:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE67]'
  prefs: []
  type: TYPE_PRE
- en: 'Remove `mysql`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE68]'
  prefs: []
  type: TYPE_PRE
- en: 'Remove the binaries (optional):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE69]'
  prefs: []
  type: TYPE_PRE
- en: Managing the MySQL Server with systemd
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: If you install MySQL using an RPM or Debian package server, startup and shutdown
    is managed by `systemd`. On platforms for which the `systemd` support for MySQL
    is installed, `mysqld_safe`, `mysqld_multi`, and `mysqld_multi.server` are not
    installed. MySQL server startup and shutdown is managed by `systemd` using the `systemctl`
    command. You need to configure `systemd` as follows.
  prefs: []
  type: TYPE_NORMAL
- en: RPM-based systems use the `mysqld.service` files, and APT-based systems use
    the `mysql.server` files.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Create a localized `systemd` configuration file:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE70]'
  prefs: []
  type: TYPE_PRE
- en: 'Create/open the `conf` file:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE71]'
  prefs: []
  type: TYPE_PRE
- en: 'Enter the following:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE72]'
  prefs: []
  type: TYPE_PRE
- en: 'Reload `systemd`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE73]'
  prefs: []
  type: TYPE_PRE
- en: 'For temporary changes, you can reload without editing the `conf` file:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE74]'
  prefs: []
  type: TYPE_PRE
- en: After modifying the `systemd` environment, restart the server to make the changes
    effective.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Enable `mysql.serviceshell> sudo systemctl`, and enable `mysql.service`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE75]'
  prefs: []
  type: TYPE_PRE
- en: 'Restart `mysql`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'On RPM platforms:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE76]'
  prefs: []
  type: TYPE_PRE
- en: 'On Debian platforms:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE77]'
  prefs: []
  type: TYPE_PRE
- en: Downgrading from MySQL 8.0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: If your application is not performing as expected, you can always downgrade
    to a previous GA release (MySQL 5.7). Before downgrading, it is recommended to
    take a logical backup (refer to Chapter 7, *Backups*). Note that you can downgrade
    by only one previous release. Suppose that you want to downgrade from MySQL 8.0
    to MySQL 5.6, you have to downgrade to MySQL 5.7, and then from MySQL 5.7 to MySQL
    5.6.
  prefs: []
  type: TYPE_NORMAL
- en: 'You can do it in two ways:'
  prefs: []
  type: TYPE_NORMAL
- en: In-place downgrade (downgrades within MySQL 8)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Logical downgrade
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the following subsections, you will be learning how to handle the installation/uninstallation/upgrade/downgrade
    using various repositories, bundles, and so on.
  prefs: []
  type: TYPE_NORMAL
- en: In-place Downgrades
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'For downgrades between the GA status releases within MySQL 8.0 (note that you
    cannot downgrade to MySQL 5.7 using this method):'
  prefs: []
  type: TYPE_NORMAL
- en: Shut down the old MySQL version
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Replace the MySQL 8.0 binaries or older binaries
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Restart MySQL on the existing `data directory`
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Run the `mysql_upgrade` utility
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Using YUM repositories
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Prepare MySQL for a slow shutdown, which ensures that the undo logs are empty
    and data files are fully prepared in case of file format differences between releases:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE78]'
  prefs: []
  type: TYPE_PRE
- en: 'Shut down the `mysql` server as described in the *Stopping MySQL 8.0 Server* section:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE79]'
  prefs: []
  type: TYPE_PRE
- en: 'Remove the `InnoDB` redo log files (the `ib_logfile*` files) from the `data
    directory` to avoid downgrade issues related to redo log file format changes that
    may have occurred between releases:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE80]'
  prefs: []
  type: TYPE_PRE
- en: Downgrade MySQL. To downgrade the server, you need to uninstall MySQL 8.0, as
    described in the *Uninstalling MySQL 8* section. The configuration files are automatically
    stored as backup.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'List the available versions:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE81]'
  prefs: []
  type: TYPE_PRE
- en: 'Downgrades are tricky; it is better to remove the existing packages before
    downgrading:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE82]'
  prefs: []
  type: TYPE_PRE
- en: 'Install the older version:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE83]'
  prefs: []
  type: TYPE_PRE
- en: Using APT Repositories
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Reconfigure MySQL and choose the older version:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE84]'
  prefs: []
  type: TYPE_PRE
- en: 'Run `apt-get update`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE85]'
  prefs: []
  type: TYPE_PRE
- en: 'Remove the current version:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE86]'
  prefs: []
  type: TYPE_PRE
- en: 'Install the older version (autoselected since you have reconfigured):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE87]'
  prefs: []
  type: TYPE_PRE
- en: Using the RPM or APT bundle
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Uninstall the existing packages (refer to the *Uninstalling MySQL 8* section)
    and install the new packages, which can be downloaded from the MySQL Downloads
    (refer to the *Installing MySQL 8.0 using RPMs or DEB files* section).
  prefs: []
  type: TYPE_NORMAL
- en: Using Generic Binaries
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'If you have installed MySQL through binaries, you have to remove the symlink
    to the old version (refer to the *Uninstalling MySQL 8* section) and do a fresh
    installation (refer to the *Installing MySQL on Linux Using Generic Binaries*
    section):'
  prefs: []
  type: TYPE_NORMAL
- en: Start the server as described in the *Starting or Stopping MySQL 8* section.
    Please note that the start procedure is the same for all the versions.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Run the `mysql_upgrade` utility:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE88]'
  prefs: []
  type: TYPE_PRE
- en: 'Restart the MySQL server to ensure that any changes made to the system tables
    take effect:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE89]'
  prefs: []
  type: TYPE_PRE
- en: Logical Downgrades
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Here is an outline of the steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Export existing data from the MySQL 8.0 version using logical backup (refer
    to Chapter 7*, Backups* for logical backup methods)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Install MySQL 5.7
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Load the dump file into the MySQL 5.7 version (refer to Chapter 8, *Restoring
    Data* for restoring methods)
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Run the `mysql_upgrade` utility
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Here are the detailed steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'You need to take logical backup of the database. (refer to [Chapter 7](part0250.html#7EDCK0-faa69fe6f4c04957afca3568dcd9cd83),
    *Backups* for a quicker backup called `mydumper`):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE90]'
  prefs: []
  type: TYPE_PRE
- en: Shut down the MySQL server as described in the *Starting or Stopping MySQL 8*
    section.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Move the `data directory`. Instead of restoring the SQL backup (in step 1),
    we can move back the `data directory` if you want to keep MySQL 8:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE91]'
  prefs: []
  type: TYPE_PRE
- en: Downgrade MySQL. To downgrade the server, we need to uninstall MySQL 8\. The
    configuration files are automatically backed up.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Using YUM Repositories
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'After the uninstallation, install the older version:'
  prefs: []
  type: TYPE_NORMAL
- en: 'Switch the repositories:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE92]'
  prefs: []
  type: TYPE_PRE
- en: 'Verify that `mysql57-community` is enabled:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE93]'
  prefs: []
  type: TYPE_PRE
- en: 'Downgrades are tricky; it is better to remove the existing packages before
    downgrading:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE94]'
  prefs: []
  type: TYPE_PRE
- en: 'List the available versions:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE95]'
  prefs: []
  type: TYPE_PRE
- en: 'Install MySQL 5.7:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE96]'
  prefs: []
  type: TYPE_PRE
- en: Using APT Repositories
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Reconfigure `apt` to switch to MySQL 5.7:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE97]'
  prefs: []
  type: TYPE_PRE
- en: 'Run `apt-get update`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE98]'
  prefs: []
  type: TYPE_PRE
- en: 'Remove the current version:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE99]'
  prefs: []
  type: TYPE_PRE
- en: 'Install MySQL 5.7:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE100]'
  prefs: []
  type: TYPE_PRE
- en: Using RPM or APT bundles
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Uninstall the existing packages (refer to the *Uninstalling MySQL 8* section)
    and install the new packages, which can be downloaded from MySQL Downloads (refer
    to the *Installing MySQL 8 using RPM or DEB files* section).
  prefs: []
  type: TYPE_NORMAL
- en: Using Generic Binaries
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: If you have installed MySQL through binaries, you have to remove the symlink
    to the old version (refer to the *Uninstalling MySQL 8* section) and do a fresh
    installation (refer to the *Installing MySQL on Linux using Generic Binaries*
    section).
  prefs: []
  type: TYPE_NORMAL
- en: 'Once you have downgraded MySQL, you have to restore the backup and run the `mysql_upgrade`
    utility:'
  prefs: []
  type: TYPE_NORMAL
- en: Start MySQL (refer to the *Starting or Stopping MySQL 8* section). You need
    to reset the password again.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Restore the backup (this may take a long time, depending up on the size of
    backup). Refer to [Chapter 8](part0296.html#8Q96G0-faa69fe6f4c04957afca3568dcd9cd83),
    *Restoring Data*, for a quick restoration method called `myloader`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE101]'
  prefs: []
  type: TYPE_PRE
- en: 'Run `mysql_upgrade`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE102]'
  prefs: []
  type: TYPE_PRE
- en: 'Restart the MySQL server to ensure that any changes made to the system tables
    take effect. Refer to the *Starting or Stopping MySQL 8* section:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE103]'
  prefs: []
  type: TYPE_PRE
- en: Upgrading to MySQL 8.0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: MySQL 8 uses a global `data dictionary` containing information about database
    objects in transactional tables. In previous versions, the dictionary data was
    stored in metadata files and non-transactional system tables. You need to upgrade
    your `data directory`  from the file-based structure to the data-dictionary structure.
  prefs: []
  type: TYPE_NORMAL
- en: 'Just like a downgrade, you can upgrade using two methods:'
  prefs: []
  type: TYPE_NORMAL
- en: In-place upgrade
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Logical upgrade
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: You also should check a few prerequisites before the upgrade.
  prefs: []
  type: TYPE_NORMAL
- en: Getting ready
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Check for obsolete datatypes or triggers that have a missing or empty definer
    or an invalid creation context:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE104]'
  prefs: []
  type: TYPE_PRE
- en: 'There must be no partitioned tables that use a storage engine that does not
    have native partitioning support. To identify these tables, execute this query:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE105]'
  prefs: []
  type: TYPE_PRE
- en: 'If there are any of these tables, change them to `InnoDB`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE106]'
  prefs: []
  type: TYPE_PRE
- en: 'Or remove the partitioning:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE107]'
  prefs: []
  type: TYPE_PRE
- en: 'There must be no tables in the MySQL 5.7 `mysql` system database that have
    the same name as a table used by the MySQL 8.0 `data dictionary`. To identify
    tables with those names, execute this query:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE108]'
  prefs: []
  type: TYPE_PRE
- en: 'There must be no tables that have foreign key constraint names longer than
    64 characters. To identify tables with constraint names that are too long, execute
    this query:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE109]'
  prefs: []
  type: TYPE_PRE
- en: 'Tables not supported by MySQL 8.0, such as `ndb`, should be moved to `InnoDB`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE110]'
  prefs: []
  type: TYPE_PRE
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Just like the previous recipe, the following subsections will take you through
    the details with various systems, bundles, and so on.
  prefs: []
  type: TYPE_NORMAL
- en: In-place upgrades
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Here is an outline of the steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Shut down the old MySQL version.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Replace the old MySQL binaries or packages with the new ones (detailed steps
    for different types of installation methods are covered).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Restart MySQL on the existing `data directory`.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Run the `mysql_upgrade` utility.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'In the MySQL 5.7 server, if there are encrypted `InnoDB` tablespaces**,** rotate
    the `keyring` master key by executing this statement:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE111]'
  prefs: []
  type: TYPE_PRE
- en: 'Here are the detailed steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Configure your MySQL 5.7 server to perform a slow shutdown. With a slow shutdown,
    `InnoDB` performs a full purge and change buffer merge before shutting down, which
    ensures that the undo logs are empty and the data files are fully prepared in
    case of file format differences between releases.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'This step is the most important because, without it, you will end up with the
    following error:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE112]'
  prefs: []
  type: TYPE_PRE
- en: 'This redo log was created with MySQL 5.7.18\. Please follow the instructions
    at [http://dev.mysql.com/doc/refman/8.0/en/upgrading.html](http://dev.mysql.com/doc/refman/8.0/en/upgrading.html):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE113]'
  prefs: []
  type: TYPE_PRE
- en: Shut down the MySQL server as described in the *Starting or Stopping MySQL 8*
    section.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Upgrade the MySQL binaries or packages.
  prefs: []
  type: TYPE_NORMAL
- en: YUM-based systems
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Switch the repositories:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE114]'
  prefs: []
  type: TYPE_PRE
- en: 'Verify that `mysql80-community` is enabled:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE115]'
  prefs: []
  type: TYPE_PRE
- en: 'Run the yum update:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE116]'
  prefs: []
  type: TYPE_PRE
- en: APT-based systems
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Reconfigure the `apt` to switch to MySQl 8.0:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE117]'
  prefs: []
  type: TYPE_PRE
- en: 'Run `apt-get update`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE118]'
  prefs: []
  type: TYPE_PRE
- en: 'Remove the current version:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE119]'
  prefs: []
  type: TYPE_PRE
- en: 'Install MySQL 8:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE120]'
  prefs: []
  type: TYPE_PRE
- en: Using RPM or APT bundles
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Uninstall the existing packages (refer to the *Uninstalling MySQL 8* section)
    and install the new packages, which can be downloaded from MySQL Downloads (refer
    to the *Installing MySQL 8.0 using RPM or DEB files* section).
  prefs: []
  type: TYPE_NORMAL
- en: Using Generic Binaries
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: If you have installed MySQL through binaries, you have to remove the symlink
    to the old version (refer to the *Uninstalling MySQL 8* section) and do a fresh
    installation (refer to the *Installing MySQL on Linux using generic binaries*
    section).
  prefs: []
  type: TYPE_NORMAL
- en: Start the MySQL 8.0 server (refer to the *Starting or Stopping MySQL 8 to start
    MySQL* section). If there are encrypted `InnoDB` tablespaces, use the `--early-plugin-load`
    option to load the `keyring` plugin.
  prefs: []
  type: TYPE_NORMAL
- en: The server automatically detects whether `data dictionary` tables are present.
    If not, the server creates them in the `data directory` , populates them with
    metadata, and then proceeds with its normal startup sequence. During this process,
    the server upgrades metadata for all database objects, including databases, tablespaces,
    system and user tables, views, and stored programs (stored procedures and functions,
    triggers, event scheduler events). The server also removes files that previously
    were used for metadata storage. For example, after upgrading, you will notice
    that your tables no longer have `.frm` files.
  prefs: []
  type: TYPE_NORMAL
- en: The server creates a directory named `backup_metadata_57` and moves the files
    used by MySQL 5.7 into it. The server renames the `event` and `proc` tables to
    `event_backup_57` and `proc_backup_57`. If this upgrade fails, the server reverts
    all changes to the `data directory`. In this case, you should remove all redo
    log files, start your MySQL 5.7 server on the same `data directory`, and fix the
    cause of any errors. Then, perform another slow shutdown of the 5.7 server and
    start the MySQL 8.0 server to try again.
  prefs: []
  type: TYPE_NORMAL
- en: 'Run the `mysql_upgrade` utility:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE121]'
  prefs: []
  type: TYPE_PRE
- en: '`mysql_upgrade` examines all tables in all databases for incompatibilities
    with the current version of MySQL. It makes any remaining changes required in
    the `mysql` system database between MySQL 5.7 and MySQL 8.0, so that you can take
    advantage of new privileges or capabilities. `mysql_upgrade` also brings the performance
    schema, `INFORMATION_SCHEMA`, and `sys schema` objects up to date for MySQL 8.0.'
  prefs: []
  type: TYPE_NORMAL
- en: Restart the MySQL server (refer to the *Starting or Stopping MySQL 8 to start
    MySQL* section).
  prefs: []
  type: TYPE_NORMAL
- en: Logical Upgrades
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Here is an outline of the steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Export existing data from the old MySQL version using `mysqldump`
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Install the new MySQL version
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Load the dump file into the new MySQL version
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Run the `mysql_upgrade` utility
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Here are the detailed steps:'
  prefs: []
  type: TYPE_NORMAL
- en: 'You need to take a logical backup of the database (refer to [Chapter 7](part0250.html#7EDCK0-faa69fe6f4c04957afca3568dcd9cd83),
    *Backups* for a quicker backup called `mydumper`):'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE122]'
  prefs: []
  type: TYPE_PRE
- en: Shut down the MySQL server (refer to the *Starting or Stopping MySQL 8* section).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Install the new MySQL version (refer to the methods mentioned in the *In-place
    upgrades* section).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Start the MySQL server (refer to the *Starting or Stopping MySQL 8* section).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'Reset the temporary `root` password:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE123]'
  prefs: []
  type: TYPE_PRE
- en: 'Restore the backup (this may take a long time depending up on the size of the
    backup). Refer to [Chapter 8](part0296.html#8Q96G0-faa69fe6f4c04957afca3568dcd9cd83),
    *Restoring Data* for a quick restoration method called `myloader`:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE124]'
  prefs: []
  type: TYPE_PRE
- en: 'Run the `mysql_upgrade` utility:'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[PRE125]'
  prefs: []
  type: TYPE_PRE
- en: Restart the MySQL server (refer to the *Starting or Stopping MySQL 8* section).
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Installing MySQL utilities
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: MySQL utilities gives you very handy tools to smoothly carry out day-to-day
    operations without much manual effort.
  prefs: []
  type: TYPE_NORMAL
- en: How to do it...
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: It can be installed on YUM-based and APT-based systems in the following manner.
    Let's take a look.
  prefs: []
  type: TYPE_NORMAL
- en: On YUM-based systems
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Download the files from the MySQL downloads page, [https://dev.mysql.com/downloads/utilities/](https://dev.mysql.com/downloads/utilities/),
    by selecting Red Hat Enterprise Linux/Oracle Linux, or directly from this link,
    using `wget`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE126]'
  prefs: []
  type: TYPE_PRE
- en: On APT-based systems
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'Download the files from the MySQL Downloads page, [https://dev.mysql.com/downloads/utilities/](https://dev.mysql.com/downloads/utilities/),
    by selecting Ubuntu Linux,  or directly from this link, using `wget`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE127]'
  prefs: []
  type: TYPE_PRE
