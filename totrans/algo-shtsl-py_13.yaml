- en: '13'
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Portfolio Management System
  id: totrans-1
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '"Toto, I have a feeling we are not in Kansas anymore."'
  id: totrans-2
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '>'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
- en: – Dorothy, The Wizard of Oz
  id: totrans-4
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: My first job in the hedge fund world was to build and maintain a **Portfolio
    Management System** (**PMS**) for a start-up hedge fund with less than $5 million
    under management. The principals believed that risk management was not some ornament
    of the business, but the business itself. Fast forward to now, and they are the
    dominant player in the Japanese alternative space. In this chapter, we will continue
    with our work from the last two chapters, and introduce a customized PMS which
    shows risk visualization across the portfolio.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
- en: 'To illustrate the importance of a robust PMS, let''s connect a few concepts
    we explored throughout this book. In *Chapter 1*, *The Stock Market Game*, we
    set the context that the market is an infinite, complex random game. In *Chapter
    6*, *The Trading Edge is a Number, and Here is the Formula*, we unveiled the magical,
    mysterious, and mythical trading edge formula. In *Chapter 8*, *Position Sizing:
    Money is Made in the Money Management Module*, we demonstrated that position sizing
    determines performance. And we learned in *Chapter 11*, *The Long/Short Toolbox*,
    about the tools in our toolbox. So, we know that position sizing is the key determinant,
    but we don''t know which positions will work out, yet we must maintain a positive
    expectancy while managing exposures. Rinse and repeat every day for years to attract
    and keep investors.'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
- en: Over the course of my career, friends and colleagues have been generous enough
    to unveil their PMSes. Survival is directly correlated to the quality of their
    PMSes. Not everyone who had a proper system made it. Yet every single manager
    who did not have a system eventually crashed.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
- en: 'A PMS is like flight instruments. Any rookie can fly a plane in clear skies.
    Instruments are there to prevent crashes during takeoff and when landing at night,
    through fog and turbulence. Without instruments, not everyone will be coming home.
    The market is not fair weather and smooth sailing all the time. Things do get
    ugly unexpectedly. Emotions do steer us off course. In execution trader English,
    how can you claim to be a portfolio manager if you don''t have a solid PMS? Building a
    customized PMS using Python deserves its own book, if not its own dedicated literary
    genre, and therefore exceeds the scope of this book. However, in this chapter
    we will briefly touch on a few fundamental concepts and guiding principles that
    will hopefully guide you:'
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
- en: Symptoms of poor portfolio management systems
  id: totrans-9
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Your portfolio management system is your Iron Man suit
  id: totrans-10
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Automating the boring stuff
  id: totrans-11
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Building a robust portfolio management system
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'You can access color versions of all images in this chapter via the following
    link: [https://static.packt-cdn.com/downloads/9781801815192_ColorImages.pdf](https://static.packt-cdn.com/downloads/9781801815192_ColorImages.pdf).
    You can also access the source code for this chapter via the book''s GitHub repository:
    [https://github.com/PacktPublishing/Algorithmic-Short-Selling-with-Python-Published-by-Packt](https://github.com/PacktPublishing/Algorithmic-Short-Selling-with-Python-Published-by-Packt).'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
- en: Importing libraries
  id: totrans-14
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'For this chapter and the rest of the book, we will be working with the `pandas`,
    `numpy`, `yfinance`, and `matplotlib` libraries. So, please remember to import
    them first:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  id: totrans-16
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Symptoms of poor portfolio management systems
  id: totrans-17
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: When it comes to turning performance around, a good PMS is the lowest hanging
    fruit. In 2005, I joined a hedge fund whose PMS was so ugly, looking at it could
    have caused brain damage. I promptly tooled it up, at least to get rid of the
    health hazard. Suddenly, problem children lit up like garlands on a Christmas
    tree. Volatile penny stocks on the short side, lazy dogs, and unappreciated racing
    hounds were all swiftly dealt with. Volatility came down. Performance was more
    consistent. The Sharpe ratio jumped. Investors noticed. **Assets Under Management**
    (**AUM**) grew. It was that simple.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 在改善绩效方面，一个好的PMS是最容易实现的。2005年，我加入了一个对冲基金，其PMS非常糟糕，看一眼就可能导致脑损伤。我立即对其进行了改进，至少是为了消除健康风险。突然间，问题儿童们就像圣诞树上的彩灯一样亮起来。短期股票的波动性下降了，表现更加一致。夏普比率提高了。投资者们也注意到了。**管理资产**（**AUM**）增长了。就是这么简单。
- en: Everyone wants to know the "secret sauce" of the winners, but this is one area
    where the lessons of the "alpha-challenged" ones might help us from inadvertently
    repeating the same mistakes. Here is a simple exercise that will help you figure
    out if your system is in need of an upgrade. Deficient PMSes share one or more
    of the following symptoms.
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: 每个人都想知道赢家的“秘密配方”，但这是一个领域，失败者的教训可能会帮助我们避免无意中重复同样的错误。以下是一个简单的练习，将帮助您确定您的系统是否需要升级。有缺陷的PMS表现出以下一个或多个症状。
- en: Ineffective capital allocation
  id: totrans-20
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 资本配置无效
- en: 'As much as portfolio managers like to project an Olympian demi-god image to
    the public, they can be reeled back to earth with a few sentences:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管投资组合经理们喜欢向公众展示奥林匹克半神般的形象，但只需几句话就能将他们拉回现实：
- en: '"Nice guys finish last": some stocks post impressive returns that go unnoticed
    because positions are small. Those are often exploratory tiny positions. They
    post high returns but contribute poorly because they are not adequately sized.'
  id: totrans-22
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '"好人总是最后完成": 一些股票取得了令人印象深刻的回报，但由于头寸较小而未被注意到。这些通常是探索性的小头寸。它们取得了高回报，但贡献较少，因为它们的规模不够。'
- en: '"Fat cats don''t catch the mice": some big positions contribute only because
    of their massive weight. This is a classic problem with PMS. It is directly related
    to the above point. Those are often high-conviction ideas that occupy far too
    much real estate for their paltry returns.'
  id: totrans-23
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: “肥猫抓不到老鼠”：一些大头寸仅仅因为它们的巨大权重而有贡献。这是PMS的一个经典问题。这与上述观点直接相关。这些通常是占据太多空间的高信念想法，而其回报微薄。
- en: '"Once we were warriors": those are veteran contributors who are now mooching
    rent-free. Those are ideas that have been stale for a while. They have a lot of
    embedded historical contribution but do not pay rent anymore. We have addressed
    the situation in the game of two thirds in *Chapter 7*, *Improve Your Trading
    Edge*.'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '"曾经我们是勇士": 这些是曾经有贡献的老手，现在却在免费搭便车。这些是已经过时一段时间的想法。它们有很多历史贡献，但不再产生收益。我们在*第7章*的“提高交易优势”中已经解决了这个问题。'
- en: Undermonitored risk detection
  id: totrans-25
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 风险监测不足
- en: A key metric to keep an eye on is liquidity, to avoid "Hotel California Syndrome."
    In other words, you do not own what you cannot liquidate, it owns you. Liquidity
    is the currency of bear markets. Are there positions that cannot be liquidated
    without severe market impact? Below is a function that restates position size
    in days to exit at a fraction of the average volume. Sheer terror for a short
    seller is when you see a bear market rally gain momentum and realize your position
    is too big to get out unscathed. There are few worse feelings than being squeezed
    out of a position only to see it resume its downward descent post bear market
    tsunami.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 一个关键的指标是流动性，以避免“加州旅馆综合症”。换句话说，你不拥有你无法清算的东西，它拥有你。流动性是熊市的货币。是否有头寸无法在没有严重市场影响的情况下清算？下面是一个函数，将头寸规模重新表述为以平均成交量的一部分退出所需的天数。对于空头卖方来说，最大的恐惧就是看到熊市的反弹势头增强，并意识到自己的头寸太大，无法幸免。很少有比被迫清仓后看到头寸在熊市海啸后继续下跌更糟糕的感觉。
- en: 'A simple risk measure is to restate a position size as the number of days necessary
    to liquidate at a fraction of the average volume. The code below simply calculates
    a fraction of the average volume. The position quantity is divided by this fraction:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 一个简单的风险度量是将头寸规模重新表述为在平均成交量的一部分上清算所需的天数。下面的代码简单地计算了平均成交量的一部分。头寸数量除以这个分数：
- en: '[PRE1]'
  id: totrans-28
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'This produces an output something like the following:'
  id: totrans-29
  prefs: []
  type: TYPE_NORMAL
  zh: 这会产生以下类似的输出：
- en: '[PRE2]'
  id: totrans-30
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'We can produce the chart shown in *Figure 13.1*:'
  id: totrans-31
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以生成*图13.1*中显示的图表：
- en: '[PRE3]'
  id: totrans-32
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'We downloaded `volume` data since the beginning of 2021\. The function multiplies
    a fixed percentage by a moving average of the volume. This number of shares is
    divided by a fraction of volume: `0.01`, or 1%. This value is arbitrary and deliberately
    low to show the principle. In practice, 5-10% are reasonable thresholds. At the
    end of June 2021, it would take roughly 5 days to liquidate the entire position
    if the order size did not exceed 1% of the average volume. We printed the last
    number in the series and plotted the moving average:'
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 我们下载了自2021年初以来的`成交量`数据。该函数将固定百分比乘以成交量的移动平均值。股票数量除以成交量的一部分：`0.01`，或者1%。这个值是任意的，故意设置得很低以展示原则。实际上，5-10%是合理的阈值。到2021年6月底，如果订单大小不超过平均成交量的1%，则大约需要5天时间清算整个头寸。我们打印了系列中的最后一个数字并绘制了移动平均线：
- en: '![](img/B17704_13_01.png)'
  id: totrans-34
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17704_13_01.png)'
- en: 'Figure 13.1: Days to liquidate at 1% of 3 months average volume'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 图13.1：在3个月平均成交量的1%上清算所需的天数
- en: The above chart shows liquidity is not static. It would originally take about
    2 days to liquidate the position trading at 1% of the average daily volume. As
    liquidity thins out, the number of days necessary to liquidate increases to 5
    days, then comes back down to around 3.5 days. A week is an eternity when price
    moves against you. Liquidity should therefore be monitored.
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 上面的图表显示流动性并不是静态的。最初需要大约2天时间来清算占平均日成交量1%的头寸。随着流动性的减少，清算所需的天数增加到5天，然后回落到大约3.5天。当价格朝着你的方向波动时，一周就像是永恒。因此，流动性应该被监控。
- en: Market impact is the adverse change in price caused by trading large quantities.
    Market impact starts when positions are bigger than 5% of the daily volume. If
    a position takes more than 5 days at 10% of the volume, then expect some serious
    market impact. Besides, the violence of bear market rallies cannot be understated
    enough. You will mentally be on your back foot trading yourself out of a hole.
    So, always monitor liquidity and trim positions when volume thins out.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 市场冲击是由于交易大量股票而导致价格不利变化。当持仓量超过每日成交量的5%时，市场冲击就会开始。如果一个头寸占据了超过5天的10%的成交量，那么就会出现严重的市场冲击。此外，熊市反弹的激烈程度也不容忽视。你会发现自己在努力应对市场的波动。因此，始终要监控流动性，并在成交量减少时减少头寸。
- en: High volatility
  id: totrans-38
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 高波动性
- en: Crowded shorts have high average borrow utilization. Liquidity will thin out,
    volatility will increase, and returns will deteriorate. Heatmaps of utilization
    or borrowing fees are very valuable tools. At the date of publication, there are
    unfortunately no free sources for borrow utilization. As a shortcut, when the
    lending fee is largely above the average, assume popularity. The simplest way
    to deal with crowded shorts is to reduce position size as popularity rises. Again,
    make simple rules, like (for example) cut exposure in half if utilization rises
    above 40% and by an additional half for every 10% increase. By the time utilization
    reaches 60%, exposure would be 25% of the original size. This is just food for
    thought.
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 拥挤的做空交易利用率很高。流动性将减少，波动性将增加，回报将恶化。利用率或借贷费用的热图是非常有价值的工具。在出版日期时，遗憾的是没有免费的借贷利用率来源。作为一种捷径，当借贷费用大大高于平均水平时，可以假设它很受欢迎。应对拥挤的做空交易的最简单方法是随着受欢迎程度的上升减少头寸规模。再次，制定简单的规则，比如（例如）如果利用率上升到40%以上，则减少一半的敞口，每增加10%再减少一半。到利用率达到60%时，敞口将是原始规模的25%。这只是一个思考的食物。
- en: 'Blow-ups do not stand out: people want to feel good about themselves. In the
    markets, doing what feels good is rarely the most lucrative course of action.
    Stocks at risk must visually nag managers into taking action. Stocks rarely blow
    up unexpectedly. They often give subtle signals that things are not going the
    way they should.'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
  zh: 爆仓并不突出：人们希望对自己感到满意。在市场上，做自己感觉良好的事很少是最有利可图的行动。有风险的股票必须在视觉上提醒管理者采取行动。股票很少会意外爆仓。它们经常发出微妙的信号，表明事情并不如预期那样进行。
- en: High correlation
  id: totrans-41
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 高相关性
- en: 'The goal of diversification is to reduce correlation. Correlation is difficult
    to avoid. In *Chapter 4*, *Long/Short Methodologies: Absolute and Relative*, we
    introduced the relative series to reduce correlation with the benchmark. However,
    the focus shifts from timing the absolute top or bottom to catching sector rotation,
    and allocating assets accordingly. Correlation within a portfolio is hard to eliminate.
    Frankly speaking, I do not know how to accomplish this in practice. Neither have
    I encountered successful methods so far.'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 分散风险的目标是降低相关性。相关性很难避免。在第4章“多空方法论：绝对和相对”中，我们介绍了相对系列以减少与基准的相关性。然而，重点从定时绝对顶部或底部转移到捕捉板块轮动，并相应地配置资产。投资组合内的相关性很难消除。坦率地说，我不知道如何在实践中实现这一点。到目前为止，我也没有遇到成功的方法。
- en: Poor exposure management
  id: totrans-43
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 敞口管理不善
- en: 'There are a few different types of exposures, which can indicate a poorly managed
    portfolio in the following ways:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 有几种不同类型的敞口，可能表明投资组合管理不善：
- en: 'Net exposure: when portfolio net exposure does not match the current bullish/bearish
    view. This is particularly true in bear phases, when net exposure still points
    to residual bullishness despite ambient gloom. Portfolio cognitive dissonance
    is when exposures do not reflect the claims of managers.'
  id: totrans-45
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 净敞口：当投资组合的净敞口与当前的看涨/看跌观点不符时。这在熊市阶段尤为真实，当净敞口仍然指向残余的看涨情绪时，尽管周围充满了阴霾。投资组合认知失调是指敞口不反映管理者的主张。
- en: 'Net beta exposure: true market sensitivity is absent in most deficient systems.
    When managers focus solely on net exposure, they conflate low directionality with
    net market sensitivity. Net beta goes one step beyond net exposure to reflect
    the sensitivity to the market.'
  id: totrans-46
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 净贝塔敞口：大多数不足系统中缺乏真正的市场敏感性。当管理者只关注净敞口时，他们将低定向性与净市场敏感性混为一谈。净贝塔敞口比净敞口更进一步，反映了对市场的敏感性。
- en: 'Market cap exposure: shorting futures is the junk food of hedging. As we saw
    in *Chapter 11*, *The Long/Short Tooolbox*, small and large caps have different
    risk profiles. Small caps perform well when the general mood of the market is
    optimistic, while large caps are safer bets. The net market cap exposure reflects
    the overall optimism of the portfolio'
  id: totrans-47
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 市值敞口：做空期货是对冲的垃圾食品。正如我们在第11章“多空工具箱”中看到的，小盘股和大盘股有不同的风险特征。当市场的总体情绪乐观时，小盘股表现良好，而大盘股是更安全的选择。净市值敞口反映了投资组合的整体乐观情绪
- en: 'Gross exposure: too much leverage in good times and too much cash in bad times.
    Gross exposure is the easiest lever to reduce or add risk. When in doubt, collapse
    leverage is the simplest risk policy to live by.'
  id: totrans-48
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 总敞口：在好时期杠杆过多，在坏时期现金过多。总敞口是最容易减少或增加风险的杠杆。当犹豫不决时，减少杠杆是最简单的风险策略。
- en: 'Exchange exposure: exposure by market cap and exchange explains a lot of good/bad
    performance. As we saw in *Chapter 4*, *Long/Short Methodologies: Absolute and
    Relative*, Nasdaq has outperformed S&P 500 for years. Years of easy money have
    rewarded speculative issues and those who bet on them. When money is easy, it
    is easy to make money. No bull market has ever boosted anyone''s IQ.'
  id: totrans-49
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 交易所敞口：按市值和交易所的敞口解释了很多好/坏表现。正如我们在第4章“多空方法论：绝对和相对”中看到的，纳斯达克多年来一直优于标普500。多年来的轻松赚钱奖励了投机性问题和那些对它们押注的人。当钱容易赚时，赚钱也容易。没有一次牛市会提高任何人的智商。
- en: All in all, the highest return on investment in the asset management industry
    is a bespoke PMS. As the information gap closes, market participants scramble
    to find an edge. If you can spot and address problems earlier than your peers,
    you gain a sustainable competitive edge.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
- en: Your portfolio management system is your Iron Man suit
  id: totrans-51
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: '"You know, the question I get asked most often is, "Tony, how do you go to
    the bathroom in your suit?" [Long pause] Just like that."'
  id: totrans-52
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '>'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
- en: – Tony Stark, Iron Man
  id: totrans-54
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: Tony Stark may be a genius, a billionaire, a playboy, and a philanthropist.
    What truly gives him his superpower is his custom-made Iron Man suit. He did not
    buy his suit off the rack at Macy's. He torpedoed a few Lamborghinis in his garage
    building something that uniquely enhanced his fighting style. In the same way,
    your PMS is your Iron Man suit. It is an extension of your trading strategy. Its
    sole purpose is to help you make trading decisions under uncertainty. Since no
    one trades like you, it requires a high degree of customization.
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
- en: A classic mistake is to buy an expensive off-the-shelf software package, thinking
    that more information will lead to better trading decisions. Software solutions
    are primarily reporting tools designed by middle office personnel for front office
    professionals. Your PMS is a trading tool, not a reporting one. A Barra factor
    decomposition or the Street consensus earnings per share will not tell you how
    many shares of whichever company you should be buying or selling short today.
    Information turns into knowledge, which does not readily translate into skill.
    The key to building skill is to focus exclusively on information that directly
    leads to action.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
- en: 'In practice, a few months after system integration, portfolio managers often
    end up managing their portfolio with a low-tech Excel spreadsheet feeding from
    those shiny toys. They bought a Lamborghini to fetch the milk. Therefore, before
    you rush to buy the most expensive toy out there, here are a few principles that
    will help you clarify your needs. Information must be organized under four principles:
    clarity, relevance, simplicity, and flexibility.'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
- en: 'Clarity: bypass the left brain'
  id: totrans-58
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Under stress, your amygdala releases chemicals that reduce the activity of
    your prefrontal cortex, or "thinking brain." Your ability to think clearly gets
    impaired. Your PMS needs clarity: the information must be organized so that problems
    jump out at you. Secondly, the left brain cannot process rows and columns of numbers.
    It is slow, 5 to 7 bits per second. It does not make associations. Everything
    blurs into a sterile number soup. Meanwhile, the right brain processes information
    one hundred times faster, seeks patterns, and makes associations. Fortunately,
    data visualization is the new trend in data science. Visual cues bypass the slower-thinking
    brain. When decisions involve multiple factors, painting by numbers facilitates
    associations. For example, visualizing your positions within your investment universe
    as a heatmap will immediately tell you whether you are on the right track and
    riding the best horse within each sector. We will look at a portfolio heatmap
    at the end of the chapter.'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
- en: 'Another topic is alerts. Did you ever wonder why disaster sirens are so annoying?
    People might not get the same sense of urgency if the "Ode to Joy" were to announce
    an imminent earthquake, tsunami, or volcanic eruption. We are hardwired to move
    away from pain and toward pleasure. Alarms are there to compel the most reluctant
    people into action. When a position needs to be dealt with, make the alert as
    nagging as possible. The more annoying the alert, the more likely it will be swiftly
    dealt with. The best alerts are those you must manually acknowledge first before
    doing your daily routine. Example: let''s say that a stock has reached a stop
    loss. If an alert is set such that you must click on it to be able to continue
    to your portfolio, two things can happen. Either you will swiftly deal with the
    problem, or you will end up avoiding your tool altogether. When the need to be
    right supersedes the imperative to make money, our inner idiot works extra hard
    to self-sabotage.'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个话题是警报。你是否曾经想过为什么灾难警报声音如此刺耳？如果“快乐颂”来宣布即将发生地震、海啸或火山爆发，人们可能不会感到同样的紧迫感。我们天生就倾向于远离痛苦，向快乐靠拢。警报的存在是为了迫使最不情愿行动的人采取行动。当一个头寸需要处理时，要尽可能让警报变得刺耳。警报越刺耳，处理问题的可能性就越大。最好的警报是你必须在进行日常例行工作之前手动确认的警报。例如：假设一只股票已经达到了止损点。如果设置了一个警报，你必须点击它才能继续查看你的投资组合，那么会发生两件事。要么你会迅速处理问题，要么你最终会完全避开你的工具。当正确性的需求超过了赚钱的必要性时，我们内心的白痴会更加努力地自我破坏。
- en: A classic mistake is to have multiple pages, one for each risk factor. This
    means users must juggle between pages and take notes. Every degree of friction
    increases information leakage. A pilot should not have to run up and down the
    plane to see if the hydraulics and the fuel gauge are all in order. If you want
    to make associations between different risks, you need to bring all relevant information
    into a one-page summary that allows drill-down in later pages. Think of it like
    the dashboard of a car or a plane. All the information you need is on display
    before you.
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 一个经典的错误是有多个页面，每个页面对应一个风险因素。这意味着用户必须在页面之间来回切换并做笔记。每增加一点摩擦力都会增加信息泄漏。飞行员不应该不停地在飞机上跑来跑去，看液压系统和燃油表是否都正常。如果你想要在不同的风险之间建立关联，你需要将所有相关信息汇总到一个页面摘要中，以便在后续页面中进行深入了解。可以把它想象成汽车或飞机的仪表盘。你需要的所有信息都在显示屏上。
- en: 'Put things in context. The left brain does not process numbers effectively.
    Gross exposure of 295% is just a number. When plotted on a chart that displays
    benchmark, gross, and net exposures and performance, that number is in context.
    It is a visual representation of what the market did, how you were positioned,
    and the resulting performance over time. A picture is worth a thousand words.
    Let''s recycle the example we saw in *Chapter 11*, *The Long/Short Toolbox*. We
    simulated a portfolio from the following tickers. We ran the numbers assuming
    no trading from December 31st 2020 through to June 2021:'
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 把事情放在上下文中。左脑无法有效地处理数字。295%的总敞口只是一个数字。当它在显示基准、总敞口和净敞口以及绩效的图表上绘制时，这个数字就有了上下文。这是市场的视觉呈现，展示了市场的表现、你的持仓以及随时间的绩效。一图胜千言。让我们回顾一下我们在*第11章*，*多空工具箱*中看到的例子。我们从以下股票代码模拟了一个投资组合。我们假设从2020年12月31日到2021年6月期间没有交易：
- en: '[PRE4]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: In *Chapter 11*, *The Long/Short Toolbox*, we worked on the `port` dataframe.
    This time, we will visualize exposures using `price_df`. We will first calculate
    benchmark returns. Then, we will calculate long and short market values in relative
    and absolute.
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: 在*第11章*，*多空工具箱*中，我们处理了`port`数据框。这一次，我们将使用`price_df`来可视化敞口。我们首先计算基准回报。然后，我们将计算相对和绝对的多头和空头市值。
- en: We will calculate exposures and returns in absolute and relative.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将计算绝对和相对的敞口和回报。
- en: '[PRE5]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: The `rel_price` frame is the `price_df` dataframe divided by the benchmark close
    multiplied by 1,000\. We use continuous series, not rebased to the beginning of
    the series. The value of the index at the beginning is 4 decimals long. We therefore
    multiply the relative price by 1,000 to have easier numbers to work with. We multiply
    the prices by the number of shares, aggregate by the sign of the positions, and
    sum up to obtain relative long and short market values. Since there was no trading,
    there was no change to the market values other than returns. We therefore calculate
    cumulative returns using the market value daily changes. As we saw in *Chapter
    11*, *The Long/Short Toolbox*, the gross exposure uses the absolute series. This
    is the actual balance sheet usage.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: '`rel_price`框架是`price_df`数据框除以基准收盘价乘以1,000。我们使用连续系列，而不是重新调整到系列的开始。指数在开始时的值有4位小数。因此，我们将相对价格乘以1,000，以便更容易处理数字。我们将价格乘以股数，按持仓的符号进行汇总，然后求和以获得相对多头和空头市值。由于没有交易，除了回报之外，市值没有变化。因此，我们使用市值的日变化来计算累积回报。正如我们在*第11章*，*多空工具箱*中看到的，总敞口使用绝对系列。这是实际的资产负债表使用情况。'
- en: 'We plot the main exposures and the returns in a chart. We then plot the relative
    series:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在图表中绘制了主要的敞口和回报。然后我们绘制了相对系列：
- en: '[PRE6]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'We will have four graphs. The first one is the "who are you?" chart:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 我们将有四个图表。第一个是“你是谁？”图表：
- en: '![](img/B17704_13_02.png)'
  id: totrans-71
  prefs: []
  type: TYPE_IMG
  zh: '![](img/B17704_13_02.png)'
- en: 'Figure 13.2: The "who are you" chart: market returns and exposures'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 图13.2："你是谁"图表：市场回报和敞口
- en: 'The above chart is a personal favorite. If there was one chart to sum up the
    portfolio management skill of a manager, it would be this one. It shows how managers
    respond to what the market throws at them. The benchmark market returns is the
    solid red line and all the other lines are the manager''s response:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 上面的图表是我个人最喜欢的。如果有一个图表可以总结一个经理的投资组合管理技能，那就是这个。它展示了经理们如何应对市场的波动。基准市场回报是实线红线，其他所有线条都是经理的反应：
- en: Gross exposure is the dashed line. Leverage is a direct reflection of confidence.
    Rising gross exposure displays confidence.
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 总敞口是虚线。杠杆是信心的直接反映。增加的总敞口显示出信心。
- en: Net exposure is the dotted line. Net exposure symbolizes optimism. A rising
    net exposure indicates growing bullishness. As both sides of the portfolio worked
    out nicely, shorts decreased while longs increased in value. This resulted in
    a net long drift.
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Net beta is the dashed-dotted stable line. Net beta symbolizes risk appetite.
    When risk is on, more speculative issues will populate the long book and defensive
    sectors and names will be on the short side. There was no trading, so the net
    beta is simply a reflection of the evolution of the market values.
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Finally, the solid black line is the returns. Managing exposures this way resulted
    in this performance.
  id: totrans-77
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The only missing component in this chart is net trading. Plot net long/short
    trading in bars and this will display responses. Since there was no trading in
    this example, there are no bars.
  id: totrans-78
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Next, let''s look at how the long and short books contributed to performance.
    Our original premise is that a long/short portfolio is the sum of two relative
    books. The long book must outperform the index while the short one has to trail
    the benchmark. Here is how it came about:'
  id: totrans-79
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B17704_13_03.png)'
  id: totrans-80
  prefs: []
  type: TYPE_IMG
- en: 'Figure 13.3: Returns: benchmark, absolute, relative, long and short'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
- en: In practice, it is exceedingly rare to consistently outperform the index over
    a short period of time. The red solid line is the benchmark. The dotted blue line
    is the relative performance and the solid black line is the absolute one.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
- en: 'First of all, the performance of the long/short exceeded the index. This is
    as close to fiction as this book will ever get. The relative long returns are
    upward triangles. The short relative returns are downward triangles. Secondly,
    note how close to the index the long and short relative returns are. They are
    the excess returns over the index. Put this in perspective with the number of
    stocks in the relative bullish or bearish regime we saw in *Chapter 4*, *Long/Short
    Methodologies: Absolute and Relative*. They oscillate around the benchmark.'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
- en: 'To fully understand the meaning of excess returns, let''s compare the relative
    long/short returns with the absolute ones:'
  id: totrans-84
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B17704_13_04.png)'
  id: totrans-85
  prefs: []
  type: TYPE_IMG
- en: 'Figure 13.4: Returns: benchmark, absolute, relative, long and short'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
- en: This noisy chart shows the absolute long and short returns. It shows a principle
    still foreign to many absolute players. Making money on the short side in a bull
    market means losing as little as possible. Breaking even is a good thing. Think
    about it from your long positions in a bear market. You do not expect to make
    any money, and quite frankly you would be happy if you did not lose your shirt
    on your longs.
  id: totrans-87
  prefs: []
  type: TYPE_NORMAL
- en: 'Let''s remove both absolute and relative net returns and concentrate on long
    and short absolute and relative returns to drive the point home:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B17704_13_05.png)'
  id: totrans-89
  prefs: []
  type: TYPE_IMG
- en: 'Figure 13.5: Returns: benchmark, absolute, relative, long and short'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
- en: 'In execution trader English, expect your shorts to bleed in a bull market.
    Just make sure you do not let a small scratch turn into an infection and gangrene
    the entire portfolio. This is where a lot of novice short sellers make the classic
    mistake of shrinking their short book. Here is how this syllogism usually goes:'
  id: totrans-91
  prefs: []
  type: TYPE_NORMAL
- en: The long/short arena is a highly competitive sport. Every basis point of performance
    counts.
  id: totrans-92
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: The short book is leaking alpha, financial creole for losing money.
  id: totrans-93
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: So, let's shrink the short book to jugulate the alpha hemorrhage and focus on
    the long side.
  id: totrans-94
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: That line of thinking usually ends up in an atrophied short side. This widens
    the net exposure and increases the net beta. This directly increases the correlation
    with the markets and the volatility of returns. Those two are precisely what investors
    are willing to pay a premium to avoid. Selling short is a muscle that atrophies
    when not flexed. In conclusion, focus on your mandate, your exposures, and the
    excess returns over the index.
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
- en: 'Relevance: the Iron Man auto radio effect'
  id: totrans-96
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Despite all the gadgets in his suit, have you ever wondered why Tony Stark does
    not have a low-tech auto radio in his Iron Man suit? He is also the CEO of Stark
    Industries and maybe he would like to know what market experts think about his
    share price. However, listening to the chrematocoulrophony on CNBC is simply a
    distraction Tony Stark cannot afford when he fights some bad guy.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: 尽管他的战衣里有很多小工具，你是否曾想过为什么托尼·斯塔克的铁人战衣里没有一个低科技的自动收音机？他还是斯塔克工业的CEO，也许他想知道市场专家对他的股价有什么看法。然而，听CNBC上的财经噱头对托尼·斯塔克来说只是一种分心，他在与坏家伙战斗时无法承受这种分心。
- en: The Iron Man auto radio effect is the reason why market participants sometimes
    invoke a human limitation to the number of stocks they can manage. Your PMS is
    not here to provide information. It is an extension of your trading strategy,
    here to tell you what to do. It will spit out orders that will either come from
    signals in your strategy or your risk management. You do not need to know your
    Sharpe ratio or consensus EPS 2 years out to execute a stop loss. You need to
    know your main exposures and how many shares you need to trade to hedge your portfolio
    according to the mandate you designed in *Chapter 11*, *The Long/Short Toolbox*.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 铁人自动收音机效应是市场参与者有时会提及的一个人类限制的原因，即他们可以管理的股票数量有限。你的PMS不是用来提供信息的。它是你交易策略的延伸，这里是告诉你该做什么的。它将产生订单，这些订单要么来自你策略中的信号，要么来自你的风险管理。你不需要知道你的夏普比率或共识EPS
    2年后来执行止损。你需要知道你的主要敞口和根据你在*第11章*，*多空头工具箱*中设计的授权来对冲你的投资组合需要交易多少股票。
- en: Everyone has a monitoring screen that shows what goes on in their portfolio.
    Very few market participants have taken the extra step to build a trading screen
    that embeds their trading rules and processes information into trading decisions.
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: 每个人都有一个监控屏幕，显示他们投资组合中发生的事情。很少有市场参与者采取额外的步骤来建立一个交易屏幕，将他们的交易规则和流程信息嵌入到交易决策中。
- en: 'Build a separate trading sheet with a column for each trading decision: stop
    loss, profit taking, time exit, re-entry, and so on. Have your trading rules or
    investment process run in the background. When a decision needs to be made, display
    the number of shares in the corresponding cell, else leave it blank.'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: 建立一个单独的交易表，每个交易决策都有一列：止损、获利、时间退出、重新进入等等。让你的交易规则或投资流程在后台运行。当需要做出决定时，在相应的单元格中显示股票数量，否则留空。
- en: For example, when a stock has reached a profit-taking target, just print the
    number of shares that need to be closed.
  id: totrans-101
  prefs: []
  type: TYPE_NORMAL
  zh: 例如，当一只股票达到了获利目标时，只需打印出需要平仓的股票数量。
- en: 'In *Chapter 11*, *The Long/Short Toolbox*, we performed a pro rata risk adjustment.
    First, we will republish the code. We will show the aggregates before and after
    adjustment. We will then print out orders:'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 在*第11章*，*多空头工具箱*中，我们进行了按比例风险调整。首先，我们将重新发布代码。我们将展示调整前后的聚合。然后我们将打印出订单：
- en: '[PRE7]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'We decide to update risk equally on the long and short side by `-0.01`, which
    equates to reducing risk by 1%. The sorting key to pro-rate the adjustment was
    the relative risk-adjusted returns. The lower the relative performance in units
    of relative risk, the bigger the adjustment. The adjusted stocks and quantities
    to be traded were:'
  id: totrans-104
  prefs: []
  type: TYPE_NORMAL
  zh: 我们决定通过“-0.01”在多头和空头上平等地更新风险，这相当于将风险降低1%。用于按比例调整的排序关键是相对风险调整收益。相对风险单位的表现越低，调整就越大。要交易的调整后的股票和数量是：
- en: '[PRE8]'
  id: totrans-105
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: You can adjust the value of the `adjust_long` and `adjust_short` variables to
    whatever risk adjustment you'd like to make (positive or negative). Add a column
    for prices, another for order type, and that is all the system must spit out.
    You do not need to know anything about malolactic fermentation and aging in barrels
    every time you drink a glass of wine.
  id: totrans-106
  prefs: []
  type: TYPE_NORMAL
  zh: 你可以调整`adjust_long`和`adjust_short`变量的值，以进行任何你想要的风险调整（正向或负向）。添加一个价格列，另一个订单类型列，这就是系统必须产生的所有内容。每次喝一杯葡萄酒时，你不需要了解关于苹果酸-乳酸发酵和桶中陈酿的任何信息。
- en: 'Simplicity: complexity is a form of laziness'
  id: totrans-107
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 简单：复杂性是一种懒惰的表现
- en: When you are fighting for your life, you do not need a heavy, shiny parade costume.
    You need Spartan armor—light, effective, battle-tested.
  id: totrans-108
  prefs: []
  type: TYPE_NORMAL
  zh: 当你在为生命而战时，你不需要一套沉重、闪亮的游行服装。你需要斯巴达盔甲——轻便、有效、经过战斗考验。
- en: As you start building your PMS, you will be tempted to add more bells and whistles.
    Complexity is a form of laziness. Build what is necessary, not what is nice. For
    example, if you trade moving averages, you do not need four columns with price,
    first and second moving averages, and shares. This is information overload. All
    you need is a column with the number of shares or the weight to be traded and
    only when the condition is met.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 当你开始建立你的PMS时，你会忍不住想要添加更多的花里胡哨。复杂性是一种懒惰的表现。只建立必要的东西，而不是好看的东西。例如，如果你交易移动平均线，你不需要四列价格、第一和第二移动平均线和股票。这是信息过载。你只需要一列股票数量或交易权重，只有当条件满足时才需要。
- en: Your PMS does not need to reinvent the wheel. Prime brokers provide a lot of
    the information you need through their API. For example, performance calculation
    is a waste of resources. It involves corporate actions such as stock splits, dividends,
    and subscriptions/redemptions. This all goes into modified Dietz time series performance
    calculation, separated by share class. Meanwhile, your prime brokers will provide
    **net asset value** (**NAV**) and performance calculations via their API every
    morning before breakfast.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
  zh: 你的PMS不需要重新发明轮子。Prime经纪商通过他们的API提供了你需要的大量信息。例如，绩效计算是一种资源浪费。它涉及股票拆分、股利和认购/赎回等公司行为。这一切都包括在修改后的Dietz时间序列绩效计算中，按股份类别分开。与此同时，你的Prime经纪商每天早餐前都会通过他们的API提供**净资产值**（**NAV**）和绩效计算。
- en: The rule of thumb is to only display information that will lead to a decision,
    either directly, such as trades to take, or indirectly, such as levels of open
    risk. Another example is borrow utilization. Your system spits out a short trade
    for *x* thousands of shares. You start to salivate, but then the system also shows
    that borrow utilization is around 40%. It would probably be wiser to trade smaller
    sizes.
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 一个经验法则是只显示会导致决策的信息，要么是直接的，比如要进行的交易，要么是间接的，比如开放风险的水平。另一个例子是借用利用率。你的系统输出了一笔*x*千股的空头交易。你开始流口水，但然后系统也显示借用利用率约为40%。交易更小的规模可能更明智。
- en: 'Flexibility: information does not translate into decision'
  id: totrans-112
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 灵活性：信息并不转化为决策
- en: Tooling up managers with a PMS is like giving glasses to a myopic person. At
    first, they are happy to see anything at all. Then, they start asking for more.
    Eyesight gives vision. A classic mistake is to buy expensive software before figuring
    out what you need. Software solutions are conceived by middle-office personnel
    for front-office warriors. This often results in front-office personnel using
    a fraction of the software's capability and building a separate tool on Excel.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 为管理者提供PMS就像给近视的人戴眼镜一样。起初，他们很高兴能看到任何东西。然后，他们开始要求更多。视力给予视野。一个经典的错误是在弄清楚你需要什么之前购买昂贵的软件。软件解决方案是由中后台人员为前台战士构思的。这经常导致前台人员只使用软件能力的一小部分，并在Excel上构建一个单独的工具。
- en: Another mistake is to hardcode everything from inception. Your PMS will evolve
    with you. Every small improvement has a knock-on effect. When people take on an
    exercise routine, the prospect of a night out drinking is not so attractive. No
    one trades like you do, so no one else can do it for you. It does not have to
    be perfect, but it must work first. In the beginning, make it cheap and flexible.
    Excel, Google Sheets, R, Python, and Jupyter Notebooks are enough to start experimenting.
    In theory, C++ is faster than Python. In practice, C++ is months, if not years,
    slower than Python. Python is the new Excel!
  id: totrans-114
  prefs: []
  type: TYPE_NORMAL
  zh: 另一个错误是从一开始就将所有内容硬编码。你的PMS将随着你的发展而发展。每一个小的改进都会产生连锁效应。当人们开始进行锻炼时，晚上出去喝酒的前景就不那么吸引人了。没有人像你一样交易，所以也没有人能够替你交易。它不必完美，但必须首先工作。一开始，让它便宜和灵活。Excel，Google表格，R，Python和Jupyter笔记本足以开始实验。理论上，C++比Python更快。实际上，C++比Python慢了几个月，甚至几年。Python是新的Excel！
- en: Automating the boring stuff
  id: totrans-115
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 自动化无聊的事情
- en: All market participants want to be the next Jim Simmons. No one wants to take
    care of the plumbing. People want to do the exciting stuff. They want to show
    up with their billion-dollar idea and trade away. They do not want to take care
    of risk management. In this section are a few examples of time-consuming and ultimately
    boring processes that should be automated and the reasons why.
  id: totrans-116
  prefs: []
  type: TYPE_NORMAL
  zh: 所有市场参与者都想成为下一个吉姆·西蒙斯。没有人想要照顾管道工作。人们想做令人兴奋的事情。他们想拿出自己的数十亿美元的想法并进行交易。他们不想照顾风险管理。本节中列举了一些耗时且最终令人厌倦的流程的例子，这些流程应该被自动化，并列出了原因。
- en: Trade reconciliation is the process of reconciling orders placed with trades
    executed. It shows what trades went through at what price. This is one of the
    few tasks that would make reading the tax code look like an exciting endeavor.
    Yet it is an important task as the data is used to perform trade analysis. Did
    the price beat the **volume at weighted average price** (**VWAP**) or not?
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
  zh: 交易对账是将下达的订单与执行的交易进行对账的过程。它显示了哪些交易以什么价格进行了。这是为数不多的几项使阅读税法看起来像是一项令人兴奋的事业的任务之一。然而，这是一项重要的任务，因为这些数据用于进行交易分析。价格是否击败了**成交量加权平均价格**（VWAP）？
- en: Updating the PMS is boring but not as easy as it seems. Companies go through
    all sorts of corporate actions, such as dividends and stock splits. Those corporate
    actions have an impact on the consistency of the data. It requires attention to
    detail.
  id: totrans-118
  prefs: []
  type: TYPE_NORMAL
  zh: 更新PMS是无聊的，但并不像看起来那么容易。公司经历各种各样的公司行动，比如股息和股票分割。这些公司行动对数据的一致性产生影响。这需要注意细节。
- en: Automate trading orders routing. The vast majority of algorithmic traders have
    automated execution. After all, if the system says "Buy this much of this" or
    "Sell that much of that," then just do it. Execution is on autopilot. Discretionary
    traders still struggle with fully trusting their system. What if the system spits
    out a ludicrous number? Or, what if the market does this or that? Well, trust
    is built. A simple solution is to default to automatic execution unless there
    is a manual override.
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 自动化交易订单路由。绝大多数算法交易员都已经自动化了执行。毕竟，如果系统说“买入这么多”或“卖出那么多”，那就去做。执行是自动的。自由裁量交易员仍然在全面信任他们的系统方面挣扎。如果系统输出一个荒谬的数字怎么办？或者，如果市场做了这个或那个怎么办？嗯，信任是建立起来的。一个简单的解决方案是默认为自动执行，除非有手动覆盖。
- en: Building a robust portfolio management system
  id: totrans-120
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 构建强大的投资组合管理系统
- en: Below is a quick step-by-step guide to building a robust PMS. Remember that
    each PMS requires a high degree of customization. You are building your own Iron
    Man suit. As a result, this guide will remain fairly vague.
  id: totrans-121
  prefs: []
  type: TYPE_NORMAL
  zh: 以下是构建强大PMS的快速逐步指南。请记住，每个PMS都需要高度定制。你正在打造自己的钢铁侠战衣。因此，这个指南将保持相当模糊。
- en: 'Formalize your strategy into simple trading decisions: buy/sell, how much,
    at what price. A trading sequence is fairly straightforward. Draw a flowchart
    and fill the sequence.'
  id: totrans-122
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将你的策略形式化为简单的交易决策：买入/卖出，多少，以什么价格。交易序列相当简单。绘制一个流程图并填写序列。
- en: 'Add decisions that come out of risk management: liquidity, weight, borrow utilization,
    net beta, and gross and net exposure. We saw earlier a risk reduction across the
    entire portfolio.'
  id: totrans-123
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 增加来自风险管理的决策：流动性，权重，借用利用率，净贝塔和总体和净暴露。我们之前看到整个投资组合的风险降低。
- en: From your monitoring tool, create a separate trading sheet with each trading
    decision in a separate column. This minimalist monitoring tool is particularly
    efficient for large portfolios.
  id: totrans-124
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 从你的监控工具中，创建一个单独的交易表，每个交易决策在单独的列中。这种极简主义的监控工具对于大型投资组合特别有效。
- en: Beyond your field of vision, embed your trading rules. This can be columns in
    the far right of the sheet, macros on Excel, and scripts on Python. All you need
    is the sausage on your plate, not a visual of the entire cooking process.
  id: totrans-125
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In your field of vision, index your portfolio with tickers as rows and trading
    decisions as columns.
  id: totrans-126
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Decision visualization: if a trading decision is triggered, print the number
    of shares, or the weight, in the corresponding cell, and leave everything else
    blank. This adds visual impact.'
  id: totrans-127
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Start small with rule-based actions: stop loss or profit taking are low-effort
    high-impact decisions.'
  id: totrans-128
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Over time, build an integrated tool. Add your trading history to directly calculate
    position size. A powerful tool is to integrate your portfolio monitoring tool
    and watchlist into a market heatmap.
  id: totrans-129
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Throw out the auto radio. As you refine your process, you will be tempted to
    add cells and columns. Work a little bit harder to keep as much as possible in
    the background.
  id: totrans-130
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'In *Chapter 11*, *The Long/Short Toolbox*, there was an expanded table with
    shares to be traded. We re-sort the dataframe by side (long or short) and relative
    risk-adjusted returns (`rRAR`). We slice the dataframe to display only relevant
    columns:'
  id: totrans-131
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  id: totrans-132
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: 'It all looked something like this:'
  id: totrans-133
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B17704_13_10.png)'
  id: totrans-134
  prefs: []
  type: TYPE_IMG
- en: Let's contextualize the above table in a portfolio management framework.
  id: totrans-135
  prefs: []
  type: TYPE_NORMAL
- en: Let's visualize the side of the portfolio and the sensitivity to the market
    first. We want to know on which side the high/low beta sits. Do we have a bullish
    or a bearish skew?
  id: totrans-136
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Next, we want to have our trading decisions. We do not need to finally come
    to a conclusion on the last column. We want to know what to do first. Then, we
    can check that the system works as expected.
  id: totrans-137
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: We already know that the adjustment will reduce our gross exposure. Now, we
    want to know the before/after impact on each position. These are the "weight"
    and "weight_adj" columns.
  id: totrans-138
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Risk purists would show the impact on risk next to weight. Our asset allocation
    key was to reduce risk prorated to performance instead of weight. We wanted to
    trim poorly performing positions first. So, we display contribution, "CTR," "rCTR,"
    and relative risk-adjusted return, "rRAR."
  id: totrans-139
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Finally, we display relative risks before and after "rRISK" and "rRisk_adj."
    The last column shows the residual risk across the portfolio at the stock level.
  id: totrans-140
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: This conceptual framework is boiled down to its most essential components. Every
    number in every column has a *raison d'être*. Even the upper echelon of office
    Solitaire and Tetris grand masters, otherwise referred to as compliance and risk
    officers, would concur that this was compiled in accordance with the strictest
    risk management guidelines in vigor in the industry, vernacular for "I don't know,
    it doesn't look like it is about to blow up the farm."
  id: totrans-141
  prefs: []
  type: TYPE_NORMAL
- en: 'The only problem is that the left hemisphere of our brain is not equipped to
    process this information. This is a sterile number soup that the brain cannot
    process, let alone relate to. The conscious brain can process 5 +/-2 bits of information
    per second. In execution trader English, by the time your eyes have gone from
    one end of the table to the other, your brain has forgotten what it needed to
    look for in the first place. Second bit of bad news: you are nothing special.
    It happens to everyone. Besides, Rain Man, if you can memorize the table, you
    would make a better living counting cards at a Blackjack table.'
  id: totrans-142
  prefs: []
  type: TYPE_NORMAL
- en: The real question is, how can we turn this sterile soup into something we can
    accurately process in a single glance? It turns out our brain comes equipped with
    a right hemisphere. It processes information at lighting speed, making associations
    between seemingly random bits of data. The only drawback is that the data needs
    to be repackaged in a format this brain can process. In execution trader English,
    let's paint by numbers. We will be using a built-in constructor called Styler.
    It only takes a few lines of code to return a versatile heatmap. These few lines
    of code can be recycled to draw quick and efficient heatmaps for market returns.
  id: totrans-143
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  id: totrans-144
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: We run a long/short portfolio. Numbers appearing on the short side often carry
    a negative sign. We do not want our subconscious brain to associate short positions
    with negative returns. So, we dissociate descriptive fields (`desc_cols`) from
    the performance-related columns (`perf_cols`). The more color maps you want to
    display on a single dataframe, the more you simply stack back to back.
  id: totrans-145
  prefs: []
  type: TYPE_NORMAL
- en: The `sort_values` method is added to enhance even further the versatility of
    the heatmap. This sterile soup number comes alive when painted properly. The frescoes
    in the Sistine Chapel may look divine, but behind them is just a wall.
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
- en: '![A screenshot of a computer  Description automatically generated with low
    confidence](img/B17704_13_06.png)'
  id: totrans-147
  prefs: []
  type: TYPE_IMG
- en: 'Figure 13.6: Portfolio heatmap'
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
- en: 'This heatmap is sorted by side (long/short) and relative risk-adjusted returns
    (rRAR). Numbers come alive when painted. This table could be further simplified.
    Again, the guiding principle is to display as little distraction as possible.
    Let''s note the improvements to this display:'
  id: totrans-149
  prefs: []
  type: TYPE_NORMAL
- en: First, the quantity, cost, price, and stop loss columns are hidden. They are
    important information, but not critical. Noncritical information that could otherwise
    distract is removed. If a stop loss is triggered, you need to know how many shares
    need to be traded. Until then, they are a distraction.
  id: totrans-150
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In this example, the first five columns are strictly descriptive. The number
    of shares to be traded has no additional meaning. It therefore does not require
    a paint job.
  id: totrans-151
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The other descriptive columns operate on a yellow to turquoise to purple color
    code. Side immediately shows which side of the book we are dealing with. Beta
    shows how we are axed. It looks like most of the low beta stuff is on the short
    side. The largest weights before/after are still the stocks where post adjustment
    risk remains high.
  id: totrans-152
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Everything else is color-coded with a three color pattern ranging from red to
    orange to green, indicating the health or weight of each cell. The system works.
  id: totrans-153
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Here are other visualization ideas. When building a PMS, focus on what resonates
    for you. It is your Iron Man suit. Some people like tables and work with heatmaps.
    Some people react to charts. In the next block of code, we will visualize the
    information in the form of bar charts. We will use different keys to sort the
    data to illustrate different perspectives.
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  id: totrans-155
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: There is nothing really fancy in the code except the color code. Entrust a Frenchman
    with color coding his own book and the proverbial pig will have pastel and lavender
    lipstick reminiscent of a summer Monet garden.
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
- en: 'We used three different sorting keys to display the data under three different
    perspectives:'
  id: totrans-157
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B17704_13_07.png)'
  id: totrans-158
  prefs: []
  type: TYPE_IMG
- en: 'Figure 13.7: Portfolio sorted by "rRAR"'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
- en: The sorting key is rRAR in ascending order regardless of the side. Overall,
    the first half of the chart is occupied by long positions. The tide of a bull
    market lifts all stocks. Even though the short book has not generated massive
    absolute money, it has clocked massive returns.
  id: totrans-160
  prefs: []
  type: TYPE_NORMAL
- en: 'Secondly, we sort by "Weight" and "rRAR":'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B17704_13_08.png)'
  id: totrans-162
  prefs: []
  type: TYPE_IMG
- en: 'Figure 13.8: Portfolio sorted by "Weight" and "rRAR"'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
- en: This reclassifies everything into long/short books and puts an "rRAR" perspective
    on the portfolio. The heaviest positions are the best risk-adjusted contributors,
    which is in line with this portfolio management strategy.
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
- en: '![](img/B17704_13_09.png)'
  id: totrans-165
  prefs: []
  type: TYPE_IMG
- en: 'Figure 13.9: Portfolio sorted by "Side" and "rRisk_adj"'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
- en: 'This sorts by "Side" and relative risk post-adjustment, "rRisk_adj." This produces
    a two-sided chart with the short side on the left and the long side on the right.
    Results are consistent with the strategy. Best performers have bigger weights
    and higher risk. Next, let''s look at a market participant''s favorite stalking
    tool: the watchlist.'
  id: totrans-167
  prefs: []
  type: TYPE_NORMAL
- en: 'A watchlist is inert unless it has some trading decisions embedded. We have
    all missed a few trades simply because we took our eyes off the ball. Here is
    a step-by-step method that will ensure you maintain a healthy actionable watchlist:'
  id: totrans-168
  prefs: []
  type: TYPE_NORMAL
- en: Input ticker, target levels, date of entry
  id: totrans-169
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Automate triggers: when the price reaches the target level, print the number
    of shares to be traded, else blank'
  id: totrans-170
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'Weed out stale ideas: periodically sort by date. Delete stale ideas after each
    review'
  id: totrans-171
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Sort the list once a day
  id: totrans-172
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: This semi-automated watchlist will set you apart from the competition. Market
    participants rarely take the time to formalize their plan. When everyone else
    tries to improvise while gripped by fear, you will show up with a rational plan.
  id: totrans-173
  prefs: []
  type: TYPE_NORMAL
- en: 'This process will probably take weeks if not months, depending on your level
    of formalization. A bespoke PMS will have these positive effects:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
- en: It will force you to formalize your process. If investment is a process, then
    automation is the logical conclusion. This principle has withstood the test of
    time since the dawn of the industrial revolution. The evolution of computer processing
    has reinforced it.
  id: totrans-175
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It will shed a crude light on the flaws in your process. Discretionary and semi-automated
    market participants have blind spots.
  id: totrans-176
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'It will reduce emotional interference: making decisions out of a monitoring
    screen is 100% discretionary. Running an algorithm is 100% systematic. You will
    fall somewhere along the spectrum.'
  id: totrans-177
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'It reduces stress: when all decisions run in the background and only show up
    when needed, you do not need to worry and preemptively take action.'
  id: totrans-178
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It frees up mental bandwidth to either manage more names or spend more time
    thinking. When your system is aligned with your process, you will spend less time
    worrying, in other words, consuming mental bandwidth, and more time planning.
  id: totrans-179
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: When you are an analyst or a hobby retail trader, you are a stock jockey. You
    champion a few stocks. You have some skin in the game, but you do not go to bed
    with million-dollar tickets hanging over your sleep like swords of Damocles. When
    you choose to become a portfolio manager, you are not a jockey anymore. You take
    on the responsibility of stable master. Your job is to optimize finite resources
    among all the horses in your stable. This is why you need a PMS.
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
- en: Summary
  id: totrans-181
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Investing in a PMS is the highest return on investment decision you will ever
    make. Without one, you might get lucky a few times picking the right stocks here
    and there, but nothing compares to the disciplined consistency of a robust PMS.
    You will top up winners and deal with flesh wounds before gangrene sets in and
    limits performance. You will become a more disciplined market participant. Risk
    management is not part of the business. It is the business. Portfolio managers
    are not in the business of picking stocks. They are in the business of managing
    risk with the stocks they either picked or passed. Small benefits compound over
    time and set you apart from the competition who still run around believing stock
    picking is the key to success. When your portfolio management becomes your Iron
    Man suit, you will be competing against people who think they trade a system.
  id: totrans-182
  prefs: []
  type: TYPE_NORMAL
- en: Short selling is risky. The market does not cooperate. Yet choosing not to learn
    to sell short is riskier. You may well choose never to engage in short selling,
    but regardless, learning to sell short can only enrich your repertoire. We sincerely
    hope that this book will spark a conversation about short selling. The field has
    been demonized and under-researched for too long. We hope to have given its letters
    of nobility to the discipline.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
- en: We began by dispelling myths about short selling and explaining why the long
    mindset predictably fails on the short side. We continued by looking into idea
    generation with the relative series and regime definition. It was also about position
    sizing and risk management. The final part of the book was much more than long/short
    portfolio construction. It was about designing a product that investors find attractive—uncorrelated
    low volatility returns—using a long/short vehicle.
  id: totrans-184
  prefs: []
  type: TYPE_NORMAL
- en: You will find an automated stock screening tool in *Appendix, Stock Screening*
    that we hope you will find useful!
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
