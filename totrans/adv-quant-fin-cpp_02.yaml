- en: Chapter 2. Mathematical Models
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In the previous chapter, we described the Bento Box template as a methodology
    for structuring our approach to price financial derivatives. In the context of
    the Bento Box template, this chapter corresponds to box 2—mathematical models.
    Here we review some of the key mathematical models used in the financial derivatives
    markets today to describe the behavior of the underlying. In particular, the future
    evolution of the underlying. The following are the examples of these underlyings:'
  prefs: []
  type: TYPE_NORMAL
- en: An equity or stock
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: An exchange rate
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: An interest rate
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: A credit rating
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Equity
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the equity asset class, the underlying is the price of a company stock. For
    instance, the current price of one share of Vodafone PLC (VOD.L) as quoted in
    the London Stock Exchange ([www.londonstockexchange.com](http://www.londonstockexchange.com))
    at some particular time. The price could be £2.32 and the time could be 11:33:24
    on May 13, 2013.
  prefs: []
  type: TYPE_NORMAL
- en: In mathematical terms, thus, the price of a stock can be represented as a scalar
    function of the current time *t*. We will denote this function as *S(t)*. Note
    that in technical terms, *S(t)* is a time series, which even though apparently
    continuous (with *C[0]* continuity), is in reality discontinuous (subject to jumps).
    In addition, it is not a well-behaved function, that is, its first derivative
    does not exist.
  prefs: []
  type: TYPE_NORMAL
- en: We are going to model *S(t)* as an stochastic variable. And all the constructions
    that we build around this value, such as the value of the payoff *H(S_t)* will
    be in consequence stochastic functions. In this situation, we are required not
    to use the standard tools of calculus (such as Taylor series, derivatives, Riemann
    integral), but are instead required to use the tools from stochastic calculus
    (such as Ito lemma, Radon-Nykodym derivative, Riemann-Stieltjes integral) to advance
    our modeling.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this context, the behavior of the variable *S(t)* can be described by an
    SDE. In the case of equities, the standard SDE used to describe the behavior of
    equities is called **GBM.** Under the so-called real-world probability measure
    *P*, GBM is formally represented in continuous time as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Equity](img/00011.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Equation 1
  prefs: []
  type: TYPE_NORMAL
- en: 'However, in literature, this representation is not used for the pricing of
    financial derivatives. It is substituted by the following representation under
    the risk-neutral measure *Q*:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Equity](img/00012.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Equation 2
  prefs: []
  type: TYPE_NORMAL
- en: 'In the preceding equation, we have substituted the drift ![Equity](img/00013.jpeg)
    by the risk-free rate ![Equity](img/00014.jpeg) of interest, ![Equity](img/00015.jpeg)
    is the volatility, and *dW* is the increment of a Wiener process. Equation 2 can
    be further represented as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Equity](img/00016.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: In the preceding equation, we can identify the term *dS/S* on the left hand
    side (**LHS**) of the equation as the return of the equity. Thus, the two terms
    on the right hand side (**RHS**) of the equation are a "drift term" and a "volatility
    term". Each of these terms are "scaled" by parameters ![Equity](img/00013.jpeg)
    and ![Equity](img/00017.jpeg), which are calibrated to current market prices of
    traded instruments, such as call and put options.
  prefs: []
  type: TYPE_NORMAL
- en: Note that equation 2 is the fundamental equation used to describe the underlyings
    in the word of financial derivatives.
  prefs: []
  type: TYPE_NORMAL
- en: 'For the purpose of pricing derivatives, we require to transform equation 2
    from continuous time into discrete time to model the behavior of stocks, say every
    day (![Equity](img/00018.jpeg) days, but in finance we always work in annualized
    terms, so ![Equity](img/00019.jpeg) years). We can easily approximate equation
    2 by using the Euler-Murayama discretization as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Equity](img/00020.jpeg)![Equity](img/00021.jpeg)![Equity](img/00022.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Equation 3
  prefs: []
  type: TYPE_NORMAL
- en: In the preceding equation, we approximate the differential of the Wiener process
    as the square root of delta *t* multiplied by a draw from a Gaussian distribution
    with zero mean and standard deviation 1 (*N(0,1)*). Equation 3 is a linear iterative
    equation, which we can compute by having a starting value of *S0* for a number
    of time steps *S1*, *S2*, …, *SN*. We only need the values of the parameters *r*
    and *σ*, and a Gaussian random number generator for the value of *ε*.
  prefs: []
  type: TYPE_NORMAL
- en: In order to compute the draw from the cumulative standard normal distribution,
    we will use a method called the **Box-Muller** method. The Box Muller method allows
    us to convert uniform random numbers into Gaussian random numbers. This is very
    useful because in many computer libraries we can find standard functions to generate
    random numbers from a uniform distribution (for example, function `rand()` in
    C) and through the Box Muller method, we can generate the Gaussian draws we need.
    We will discuss more about this in [Chapter 4](part0028_split_000.html#QMFO2-f9cfc61bea324a5db85ec5ea1673cdfd
    "Chapter 4. Equity Derivatives in C++"), *Equity Derivatives in C++*.
  prefs: []
  type: TYPE_NORMAL
- en: For example, imagine that we would like to simulate the behavior of the stock
    of company ABC for the next four days. The current value of the stock is 100 EUR.
    The risk-free interest rate stands at 5 percent per annum (**p.a.**), and the
    volatility is at 30 percent pa. How shall we proceed?
  prefs: []
  type: TYPE_NORMAL
- en: First we construct a time grid for the business days in which we need the values
    (note that there are 255 business days in a year). These are *t0*, *t1*, *t2*,
    *t3*, and *t4*. These correspond respectively to Monday, Tuesday, Wednesday, Thursday,
    and Friday. In finance, we always work in annualized terms and, therefore, these
    dates correspond to ![Equity](img/00023.jpeg), so *t0=0*, *t1=1/255*, *t2=2/255*,
    *t3=3/255*, and *t4=4/255*.
  prefs: []
  type: TYPE_NORMAL
- en: We then need the grid of stock prices *S(t)*. These are *S(t0)*, *S(t1)*, *S(t2)*,
    *S(t3)*, and *S(t4)*, which we will assign respectively to Monday, Tuesday, Wednesday,
    Thursday, and Friday that are represented as *S0*, *S1*, *S2*, *S3*, and *S4*.
    We already know the value of *S0*, which is the initial price (as observed today),
    that is, *S0=100* on Monday.
  prefs: []
  type: TYPE_NORMAL
- en: 'Before doing that, we will need a vector of draws from the cumulative standard
    normal distribution as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Equity](img/00024.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'We can then apply equation 3 iteratively to go from the value of Monday *S0*
    to the value of Tuesday *S1* as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Equity](img/00025.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'Alternatively, we can go from the value of Monday *S0* to the value of Tuesday
    *S1* with the numerical values as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Equity](img/00026.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'We can then calculate the values for the rest of the days as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Equity](img/00027.jpeg)![Equity](img/00028.jpeg)![Equity](img/00029.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'If we put together these set of calculated stock prices and plot them against
    time, we obtain the following graph:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Equity](img/00030.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Simulated stock prices
  prefs: []
  type: TYPE_NORMAL
- en: Foreign exchange
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the forex asset class, the underlying is the value of an exchange rate. For
    example, the current exchange rate between the euro (EUR) and the British pound
    sterling (GBP) at some particular time. The exchange rate could be *EUR/GBP =
    1.31*, meaning that £1 will be exchanged by € 1.31, and the current time could
    be 11:33:24 on May 13, 2013\.
  prefs: []
  type: TYPE_NORMAL
- en: 'Thus, in mathematical terms, the exchange rate can be represented as a function
    *X(t)*, which is a scalar function of time, just like in the case of equities.
    The exchange rate *X(t)* is thus modeled as an stochastic variable. In mathematical
    terms, the behavior of *X(t)* is described using an SDE just like in the case
    of equities. However, while for equities we used GBM, in the case of forex, we
    will use a variation that comes from the work of (Garman-Kohlhagen 1983). According
    to this model, the stochastic differential equation for exchange rates can be
    expressed as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Foreign exchange](img/00031.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Equation 4
  prefs: []
  type: TYPE_NORMAL
- en: In the preceding equation, *rd* and *rf* represent the domestic and the foreign
    risk-free interest rates. The volatility ![Foreign exchange](img/00015.jpeg) is
    a parameter calibrated to market-quoted instruments.
  prefs: []
  type: TYPE_NORMAL
- en: As we did earlier, before proceeding for the purposes of pricing derivatives,
    we require to transform equation 1 from continuous time into discrete time to
    model the behavior of exchange rates say every day (![Foreign exchange](img/00018.jpeg)
    day).
  prefs: []
  type: TYPE_NORMAL
- en: 'We again apply the Euler-Murayama discretization to equation 1 by transforming
    the differential *dX* into a difference ![Foreign exchange](img/00032.jpeg), keeping
    the constants constants *rd*, *rf*, and ![Foreign exchange](img/00015.jpeg) unchanged,
    and approximating the differential of the Wiener process as the square root of
    delta *t* multiplied by a draw from a cumulative standard normal distribution,
    as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Foreign exchange](img/00033.jpeg)![Foreign exchange](img/00034.jpeg)![Foreign
    exchange](img/00035.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Equation 5
  prefs: []
  type: TYPE_NORMAL
- en: As in the case of equation 2, equation 5 is also a linear iterative equation,
    which we can compute iteratively by having a starting value of *X0* for a number
    of time steps *X1*, *X2*, …, *XN*. We only need the values of the parameters *rd*,
    *rf*, and *sigma* and a Gaussian random number generator for the value of *epsilon*.
  prefs: []
  type: TYPE_NORMAL
- en: For example, imagine that we would like to simulate the behavior of the EUR/USD
    exchange rate for the next four days at the last quoted value of the business
    day (known as **end of day** (**EOD**)). The current value of the exchange rate
    EUR/USD is 1.33\. The domestic risk-free interest rate is 5 percent p.a. and the
    foreign risk-free interest rate is 3 percent pa, while the volatility is at 30
    percent pa. How shall we proceed?
  prefs: []
  type: TYPE_NORMAL
- en: First we construct a time grid for the business days in which we need the values
    (note that there are 255 business days in a year). These are *t0*, *t1*, *t2*,
    *t3*, and *t4*. These correspond to Monday, Tuesday, Wednesday, Thursday, and
    Friday respectively, in turn corresponding to *t0=0*, *t1=1/255*, *t2=2/255*,
    *t3=3/255*, and *t4=4/255* in annualized terms.
  prefs: []
  type: TYPE_NORMAL
- en: 'We then need the grid of EOD exchange rates *X (t)*. These are *X0*, *X1*,
    *X2*, *X3*, and *X4*. We already know the value of *X0*, which is the initial
    FX rate (as observed today), that is, *X0=1.33* on Monday. As we did earlier,
    before proceeding, we compute a vector of draws from the cumulative standard normal
    distribution to obtain the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Foreign exchange](img/00036.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'We can then apply equation 3 iteratively to go from the value of Monday *X0*
    to the value of Tuesday *X1* as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Foreign exchange](img/00037.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'Alternatively, we can go from the value of Monday *S0* to the value of Tuesday
    *S1* with the numerical values as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Foreign exchange](img/00038.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'We can then calculate the values for the rest of the days as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Foreign exchange](img/00039.jpeg)![Foreign exchange](img/00040.jpeg)![Foreign
    exchange](img/00041.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'If we put together these sets of computed rates and plot them as a function
    of time, we obtain the following graph:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Foreign exchange](img/00042.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Simulated exchange rates
  prefs: []
  type: TYPE_NORMAL
- en: Interest rates
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In the interest rate asset class, the underlying is an interest rate. Interest
    rates are quite complex. We can see this if we consider the question "what is
    the interest rate today?" The answer is certainly not simply "5 percent pa" because
    we also need to specify the maturity of the rates (*T*) we want to know. So interest
    has one more dimension than objects like equities or forex. While the currently
    observed equity value is a scalar quantity, that is, a single number, the current
    interest rate curve is a vector.
  prefs: []
  type: TYPE_NORMAL
- en: For example, let's consider the spot EURIBOR interest rates observed on May
    13, 2013 for the maturities of 1 month, 3 months, 6 months, and 12 months (as
    published by [http://www.euribor-ebf.eu/](http://www.euribor-ebf.eu/)). We denote
    these spot rates quoted by *R(t,T)* as *R(0,3M)=EURIBOR 3M = 1 percent pa*, *R(0,6M)=
    EURIBOR 6M = 2 percent pa*, *R(0,9M)=EURIBOR 9M = 3 percent pa*, and *R(0,12M)=EURIBOR
    12M = 4 percent pa*. Note that *t=0* because we consider May 13, 2013 as the current
    date.
  prefs: []
  type: TYPE_NORMAL
- en: 'How would each of these rates evolve into the future? In other words, how can
    we model *R(t,T)*? We have the following two choices reflecting the two modelling
    schools present in literature:'
  prefs: []
  type: TYPE_NORMAL
- en: Short rate models
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Market models
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The first is the oldest, while the second is more recent.
  prefs: []
  type: TYPE_NORMAL
- en: In the first model, the key modelling variable is an idealization of the interest
    rate, the so-called short rate. It is an infinitesimal interest rate *dr* that
    applies to a very short time interval. To obtain the interest rate that applies
    to a full period, we ought to add or integrate the effect of all these small interest
    rates in the period. In the second model, the key modeling variable is an actual
    quoted or market interest rate, such as LIBOR. That's why these models are called
    market models in general, and its most famous version is called **Libor Market
    Model**.
  prefs: []
  type: TYPE_NORMAL
- en: Short rate models
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In continuous time, the short rate can be represented by the following SDE
    developed by Vasicek as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Short rate models](img/00043.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Equation 6
  prefs: []
  type: TYPE_NORMAL
- en: The preceding equation is a mean reverting process. The parameter ![Short rate
    models](img/00044.jpeg) is the mean reversion level, ![Short rate models](img/00045.jpeg)
    is the speed of the mean reversion, and ![Short rate models](img/00046.jpeg) is
    the volatility. The parameters ![Short rate models](img/00044.jpeg), ![Short rate
    models](img/00045.jpeg), and ![Short rate models](img/00046.jpeg) control how
    the stochastic process behaves. The value assigned to ![Short rate models](img/00044.jpeg)
    will be long-term interest rate level to which interest rates will tend, while
    ![Short rate models](img/00045.jpeg) will control how fast interest rates return
    to the long-term mean level. The volatility ![Short rate models](img/00046.jpeg)
    controls the magnitude of the "jumps" of the process. These parameters can be
    calibrated to market-quoted instruments, such as options on interest rate swaps
    (known as **swaptions**).
  prefs: []
  type: TYPE_NORMAL
- en: 'We can approximate the Vasicek process via the Euler-Murayama methodology described
    previously to obtain a discretized version of the stochastic process, as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Short rate models](img/00047.jpeg)![Short rate models](img/00048.jpeg)![Short
    rate models](img/00049.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Equation 7
  prefs: []
  type: TYPE_NORMAL
- en: The preceding equation is a linear iterative equation, which we can compute
    iteratively by having a starting value of *r0* for a number of time steps *r1*,
    *r2*, …, *rN*. We only need the values of the parameters *theta*, *lambda*, and
    *sigma*, and a Gaussian random number generator for the value of *epsilon*.
  prefs: []
  type: TYPE_NORMAL
- en: For example, imagine that we would like to simulate the behavior of the short
    rate of interest for the next four days. The current value of the interest rate
    is 5 percent. The parameters ![Short rate models](img/00045.jpeg)= 1.0 and ![Short
    rate models](img/00044.jpeg)= 2.0, while the volatility is at 30 percent pa. How
    shall we proceed?
  prefs: []
  type: TYPE_NORMAL
- en: First we construct a time grid for the days in which we need the values. These
    are *t0*, *t1*, *t2*, *t3*, and *t4* in order to correspond to Monday (*t0*),
    Tuesday (*t1*), Wednesday (*t2*), Thursday (*t3*), and Friday (*t4*), in turn
    corresponding to *t0=0*, *t1=1/365*, *t2=2/365*, *t3=3/365*, and *t4=4/365* in
    annualized terms.
  prefs: []
  type: TYPE_NORMAL
- en: We then need the grid for the short rates *r(t)*. These are *r0*, *r1*, *r2*,
    *r3*, and *r4*. We will assign them to Monday, Tuesday, Wednesday, Thursday and
    Friday, respectively. As we already know the value of *r0*, which is the initial
    interest rate (as observed today), we have that *r0=5 percent* on Monday.
  prefs: []
  type: TYPE_NORMAL
- en: 'As we did earlier, before proceeding, we compute a vector of draws from the
    cumulative standard normal distribution to obtain the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Short rate models](img/00036.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'We can then apply equation 3 iteratively to go from the value of Monday *r0*
    to the value of Tuesday *r1* as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Short rate models](img/00050.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'Alternatively, we can go from the value of Monday *S0* to the value of Tuesday
    *S1* with the numerical values as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Short rate models](img/00050.jpeg)![Short rate models](img/00051.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'We can then calculate the values for the rest of the days as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Short rate models](img/00052.jpeg)![Short rate models](img/00053.jpeg)![Short
    rate models](img/00054.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Market models
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '**Libor Market Model** (**LMM)** is an advanced mathematical model used to
    price interest rate derivatives. Also known as the BGM model after its authors
    (Brace, Gatarek, Musiela, 1997), the LMM has become hegemonic in the financial
    markets worldwide. Literature offers a wide range of publications about the LMM,
    mostly its many variants and its complex advanced issues.'
  prefs: []
  type: TYPE_NORMAL
- en: The LMM in reality can be understood not as a single model, but rather as a
    large family of models (Rebonato 1998) and (Brigo and Mercurio 2006). Its many
    variants include the number of factors considered, the type of volatility modeling
    used, the type of correlation modeling used, whether stochastic volatility or
    SABR are used, whether forward LIBOR rates or swap rates are used, and whether
    semi-analytical or numerical solution methods are used, among others.
  prefs: []
  type: TYPE_NORMAL
- en: Our methodology and notation closely follows that of (Pelsser 2000), which,
    even though succinct, provides a clear introduction to the LMM. From all the possible
    variations of the LMM, in this work, we chose the simplest implementation—embodied
    in the use of lognormal SDEs (GBM) for the forward rates and a single Wiener process
    driving the volatility in all rates (that is, a one factor case). Under these
    conditions, we further explore the use of flat volatility.
  prefs: []
  type: TYPE_NORMAL
- en: 'We first divide the term structure of interest rates *N* in a set of forward
    rates *L* and a set of reset times *T* as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Market models](img/00055.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'Each of the preceding forward rates will have its own stochastic process driving
    them, which will result in *N* stochastic processes. Following BGM, we use Geometric
    Brownian Motion (BGM) following (Brace, Gatarek, and Musiela 1997) to describe
    each of these stochastic processes as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Market models](img/00056.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Equation 8
  prefs: []
  type: TYPE_NORMAL
- en: 'We now further simplify the model and use a single factor driving all the forward
    rates. This simplification can be later relaxed into a multifactor LMM. It can
    be shown that by choosing the last rate as a terminal measure, the drift has the
    form as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Market models](img/00057.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Note that the drift in the preceding GBM equation is a function of the forward
    rate, thus not constant but state-dependent.
  prefs: []
  type: TYPE_NORMAL
- en: 'Given the complexity of the processes in the LMM, it is not possible to obtain
    a closed-form solution for all the forward rates. This is not a problem, however,
    as robust numerical methods can be used to solve the discretized version of the
    forward rate. One important method that is widely used for market models is **Monte
    Carlo simulation**. The forward rates *Li(Tn)* are the realizations of the spot
    LIBOR rates. In each column, the forward rate *Li(Tn+1)* is updated using the
    following discretization:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Market models](img/00058.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Equation 9
  prefs: []
  type: TYPE_NORMAL
- en: 'The preceding equation, like the ones we have shown for equities and forex,
    ought to be solved iteratively using simulation. The forward rates can be arranged
    in an arithmetic table as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Market models](img/00059.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: In the preceding table, the left column represents the term structure of interest
    rates at time *t=0*. Given a set of LIBOR rates realized on this for *T1*, *T2*,
    …*TN*, we can extract the future rates that we need for simulation as the ones
    present in the main diagonal of the preceding table.
  prefs: []
  type: TYPE_NORMAL
- en: 'For example, consider the following paying fixed-for-floating **Interest Rate
    Swap** (**IRS**) with a notional of 1 million EUR. This IRS pays 5 percent every
    3 months and receives EURIBOR 3 months'' rate every 3 months. The total maturity
    of the swap is one year, given the following current term structure of interest
    rates:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Market models](img/00060.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Compute the present value of this swap using the LMM. How shall we proceed?
  prefs: []
  type: TYPE_NORMAL
- en: Term structure of spot rates of interest at *t=0* are *EURIBOR 3M = 1 percent
    pa*, *EURIBOR 6M = 2 percent pa*, *EURIBOR 9M = 3 percent pa*, and *EURIBOR 12M
    = 4 percent pa*.
  prefs: []
  type: TYPE_NORMAL
- en: 'First, we need to compute the initial forward rates by bootstrapping as observed
    from time *t=0*. We obtain this using the following equation:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Market models](img/00061.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'Then using the iterative equation 9, we compute the forward the rates into
    the future as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Market models](img/00062.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: We populate the initial forward rates in the left-most column and advance column-by-column
    to the right until we have all the values we need, as shown on the right. For
    more details on the calculation, see the book by (Pelsser 2000). Note that even
    though an IRS can be priced "statically" (that is, without simulation), we use
    this example to give an idea of what are the steps that the LMM method requires
    for calculation.
  prefs: []
  type: TYPE_NORMAL
- en: Credit
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In credit derivatives modeling, the underlying is credit risk. Modern methodologies
    of credit risk measurement can be grouped into two alternative approaches—the
    structural approach pioneered by (Merton 1974) and a reduced form approach utilizing
    intensity based models to estimate stochastic hazard rates, pioneered by various
    authors, including (Jarrow and Turnbull 1995), (Jarrow, Lando, and Turnbull 1997),
    and (Duffie and Singleton 1999).
  prefs: []
  type: TYPE_NORMAL
- en: Structural models
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The structural approach to credit risk assumes that a firm defaults when the
    market value of its assets is less than the obligations or debt it has to pay.
    Structural models are, therefore, sometimes also referred to as **asset value
    models**. These models look at a company''s balance sheet and its capital structure
    to assess its creditworthiness. However, one of the key problems with this approach
    is that the value of a company''s assets is hard to observe directly. The annual
    report only provides an accounting version of the company''s real assets and not
    their market value. For public companies, the equity is normally observable, as
    is its debt. (Merton 1974) starts with the assumption of an extremely simplified
    capital structure of the following form:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Structural models](img/00063.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Equation 10
  prefs: []
  type: TYPE_NORMAL
- en: In the preceding equation, *V* represents the value of the firm (the total of
    the assets of the firm), while *E* is its equity and *D* its debt. The equity
    *E* is understood as the total value of the equity of the firm, which is equal
    to the market value of a share (stock) multiplied by the number of shares in the
    market. For this simplified company, the debt is represented by a single zero
    coupon bond with maturity *T*.
  prefs: []
  type: TYPE_NORMAL
- en: 'At this point Merton asks the question "for a company with the preceding capital
    structure, when will it go in default?" Well, depends on our definition of default.
    If we take as default the fact that the company cannot pay its obligations at
    some specific future time *T*, then this condition will be satisfied if the value
    of the company at time *T*, that is, *V(T)* is larger than the face value of debt
    *D(T)*. At this moment in time, the bond holders will request payment and the
    company will be in position to cover it. On the contrary, if at maturity, the
    value of the firm is less than the value of the debt it has to pay, it, therefore,
    will not be able to honor its obligations and will be in default. These two scenarios
    can be defined mathematically as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Structural models](img/00064.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'What about equity holders? They are in possession of the company''s stock in
    the end. Considering the preceding two scenarios, we then know that if the company
    goes in default, they receive nothing, while if the company continues to operate,
    they receive the difference between *V(T)* and *D(T)* at maturity, thus giving
    us the following equation:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Structural models](img/00065.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'Note that the expression on the left can be written succinctly as the single
    expression on the right. The expression on the right-hand side represents the
    payoff to equity holders at maturity. Moreover, this expression has exactly the
    same form as the payoff of a European Call option with the underlying *V(t)* and
    strike *D*. Following Merton, we further assume that the dynamics of the firm
    follow a GBM as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Structural models](img/00066.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Equation 11
  prefs: []
  type: TYPE_NORMAL
- en: 'And by doing this, we establish a bridge between credit risk and the pricing
    of equity derivatives. In fact, we can now use all the results from pricing equity
    derivatives to price structural models of credit risk. Note that the volatility
    ![Structural models](img/00015.jpeg) is the firm''s assets volatility and not
    the equity volatility. The value of the assets of the firm at time *t=0* can therefore
    be calculated using the Black-Scholes formula as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Structural models](img/00067.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Equation 12
  prefs: []
  type: TYPE_NORMAL
- en: '![Structural models](img/00068.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: In equation 12, *N()* is the cumulative standard normal distribution. This is
    a useful expression when we need to calculate problems like **Initial Public Offer**
    (**IPO**) of a firm and determine, based on the characteristics of a firm, what
    should be the fair price of its equity.
  prefs: []
  type: TYPE_NORMAL
- en: For example, imagine that we have a firm that has a total value of its assets
    of 100 million USD. The risk-free interest rate is 5 percent. The volatility of
    the firm's assets is assumed to be 20 percent. And the face value of its debt
    stands at 70 million USD payable as a zero coupon bond in four years. What should
    be the fair value of its equity at time *t=0*?
  prefs: []
  type: TYPE_NORMAL
- en: 'We use the framework of structural models of credit risk and proceed as follows.
    The parameters are ![Structural models](img/00069.jpeg), ![Structural models](img/00070.jpeg),
    ![Structural models](img/00071.jpeg), ![Structural models](img/00072.jpeg), and
    ![Structural models](img/00073.jpeg). Using the preceding formula we obtain the
    following equation:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Structural models](img/00074.jpeg)![Structural models](img/00075.jpeg)![Structural
    models](img/00076.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Intensity models
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The default is a random variable tau (*τ*) that denotes the time in which the
    company will go in default. Default can be described as bankruptcy, lack of payment,
    and so on. To model the arrival risk of a credit event, we need to model an unknown
    random point in time *τ*.
  prefs: []
  type: TYPE_NORMAL
- en: 'Intensity-based models focus directly on describing the conditional probability
    of default without the definition of the exact default event. Intensity models
    are based on the concept of survival probability. It is an idea borrowed from
    actuarial and biological sciences. Survival probability is a decaying exponential
    function, which describes the probability of how long a firm or a country (sovereign)
    will survive. This can be expressed mathematically in the simplest terms as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Intensity models](img/00077.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Equation 13
  prefs: []
  type: TYPE_NORMAL
- en: 'But we want to model default, not survival. In fact, we can compute the probability
    of default in some future period *[S,T]* as shown from the current time *t*, simply
    as the difference between two consecutive survival probabilities. The probability
    of default ![Intensity models](img/00078.jpeg) in that future period then can
    be calculated using the following formula:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Intensity models](img/00079.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Equation 14
  prefs: []
  type: TYPE_NORMAL
- en: The preceding formulas are fundamental for the modeling of credit risk. With
    them, we can describe the likelihood of default, which is a probabilistic event
    that will happen in the future. The cashflows associated with this future event
    are thus contingent on the occurrence of this event. Following the classical framework
    of financial derivatives, thus credit derivatives can be understood as contingent
    claims, in which the event that triggers the future cash flow is default.
  prefs: []
  type: TYPE_NORMAL
- en: To be concrete, consider the simplified situation—we are expecting to receive
    a single cash flow from a company at some future time *T*. What is the present
    value of this cash flow?
  prefs: []
  type: TYPE_NORMAL
- en: 'If we don''t consider credit risk, the **Present Value** (**PV**) of the cash
    flow is simply the discounted **Future Value** (**FV**) of the cash flow. If the
    discount factor in the intervening time is DF, then we can write the simplest
    formula in finance, which states the following:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Intensity models](img/00080.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'We can go one step further and assuming continuous compounding with a constant
    risk-free rate *r*, we can obtain the following equation:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Intensity models](img/00081.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Equation 15
  prefs: []
  type: TYPE_NORMAL
- en: 'What happens now if we consider the credit risk of the company? The first thing
    to notice is that the cash flow is not any more certain, but it is uncertain.
    In mathematical terms, it is not any more deterministic, but it is probabilistic.
    Therefore, we ought to rewrite the previous equation. But because the future cash
    flow is unknown, it is in fact a random variable. We ought to write it as an expected
    value of this random variable as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Intensity models](img/00082.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'This expectation thus introduces a probability of FV happening or not. But
    what is this probability? The probability that the company will be there in the
    future to make the payment. In other words, the probability that the company has
    survived until then, in other words its survival probability. So we can substitute
    ![Intensity models](img/00083.jpeg) with ![Intensity models](img/00084.jpeg) in
    order to obtain the following formula:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Intensity models](img/00085.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'Furthermore, we can explicitly represent the survival probability described
    previously as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Intensity models](img/00086.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'We will receive the future cash flow only if the company is present then in
    the future (or has survived) to do it. The final expression for the present value
    of the cashflow, taking into account credit risk, is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Intensity models](img/00087.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Equation 16
  prefs: []
  type: TYPE_NORMAL
- en: This last expression is interesting as it shows that credit risk is a form of
    "spread" that is added to the risk free rate that we normally use to discount
    future cashflows.
  prefs: []
  type: TYPE_NORMAL
- en: For example, imagine that we expect to receive 1 million USD from a counterparty
    that has a credit risk, quantified by its hazard rate, of ![Intensity models](img/00088.jpeg).
    Assuming that the risk-free interest rate ![Intensity models](img/00089.jpeg),
    compute the present value of the cash flow firstly, without credit risk and secondly,
    with credit risk. Assume continuous time discounting. Assume that the recovery
    rate is ![Intensity models](img/00090.jpeg). How shall we proceed?
  prefs: []
  type: TYPE_NORMAL
- en: 'By applying the preceding formulas, we obtain that without credit risk, the
    *PV* is as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Intensity models](img/00081.jpeg)![Intensity models](img/00091.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'Now, if we consider the credit risk, we have the *PV* as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Intensity models](img/00087.jpeg)![Intensity models](img/00092.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Note that the second cash flow is smaller than the first. The effect of the
    credit risk is to view the value of the cash flow today (its *PV*) as reduced
    because not being certain, it has to be multiplied by the chance that it happens
    (that is, its survival probability).
  prefs: []
  type: TYPE_NORMAL
- en: 'In the previous analysis, we have assumed that when default occurs, all of
    the future cash flow FV will be lost. However, in most real situations, some fraction
    of money is recovered. If we define this fraction as the recovery rate *R*, the
    present value *PV* of the risky future cash flow is still the same, as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Intensity models](img/00082.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'But the expectation is now resolved in terms of two possible states, default
    or no default, and each of them is multiplied by its respective probabilities,
    as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Intensity models](img/00093.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: 'In the preceding equation, we have taken into account the recovery rate *R*
    in the case of default. The present value of the risky cash flow *PV* is now as
    follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '![Intensity models](img/00094.jpeg)'
  prefs: []
  type: TYPE_IMG
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: This chapter gave an overview of the fundamental models used to price derivatives
    in the modern financial markets. We will now take these models as basis to model
    the underlying of the various asset classes we reviewed and apply a number of
    numerical methods to implement their calculations efficiently in a computer.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will concentrate on numerical methods.
  prefs: []
  type: TYPE_NORMAL
