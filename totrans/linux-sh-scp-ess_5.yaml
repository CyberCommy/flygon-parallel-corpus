- en: Chapter 5. Customizing the Environment
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In a default system, we get certain settings that are preconfigured. As time
    progresses, we often feel the need to modify some of the default settings provided.
    Similar needs arise when we are working in a shell to get things done, for example,
    modifying the environment according to the needs of the application. Some of the
    features are so irresistible that we may need them every time, for example, the
    editor of our choice used by an application. While working on an important task,
    it may happen that we forget a command that we used a few days ago. In such cases,
    we try to recall that command as soon as possible to get work done. If we can't
    remember, we consume time and effort searching on the Internet or in text books
    for the exact command and syntax.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
- en: In this chapter, we will see how, by adding or changing the existing environment
    variables, we can modify the environment as per our application needs. We will
    also see how a user can modify the `.bashrc`, `.bash_profile`, and `.bash_logout`
    files to make the setting changes available permanently. We will see how we can
    search and modify the history of previously executed commands. We will also see
    how to run multiple tasks from a single shell and manage them together.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
- en: 'This chapter will cover the following topics in detail:'
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
- en: Knowing the default environment
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Modifying the shell environment
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Using bash startup files
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Knowing your history
  id: totrans-7
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Managing tasks
  id: totrans-8
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Knowing the default environment
  id: totrans-9
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Setting up a proper environment is very important for running a process. An
    environment consists of environment variables that may or may not have a default
    value set. The required environment is set by modifying the existing environment
    variables or creating new environment variables. Environment variables are exported
    variables that are available to the current process and also its child processes.
    In [Chapter 1](ch01.html "Chapter 1. The Beginning of the Scripting Journey"),
    *The Beginning of the Scripting Journey*, we learned about some of the builtin
    shell variables that can be used in our application as environment variables to
    set the environment.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
- en: Viewing a shell environment
  id: totrans-11
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To view the current environment in the shell, we can use the `printenv` or `env`
    commands. Environment variables may have no value, a single value, or a multiple
    value set. If multiple values exist, each value is separated by a colon (:).
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
- en: printenv
  id: totrans-13
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'We can use `printenv` to print the value associated with a given environment
    variable. The syntax is as follows:'
  id: totrans-14
  prefs: []
  type: TYPE_NORMAL
- en: '`$ printenv [VARIABLE]`'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
- en: 'Consider the following as examples:'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  id: totrans-17
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'If no `VARIABLE` is specified, `printenv` prints all environment variables
    as follows:'
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  id: totrans-19
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: env
  id: totrans-20
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'We can also use the `env` command to view environment variables as follows:'
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  id: totrans-22
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: This displays all environment variables defined for a given shell.
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
- en: Note
  id: totrans-24
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: To view value(s) of a specific environment variable, the `echo` command can
    also be used followed by an environment variable name prefixed with a dollar symbol
    (`$`). For example, `echo $SHELL`.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
- en: Differences between shell and environment variables
  id: totrans-26
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Both shell and environment variables are variables that are accessible and
    set for a given shell that may be used by an application or a command running
    in that shell. However, there are a few differences between them, which are set
    out in the following table:'
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
- en: '| Shell variables | Environment variables |'
  id: totrans-28
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-29
  prefs: []
  type: TYPE_TB
- en: '| Both local and exported variables are shell variables | Exported shell variables
    are environment variables |'
  id: totrans-30
  prefs: []
  type: TYPE_TB
- en: '| The `set builtin` command is used to see the name and corresponding value
    of a shell variable | The `env` or `printenv` command is used to see the name
    and corresponding value of an environment variable |'
  id: totrans-31
  prefs: []
  type: TYPE_TB
- en: '| Local shell variables are not available for use by their child shells | Child
    shells inherit all environment variables present in the parent shell |'
  id: totrans-32
  prefs: []
  type: TYPE_TB
- en: '| A shell variable is created by specifying a variable name on the left and
    value(s) separated by a colon (:) on the right-hand side of an equal operator
    (=) | An environment variable can be created by prefixing an export shell built
    - in command to the existing shell variable, or while creating a new shell variable
    |'
  id: totrans-33
  prefs: []
  type: TYPE_TB
- en: Modifying a shell environment
  id: totrans-34
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: When a new shell is launched, it has the initial environment set that will be
    used by any application or command that gets executed in a given shell. We now
    know that the `env` or `setenv` shell builtin command can be used to view which
    environment variables are set for this shell. The shell also provides the capability
    to modify the current environment. We can also modify the current bash environment
    by creating, modifying, or deleting environment variables.
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
- en: Creating environment variables
  id: totrans-36
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: To create a new environment variable in a shell, the `export` shell builtin
    command is used.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
- en: 'For example, we will create a new environment variable `ENV_VAR1`:'
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  id: totrans-39
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'A new environment variable with the name `ENV_VAR1` is created. To view a new
    environment variable, we can call the `printenv` or `env` command:'
  id: totrans-40
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  id: totrans-41
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'We can also use the `echo` command to print the value of an environment variable:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'A local shell variable can also be exported further as an environment variable.
    As an example, we will create the `ENV_VAR2` and `LOCAL_VAR1` variables:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'No environment variable is found with the name `ENV_VAR2`. This is because
    while creating `ENV_VAR2`, it wasn''t exported. Therefore, it will be created
    as a local variable of a shell:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Now, to make the `ENV_VAR2` shell variable as an environment variable, we can
    use the export command:'
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: The variable `LOCAL_VAR1` is not an environment variable.
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
- en: 'One of the important features of environment variables is that it is available
    to all of its child shells. We can see this in the following example:'
  id: totrans-51
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  id: totrans-52
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: We can see that the environment variables from a parent shell got inherited
    by a child shell—for example, `ENV_VAR1`, `ENV_VAR2`—while the local variable,
    such as `LOCAL_VAR1`, remains available only to a shell in which the variable
    was created.
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
- en: Modifying environment variables
  id: totrans-54
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'Shell provides flexibility for modifying any existing environment variable.
    For example, consider the `HOME` environment variable. By default, the `HOME`
    environment variable contains the path of the current logged in user''s home directory:'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  id: totrans-56
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: 'Now, we will modify the `HOME` environment variable value to `/tmp`:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: 'We can also append a value to an environment variable. To do this, make sure
    the new value is separated with a colon (`:`). For example, consider the `PATH`
    environment variable:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'Now, we want to add a new path to the `PATH` variable—for example, `/home/foo/projects/bin`—so
    that, while looking for a program or command, the shell can search the specified
    path too. To append a path to the `PATH` environment variable, use a colon (:)
    followed with a new path name:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: We can see that the new path has been appended to the existing values of the
    `PATH` variable.
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
- en: We can also append multiple values to an environment variable; for that, each
    value should be separated by a colon (`:`).
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
- en: 'For example, we will add two more application paths to the `PATH` variable:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: The two new paths, `/home/foo/project1/bin` and `/home/foo/project2/bin`, have
    been added to the `PATH` variable.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
- en: Deleting environment variables
  id: totrans-68
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: We can delete or reset a value of an environment variable using the `unset`
    shell builtin command.
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
- en: 'For example, we will create an environment variable called `ENV1`:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: 'The environment variable `ENV1` gets deleted by the `unset` command. Now, to
    reset an environment variable, assign it a blank value:'
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  id: totrans-73
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: Using bash startup files
  id: totrans-74
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Until now, to perform a task or set anything for a given shell, we had to execute
    the needed commands in a shell. One of the main limitations to this approach is
    that the same configuration won't be available in a new shell. In a lot of cases,
    a user may want that whenever he or she launches a new shell, whereas instead
    a new customized configuration on top of the default configuration is available
    for use. For customizing bash, three files are available in a user's home directory
    that get executed by default whenever a user launches a new bash. These files
    are `bashrc`, `.bash_profile`, and `.bash_logout`.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
- en: .bashrc
  id: totrans-76
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: In a graphical system, mostly a non-login shell is used by a user. To run a
    non-login shell, we don't need the login credentials. Starting a shell in a graphical
    system provides a non-login shell. When a bash is invoked in non-login mode, the
    `~/.bashrc` file is invoked and the configuration available in it is executed
    and applied in any bash shell being launched. Settings that are needed in both
    the login and non-login shell are kept in the `~/.bashrc` file.
  id: totrans-77
  prefs: []
  type: TYPE_NORMAL
- en: 'For example, on a Fedora 22 system default, the `~/.bashrc` file looks as follows:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  id: totrans-79
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Any addition done in `~/.bashrc` will be reflected only to the current user's
    bash shell. We can see that the `.bashrc` file also checks whether the `etc/bashrc`
    file is available. If available, that gets executed too. The `/etc/bashrc` file
    contains configuration applied to a bash shell for all users—that is, systemwide.
    Sysadmin can modify the `/etc/bashrc` file if any configuration needs to be applied
    to all users' bash shells.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
- en: 'The file `/etc/bashrc` also looks into the script files available in `/etc/profile.d`,
    which can be confirmed by the following code snippet taken from the `/etc/bashrc`
    file:'
  id: totrans-81
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  id: totrans-82
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: 'The following example shows a modified `.bashrc` file. Name this file `custom_bashrc`:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: The `LD_LIBRARY_PATH` environment variable is used to give the runtime shared
    library loader (`ld.so`) an extra set of directories to look for when searching
    for shared libraries. You can learn more about the shared library at [http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html](http://tldp.org/HOWTO/Program-Library-HOWTO/shared-libraries.html).
  id: totrans-85
  prefs: []
  type: TYPE_NORMAL
- en: 'Make a backup of your original `~/.bashrc` file before modifying it:'
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE20]'
  id: totrans-87
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'Now, copy the `custom_bashrc` file to `~/.bashrc`:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE21]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'To apply modified settings, open a new bash shell. To apply a new `.bashrc`
    in the same bash shell, you can source into a new `~/.bashrc` file:'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE22]'
  id: totrans-91
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'We can check whether the new settings are available or not:'
  id: totrans-92
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE23]'
  id: totrans-93
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: '[PRE24]'
  id: totrans-94
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: '[PRE25]'
  id: totrans-95
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: '[PRE26]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: The `alias` command displays aliases that we added in `.bashrc`—that is, `rm`,
    `cp`, `df`, and `ll`.
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
- en: 'Now, call the `current_directory_size()`function that we added in `.bashrc`:'
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE27]'
  id: totrans-99
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'Make sure to move back the original `.bashrc` file whose backup we created
    at the beginning of this example, and source into it to get the settings reflected
    in the current shell session. This is required if you don''t want any of the configuration
    changes that we did while playing out the preceding example:'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE28]'
  id: totrans-101
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: Note
  id: totrans-102
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: When bash is invoked as a non-login shell, it loads the configuration available
    in the `~/.bashrc`, `/etc/bashrc`, and `/etc/profile.d/*.sh` files.
  id: totrans-103
  prefs: []
  type: TYPE_NORMAL
- en: .bash_profile
  id: totrans-104
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'In a non-graphical system, after a successful login, the user gets a shell.
    Such a shell is called a login shell. When a bash is invoked as a login shell,
    first the `/etc/profile` file gets executed; this runs the script available in
    `/etc/profile.d/` as well. The following code snippet taken from `/etc/profile`
    also mentions this:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE29]'
  id: totrans-106
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'These are global settings applied to any user''s login shell. Furthermore,
    `~/.bash_profile` gets executed for a login shell. On a Fedora 22 system, the
    default content of the `~/.bash_profile` file looks as follows:'
  id: totrans-107
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE30]'
  id: totrans-108
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: From the contents, we can see that it looks for the `.bashrc` file in a user's
    home directory. If the `.bashrc` file is available in a home directory, it gets
    executed. We also know that the `~/.bashrc` file executes the `/etc/bashrc` file
    as well. Next, we see that `.bash_profile` appends the `PATH` variable with the
    `$HOME/.local/bin` and `$HOME/bin` values. Furthermore, the modified `PATH` variable
    is exported as an environment variable.
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
- en: A user can modify the `~/.bash_profile` file as per his/her customized configuration
    needs, such as default shell, editor for login shell, and so on.
  id: totrans-110
  prefs: []
  type: TYPE_NORMAL
- en: 'The following example contains a modified configuration in `.bash_profile`.
    We will use `bash_profile` as its filename:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE31]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'Changes are made after the **Added configuration by us** comment. Before we
    apply this new configuration to `~/.bash_profile`, we will first make a backup
    of the original file. This will help us in restoring the original content of the
    `.bash_profile` file:'
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE32]'
  id: totrans-114
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: 'A new file `.bash_profile.bak` will be created in the `home` directory. Now,
    we will copy our new configuration to `~/.bash_profile`:'
  id: totrans-115
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE33]'
  id: totrans-116
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'To see the reflected changes in a login shell, we can either login as a non-graphical
    interface or just perform `ssh` into the same machine to run a login shell. SSH
    (Secure Shell) is a cryptographic network protocol for initiating text-based shell
    sessions on remote machines in a secure way. In UNIX and Linux-based systems,
    SSH to a local or remote machine can be done using the `ssh` command. The `man`
    page of `ssh` (`man ssh`) shows all the capabilities provided by it. To do a remote
    login on the same machine, we can run `ssh username@localhost`:'
  id: totrans-117
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE34]'
  id: totrans-118
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: '[PRE35]'
  id: totrans-119
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'We can see that all the details added by us are printed in a login shell. Another
    way to quickly test our new `.bash_profile` is by doing source to it:'
  id: totrans-120
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE36]'
  id: totrans-121
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: '[PRE37]'
  id: totrans-122
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'To reset changes done in the `~/.bash_profile` file, copy from the `~/.bash_profile.bak`
    file that we created at the beginning of this example and source into it to get
    the changes reflected in the current shell:'
  id: totrans-123
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE38]'
  id: totrans-124
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: Note
  id: totrans-125
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: When bash is invoked as a login shell, it loads the configuration available
    in the `/etc/profile`, `/etc/profile.d/*.sh`, `~/.bash_profile`, `.~/.bashrc`,
    and `~/etc/bashrc` files.
  id: totrans-126
  prefs: []
  type: TYPE_NORMAL
- en: .bash_logout
  id: totrans-127
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: The `.bash_logout` file present in a user's home directory gets executed every
    time a login shell exits. This is useful when a user has logged in remotely or
    has a non-graphical interface. A user can add clean-up tasks to be performed before
    he/she logs off from a system. A clean-up task may include removing the temporary
    files created, clearing environment variables, logging off important data, archiving
    or encrypting certain tasks, uploading onto the Web, and so on.
  id: totrans-128
  prefs: []
  type: TYPE_NORMAL
- en: Knowing your history
  id: totrans-129
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: Shells provide an interesting feature that allows you to find out the history
    of all commands you have executed previously in a shell. It often happens that
    we forget what command was typed on the previous day to perform a task. We may
    or may not be able to recall the exact syntax, but it is very convenient that
    we can refer to the history saved by the shell.
  id: totrans-130
  prefs: []
  type: TYPE_NORMAL
- en: Shell variables controlling the history
  id: totrans-131
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'There are shell variables that can be altered to change what and how much history
    a user can see. These shell variables are mentioned in the following table:'
  id: totrans-132
  prefs: []
  type: TYPE_NORMAL
- en: '| Name | Value |'
  id: totrans-133
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-134
  prefs: []
  type: TYPE_TB
- en: '| HISTFILE | Name of file in which by default history will be saved |'
  id: totrans-135
  prefs: []
  type: TYPE_TB
- en: '| HISTFILESIZE | Number of commands to be kept in history file |'
  id: totrans-136
  prefs: []
  type: TYPE_TB
- en: '| HISTSIZE | Number of history to be stored in memory for current session |'
  id: totrans-137
  prefs: []
  type: TYPE_TB
- en: '| HISTCONTROL | A colon-separated list of values controlling how commands are
    saved on the history list |'
  id: totrans-138
  prefs: []
  type: TYPE_TB
- en: 'The value of the `HISTCONTROL` shell variable can be:'
  id: totrans-139
  prefs: []
  type: TYPE_NORMAL
- en: '| Value | Description |'
  id: totrans-140
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-141
  prefs: []
  type: TYPE_TB
- en: '| ignorespace | Lines which starts with a blank space, doesn''t save in history
    list |'
  id: totrans-142
  prefs: []
  type: TYPE_TB
- en: '| ignoredups | Don''t save lines which matches in previous saved history list
    |'
  id: totrans-143
  prefs: []
  type: TYPE_TB
- en: '| ignoreboth | Applies both ignorespace and ignoredups |'
  id: totrans-144
  prefs: []
  type: TYPE_TB
- en: '| erasedups | Remove all previous lines from history matching current line
    before saving it in history file |'
  id: totrans-145
  prefs: []
  type: TYPE_TB
- en: 'Let''s see what values these shell variables may contain:'
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE39]'
  id: totrans-147
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: From the value obtained, we can see that the default history is saved into the
    `.bash_history` file of a user's `home` directory, with the maximum history command
    lines saved as 1000\. Also, any duplicate history that is already present in the
    previous history line isn't saved.
  id: totrans-148
  prefs: []
  type: TYPE_NORMAL
- en: The history builtin command
  id: totrans-149
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Shells provide the `history` builtin command so that a user will know the history
    of commands executed up to now.
  id: totrans-150
  prefs: []
  type: TYPE_NORMAL
- en: 'Running the history without any options, prints all the previously typed commands
    on `stdout`. The sequence of commands are provided oldest to latest as we go from
    top to bottom of the output:'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE40]'
  id: totrans-152
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: '![The history builtin command](img/4335_05_01.jpg)'
  id: totrans-153
  prefs: []
  type: TYPE_IMG
- en: 'The following table explains the options available with the `history` shell
    built - in command:'
  id: totrans-154
  prefs: []
  type: TYPE_NORMAL
- en: '| Option | Description |'
  id: totrans-155
  prefs: []
  type: TYPE_TB
- en: '| --- | --- |'
  id: totrans-156
  prefs: []
  type: TYPE_TB
- en: '| -a | Append the new history lines into history immediately |'
  id: totrans-157
  prefs: []
  type: TYPE_TB
- en: '| -c | Clears history from current list |'
  id: totrans-158
  prefs: []
  type: TYPE_TB
- en: '| -d offset | Deletes history from offset specified |'
  id: totrans-159
  prefs: []
  type: TYPE_TB
- en: '| -r | Append the content of saved history to current list |'
  id: totrans-160
  prefs: []
  type: TYPE_TB
- en: '| -w | Write the current history list to the history file after overwriting
    existing saved history contents |'
  id: totrans-161
  prefs: []
  type: TYPE_TB
- en: 'To see the last five commands executed, we can also perform the following commands:'
  id: totrans-162
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE41]'
  id: totrans-163
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: 'We will find that all the commands executed match a given string from the history
    file. For example, search for commands having the `set` string in them:'
  id: totrans-164
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE42]'
  id: totrans-165
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: 'To clear all the history of commands saved and to append the history available
    in the current list, we can do the following (don''t run the following commands
    if you don''t want to loose the saved command history):'
  id: totrans-166
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE43]'
  id: totrans-167
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: Modifying the default history behavior
  id: totrans-168
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: By default, shell has some values set for managing the history. In the previous
    section, we saw that a maximum of 1000 lines of history will be stored in the
    history file. If a user spends most of his time working with a shell, he may have
    used 1000 or above commands in one or two days. In such a case, he will not be
    able to look at the history if he has typed a command ten days ago. Depending
    upon the individual use-case, a user can modify the number of lines to be stored
    in the history file.
  id: totrans-169
  prefs: []
  type: TYPE_NORMAL
- en: 'Executing the following command will set the maximum number of lines the history
    file may have to `100000`:'
  id: totrans-170
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE44]'
  id: totrans-171
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: 'Similarly, we can change where the history file should be saved. We saw that,
    by default, it is saved in the `.bash_history` file in the `home` directory. We
    can modify the `HISTFILE` shell variable and set it to whatever location we want
    our command history to be saved to:'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE45]'
  id: totrans-173
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: Now the executed command history will be saved in the `customized_history_path`
    file in the home directory instead of the `~/.bash_history` file.
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
- en: To make these changes reflect to all the shells being launched by a user and
    for all sessions, add these modifications to the `~/.bashrc` file.
  id: totrans-175
  prefs: []
  type: TYPE_NORMAL
- en: Handy shortcuts for seeing the history
  id: totrans-176
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Depending upon a user's history size setting, the number of commands available
    in the history may be large. If a user wants to look for a specific command, he
    or she will have to look through the entire history, which can sometimes be troublesome.
    Shells provide some shortcuts to help us find a specific command previously executed.
    Knowledge of these shortcuts can save time in finding previously executed commands
    in the history.
  id: totrans-177
  prefs: []
  type: TYPE_NORMAL
- en: '[Ctrl + r]'
  id: totrans-178
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'While working in a shell, the [*Ctrl* + *r*] shortcut allows you to search
    for a command in the history. Start typing a command after pressing [*Ctrl* +
    *r*]; the shell shows a complete command that matches the substring of the command
    typed. To move forward to the next match, type [*Ctrl* + *r*] on the keyboard
    again and so on:'
  id: totrans-179
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE46]'
  id: totrans-180
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: We can see that typing `his`, suggested from history `man history` that we previously
    typed.
  id: totrans-181
  prefs: []
  type: TYPE_NORMAL
- en: Up and down arrow key
  id: totrans-182
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The up and down arrow keys available on the keyboard can be used to go back
    and forward in the history of commands previously executed by the user. For example,
    to get the previous command, press the up arrow key once. To go back even further,
    press the up arrow key again and so on. Further, to go forward in the history
    use the down arrow key.
  id: totrans-183
  prefs: []
  type: TYPE_NORMAL
- en: '!!'
  id: totrans-184
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The shortcut `!!` can be used to reexecute the last command executed in the
    shell:'
  id: totrans-185
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE47]'
  id: totrans-186
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: '!(search_string)'
  id: totrans-187
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'This shortcut executes the last command starting with `search_string`:'
  id: totrans-188
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE48]'
  id: totrans-189
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: '!?(search_string)'
  id: totrans-190
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'This shortcut executes the last command found with the substring `search_string`:'
  id: totrans-191
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE49]'
  id: totrans-192
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: Task management
  id: totrans-193
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: When an application runs, it is possible that it will run for a long period
    of time or run until the computer shuts down. While running an application in
    a shell, we know that a shell prompt only comes back when running a program in
    the shell completes successfully or terminates due to some error. Unless we get
    a shell prompt back, we can't run another command in the same shell. We can't
    even close that shell because it will close the running process.
  id: totrans-194
  prefs: []
  type: TYPE_NORMAL
- en: Also, to run another application, we will have to open another shell in a new
    terminal and then run it. It can become difficult and tedious to manage if we
    have to run a lot of tasks. Shells provide ways to run a task in the background
    and suspend, kill, or move back in the foreground.
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
- en: Running tasks in the background
  id: totrans-196
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: A task can be started as a background in a shell by appending an ampersand (&).
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
- en: For example, we want to search for a string in the entire filesystem. Depending
    upon the filesystem's size and the number of files, it may take a lot of time.
    We can call the `grep` command to search for a string and save the result in a
    file. A filesystem hierarchy in Linux starts from the root('`/`').
  id: totrans-198
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE50]'
  id: totrans-199
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: Here, the `grep` searches for a string in the entire filesystem, sends any error
    message to `/dev/null`, and saves the search result into the `out1.txt` file.
    An ampersand (&) at the end sends the entire job to the background, prints PID
    of the started task, and returns back the shell prompt.
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
- en: Now, we can do other work in the same opened shell and perform other tasks.
  id: totrans-201
  prefs: []
  type: TYPE_NORMAL
- en: Sending a running task to the background
  id: totrans-202
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: It often happens that we run a task in a shell normally—that is, as a foreground
    task—but later we want to move it to the background. It is possible to do this
    by first suspending the current task using [*Ctrl* + *z*] and then using `bg`
    to move the task to the background.
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
- en: 'Consider the last text search as an example. We start a search normally as
    follows:'
  id: totrans-204
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE51]'
  id: totrans-205
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: 'We will not see anything happening on the shell and we will just keep waiting
    for a shell prompt to return. Alternatively, we can suspend the running job using
    [Ctrl + z]:'
  id: totrans-206
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE52]'
  id: totrans-207
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: 'Then, to send a suspended task to continue running in the background, use the
    `bg` command:'
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE53]'
  id: totrans-209
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: Listing background tasks
  id: totrans-210
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'To find out which tasks are running in the background or suspended in the current
    shell, `jobs` shell built - in is used as follows:'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE54]'
  id: totrans-212
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: '[PRE55]'
  id: totrans-213
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: Here, index [1] and [2] are job numbers.
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
- en: The character '`+`' identifies the job that would be used as a default by the
    `fg` or `bg` command, and the character '`-`' identifies the job that would become
    a default if the current default job exits or terminates.
  id: totrans-215
  prefs: []
  type: TYPE_NORMAL
- en: 'Create another task and suspend it using the following commands:'
  id: totrans-216
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE56]'
  id: totrans-217
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: 'To view PID of all background and suspended tasks, we can use the `–p` option:'
  id: totrans-218
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE57]'
  id: totrans-219
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: '[PRE58]'
  id: totrans-220
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: 'PID of jobs is in sequence. To view only the tasks running in the background,
    the `-r` option is used as follows:'
  id: totrans-221
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE59]'
  id: totrans-222
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: '[PRE60]'
  id: totrans-223
  prefs: []
  type: TYPE_PRE
  zh: '[PRE60]'
- en: 'To view only the suspended tasks, the `-s` option is used as follows:'
  id: totrans-224
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE61]'
  id: totrans-225
  prefs: []
  type: TYPE_PRE
  zh: '[PRE61]'
- en: '[PRE62]'
  id: totrans-226
  prefs: []
  type: TYPE_PRE
  zh: '[PRE62]'
- en: 'To view a particular index job, use an index number with the `jobs` command:'
  id: totrans-227
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE63]'
  id: totrans-228
  prefs: []
  type: TYPE_PRE
  zh: '[PRE63]'
- en: '[PRE64]'
  id: totrans-229
  prefs: []
  type: TYPE_PRE
  zh: '[PRE64]'
- en: Moving tasks to the foreground
  id: totrans-230
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'We can move a background or suspended task to the foreground using the shell
    built - in command `fg`:'
  id: totrans-231
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE65]'
  id: totrans-232
  prefs: []
  type: TYPE_PRE
  zh: '[PRE65]'
- en: '[PRE66]'
  id: totrans-233
  prefs: []
  type: TYPE_PRE
  zh: '[PRE66]'
- en: 'The character ''`+`'' is mentioned in the job index `3`. This means, running
    the `fg` command will run the third job in the foreground:'
  id: totrans-234
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE67]'
  id: totrans-235
  prefs: []
  type: TYPE_PRE
  zh: '[PRE67]'
- en: 'The following command suspends the third task:'
  id: totrans-236
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE68]'
  id: totrans-237
  prefs: []
  type: TYPE_PRE
  zh: '[PRE68]'
- en: 'To move a particular job to the foreground, use `fg` with a task index number:'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 要将特定作业移到前台，请使用带有任务索引号的`fg`：
- en: '[PRE69]'
  id: totrans-239
  prefs: []
  type: TYPE_PRE
  zh: '[PRE69]'
- en: Terminating tasks
  id: totrans-240
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 终止任务
- en: 'We can also delete a running or suspended task if it''s no longer needed. This
    can be done by using the `disown` shell built - in command:'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 如果不再需要，我们也可以删除运行中或挂起的任务。这可以通过使用`disown` shell内置命令来完成：
- en: '[PRE70]'
  id: totrans-242
  prefs: []
  type: TYPE_PRE
  zh: '[PRE70]'
- en: '[PRE71]'
  id: totrans-243
  prefs: []
  type: TYPE_PRE
  zh: '[PRE71]'
- en: 'Using `disown` without any option, deletes a task that has the character ''`+`''
    mentioned with a task:'
  id: totrans-244
  prefs: []
  type: TYPE_NORMAL
  zh: 使用`disown`而不带任何选项，会删除具有字符'`+`'的任务：
- en: '[PRE72]'
  id: totrans-245
  prefs: []
  type: TYPE_PRE
  zh: '[PRE72]'
- en: '[PRE73]'
  id: totrans-246
  prefs: []
  type: TYPE_PRE
  zh: '[PRE73]'
- en: 'To delete running tasks, the `-r` option is used:'
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 要删除运行中的任务，使用`-r`选项：
- en: '[PRE74]'
  id: totrans-248
  prefs: []
  type: TYPE_PRE
  zh: '[PRE74]'
- en: 'To remove all tasks, the `-a` option is used as follows:'
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: 要删除所有任务，使用`-a`选项如下：
- en: '[PRE75]'
  id: totrans-250
  prefs: []
  type: TYPE_PRE
  zh: '[PRE75]'
- en: The output of `jobs` shows nothing because all the suspended and running tasks
    got deleted by the `-a` option.
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: '`jobs`的输出什么也不显示，因为所有挂起和运行中的任务都被`-a`选项删除了。'
- en: Summary
  id: totrans-252
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 总结
- en: After reading this chapter, you now know how to create and modify environment
    variables in a shell. You also know how `.bashrc` and `.bash_profile` help in
    making changes that are available permanently for all sessions of a user. You
    learned how to search the history of commands that we have previously executed
    and also how to run and manage different tasks in a shell by using the `fg` and
    `bg` shell built - in commands.
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 阅读完本章后，您现在知道如何在shell中创建和修改环境变量。您还知道`.bashrc`和`.bash_profile`如何帮助永久地为用户的所有会话进行更改。您学会了如何搜索我们先前执行的命令的历史记录，以及如何使用`fg`和`bg`
    shell内置命令在shell中运行和管理不同的任务。
- en: In the next chapter, we will see what important types of files are available
    on Linux-based systems and what operations can be performed on them to get meaningful
    results.
  id: totrans-254
  prefs: []
  type: TYPE_NORMAL
  zh: 在下一章中，我们将看到在基于Linux的系统上有哪些重要类型的文件，以及可以对它们执行哪些操作以获得有意义的结果。
