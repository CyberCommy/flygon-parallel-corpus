- en: Chapter 11. Using AJAX with Django
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: AJAX is an acronym for Asynchronous JavaScript and XML. This technology allows
    a browser to asynchronously communicate with the server using JavaScript. Refreshing
    the web page is not necessarily required to perform an action on the server.
  prefs: []
  type: TYPE_NORMAL
- en: Many web applications have been released that run on AJAX. A web application
    is often described as a website containing only one page and which performs all
    operations with an AJAX server.
  prefs: []
  type: TYPE_NORMAL
- en: If you are not using a library, using AJAX requires a lot of lines of code to
    be compatible with several browsers. When including jQuery, it is possible to
    make easy AJAX requests while at the same time being compatible with many browsers.
  prefs: []
  type: TYPE_NORMAL
- en: 'In this chapter, we will cover:'
  prefs: []
  type: TYPE_NORMAL
- en: Working with JQuery
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: JQuery basics
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Working with AJAX in the task manager
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Working with jQuery
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: jQuery is a JavaScript library designed to effectively manipulate the DOM of
    the HTML page. The **DOM** (**Document Object Model**) is the internal structure
    of the HTML code, and jQuery greatly simplifies the handling.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following are some advantages of jQuery:'
  prefs: []
  type: TYPE_NORMAL
- en: DOM manipulation is possible with CSS 1-3 selectors
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It integrates AJAX
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: It is possible to animate the page with visual effects
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Good documentation with numerous examples
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Many libraries have been created around jQuery
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: jQuery basics
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we use jQuery to make AJAX requests. Before using jQuery, let's
    understand its basics.
  prefs: []
  type: TYPE_NORMAL
- en: CSS selectors in jQuery
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'CSS selectors used in style sheets can effectively retrieve an item with very
    little code. This is a feature that is so interesting that it is implemented in
    the HTML5 Selector API with the following syntax:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'jQuery also allows us to use CSS selectors. To do the same thing with jQuery,
    you must use the following syntax:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: At the moment, it is better to use jQuery than the Selector API because jQuery
    1.x.x guarantees great compatibility with older browsers.
  prefs: []
  type: TYPE_NORMAL
- en: Getting back the HTML content
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'It is possible to get back the HTML code between two tags with the `html()`
    method:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: This line will display an alert with the HTML content of the `<div id="div_1">`
    tag. Concerning the input and textarea tags, it is possible to recover their content
    in the same way as with the `val()` method.
  prefs: []
  type: TYPE_NORMAL
- en: Setting HTML content in an element
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: Changing the content of a tag is very simple because we're using the same method
    as the one we used for recovery. The main difference between the two is that we
    will send a parameter to the method.
  prefs: []
  type: TYPE_NORMAL
- en: 'Thus, the following instruction will add a button in the div tag:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: Looping elements
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'jQuery also allows us to loop all the elements that match a selector. To do
    this, you must use the `each()` method as shown in the following example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: Importing the jQuery library
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'To use jQuery, you must first import the library. There are two ways to add
    jQuery to a web page. Each method has its own advantages, as outlined here:'
  prefs: []
  type: TYPE_NORMAL
- en: Download jQuery and import it from our web server. Using this method, we keep
    control over the library and we are sure that the file will be reachable if we
    have our own website too.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Use the hosted libraries of the Google-hosted bookstores reachable from any
    website. The advantage is that we avoid an HTTP request to our server, which saves
    a bit of power.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In this chapter, we will host jQuery on our web server to not be dependent on
    a host.
  prefs: []
  type: TYPE_NORMAL
- en: We will import jQuery in all the pages of our application because we might need
    multiple pages. In addition, the cache of the browser will keep jQuery for some
    time so as not to download it too often. For this, we will download jQuery 1.11.0
    and save it on the `TasksManager/static/javascript/lib/jquery-1.11.0.js` file.
  prefs: []
  type: TYPE_NORMAL
- en: 'Then, you must add the following line in the head tag of the `base.html` file:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: With these changes, we can use jQuery in all the pages of our website, and we
    can add lines in the `head` block from the template which extends `base.html`.
  prefs: []
  type: TYPE_NORMAL
- en: Working with AJAX in the task manager
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 'In this section, we will modify the page that displays the list of tasks for
    deleting the tasks to be carried out in AJAX. To do this, we will perform the
    following steps:'
  prefs: []
  type: TYPE_NORMAL
- en: Add a `Delete` button on the `task_list` page.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Create a JavaScript file that will contain the AJAX code and the function that
    will process the return value of the AJAX request.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: Create a Django view that will delete the task.
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: 'We will add the Delete button by modifying the `tasks_list.html` template.
    To do this, you must change the `for` task in task loop in `tasks_list` as follows:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 'In the preceding code, we added an `id` property to the `<tr>` tag. This property
    will be useful in the JavaScript code to delete the task line when the page will
    receive the AJAX response. We also replaced the **Delete** link with a **Delete**
    button that executes the JavaScript `task_delete()` function. The new button will
    call the `task_delete()` function to execute the AJAX request. This function accepts
    two parameters:'
  prefs: []
  type: TYPE_NORMAL
- en: The identifier of the task
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: The URL of the AJAX request
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 'We will create this function in the `static/javascript/task.js` file by adding
    the following code:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'We must add the following lines after the `title_html` block in the `tasks_list.html`
    template to import `task.js` in the template:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: 'We must add the following URL to the `urls.py` file:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: 'This URL will use the views contained in the `view/ajax/task_delete_ajax.py`
    file. We must create the AJAX module with the `__init__.py file` and our `task_delete_ajax.py`
    file with the following content:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: Summary
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: In this chapter, we learned how to use jQuery. We saw how to easily access the
    DOM with this library. We also created an AJAX request on our `TasksManager` application
    and we wrote the view to process this request.
  prefs: []
  type: TYPE_NORMAL
- en: In the next chapter, we will learn how to deploy a Django project based on the
    Nginx and PostgreSQL server. We will see and discuss the installation step by
    step.
  prefs: []
  type: TYPE_NORMAL
